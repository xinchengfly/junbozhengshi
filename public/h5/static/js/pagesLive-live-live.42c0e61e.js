(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pagesLive-live-live"],{"0660":function(e,t,n){"use strict";var r=n("4932"),i=n.n(r);i.a},"0665":function(e,t,n){"use strict";var r=n("4ea4");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=r(n("77c4")),o=(r(n("49ae")),n("c8c3"),{components:{uniLoadMore:i.default},data:function(){return{popupVisible:!1,emojiShow:!1,inputBottom:0,inputheight:0,content:""}},beforeCreate:function(){},props:["emojiData"],methods:{selemoji:function(e){console.log(e),this.content+=e},show:function(){this.popupVisible=!0},close:function(){this.popupVisible=!1},sendTextMsg:function(){uni.hideKeyboard(),this.$emit("closeMsg",this.content),this.content="",this.emojiShow=!1,this.popupVisible=!1},inputFocus:function(e){this.inputBottom=e.detail.height,this.emojiShow=!1,console.log(e)},inputBlur:function(){this.inputBottom=0}}});t.default=o},"0676":function(e,t){function n(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}e.exports=n},"076b":function(e,t,n){var r=n("24fb");t=r(!1),t.push([e.i,".iconfont[data-v-0efb07cb]{font-family:nvueIcon}.nlv_borT[data-v-0efb07cb]{border-color:#ebebeb;border-style:solid;border-top-width:%?1?%}.wrapgift-mask[data-v-0efb07cb]{background-color:#000;opacity:.1;position:fixed;left:0;right:0;top:0;bottom:0;z-index:201910}.pop__ui_child[data-v-0efb07cb]{background-color:#fbfbfb;border-top-left-radius:12px;border-top-right-radius:12px;font-size:14px;overflow:hidden;position:fixed;bottom:0;left:0;right:0;z-index:201911}.more-box[data-v-0efb07cb]{background-color:#2a2634;width:%?750?%;height:%?350?%;position:fixed;bottom:0;border-top-left-radius:%?16?%;border-top-right-radius:%?16?%;display:flex;flex-direction:row;align-items:center;justify-content:center;padding:0 %?20?%;z-index:9999}.more-list[data-v-0efb07cb]{display:flex;flex-direction:column;justify-content:center;flex:1;align-items:center;padding:%?50?% 0}.more-icont[data-v-0efb07cb]{font-size:%?76?%}.more-list-active[data-v-0efb07cb]{border-width:%?1?%;border-color:#ea4678;border-style:solid;border-radius:%?16?%}.Progress[data-v-0efb07cb]{background-color:rgba(0,0,0,.3);\n\t/* opacity: 0.3; */height:%?100?%;width:%?700?%;position:fixed;bottom:%?370?%;border-radius:%?16?%;left:%?25?%;display:flex;flex-direction:row;align-items:center;justify-content:center;padding:0 %?30?%}.progress-bar[data-v-0efb07cb]{position:fixed;bottom:%?360?%;width:%?750?%;justify-content:center}.wrap__giftPanel[data-v-0efb07cb]{z-index:100}.icon-weixin[data-v-0efb07cb]{color:#04be01;background:none}.icon-jingmeihaibao[data-v-0efb07cb]{background:none}",""]),e.exports=t},"0927":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r={data:function(){return{type:0,width:600,backgroundColor:"none",boxShadow:"none",form:{},coupon:[]}},props:["qrcode","winHeight"],created:function(){},mounted:function(){this.setData()},methods:{setData:function(){console.log(this.winHeight)},hidePopupFunc:function(e){this.isPopup=!1,this.$emit("close")},savePosterImg:function(){var e=this;uni.showLoading({title:"加载中"}),uni.downloadFile({url:e.qrcode,success:function(t){uni.hideLoading(),uni.saveImageToPhotosAlbum({filePath:t.tempFilePath,success:function(t){uni.showToast({title:"保存成功",icon:"success",duration:2e3}),e.isCreatedImg=!1},fail:function(e){"saveImageToPhotosAlbum:fail auth deny"===e.errMsg&&(uni.showToast({title:"请允许访问相册后重试",icon:"none",duration:1e3}),setTimeout((function(){uni.openSetting()}),1e3))},complete:function(e){console.log("complete")}})}})}}};t.default=r},"0ccb":function(e,t,n){var r=n("50c4"),i=n("1148"),o=n("1d80"),a=Math.ceil,s=function(e){return function(t,n,s){var c,u,l=String(o(t)),d=l.length,f=void 0===s?" ":String(s),h=r(n);return h<=d||""==f?l:(c=h-d,u=i.call(f,a(c/f.length)),u.length>c&&(u=u.slice(0,c)),e?l+u:u+l)}};e.exports={start:s(!1),end:s(!0)}},"0f10":function(e,t,n){"use strict";n.r(t);var r=n("fbe4"),i=n.n(r);for(var o in r)"default"!==o&&function(e){n.d(t,e,(function(){return r[e]}))}(o);t["default"]=i.a},"108f":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;n("fcde");var r={data:function(){return{showPlanView:!1,open_plan:!1,userInfo:{},planList:[],payType:20,choose_id:0}},props:["gift_name"],beforeCreate:function(){},methods:{show:function(){this.showPlanView=!0,this.getUser(),this.getPlan()},getRequest:function(){var e=this;return e},getUser:function(){var e=this;e.getRequest()._get("user.user/detail",{},(function(t){e.userInfo=t.data.userInfo}))},getPlan:function(){var e=this;e.getRequest()._get("plus.live.plan/lists",{},(function(t){e.planList=t.data.list}))},chooseplan:function(e){this.choose_id=e.plan_id},submit:function(){var e=this;uni.showLoading({title:"加载中"}),e.getRequest()._post("plus.live.plan/submit",{plan_id:e.choose_id},(function(t){e.gotoPage("/pages/order/cashier?order_id="+t.data.order_id+"&order_type=30")}))},showError:function(e,t){uni.showModal({title:"友情提示",content:e,showCancel:!1,success:function(e){t&&t()}})},showSuccess:function(e,t){uni.showModal({title:"友情提示",content:e,showCancel:!1,success:function(e){t&&t()}})},changeType:function(e){this.payType=e},close:function(){this.showPlanView=!1,this.$emit("closePlan")}}};t.default=r},1148:function(e,t,n){"use strict";var r=n("a691"),i=n("1d80");e.exports="".repeat||function(e){var t=String(i(this)),n="",o=r(e);if(o<0||o==1/0)throw RangeError("Wrong number of repetitions");for(;o>0;(o>>>=1)&&(t+=t))1&o&&(n+=t);return n}},"11b0":function(e,t,n){function r(e){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}n("a4d3"),n("e01a"),n("d28b"),n("a630"),n("d3b7"),n("3ca3"),n("ddb0"),e.exports=r},"12e3":function(e,t,n){"use strict";var r=n("156c"),i=n.n(r);i.a},"130f":function(e,t,n){var r=n("23e7"),i=n("da84"),o=n("2cf4"),a=!i.setImmediate||!i.clearImmediate;r({global:!0,bind:!0,enumerable:!0,forced:a},{setImmediate:o.set,clearImmediate:o.clear})},"143c":function(e,t,n){var r=n("74e8");r("Int32",(function(e){return function(t,n,r){return e(this,t,n,r)}}))},"14bd":function(e,t,n){"use strict";var r;n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return o})),n.d(t,"a",(function(){return r}));var i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return e.popupVisible?n("v-uni-view",{staticClass:"popup-footer"},[n("v-uni-view",{staticClass:"pop__ui_panel"},[n("v-uni-view",{staticClass:"pop__ui_mask",on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.close.apply(void 0,arguments)}}}),n("v-uni-view",{staticClass:"pop__ui_child anim-footer",on:{click:function(t){t.stopPropagation(),arguments[0]=t=e.$handleEvent(t)}}},[n("div",[e.live_user?n("div",{staticClass:"foot-anchorinfo-wrap-anchorinfo p-0-20 tc"},[n("div",{staticClass:"foot-anchorinfo-wrap-nickName d-c-c fb f34"},[n("v-uni-text",[e._v(e._s(e.live_user.supplier.name))])],1),n("div",{staticClass:"d-c-c d-r mt20 gray9 f28"},[n("v-uni-text",{staticClass:"p-0-10 gray6 f28"},[e._v("粉丝"+e._s(e.live_user.supplier.fav_count))]),n("v-uni-text",{staticClass:"p-0-10 gray6 f28"},[e._v("点赞"+e._s(e.live_user.digg_num))])],1)]):e._e(),n("div",{staticClass:"foot-anchorinfo-wrap-bottom d-b-c d-r"},[e.is_follow?e._e():n("div",{staticClass:"foot-anchorinfo-guanzhu flex-1 d-c-c",on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.followFunc.apply(void 0,arguments)}}},[n("v-uni-text",{staticClass:"f34 gray6"},[e._v("+关注")])],1),e.is_follow?n("div",{staticClass:"foot-anchorinfo-guanzhu flex-1 d-c-c",on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.followFunc.apply(void 0,arguments)}}},[n("v-uni-text",{staticClass:"f34 gray6"},[e._v("已关注")])],1):e._e(),n("div",{staticClass:"foot-anchorinfo-zhuye flex-1 d-c-c",on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.gotoAnchorPage.apply(void 0,arguments)}}},[n("v-uni-text",{staticClass:"f34 gray6"},[e._v("主页")])],1)])]),n("div",{staticClass:"foot-anchorinfo-wrap-photo-box"},[n("v-uni-image",{staticClass:"foot-anchorinfo-wrap-photo",attrs:{src:e.live_user.supplier.logo.file_path,mode:"aspectFill"}})],1)])],1)],1):e._e()},o=[]},"156c":function(e,t,n){var r=n("a2ba");"string"===typeof r&&(r=[[e.i,r,""]]),r.locals&&(e.exports=r.locals);var i=n("4f06").default;i("0e9560b9",r,!0,{sourceMap:!1,shadowMode:!1})},"164d":function(e,t,n){var r=n("2ff1");"string"===typeof r&&(r=[[e.i,r,""]]),r.locals&&(e.exports=r.locals);var i=n("4f06").default;i("3ed786aa",r,!0,{sourceMap:!1,shadowMode:!1})},"1bc5":function(e,t,n){var r=n("24fb");t=r(!1),t.push([e.i,".m-auto[data-v-7445f8ed]{margin:0 auto}.pop__ui_mask[data-v-7445f8ed]{background-color:#000;opacity:.1;position:fixed;left:0;right:0;top:0;bottom:0;z-index:1000}.pop__ui_child[data-v-7445f8ed]{background-color:#fbfbfb;border-top-left-radius:12px;border-top-right-radius:12px;font-size:14px;overflow:hidden;position:fixed;bottom:0;left:0;right:0;z-index:1001}.pop__ui_head[data-v-7445f8ed]{border-style:solid;border-color:#ebebeb;border-bottom-width:%?1?%;font-size:%?28?%;font-weight:700;padding:%?30?%;text-align:left}.wrap_carts[data-v-7445f8ed]{height:%?650?%}.item[data-v-7445f8ed]{flex-direction:row;align-items:center;padding:%?30?%;position:relative}.gpic[data-v-7445f8ed]{margin-right:%?30?%;height:50px;width:50px}.ginfo[data-v-7445f8ed]{flex:1}.name[data-v-7445f8ed]{font-size:%?28?%}.price[data-v-7445f8ed]{color:#ff0f33;font-size:%?28?%;margin-top:%?15?%}.gbtn[data-v-7445f8ed]{background-image:linear-gradient(90deg,#ff540a,#ff0f33);border-radius:%?5?%;color:#fff;font-size:%?28?%;padding:%?12?% %?25?%}.product-head[data-v-7445f8ed]{flex-direction:row}.product-head-btn[data-v-7445f8ed],.add-product-head-btn[data-v-7445f8ed]{height:%?60?%;line-height:%?60?%;background-color:#fff;border-color:#f72b6c}.add-product-list[data-v-7445f8ed]{width:%?750?%;height:%?700?%}.add-product-head[data-v-7445f8ed]{flex-direction:row}.add-product-item[data-v-7445f8ed]{flex-direction:row;padding:%?20?%}.add-product-picture[data-v-7445f8ed]{width:%?160?%;height:%?160?%}.add-product-picture-image[data-v-7445f8ed]{width:%?160?%;height:%?160?%}.text-ellipsis-2[data-v-7445f8ed]{height:%?70?%}.add-product-relation[data-v-7445f8ed]{background-color:#51a938;color:#fff;border-color:#51a938;font-size:12px;display:flex;align-items:center;border-radius:%?6?%;width:%?120?%;padding:%?10?% 0}.add-product-relation uni-text[data-v-7445f8ed]{\n\t/* display: flex;\n\theight: 60rpx;\n\tline-height: 60rpx; */}.add-product-relation-hover[data-v-7445f8ed]{background-color:#abd7a2;border-color:#abd7a2}.add-product-order[data-v-7445f8ed]{position:absolute;width:%?750?%;height:%?900?%;right:0;bottom:0;left:0;border-radius:%?16?% %?16?% 0 0;background-color:#fff;transition:-webkit-transform .2s ease;transition:transform .2s ease;transition:transform .2s ease,-webkit-transform .2s ease;-webkit-transform:translate(0);transform:translate(0)}.add-product-order-close[data-v-7445f8ed]{transition:-webkit-transform 0s ease;transition:transform 0s ease;transition:transform 0s ease,-webkit-transform 0s ease;-webkit-transform:translateY(100%);transform:translateY(100%)}.order-close[data-v-7445f8ed]{width:%?40?%;height:%?40?%}.add-order-head[data-v-7445f8ed]{background-color:#eee;flex-direction:row}.order-num[data-v-7445f8ed]{font-size:28px;color:#ababab;margin-bottom:%?10?%}.order-title[data-v-7445f8ed]{text-overflow:ellipsis;overflow:hidden}.order-money[data-v-7445f8ed]{margin-top:%?20?%}",""]),e.exports=t},"1bf2":function(e,t,n){var r=n("23e7"),i=n("56ef");r({target:"Reflect",stat:!0},{ownKeys:i})},"1bfa":function(e,t,n){"use strict";var r=n("4ea4");n("99af"),n("4160"),n("c975"),n("a434"),n("159b"),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=r(n("77c4")),o={components:{uniLoadMore:i.default},data:function(){return{popupVisible:!1,product_active:"",total:0,open_products:!1,relationIds:[],productList:[],open_order:!1,open_addproduct:!1,no_more:!1,listData:[],page:1,list_rows:10,productIds:[],open_Order:!1,loading:!1}},props:["isCaster","room_id","shop_supplier_id"],computed:{loadingType:function(){return this.loading?1:0!=this.listData.length&&this.no_more?2:0}},methods:{show:function(e){this.popupVisible=!0,this.getProduct()},getRequest:function(){var e=this;return e},getProduct:function(){var e=this;e.open_addproduct=!1,e.relationIds=[],uni.showLoading({title:"正在加载",mask:!0}),e.getRequest()._get("plus.live.RoomApply/liveproduct",{shop_supplier_id:e.shop_supplier_id},(function(t){if(uni.hideLoading(),null!=t.data.list){e.productList=t.data.list.data;for(var n=0;n<e.productList.length;n++)e.relationIds.push(e.productList[n].product_id);e.total=t.data.list.total}}),!1,(function(){uni.hideLoading()}))},addProductFunc:function(){var e=this;this.open_addproduct=!0,this.productIds=[],this.relationIds.forEach((function(t){e.productIds.push(t)})),this.start()},start:function(){this.loading=!0,this.no_more=!1,this.listData=[],this.page=1,this.list_rows=10,this.getData()},getData:function(){var e=this,t=e.page,n=e.list_rows;e.loading=!0,e.getRequest()._get("plus.live.RoomApply/product_list",{page:t||1,list_rows:n},(function(t){e.loading=!1,e.listData=e.listData.concat(t.data.list.data),e.last_page=t.data.list.last_page,t.data.list.last_page<=1&&(e.no_more=!0)}))},loadmoreFunc:function(){var e=this;if(e.bottomRefresh=!0,e.page++,e.loading=!0,e.page>e.last_page)return e.loading=!1,void(e.no_more=!0);e.getData()},isrelation:function(e){return-1!=this.productIds.indexOf(e.product_id)},relationProduct:function(e){this.productIds.push(e.product_id)},confirmFunc:function(){var e=this,t=e.productIds;if(t.length>0){for(var n=0;n<t.length;n++)-1!=e.relationIds.indexOf(t[n])&&(t.splice(n,1),n--);0!=t.length?e.getRequest()._post("plus.live.RoomApply/addProduct",{productIds:t},(function(t){e.getProduct()})):e.getProduct()}else e.getProduct()},setProduct:function(e){var t=this;uni.showLoading({title:"设置中",mask:!0}),t.getRequest()._post("plus.live.room/set_product",{room_id:t.room_id,product_id:e.product_id},(function(n){t.product_active=e.product_id,t.$emit("setProduct",e.product_id),t.close()}))},gotoProduct:function(e){var t="/pages/product/detail/detail?product_id="+e.product_id+"&room_id="+this.room_id;this.gotoPage(t)},openOrder:function(){this.popupVisible=!1,this.$emit("openOrder")},close:function(){this.open_addproduct?this.open_addproduct=!1:this.popupVisible=!1}}};t.default=o},"1d3e":function(e,t,n){"use strict";var r;n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return o})),n.d(t,"a",(function(){return r}));var i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return e.popupVisible?n("v-uni-view",{staticClass:"wrap__giftPanel"},[n("v-uni-view",{staticClass:"wrapgift-mask",on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.close.apply(void 0,arguments)}}}),n("v-uni-view",{staticClass:"pop__ui_child anim-footer"},[n("div",{staticClass:"more-box",on:{click:function(t){t.stopPropagation(),arguments[0]=t=e.$handleEvent(t)}}},[n("div",{staticClass:"more-list",on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.share.apply(void 0,arguments)}}},[n("v-uni-button",{staticClass:"icon iconfont icon-weixin i-btntool more-icont",attrs:{"open-type":"share"}}),n("v-uni-text",{staticClass:"f28 white mt20"},[e._v("分享微信好友")])],1),n("div",{staticClass:"more-list",on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.getPoster.apply(void 0,arguments)}}},[n("v-uni-button",{staticClass:"icon iconfont icon-jingmeihaibao i-btntool more-icont"}),n("v-uni-text",{staticClass:"f28 white mt20"},[e._v("生成海报")])],1)])])],1):e._e()},o=[]},"20bf":function(e,t,n){"use strict";var r=n("8aa7"),i=n("ebb5").exportTypedArrayStaticMethod,o=n("a078");i("from",o,r)},2236:function(e,t,n){var r=n("5a43");function i(e){if(Array.isArray(e))return r(e)}e.exports=i},"23fd":function(e,t,n){"use strict";var r;n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return o})),n.d(t,"a",(function(){return r}));var i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return e.popupVisible?n("v-uni-view",{staticClass:"popup-footer"},[n("v-uni-view",{staticClass:"pop__ui_panel"},[n("v-uni-view",{staticClass:"pop__ui_mask",on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.close.apply(void 0,arguments)}}}),n("v-uni-view",{staticClass:"pop__ui_child anim-footer",on:{click:function(t){t.stopPropagation(),arguments[0]=t=e.$handleEvent(t)}}},[e.open_addproduct?e._e():n("div",[n("div",{staticClass:"product-head d-b-c p20 f30"},[n("v-uni-text",{staticClass:"ml10"},[e._v("共"+e._s(e.total)+"件商品")]),n("div",{staticClass:"d-s-c"},[n("v-uni-button",{staticClass:"product-head-btn",on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.openOrder.apply(void 0,arguments)}}},[n("v-uni-text",{staticClass:"rose f30"},[e._v("订单")])],1)],1)],1),n("list",{staticClass:"add-product-list"},e._l(e.productList,(function(t,r){return n("cell",{key:r,staticClass:"add-product-item d-s-s"},[n("div",{staticClass:"add-product-picture"},[n("v-uni-view",[n("v-uni-image",{staticClass:"add-product-picture-image",attrs:{src:t.image[0].file_path,mode:"aspectFill"}})],1),n("v-uni-text",{staticClass:"rose f28"})],1),n("div",{staticClass:"flex-1 ml20"},[n("div",{staticClass:"text-ellipsis-2"},[n("v-uni-text",{staticClass:"f28"},[e._v(e._s(t.product_name))])],1),n("div",{staticClass:"d-s-s d-r p-20-0"},[n("div",{staticClass:"d-s-s price d-r flex-1 f24"},[n("v-uni-text",{staticClass:"f34 fb rose"},[e._v(e._s(t.product_price))])],1),e.isCaster&&e.product_active!=t.product_id?n("div",{staticClass:"add-product-relation",on:{click:function(n){arguments[0]=n=e.$handleEvent(n),e.setProduct(t)}}},[n("v-uni-text",{staticClass:"white f28"},[e._v("设为讲解")])],1):e._e(),e.product_active==t.product_id?n("div",{staticClass:"add-product-relation"},[n("v-uni-text",{staticClass:"white f28"},[e._v("讲解中")])],1):e._e(),e.isCaster?e._e():n("div",{staticClass:"add-product-relation",on:{click:function(n){arguments[0]=n=e.$handleEvent(n),e.gotoProduct(t)}}},[n("v-uni-text",{staticClass:"white f28 m-auto"},[e._v("去购买")])],1)])])])})),1)],1),e.open_addproduct?n("div",[n("div",{staticClass:"add-product-head d-b-c p20 f30"},[n("v-uni-text",{staticClass:"f30"},[e._v("关联商品")]),n("v-uni-button",{staticClass:"add-product-head-btn",attrs:{type:"default"},on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.confirmFunc(!0)}}},[n("v-uni-text",{staticClass:"rose f28"},[e._v("确认")])],1)],1),n("v-uni-scroll-view",{staticClass:"add-product-list",attrs:{"scroll-y":"true"},on:{scrolltolower:function(t){arguments[0]=t=e.$handleEvent(t),e.loadmoreFunc.apply(void 0,arguments)}}},[e._l(e.listData,(function(t,r){return n("v-uni-view",{key:r,staticClass:"add-product-item d-b-c"},[n("div",{staticClass:"add-product-picture"},[n("v-uni-image",{staticClass:"add-product-picture-image",attrs:{src:t.product_image,mode:"aspectFill"}})],1),n("div",{staticClass:"ml20 flex-1"},[n("div",{staticClass:"text-ellipsis-2"},[n("v-uni-text",{staticClass:"f30"},[e._v(e._s(t.product_name))])],1),n("div",{staticClass:"d-s-s d-r p-20-0"},[n("div",{staticClass:"d-s-s price d-r flex-1 f24"},[n("v-uni-text",{staticClass:"ml20 gray9 f28"},[e._v("售价："+e._s(t.product_price))])],1),e.isrelation(t)?e._e():n("div",{staticClass:"add-product-relation",on:{click:function(n){arguments[0]=n=e.$handleEvent(n),e.relationProduct(t)}}},[n("v-uni-text",{staticClass:"white f28"},[e._v("添加")])],1),e.isrelation(t)?n("div",{staticClass:"add-product-relation add-product-relation-hover"},[n("v-uni-text",{staticClass:"white f28"},[e._v("已添加")])],1):e._e()])])])})),0!=e.listData.length||e.loading?n("uni-load-more",{attrs:{loadingType:e.loadingType}}):n("v-uni-view",{staticClass:"d-c-c p30"},[n("v-uni-text",{staticClass:"cont"},[e._v("亲，暂无相关记录哦")])],1)],2)],1):e._e()])],1)],1):e._e()},o=[]},"25a6":function(e,t,n){"use strict";n.r(t);var r=n("5364"),i=n.n(r);for(var o in r)"default"!==o&&function(e){n.d(t,e,(function(){return r[e]}))}(o);t["default"]=i.a},"25eb":function(e,t,n){var r=n("23e7"),i=n("c20d");r({target:"Number",stat:!0,forced:Number.parseInt!=i},{parseInt:i})},"278c":function(e,t,n){var r=n("c135"),i=n("9b42"),o=n("6613"),a=n("c240");function s(e,t){return r(e)||i(e,t)||o(e,t)||a()}e.exports=s},29548:function(e,t,n){"use strict";var r=n("80604"),i=n.n(r);i.a},"2bab":function(e,t,n){var r=n("24fb");t=r(!1),t.push([e.i,'@charset "UTF-8";\r\n/**\r\n * 这里是uni-app内置的常用样式变量\r\n *\r\n * uni-app 官方扩展插件及插件市场（https://ext.dcloud.net.cn）上很多三方插件均使用了这些样式变量\r\n * 如果你是插件开发者，建议你使用scss预处理，并在插件代码中直接使用这些变量（无需 import 这个文件），方便用户通过搭积木的方式开发整体风格一致的App\r\n *\r\n */\r\n/**\r\n * 如果你是App开发者（插件使用者），你可以通过修改这些变量来定制自己的插件主题，实现自定义主题功能\r\n *\r\n * 如果你的项目同样使用了scss预处理，你也可以直接在你的 scss 代码中使用如下变量，同时无需 import 这个文件\r\n */\r\n/* 颜色变量 */\r\n/* 行为相关颜色 */\r\n/* 文字基本颜色 */\r\n/* 背景颜色 */\r\n/* 边框颜色 */\r\n/* 尺寸变量 */\r\n/* 文字尺寸 */\r\n/* 图片尺寸 */\r\n/* Border Radius */\r\n/* 水平间距 */\r\n/* 垂直间距 */\r\n/* 透明度 */\r\n/* 文章场景相关 */\r\n/* start--主题色--start */\r\n/* end--主题色--end */.pop__ui_mask[data-v-49660634]{background-color:#000;opacity:.1;position:fixed;left:0;right:0;top:0;bottom:0;z-index:1000}.pop__ui_child[data-v-49660634]{background-color:#fbfbfb;border-top-left-radius:12px;border-top-right-radius:12px;font-size:14px;overflow:hidden;position:fixed;bottom:0;left:0;right:0;z-index:1001}.pop__ui_head[data-v-49660634]{border-style:solid;border-color:#ebebeb;border-bottom-width:%?1?%;font-size:%?28?%;font-weight:700;padding:%?30?%;text-align:center}.iconfont[data-v-49660634]{font-family:nvueIcon}.wrap_commentPanel[data-v-49660634]{flex-direction:column;height:%?11?%}.uni_borT[data-v-49660634]{border-color:#dbdbdb;border-style:solid;border-top-width:%?1?%}.wrap__editorPanel[data-v-49660634]{flex-direction:row;align-items:flex-end;background-color:#fff;padding:%?20?% %?30?%}.wrap_editor[data-v-49660634]{flex:1;overflow:hidden}.editor[data-v-49660634]{font-size:14px;line-height:1.2}.wrap_cmtFoot[data-v-49660634]{position:fixed;left:0;right:0;z-index:201911}.uni__editorPanel .uni_editor[data-v-49660634]{box-sizing:border-box;overflow:hidden}.uni_editor .editor[data-v-49660634]{caret-color:#41a863;font-size:%?28?%;max-height:%?200?%;max-width:100%;line-height:1.2}.uni__editorPanel .uni_editor_btn[data-v-49660634]{align-self:flex-end;justify-content:center;padding:0 %?8?%;height:%?56?%}.uni__editorPanel .uni_editor_btn .iconfont[data-v-49660634]{color:#999;font-size:%?50?%}.uni__editorPanel .btn_submit[data-v-49660634]{border-radius:%?40?%;font-size:%?28?%;margin-left:%?10?%;padding:0 %?24?%;line-height:%?56?%}.uni__editorPanel .btn_submit .iconfont[data-v-49660634]{color:#999;font-size:%?48?%}.bc-white[data-v-49660634]{background-color:#fff}.slider[data-v-49660634]{width:%?750?%;height:%?256?%}.slider-emoji[data-v-49660634]{width:%?750?%;direction:ltr;flex-direction:row;flex-wrap:wrap;justify-content:center;align-content:flex-start;align-items:stretch}.slider-emoji-icon[data-v-49660634]{width:%?105?%;text-align:center;padding:%?21?% 0}.lastbox[data-v-49660634]{justify-content:flex-start}',""]),e.exports=t},"2d0d":function(e,t,n){n("4ae1");var r=n("36c6"),i=n("6f8f"),o=n("6b58");function a(e){var t=i();return function(){var n,i=r(e);if(t){var a=r(this).constructor;n=Reflect.construct(i,arguments,a)}else n=i.apply(this,arguments);return o(this,n)}}e.exports=a},"2ff1":function(e,t,n){var r=n("24fb");t=r(!1),t.push([e.i,".iconfont[data-v-7fe5f9f8]{font-family:iconfont}uni-image[data-v-7fe5f9f8]{border:0;display:inline-block;vertical-align:top;max-width:100%;position:relative}.avator-scrollbox .avator-scroll .mr_20[data-v-7fe5f9f8]{margin-right:%?-20?%}.nlv__container[data-v-7fe5f9f8]{flex:1;height:100%}.nlv_topbar[data-v-7fe5f9f8]{flex:1;flex-direction:row;align-items:center;position:absolute;left:0;right:0;top:0;z-index:1001}.topbar-info[data-v-7fe5f9f8]{flex:1;flex-direction:row;align-items:center;padding-left:%?20?%;flex-flow:column;align-items:baseline;padding-top:%?10?%}.avator-box[data-v-7fe5f9f8]{background-color:rgba(0,0,0,.4);border-radius:%?30?%;flex-direction:row;align-items:center;padding-right:%?6?%;height:%?60?%;margin-bottom:%?20?%}.ta-avator[data-v-7fe5f9f8]{border-radius:50%;margin-right:%?10?%;height:%?60?%;width:%?60?%}.tabox[data-v-7fe5f9f8]{text-overflow:ellipsis;width:%?150?%;line-height:%?27?%}.ta-name[data-v-7fe5f9f8]{color:#fff;font-size:%?24?%}.ta-num[data-v-7fe5f9f8]{color:#fff;font-size:%?24?%}.ta-gz[data-v-7fe5f9f8]{background-image:linear-gradient(90deg,#ff540a,#ff0f33);border-radius:%?40?%;color:#fff;font-size:%?24?%;text-align:center;padding:%?8?% 0;width:%?90?%}.ta-gz-on[data-v-7fe5f9f8]{background-color:hsla(0,0%,100%,.2);background-image:none}.avator-scroll[data-v-7fe5f9f8]{padding-left:%?20?%;\nwhite-space:nowrap;\nflex-direction:row;padding:0 %?10?%;height:%?60?%;width:%?230?%}.member-num[data-v-7fe5f9f8]{background-color:rgba(0,0,0,.4);border-radius:%?40?%;color:#fff;font-size:%?24?%;text-align:center;padding:%?10?% %?14?%}.topbar-right[data-v-7fe5f9f8]{flex-direction:row;margin-top:%?-10?%}.topbar_ico[data-v-7fe5f9f8]{color:#fff;font-size:%?40?%;padding:%?15?%;position:relative;z-index:1001}.nlv-rankbox[data-v-7fe5f9f8]{position:absolute;left:0;right:0;z-index:1001;direction:ltr;flex-direction:row}.nlv-rkls[data-v-7fe5f9f8]{flex-direction:row;align-items:center}.rkitem[data-v-7fe5f9f8]{background-image:linear-gradient(90deg,rgba(255,56,166,.5),rgba(57,159,255,.5));border-radius:%?40?%;color:#fff;font-size:%?24?%;margin-left:%?20?%;padding:%?4?% %?10?%}.nlv-uid[data-v-7fe5f9f8]{color:hsla(0,0%,100%,.5);font-size:%?28?%;position:absolute;right:%?20?%;top:0}.nlv_main[data-v-7fe5f9f8]{flex:1;height:100%}.nlv-swiper[data-v-7fe5f9f8]{flex:1}.nlv-playerbox[data-v-7fe5f9f8]{flex:1}.player-video[data-v-7fe5f9f8]{height:100%;width:100%}.nlv-footToolbar[data-v-7fe5f9f8]{position:absolute;left:0;right:0;bottom:0}.nlv-giftTipPanel[data-v-7fe5f9f8]{flex-direction:column;margin-left:%?20?%;margin-bottom:%?180?%}.giftip-item[data-v-7fe5f9f8]{background-color:rgba(0,0,0,.3);border-radius:%?100?%;padding:%?8?%;padding-right:%?100?%;flex-direction:row;align-items:center;width:%?410?%;margin-top:%?10?%}.gt-avator[data-v-7fe5f9f8]{border-radius:50%;height:%?72?%;width:%?72?%}.gt-info[data-v-7fe5f9f8]{padding:0 %?20?%;overflow:hidden;width:%?230?%}.gt-tit[data-v-7fe5f9f8]{color:#fff;font-size:%?28?%;overflow:hidden;height:%?40?%;line-height:%?40?%}.gt-subtit[data-v-7fe5f9f8]{color:hsla(0,0%,100%,.7);font-size:%?24?%;letter-spacing:%?4?%}.gt-gift[data-v-7fe5f9f8]{height:%?100?%;width:%?100?%;position:absolute;top:%?-6?%;right:%?35?%}.nlv-rollMsgPanel[data-v-7fe5f9f8]{margin-left:%?20?%;margin-bottom:%?20?%;height:%?400?%;width:%?500?%}.nlv-msglist[data-v-7fe5f9f8]{margin-top:%?10?%;flex-direction:column;align-items:flex-start}.msg_bg[data-v-7fe5f9f8]{background-color:rgba(0,0,0,.3);border-radius:%?24?%;padding:%?8?% %?14?%;flex-direction:row;flex-wrap:wrap}.msg_name[data-v-7fe5f9f8]{color:#fff81f;font-size:%?28?%}.msg_text[data-v-7fe5f9f8]{color:#fff;font-size:%?28?%;display:flex;justify-content:flex-start;flex-wrap:wrap;flex-wrap:wrap;overflow:hidden;width:%?450?%;direction:ltr;flex-direction:row\n\t/* width: 476rpx; */}.msg_txtxt[data-v-7fe5f9f8]{color:#fff;font-size:%?28?%;height:%?28?%}.nlv-infobox[data-v-7fe5f9f8]{padding:%?20?%;flex:1;flex-direction:row;align-items:center}.nlv_reply[data-v-7fe5f9f8]{flex:1;flex-direction:row;background-color:rgba(0,0,0,.3);border-radius:%?50?%;padding:%?23?%}.nlv_reply_text[data-v-7fe5f9f8]{color:#fff;font-size:%?30?%}.nlv_btntool[data-v-7fe5f9f8]{flex-direction:row;justify-content:flex-end}.btn-toolitem[data-v-7fe5f9f8]{display:flex;background-color:rgba(0,0,0,.3);border-radius:50%;align-items:center;justify-content:center;margin-left:%?10?%;height:%?75?%;width:%?75?%;text-align:center;line-height:%?75?%;border-width:0}.btn-toolitem-cart[data-v-7fe5f9f8]{background-image:linear-gradient(90deg,#ff955d,#f93b37)}.i-btntool[data-v-7fe5f9f8]{color:#fff;font-size:%?40?%}.avator-scrollbox[data-v-7fe5f9f8]{flex-direction:row;margin-left:%?-75?%}.product[data-v-7fe5f9f8]{position:fixed;bottom:%?140?%;right:%?20?%;background-color:#fff;padding:%?10?%;z-index:99;border-radius:%?15?%}.product-pic[data-v-7fe5f9f8]{width:%?200?%;height:%?200?%}.product-img[data-v-7fe5f9f8]{width:100%;height:100%}.product-price[data-v-7fe5f9f8]{display:flex;flex-direction:row;align-items:center;margin-top:%?10?%}.diggnum[data-v-7fe5f9f8]{width:%?74?%;height:%?22?%;font-size:%?20?%;background-color:#f93b37;color:#fff;text-align:center;line-height:%?22?%;border-radius:%?11?%;position:absolute;top:%?-28?%;left:0}.notice_back_image[data-v-7fe5f9f8]{position:absolute;top:0;left:0;width:%?750?%}.notice_content[data-v-7fe5f9f8]{text-align:center;padding-top:%?340?%;background-color:rgba(0,0,0,.6)}.notice_content_img[data-v-7fe5f9f8]{width:%?200?%;height:%?200?%;margin:0 auto;margin-bottom:44rxp}.notice_content_imgbox[data-v-7fe5f9f8]{display:flex;justify-content:center;align-items:center}.notice_btn[data-v-7fe5f9f8]{width:%?250?%;height:%?80?%;border-style:solid;border-width:%?1?%;border-color:#fb4b70;line-height:%?80?%;text-align:center;border-radius:%?40?%;background:none}.notice_btn_txt[data-v-7fe5f9f8]{color:#fb4d70}.notice_btns[data-v-7fe5f9f8]{flex-direction:row}.notice_title_t[data-v-7fe5f9f8]{text-align:center;color:#fff;font-size:%?34?%;height:%?120?%;line-height:%?120?%}.notice_title_c[data-v-7fe5f9f8]{text-align:center;color:#fff;font-size:%?22?%;height:%?38?%;line-height:%?38?%}.notice_title_b[data-v-7fe5f9f8]{text-align:center;color:#fff;font-size:%?26?%;height:%?120?%;line-height:%?120?%;display:flex;flex-direction:column;align-items:center;justify-content:center}.notice_share[data-v-7fe5f9f8]{position:absolute;top:0}.notice_jiantou[data-v-7fe5f9f8]{-webkit-transform:rotate(180deg);transform:rotate(180deg);color:#fff}.notice_back[data-v-7fe5f9f8]{width:%?750?%;color:#fff;display:flex;flex-direction:row;position:absolute;top:32px;z-index:0;font-size:%?30?%;align-items:center;justify-content:center}.notice_back_back[data-v-7fe5f9f8]{text-align:left;position:absolute;top:%?70?%;left:%?45?%;z-index:1}.icon-guanbi[data-v-7fe5f9f8]{color:#fff}.icon-jiantou[data-v-7fe5f9f8]{color:#fff}.msg_txt[data-v-7fe5f9f8]{color:#fff;font-size:%?28?%}.red[data-v-7fe5f9f8]{color:#e22319}",""]),e.exports=t},3367:function(e,t,n){var r=n("24fb");t=r(!1),t.push([e.i,'.iconfont[data-v-1960e106]{font-family:iconfont}.nlv_borT[data-v-1960e106]{border-color:#ebebeb;border-style:solid;border-top-width:%?1?%}.wrapgift-mask[data-v-1960e106]{background-color:#000;opacity:.1;position:fixed;left:0;right:0;top:0;bottom:0;z-index:1000}.wrapgift-body[data-v-1960e106]{overflow:hidden;position:fixed;bottom:0;left:0;right:0;z-index:1001}.gift-container-head[data-v-1960e106]{display:flex;flex-direction:row;justify-content:space-between;align-items:center;padding:%?20?%}.chongzhi[data-v-1960e106]{height:%?70?%;line-height:%?70?%}.plan-box[data-v-1960e106]{background-color:#fff;border-top-left-radius:%?20?%;border-top-right-radius:%?20?%\n\t/* height: 720rpx; */}.plan-cells[data-v-1960e106]{width:%?750?%;display:flex;flex-direction:row;flex-wrap:wrap;justify-content:flex-start;padding-top:0}.plan-cell-list[data-v-1960e106]{display:flex;flex-direction:column;width:%?225?%;margin:0 %?10?% %?20?%;align-items:center;justify-content:center;background-color:#efefef;padding:%?30?% 0;border-color:#fff;border-style:solid;border-width:1px;border-radius:%?5?%}.plan-list-title[data-v-1960e106]{display:flex;flex-direction:row;align-items:center}.plan-list-rmb[data-v-1960e106]{margin-top:%?10?%}.plan-box-head[data-v-1960e106]{display:flex;flex-direction:row;justify-content:flex-start}.plan-head-title[data-v-1960e106]{margin-left:%?200?%;padding:%?10?% 0}.plan-xieyi[data-v-1960e106]{text-align:center;padding:%?30?% 0;display:flex;flex-direction:row;justify-content:center}.plan-xieyi[data-v-1960e106]{text-align:center;padding:%?30?% 0;display:flex;flex-direction:row;justify-content:center}.paypop[data-v-1960e106]{position:absolute;top:0;z-index:1002;width:%?750?%;height:%?600?%;right:0;left:0;display:flex;align-items:center;justify-content:center}.paypop-cont[data-v-1960e106]{background-color:#fff;border-radius:%?16?%;display:flex;align-items:flex-start;justify-content:flex-start;flex-direction:column;width:%?750?%;padding-bottom:%?20?%}.paypop-list[data-v-1960e106]{width:%?750?%;padding:%?30?%;display:flex;flex-direction:row;align-items:center;justify-content:space-between;border-bottom:1px solid #f6f6f6;box-sizing:border-box}.pay-body[data-v-1960e106]{display:flex;flex:1;flex-direction:row;justify-content:flex-start}.icon-weixin[data-v-1960e106]{color:#04be01}.icon-yue1[data-v-1960e106]{color:#edde89}.icon-icon_xianshi-xian[data-v-1960e106]:before{content:"\\e658"}.icon-danxuanxuanzhong[data-v-1960e106]:before{content:"\\e623"}.icon-xuanze-active[data-v-1960e106]{color:#55bb36}.w100[data-v-1960e106]{width:%?750?%}.pan_btn[data-v-1960e106]{width:%?695?%;height:%?85?%;line-height:%?85?%;color:#fff;font-size:%?28?%;text-align:center;background-color:#fc3e5a;border-radius:%?5?%;overflow:hidden;cursor:pointer;text-decoration:none;position:relative;display:block;border-width:0;margin-top:0;margin-bottom:0;margin-left:%?27.5?%;margin-right:auto;padding-left:14px;padding-right:14px;box-sizing:border-box}.active_border[data-v-1960e106]{display:flex;flex-direction:column;width:%?225?%;margin:0 %?10?% %?20?%;align-items:center;justify-content:center;background-color:#efefef;padding:%?30?% 0;border-color:#fc3e5a;border-style:solid;border-width:1px;border-radius:%?5?%}',""]),e.exports=t},3394:function(e,t,n){var r=n("970b"),i=n("5bc3"),o=n("aea5"),a=n("fd4b"),s=function(){"use strict";function e(t){r(this,e),this._client=a.createInstance(t),this._accountName="",this._channel=null,this.isLogin=!1,this.isOff=!1,this.messageCache=[],this._eventBus=o,this.subscribeLoginEvents()}return i(e,[{key:"login",value:function(e,t){this._accountName=t;var n={token:e,uid:t};return this._client.login(n)}},{key:"subscribeLoginEvents",value:function(){var e=this;this._client.on("ConnectionStateChanged",(function(t,n){e._eventBus.emit("ConnectionStateChanged",t,n)})),this._client.on("MessageFromPeer",(function(t,n,r){var i=r.isOfflineMessage;if(console.log("MessageFromPeer"),i){var o={message:t.text,peerId:n,isOfflineMessage:i};e.messageCache.push(o)}e._eventBus.emit("MessageFromPeer",t,n,i)}))}},{key:"logout",value:function(){var e=this;return this._client.logout().then((function(){e._eventBus.clear(),e.messageCache=[]}))}},{key:"sendPeer",value:function(e,t){return this._client.sendMessageToPeer({text:e},t,{enableHistoricalMessaging:!1,enableOfflineMessaging:this.isOff})}},{key:"joinChannel",value:function(e){return this._channel=this._client.createChannel(e),this.subscribeChannelEvents(e),this._channel.join()}},{key:"subscribeChannelEvents",value:function(){var e=this;this._channel.on("MemberJoined",(function(t){e._eventBus.emit("MemberJoined",t)})),this._channel.on("MemberLeft",(function(t){e._eventBus.emit("MemberLeft",t)})),this._channel.on("MemberCountUpdated",(function(t){e._eventBus.emit("MemberCountUpdated",t)})),this._channel.on("ChannelMessage",(function(t,n){e._eventBus.emit("ChannelMessage",t,n)}))}},{key:"sendChannel",value:function(e){return this._channel.sendMessage({text:e})}},{key:"getMembers",value:function(){return this._channel.getMembers()}},{key:"leaveChannel",value:function(){return this._channel.leave()}},{key:"on",value:function(e,t){this._eventBus.on(e,t)}}]),e}();e.exports=s},"33a3":function(e,t,n){"use strict";n.r(t);var r=n("89da"),i=n.n(r);for(var o in r)"default"!==o&&function(e){n.d(t,e,(function(){return r[e]}))}(o);t["default"]=i.a},3569:function(e,t,n){"use strict";n.r(t);var r=n("dbb3"),i=n.n(r);for(var o in r)"default"!==o&&function(e){n.d(t,e,(function(){return r[e]}))}(o);t["default"]=i.a},"36c6":function(e,t,n){function r(t){return e.exports=r=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},r(t)}n("3410"),n("131a"),e.exports=r},"36ee":function(e,t,n){var r=n("afa6");"string"===typeof r&&(r=[[e.i,r,""]]),r.locals&&(e.exports=r.locals);var i=n("4f06").default;i("2fa0af89",r,!0,{sourceMap:!1,shadowMode:!1})},"37eb":function(e,t,n){"use strict";n.r(t);var r=n("108f"),i=n.n(r);for(var o in r)"default"!==o&&function(e){n.d(t,e,(function(){return r[e]}))}(o);t["default"]=i.a},"3a42":function(e,t,n){"use strict";n.r(t);var r=n("97cc"),i=n.n(r);for(var o in r)"default"!==o&&function(e){n.d(t,e,(function(){return r[e]}))}(o);t["default"]=i.a},"3bb0":function(e,t,n){var r=n("fae4");"string"===typeof r&&(r=[[e.i,r,""]]),r.locals&&(e.exports=r.locals);var i=n("4f06").default;i("00498a33",r,!0,{sourceMap:!1,shadowMode:!1})},"3c96":function(e,t){function n(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}e.exports=n},"3d99":function(e,t,n){var r=n("24fb");t=r(!1),t.push([e.i,".iconfont[data-v-e4d0b1ba]{font-family:iconfont}.nlv_borT[data-v-e4d0b1ba]{border-color:#ebebeb;border-style:solid;border-top-width:%?1?%}.wrapgift-mask[data-v-e4d0b1ba]{background-color:#000;opacity:.1;position:fixed;left:0;right:0;top:0;bottom:0;z-index:201910}.pop__ui_child[data-v-e4d0b1ba]{background-color:#fbfbfb;border-top-left-radius:12px;border-top-right-radius:12px;font-size:14px;overflow:hidden;position:fixed;bottom:0;left:0;right:0;z-index:201911}.more-box[data-v-e4d0b1ba]{background-color:#2a2634;width:%?750?%;height:%?350?%;position:fixed;bottom:0;border-top-left-radius:%?16?%;border-top-right-radius:%?16?%;display:flex;flex-direction:row;align-items:center;justify-content:center;padding:0 %?20?%;z-index:9999}.more-list[data-v-e4d0b1ba]{display:flex;flex-direction:column;justify-content:center;flex:1;align-items:center;padding:%?50?% 0}.more-icont[data-v-e4d0b1ba]{font-size:%?76?%}.more-list-active[data-v-e4d0b1ba]{border-width:%?1?%;border-color:#ea4678;border-style:solid;border-radius:%?16?%}.Progress[data-v-e4d0b1ba]{background-color:rgba(0,0,0,.3);\n\t/* opacity: 0.3; */height:%?100?%;width:%?700?%;position:fixed;bottom:%?370?%;border-radius:%?16?%;left:%?25?%;display:flex;flex-direction:row;align-items:center;justify-content:center;padding:0 %?30?%}.progress-bar[data-v-e4d0b1ba]{position:fixed;bottom:%?360?%;width:%?750?%;justify-content:center}.wrap__giftPanel[data-v-e4d0b1ba]{z-index:100}",""]),e.exports=t},4082:function(e,t,n){n("a4d3"),n("c975");var r=n("f0e4");function i(e,t){if(null==e)return{};var n,i,o=r(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(i=0;i<a.length;i++)n=a[i],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}e.exports=i},"40d9":function(e,t,n){var r=n("23e7"),i=Math.floor,o=Math.log,a=Math.LOG2E;r({target:"Math",stat:!0},{clz32:function(e){return(e>>>=0)?31-i(o(e+.5)*a):32}})},4362:function(e,t,n){t.nextTick=function(e){var t=Array.prototype.slice.call(arguments);t.shift(),setTimeout((function(){e.apply(null,t)}),0)},t.platform=t.arch=t.execPath=t.title="browser",t.pid=1,t.browser=!0,t.env={},t.argv=[],t.binding=function(e){throw new Error("No such module. (Possibly not yet loaded)")},function(){var e,r="/";t.cwd=function(){return r},t.chdir=function(t){e||(e=n("df7c")),r=e.resolve(t,r)}}(),t.exit=t.kill=t.umask=t.dlopen=t.uptime=t.memoryUsage=t.uvCounters=function(){},t.features={}},"448a":function(e,t,n){var r=n("2236"),i=n("11b0"),o=n("6613"),a=n("0676");function s(e){return r(e)||i(e)||o(e)||a()}e.exports=s},4636:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r={data:function(){return{popupVisible:!1,activeIndex:-1,max:5,min:0,progressVal:0,beauty:9,whiteness:9,device_position:"front",value:9,showSlider:!1}},beforeCreate:function(){},methods:{show:function(){this.popupVisible=!0},sliderChange:function(e){console.log(e),this.value=e.detail.value,0==this.activeIndex?(uni.setStorageSync("beauty",this.value),this.$emit("liveSet",{type:"beauty",value:this.value})):(uni.setStorageSync("whiteness",this.value),this.$emit("liveSet",{type:"whiteness",value:this.value}))},setBeauty:function(){this.activeIndex=0;var e=uni.getStorageSync("beauty");this.value=e||this.beauty,this.showSlider=!0},setWhiteness:function(){this.activeIndex=1;var e=uni.getStorageSync("whiteness");this.value=e||this.whiteness,this.showSlider=!0},setDevice:function(){this.showSlider=!1,this.activeIndex=2,"front"==this.device_position?this.device_position="back":this.device_position="front",this.$emit("liveSet",{type:"device_position",value:this.device_position})},close:function(){this.popupVisible=!1}}};t.default=r},4932:function(e,t,n){var r=n("e4f8");"string"===typeof r&&(r=[[e.i,r,""]]),r.locals&&(e.exports=r.locals);var i=n("4f06").default;i("2b026d2f",r,!0,{sourceMap:!1,shadowMode:!1})},"496c":function(e,t,n){"use strict";var r;n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return o})),n.d(t,"a",(function(){return r}));var i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return e.showGiftView?n("v-uni-view",{staticClass:"wrap__giftPanel"},[n("v-uni-view",{staticClass:"wrapgift-mask",on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.close.apply(void 0,arguments)}}}),n("v-uni-view",{staticClass:"pop__ui_child anim-footer",on:{click:function(t){t.stopPropagation(),arguments[0]=t=e.$handleEvent(t)}}},[n("v-uni-scroll-view",{staticClass:"wrapgift-body"},[n("v-uni-view",{staticClass:"wrap_giftlist"},[n("v-uni-view",{staticClass:"gift-head"},[n("v-uni-view",{staticClass:"gift-menu"},[n("v-uni-text",{staticClass:"gm-item gm-item-on"},[e._v("礼物")])],1),n("v-uni-view",{staticClass:"gift-coins"},[n("v-uni-text",{staticClass:"gc-coin"},[e._v(e._s(e.gift_name)+"：")]),n("v-uni-text",{staticClass:"gc-num"},[e._v(e._s(e.userInfo.gift_money))]),n("v-uni-text",{staticClass:"gc-recharge",on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.PlanFunc.apply(void 0,arguments)}}},[e._v("充值")])],1)],1),n("v-uni-swiper",{staticClass:"gift-swiper",attrs:{"indicator-dots":!0,duration:200,"indicator-color":"#dbdbdb","indicator-active-color":"#999"}},e._l(e.giftList,(function(t,r){return n("v-uni-swiper-item",{key:r},[n("v-uni-view",{staticClass:"gift__cells"},[e._l(t,(function(t,r){return[t.gift_id!=e.isGift?n("v-uni-view",{key:r+"_0",staticClass:"giftitem",on:{click:function(n){arguments[0]=n=e.$handleEvent(n),e.chooseGift(t)}}},[n("v-uni-view",{staticClass:"giftitem-rect"},[n("v-uni-image",{staticClass:"giftimg",attrs:{src:t.file_path,mode:"aspectFill"}})],1),n("v-uni-text",{staticClass:"giftname"},[e._v(e._s(t.gift_name))]),n("v-uni-text",{staticClass:"giftcoin"},[e._v(e._s(t.price)+e._s(e.gift_name))])],1):e._e(),t.gift_id==e.isGift?n("v-uni-view",{key:r+"_1",staticClass:"giftitem"},[n("v-uni-view",{staticClass:"giftitem_active"},[n("v-uni-view",{staticClass:"giftitem-rect"},[n("v-uni-image",{staticClass:"giftimg_active",attrs:{src:t.file_path,mode:"aspectFill"}})],1),n("v-uni-text",{staticClass:"giftcoin"},[e._v(e._s(t.price)+e._s(e.gift_name))]),n("v-uni-button",{staticClass:"sendbtn",on:{click:function(n){arguments[0]=n=e.$handleEvent(n),e.sendGift(t)}}},[n("v-uni-text",{staticClass:"btntext"},[e._v("发送")])],1)],1)],1):e._e()]}))],2)],1)})),1)],1)],1)],1)],1):e._e()},o=[]},"4a4b":function(e,t,n){function r(t,n){return e.exports=r=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},r(t,n)}n("131a"),e.exports=r},"4a9b":function(e,t,n){var r=n("74e8");r("Float64",(function(e){return function(t,n,r){return e(this,t,n,r)}}))},"4d90":function(e,t,n){"use strict";var r=n("23e7"),i=n("0ccb").start,o=n("9a0c");r({target:"String",proto:!0,forced:o},{padStart:function(e){return i(this,e,arguments.length>1?arguments[1]:void 0)}})},"4ebe":function(e,t,n){var r=n("24fb");t=r(!1),t.push([e.i,".share-shadow[data-v-0c585e63]{position:fixed;top:0;z-index:1010;width:%?750?%;background-color:rgba(0,0,0,.19)}.share-wrap[data-v-0c585e63]{width:90%;border-radius:%?20?%;overflow:hidden;padding-top:%?130?%;margin:0 auto}.share-wrap .content uni-image[data-v-0c585e63]{width:100%}.share-wrap .close-btns[data-v-0c585e63]{margin:%?10?% auto 0;width:%?60?%;height:%?60?%;line-height:%?60?%;text-align:center;display:flex;justify-content:center;align-items:center;border-radius:50%;background:none;border:2px solid #fff}.home-push-wrap .close-btns .iconfont[data-v-0c585e63]{color:#fff}",""]),e.exports=t},"4ec9":function(e,t,n){"use strict";var r=n("6d61"),i=n("6566");e.exports=r("Map",(function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}}),i)},"4efa":function(e,t,n){"use strict";var r;n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return o})),n.d(t,"a",(function(){return r}));var i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-uni-view",{staticClass:"share-shadow",style:"height:"+e.winHeight+" ;"},[n("v-uni-view",{staticClass:"share-wrap"},[n("v-uni-view",{staticClass:"content ww100"},[n("v-uni-image",{attrs:{src:e.qrcode,mode:"widthFix"}}),n("v-uni-button",{staticClass:"btn-rose-shadow mt20",attrs:{type:"default"},on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.savePosterImg.apply(void 0,arguments)}}},[e._v("保存图片")])],1),n("v-uni-view",{staticClass:"close-btns",on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.hidePopupFunc(!0)}}},[n("v-uni-text",{staticClass:"icon iconfont icon-guanbi"})],1)],1)],1)},o=[]},"4fad":function(e,t,n){var r=n("23e7"),i=n("6f53").entries;r({target:"Object",stat:!0},{entries:function(e){return i(e)}})},5312:function(e,t,n){var r=n("1bc5");"string"===typeof r&&(r=[[e.i,r,""]]),r.locals&&(e.exports=r.locals);var i=n("4f06").default;i("7a13e24e",r,!0,{sourceMap:!1,shadowMode:!1})},5364:function(e,t,n){"use strict";n("99af"),n("d3b7"),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=n("f5ac"),i=n("3394"),o={data:function(){return{loading_login:!1,pusherContext:null,playerContext:null,player_url:"",mainPusherInfo_url:"",room_id:"",TextMsg:"",open_gift:!1,commentsList:[],giftList:[],open_products:!1,explain_product_id:"",explain_product:null,open_more:!1,beauty:5,whiteness:5,device_position:"front",open_share:!1,param_share:{},qrcode:null,showNumTimer:null,is_click_digg:!1,roomDetail:{},userInfo:{},channel:"",appId:"",rtm_client:null,reconnectTimer:null,push_status:"loading",picture_mode:["push","pop"],isCaster:!1}},props:["winHeight","winWidth","role","is_replay","replay_url"],methods:{show:function(){null!=this.playerContext&&this.playerContext.play(),this.pusherContext&&this.reconnect()},getRequest:function(){var e=this;return e},start:function(e,t){var n=this;if(n.roomDetail=e,n.userInfo=t,n.channel="channel_"+e.shop_supplier_id,n.isCaster="broadcaster"==n.role,n.isCaster){var r=uni.getStorageSync("whiteness");r&&(n.whiteness=r);var i=uni.getStorageSync("beauty");i&&(n.beauty=i)}else console.log("观众进入");n.loginRoom()},loginRoom:function(){var e=this;uni.showLoading({title:"正在进入"}),e.getRequest()._get("plus.live.agora.api/login",{room_id:e.roomDetail.room_id,channel:e.channel,isCaster:e.isCaster},(function(t){e.appId=t.data.appId,e.initAgoraChannel(t.data.userSign).then((function(t){console.log("pushing ".concat(t));(new Date).getTime();e.mainPusherInfo_url=t,e.isCaster&&(e.pusherContext=uni.createLivePusherContext("livePusher1",e),setTimeout((function(){console.log("创建 pusherContext app：",e.pusherContext),e.pusherContext.start(),e.loginIM()}),500),e.showNumTimer=setInterval((function(){e.synRoomInfo()}),15e3))})).catch((function(e){console.log("init agora client failed: ".concat(e)),console.log(JSON.stringify(e)),uni.showToast({title:"客户端初始化失败",icon:"none",duration:5e3})}))}))},initAgoraChannel:function(e){var t=this;return new Promise((function(n,i){var o=new r.Client;t.subscribeEvents(o),r.LOG.onLog=function(e){console.log(e)},r.LOG.setLogLevel(1),t.client=o,o.setRole(t.role),o.init(t.appId,(function(){console.log("client init success"),o.join(e,t.channel,t.getRequest().getUserId(),(function(){console.log("client join channel success"),t.isCaster?o.publish((function(e){console.log("client publish success"),console.log("url="+e),n(e)}),(function(e){console.log("client publish failed: ".concat(e.code," ").concat(e.reason)),i(e)})):n()}),(function(e){console.log(": ".concat(e.code," ").concat(e.reason)),i(e)}))}),(function(e){console.log("client init failed: ".concat(e," ").concat(e.code," ").concat(e.reason)),i(e)}))}))},loginIM:function(){var e=this;e.getRequest()._get("plus.live.agora.api/rtmToken",{channel:e.channel},(function(t){e.rtm_client=new i(e.appId),e.onChannelEvent(),e.rtm_client.on("ConnectionStateChanged",(function(e,t){console.log("The connection status",e),console.log("The reason for the state change",t)})),e.rtm_client.login(t.data.userSign,""+e.getRequest().getUserId()).then((function(){console.log("AgoraRTM client login success"),e.rtm_client.joinChannel(e.channel).then((function(){console.log("join channel success");var t={type:"enter",nickName:e.userInfo.nickName};e.sendMsg(JSON.stringify(t)),e.isCaster&&e.getRequest()._post("plus.live.room/set_status",{room_id:e.roomDetail.room_id,status:101},(function(t){e.startRecord()}))})).catch((function(e){console.log("join channel failed",e)}))})).catch((function(e){console.log("AgoraRTM client login failure",e)}))}))},synRoomInfo:function(e){var t=this;t.getRequest()._post("plus.live.room/syn_room",{room_id:t.roomDetail.room_id},(function(e){var n={type:"views",views:e.data.model.views,digg_num:e.data.model.digg_num};t.sendMsg(JSON.stringify(n))}))},subscribeEvents:function(e){var t=this;e.on("video-rotation",(function(e){console.log("video rotated: ".concat(e.rotation," ").concat(e.uid))})),e.on("stream-added",(function(n){var r=n.uid;console.log("stream ".concat(r," added")),e.subscribe(r,(function(e,n){console.log("stream ".concat(r," subscribed successful")),console.log(e),t.player_url=e,t.loginIM()}),(function(e){console.log("stream subscribed failed ".concat(e," ").concat(e.code," ").concat(e.reason))}))})),e.on("stream-removed",(function(e){var t=e.uid;console.log("stream ".concat(t," removed"))})),e.on("error",(function(e){var n=e||{},r=n.code||0,i=n.reason||"";console.log("error: ".concat(r,", reason: ").concat(i)),501!==r&&904!==r||t.reconnect()})),e.on("update-url",(function(e){console.log("update-url: ".concat(JSON.stringify(e)))}))},onChannelEvent:function(){var e=this;e.rtm_client.on("ChannelMessage",(function(t,n){t.text;console.log("message -----"),console.log(t),n!=e.getRequest().getUserId()&&e.$emit("showMsg",t.text)})),e.rtm_client.on("MemberJoined",(function(e){console.log("memberId: ",e)})),e.rtm_client.on("MemberLeft",(function(e){console.log("memberId: ",e)}))},sendMsg:function(e){var t=this;t.rtm_client.sendChannel(e).then((function(){t.$emit("showMsg",e)})).catch((function(e){console.log("频道消息发送失败的处理逻辑"),console.log(e)}))},liveSet:function(e){switch(e.type){case"beauty":this.beauty=e.value;break;case"whiteness":this.whiteness=e.value;break;case"device_position":this.device_position=e.value,null!=this.pusherContext&&this.pusherContext.switchCamera({type:e.value,success:function(e){console.log("切换成功")},fail:function(e){console.log(e)}});break}},reconnect:function(){var e=this;uni.showToast({title:"尝试恢复链接...",icon:"none",duration:5e3}),e.client&&e.client.destroy(),e.reconnectTimer=setTimeout((function(){e.loginRoom()}),1e3)},recorderStateChange:function(e){console.log("live-pusher code: ",e),-1307===e.detail.code&&(console.log("live-pusher stopped ---- error"),this.push_status="error"),1008===e.detail.code&&(console.log("live-pusher started"),"loading"===this.push_status&&(this.push_status="ok"))},recorderNetChange:function(e){},onMainError:function(e){console.log("onMainError called: ",e)},exit:function(e){var t=this,n="/pagesLive/live/index";if("broadcaster"==t.role){e="over";var r={type:"over"};t.sendMsg(JSON.stringify(r))}"over"==e&&(n="/pagesLive/live/live-over?room_id="+t.roomDetail.room_id),t.clear(),uni.redirectTo({url:n})},startRecord:function(){var e=this;e.isCaster&&e.getRequest()._post("plus.live.agora.api/record_acquire",{room_id:e.roomDetail.room_id},(function(t){e.getRequest()._post("plus.live.agora.api/record_start",{room_id:e.roomDetail.room_id},(function(t){e.getRequest()._post("plus.live.agora.api/record_query",{room_id:e.roomDetail.room_id},(function(e){}))}))}))},clear:function(){var e=this;try{if(e.showNumTimer&&(clearInterval(e.showNumTimer),e.showNumTimer=null),e.playerContext&&(e.playerContext.stop(),e.playerContext=null),e.pusherContext&&(e.pusherContext.stop(),e.pusherContext=null),clearTimeout(this.reconnectTimer),e.reconnectTimer=null,e.isCaster)try{e.client&&e.client.unpublish()}catch(t){console.log("unpublish failed"),console.log(t)}e.client&&e.client.leave(),e.rtm_client&&e.rtm_client.logout()}catch(t){console.log(t)}}}};t.default=o},5377:function(e,t,n){var r=n("83ab"),i=n("9bf2"),o=n("ad6d"),a=n("9f7f").UNSUPPORTED_Y;r&&("g"!=/./g.flags||a)&&i.f(RegExp.prototype,"flags",{configurable:!0,get:o})},"538a":function(e,t,n){"use strict";n.r(t);var r=n("d4d7"),i=n("a80b");for(var o in i)"default"!==o&&function(e){n.d(t,e,(function(){return i[e]}))}(o);n("f295");var a,s=n("f0c5"),c=Object(s["a"])(i["default"],r["b"],r["c"],!1,null,"92fd8c86",null,!1,r["a"],a);t["default"]=c.exports},5445:function(e,t,n){var r=n("ed06");"string"===typeof r&&(r=[[e.i,r,""]]),r.locals&&(e.exports=r.locals);var i=n("4f06").default;i("ef73d118",r,!0,{sourceMap:!1,shadowMode:!1})},"54a4":function(e,t,n){"use strict";var r=n("4ea4");n("e25e"),n("ac1f"),n("1276"),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=r(n("49ae")),o=r(n("b3877")),a=r(n("a9b8")),s=r(n("d246")),c=r(n("a58a7")),u=r(n("7b8f")),l=r(n("ca4a")),d=r(n("7e6d")),f=r(n("fc7e")),h=r(n("87d5")),p=r(n("907e")),_=r(n("538a")),v=r(n("d8ff")),g=r(n("c8c3")),b=r(n("ed28")),m=r(n("6587")),y={components:{liveCart:o.default,liveGift:a.default,liveRoom:s.default,liveMsg:c.default,livePlan:u.default,liveOrder:l.default,liveAnchor:d.default,liveMore:f.default,liveShare:h.default,liveRank:p.default,Likes:_.default,share:v.default,Countdown:b.default,AppShare:m.default},data:function(){return{statusBarH:"",headerBarH:"",winHeight:"",winWidth:"",videoIndex:0,clickNum:0,giftipShowist:[],sence:"",room_id:0,shop_supplier_id:0,role:"",loading:!0,commentsList:[],maxCommentSize:100,roomDetail:{},gift_name:"",gift_num:0,hasFollow:!1,giftList:[],isCaster:!1,user:{},giftInfo:{nickName:"",avatarUrl:"",giftName:"",giftImage:""},explain_product_id:"",explain_product:null,num:0,digg_num:0,digg_times:5,digg_timer:null,is_replay:!1,replay_url:"",is_start:!1,qrcode:null,toMsg:"",emojiData:[],countdownConfig:{startstamp:0,endstamp:0,title:""},isAppShare:!1,appParams:{title:"",summary:"",path:""}}},beforeCreate:function(){},created:function(){var e=uni.getSystemInfoSync().statusBarHeight,t=e+50,n=uni.getSystemInfoSync().windowHeight,r=uni.getSystemInfoSync().windowWidth;this.statusBarH="".concat(e,"px"),this.headerBarH="".concat(t,"px"),this.winHeight="".concat(n,"px"),this.winWidth="".concat(r,"px")},onLoad:function(e){var t=i.default.getSceneData(e);this.room_id=e.room_id?e.room_id:t.rid,this.role="create"==e.sence?"broadcaster":"audience","broadcaster"==this.role&&(this.isCaster=!0),uni.setKeepScreenOn({keepScreenOn:!0})},onReady:function(){this.getRoomInfo()},onUnload:function(){this.is_start&&this.$refs.liveRoom.clear()},onShow:function(){this.$refs.liveRoom&&this.$refs.liveRoom.show()},methods:{getRequest:function(){var e=this;return e},getRoomInfo:function(){var e=this;uni.showLoading({title:"正在进入"}),e.getRequest()._post("plus.live.room/detail",{room_id:e.room_id},(function(t){if(uni.hideLoading(),e.loading=!1,e.roomDetail=t.data.model,e.gift_name=t.data.gift_name,e.hasFollow=t.data.hasFollow,e.digg_num=t.data.model.digg_num,e.countdownConfig.endstamp=e.roomDetail.start_time,e.user=t.data.user,103==e.roomDetail.live_status){if(e.is_replay=!0,""==e.roomDetail.record_url)return void uni.showModal({title:"提示",content:"暂无回放地址",success:function(e){uni.navigateBack()}});e.replay_url=e.roomDetail.record_url}if(101!=e.roomDetail.live_status&&103!=e.roomDetail.live_status||(e.is_start=!0),!e.is_replay){var n=!1;!e.isCaster||101!=e.roomDetail.live_status&&102!=e.roomDetail.live_status||(n=!0),e.isCaster||101!=e.roomDetail.live_status||(n=!0),n&&(e.is_start=!0,e.initRoom(),setTimeout((function(){e.$refs.liveRoom.start(e.roomDetail,e.user),e.initProduct()}),2e3))}}))},initRoom:function(){this.getGift(),this.initemoji()},showProduct:function(e){var t=this;t.explain_product_id=e,t.getRequest()._get("plus.live.room/product_detail",{product_id:t.explain_product_id},(function(e){t.explain_product=e.data.model}))},initProduct:function(){this.roomDetail.currentProduct&&(this.explain_product={product_image:this.roomDetail.currentProduct.image[0].file_path,product_price:this.roomDetail.currentProduct.product_price,product_id:this.roomDetail.currentProduct.product_id})},gotoProduct:function(e){var t="/pages/product/detail/detail?product_id="+this.explain_product.product_id+"&room_id="+this.room_id;uni.navigateTo({url:t})},handleSlider:function(e){var t=e.detail.current;this.videoIndex>=0&&(this.videoContextList[this.videoIndex].pause(),this.videoContextList[this.videoIndex].seek(0)),t===this.videoIndex+1?this.videoContextList[this.videoIndex+1].play():t===this.videoIndex-1&&this.videoContextList[this.videoIndex-1].play(),this.videoIndex=t},play:function(e){this.videoContextList[e].play()},pause:function(e){this.videoContextList[e].pause()},handleAttention:function(e){var t=this.vlist;t[e].attention=!t[e].attention,this.vlist=t},handleLiveCart:function(){this.$refs.liveCart.show()},handleLiveGift:function(){this.$refs.liveGift.show()},closeLive:function(){var e=this;e.is_replay?uni.redirectTo({url:"/pagesLive/live/index"}):"broadcaster"==e.role?uni.showModal({title:"提示",content:"确定要结束当前直播吗?",success:function(t){t.confirm&&(e.getRequest()._post("plus.live.agora.api/record_stop",{room_id:e.room_id},(function(e){})),console.log("record_stop"),e.getRequest()._post("plus.live.room/set_status",{room_id:e.room_id,status:103},(function(t){console.log("set_status"),e.$refs.liveRoom.exit("over")})))}}):e.$refs.liveRoom.exit("auto")},handleRollMsg:function(){this.$refs.liveMsg.show()},closeMsg:function(e){var t=this,n={type:"text",msg:e,nickName:t.user.nickName};t.$refs.liveRoom.sendMsg(JSON.stringify(n))},showMsg:function(e){var t=this,n=JSON.parse(e);"text"==n.type?(t.commentsList.push(n),t.removeComment()):"enter"==n.type?(t.commentsList.push(n),t.removeComment(),t.roomDetail.view_num++):"gift"==n.type?(t.giftInfo={nickName:n.nickName,avatarUrl:n.avatarUrl,giftName:t.getGiftName(n.msg),giftImage:t.getGiftImage(n.msg)},setTimeout((function(){t.giftInfo={nickName:""}}),5e3)):"views"==n.type?(t.roomDetail.view_num=n.views,t.roomDetail.digg_num=n.digg_num):"digg"==n.type?t.digg_num=n.digg_num:"over"==n.type?t.$refs.liveRoom.exit("over"):"explain"==n.type?t.showProduct(n.msg):"gift_num"==n.type&&(t.roomDetail.gift_num=n.msg)},removeComment:function(){var e=this,t=e.commentsList.length-e.maxCommentSize;if(t>0)for(var n=0;n<t;n++)e.commentsList.shift();e.toMsg="comment"+(e.commentsList.length-1)},getGift:function(){var e=this;e.getRequest()._get("plus.live.room/gift",{},(function(t){for(var n=[],r=[],i=0,o=0;o<t.data.list.length;o++)i++,r.push(t.data.list[o]),i>=8&&(n.push(r),r=[],i=0);r.length>0&&n.push(r),e.giftList=n}))},openPlan:function(){this.$refs.livePlan.show()},closePlan:function(){this.$refs.liveGift.show()},openOrder:function(){this.$refs.liveOrder.show()},closeOrder:function(){this.$refs.liveCart.show()},setProduct:function(e){var t=this,n={type:"explain",msg:e};t.$refs.liveRoom.sendMsg(JSON.stringify(n))},followFunc:function(){var e=this;e.getRequest()._post("user.Favorite/add",{shop_supplier_id:e.shop_supplier_id,pid:e.shop_supplier_id,type:10},(function(t){e.hasFollow=!e.hasFollow}))},openAnchor:function(){this.$refs.liveAnchor.show()},changeFollow:function(e){this.hasFollow=e},openMore:function(){this.$refs.liveMore.show()},openShare:function(e){var t=this;t.$refs.liveShare.show()},liveSet:function(e){this.$refs.liveRoom.liveSet(e)},openRank:function(){this.$refs.liveRank.show()},sendGift:function(e){var t=this,n=e.split(","),r={type:"gift",msg:n[0],nickName:t.user.nickName,avatarUrl:t.user.avatarUrl};t.$refs.liveRoom.sendMsg(JSON.stringify(r));var i={type:"gift_num",msg:n[1]};t.$refs.liveRoom.sendMsg(JSON.stringify(i))},getGiftName:function(e){var t="";for(var n in this.giftList)for(var r=0;r<this.giftList[n].length;r++){var i=this.giftList[n][r];if(parseInt(e)===i.gift_id){t=i.gift_name;break}}return t},getGiftImage:function(e){var t="";for(var n in this.giftList)for(var r=0;r<this.giftList[n].length;r++){var i=this.giftList[n][r];if(parseInt(e)===i.gift_id){t=i.file_path;break}}return t},digg:function(){var e=this;e.$refs.likes.handleClick(),e.digg_num++,e.getRequest()._get("plus.live.room/digg",{room_id:e.room_id,num:1},(function(t){var n={type:"digg",digg_num:t.data.digg_num};e.$refs.liveRoom.sendMsg(JSON.stringify(n))}))},livePoster:function(){var e=this;uni.showLoading({title:"加载中"});var t="wx";t="mp",e.getRequest()._get("plus.live.Room/poster",{room_id:e.room_id,source:t},(function(t){e.qrcode=t.data.qrcode,console.log(e.qrcode)}),null,(function(){uni.hideLoading()}))},closeShare:function(){this.qrcode=null},onShareAppMessage:function(){var e=this,t=e.getRequest().getShareUrlParams({room_id:e.room_id,sence:"audience"});return{title:e.roomDetail.name,path:"/pagesLive/live/live?"+t,imageUrl:e.roomDetail.share.file_path}},initemoji:function(){for(var e=Math.ceil(g.default.length/21),t=0;t<e;t++){this.emojiData[t]=[];for(var n=0;n<21;n++)g.default[21*t+n]&&this.emojiData[t].push(g.default[21*t+n])}},goBack:function(){uni.redirectTo({url:"/pagesLive/live/index"})}}};t.default=y},"5a43":function(e,t){function n(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}e.exports=n},"5b92":function(e,t,n){"use strict";n.r(t);var r=n("7cfa"),i=n.n(r);for(var o in r)"default"!==o&&function(e){n.d(t,e,(function(){return r[e]}))}(o);t["default"]=i.a},"5bc3":function(e,t){function n(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function r(e,t,r){return t&&n(e.prototype,t),r&&n(e,r),e}e.exports=r},"5e89":function(e,t,n){var r=n("861d"),i=Math.floor;e.exports=function(e){return!r(e)&&isFinite(e)&&i(e)===e}},6062:function(e,t,n){"use strict";var r=n("6d61"),i=n("6566");e.exports=r("Set",(function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}}),i)},6374:function(e,t,n){n("a4d3"),n("e01a"),n("d28b"),n("d3b7"),n("3ca3"),n("ddb0");var r=n("6613");function i(e,t){var n;if("undefined"===typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=r(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var i=0,o=function(){};return{s:o,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,s=!0,c=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return s=e.done,e},e:function(e){c=!0,a=e},f:function(){try{s||null==n["return"]||n["return"]()}finally{if(c)throw a}}}}e.exports=i},"649f":function(e,t,n){"use strict";n.r(t);var r=n("4636"),i=n.n(r);for(var o in r)"default"!==o&&function(e){n.d(t,e,(function(){return r[e]}))}(o);t["default"]=i.a},6566:function(e,t,n){"use strict";var r=n("9bf2").f,i=n("7c73"),o=n("e2cc"),a=n("0366"),s=n("19aa"),c=n("2266"),u=n("7dd0"),l=n("2626"),d=n("83ab"),f=n("f183").fastKey,h=n("69f3"),p=h.set,_=h.getterFor;e.exports={getConstructor:function(e,t,n,u){var l=e((function(e,r){s(e,l,t),p(e,{type:t,index:i(null),first:void 0,last:void 0,size:0}),d||(e.size=0),void 0!=r&&c(r,e[u],e,n)})),h=_(t),v=function(e,t,n){var r,i,o=h(e),a=g(e,t);return a?a.value=n:(o.last=a={index:i=f(t,!0),key:t,value:n,previous:r=o.last,next:void 0,removed:!1},o.first||(o.first=a),r&&(r.next=a),d?o.size++:e.size++,"F"!==i&&(o.index[i]=a)),e},g=function(e,t){var n,r=h(e),i=f(t);if("F"!==i)return r.index[i];for(n=r.first;n;n=n.next)if(n.key==t)return n};return o(l.prototype,{clear:function(){var e=this,t=h(e),n=t.index,r=t.first;while(r)r.removed=!0,r.previous&&(r.previous=r.previous.next=void 0),delete n[r.index],r=r.next;t.first=t.last=void 0,d?t.size=0:e.size=0},delete:function(e){var t=this,n=h(t),r=g(t,e);if(r){var i=r.next,o=r.previous;delete n.index[r.index],r.removed=!0,o&&(o.next=i),i&&(i.previous=o),n.first==r&&(n.first=i),n.last==r&&(n.last=o),d?n.size--:t.size--}return!!r},forEach:function(e){var t,n=h(this),r=a(e,arguments.length>1?arguments[1]:void 0,3);while(t=t?t.next:n.first){r(t.value,t.key,this);while(t&&t.removed)t=t.previous}},has:function(e){return!!g(this,e)}}),o(l.prototype,n?{get:function(e){var t=g(this,e);return t&&t.value},set:function(e,t){return v(this,0===e?0:e,t)}}:{add:function(e){return v(this,e=0===e?0:e,e)}}),d&&r(l.prototype,"size",{get:function(){return h(this).size}}),l},setStrong:function(e,t,n){var r=t+" Iterator",i=_(t),o=_(r);u(e,t,(function(e,t){p(this,{type:r,target:e,state:i(e),kind:t,last:void 0})}),(function(){var e=o(this),t=e.kind,n=e.last;while(n&&n.removed)n=n.previous;return e.target&&(e.last=n=n?n.next:e.state.first)?"keys"==t?{value:n.key,done:!1}:"values"==t?{value:n.value,done:!1}:{value:[n.key,n.value],done:!1}:(e.target=void 0,{value:void 0,done:!0})}),n?"entries":"values",!n,!0),l(t)}}},6587:function(e,t,n){"use strict";n.r(t);var r=n("715a9"),i=n("3a42");for(var o in i)"default"!==o&&function(e){n.d(t,e,(function(){return i[e]}))}(o);n("12e3");var a,s=n("f0c5"),c=Object(s["a"])(i["default"],r["b"],r["c"],!1,null,"660d6338",null,!1,r["a"],a);t["default"]=c.exports},6613:function(e,t,n){n("a630"),n("fb6a"),n("d3b7"),n("25f0"),n("3ca3");var r=n("5a43");function i(e,t){if(e){if("string"===typeof e)return r(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?r(e,t):void 0}}e.exports=i},"6b58":function(e,t,n){var r=n("7037"),i=n("3c96");function o(e,t){return!t||"object"!==r(t)&&"function"!==typeof t?i(e):t}e.exports=o},"6c57":function(e,t,n){var r=n("23e7"),i=n("da84");r({global:!0},{globalThis:i})},"6d61":function(e,t,n){"use strict";var r=n("23e7"),i=n("da84"),o=n("94ca"),a=n("6eeb"),s=n("f183"),c=n("2266"),u=n("19aa"),l=n("861d"),d=n("d039"),f=n("1c7e"),h=n("d44e"),p=n("7156");e.exports=function(e,t,n){var _=-1!==e.indexOf("Map"),v=-1!==e.indexOf("Weak"),g=_?"set":"add",b=i[e],m=b&&b.prototype,y=b,E={},w=function(e){var t=m[e];a(m,e,"add"==e?function(e){return t.call(this,0===e?0:e),this}:"delete"==e?function(e){return!(v&&!l(e))&&t.call(this,0===e?0:e)}:"get"==e?function(e){return v&&!l(e)?void 0:t.call(this,0===e?0:e)}:"has"==e?function(e){return!(v&&!l(e))&&t.call(this,0===e?0:e)}:function(e,n){return t.call(this,0===e?0:e,n),this})};if(o(e,"function"!=typeof b||!(v||m.forEach&&!d((function(){(new b).entries().next()})))))y=n.getConstructor(t,e,_,g),s.REQUIRED=!0;else if(o(e,!0)){var T=new y,R=T[g](v?{}:-0,1)!=T,S=d((function(){T.has(1)})),I=f((function(e){new b(e)})),O=!v&&d((function(){var e=new b,t=5;while(t--)e[g](t,t);return!e.has(-0)}));I||(y=t((function(t,n){u(t,y,e);var r=p(new b,t,y);return void 0!=n&&c(n,r[g],r,_),r})),y.prototype=m,m.constructor=y),(S||O)&&(w("delete"),w("has"),_&&w("get")),(O||R)&&w(g),v&&m.clear&&delete m.clear}return E[e]=y,r({global:!0,forced:y!=b},E),h(y,e),v||n.setStrong(y,e,_),y}},"6f8f":function(e,t,n){function r(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}n("d3b7"),n("4ae1"),n("25f0"),e.exports=r},7037:function(e,t,n){function r(t){return"function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?e.exports=r=function(e){return typeof e}:e.exports=r=function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(t)}n("a4d3"),n("e01a"),n("d28b"),n("d3b7"),n("3ca3"),n("ddb0"),e.exports=r},7039:function(e,t,n){var r=n("23e7"),i=n("d039"),o=n("057f").f,a=i((function(){return!Object.getOwnPropertyNames(1)}));r({target:"Object",stat:!0,forced:a},{getOwnPropertyNames:o})},"715a9":function(e,t,n){"use strict";var r;n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return o})),n.d(t,"a",(function(){return r}));var i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return e.popupVisible?n("v-uni-view",{staticClass:"wrap__giftPanel",class:e.Visible?"bottom-panel open":"bottom-panel close",on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.closePopup.apply(void 0,arguments)}}},[n("v-uni-view",{staticClass:"wrapgift-mask",on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.closePopup.apply(void 0,arguments)}}}),n("v-uni-view",{staticClass:"pop__ui_child anim-footer"},[e.showSlider?n("v-uni-view",{staticClass:"progress-bar",on:{click:function(t){t.stopPropagation(),arguments[0]=t=e.$handleEvent(t)}}},[n("v-uni-slider",{attrs:{value:e.value,activeColor:"#f72b6c",backgroundColor:"#FFFFFF","block-color":"#FFFFFF",min:0,max:9,"show-value":!0},on:{change:function(t){arguments[0]=t=e.$handleEvent(t),e.sliderChange.apply(void 0,arguments)}}})],1):e._e(),n("v-uni-view",{staticClass:"more-box",on:{click:function(t){t.stopPropagation(),arguments[0]=t=e.$handleEvent(t)}}},[n("v-uni-button",{staticClass:"more-list",attrs:{"open-type":"share"},on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.share(0,"WXSceneSession")}}},[n("v-uni-text",{staticClass:"icon iconfont icon-weixin i-btntool more-icont"},[e._v("")]),n("v-uni-text",{staticClass:"f28 white mt20"},[e._v("微信好友")])],1),n("v-uni-button",{staticClass:"more-list",on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.share(0,"WXSenceTimeline")}}},[n("v-uni-text",{staticClass:"icon iconfont icon-fenxiang i-btntool more-icont"},[e._v("")]),n("v-uni-text",{staticClass:"f28 white mt20"},[e._v("微信朋友圈")])],1)],1)],1)],1):e._e()},o=[]},7535:function(e,t,n){"use strict";n.r(t);var r=n("f2aa"),i=n("868e");for(var o in i)"default"!==o&&function(e){n.d(t,e,(function(){return i[e]}))}(o);n("9c35");var a,s=n("f0c5"),c=Object(s["a"])(i["default"],r["b"],r["c"],!1,null,"7fe5f9f8",null,!1,r["a"],a);t["default"]=c.exports},"76c7":function(e,t,n){"use strict";var r;n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return o})),n.d(t,"a",(function(){return r}));var i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-uni-view",{staticClass:"countdown"},[null==e.config.type?[0==e.status?n("v-uni-text",[e._v(e._s(e.title))]):e._e(),1==e.status?n("v-uni-text",[e._v("活动具体时间：")]):e._e(),2==e.status?n("v-uni-text",[e._v("活动结束时间：")]):e._e(),n("v-uni-text",{staticClass:"box"},[e._v(e._s(e.day))]),n("v-uni-text",{staticClass:"p-0-10"},[e._v("天")]),n("v-uni-text",{staticClass:"box"},[e._v(e._s(e.hour))]),n("v-uni-text",{staticClass:"p-0-10"},[e._v("时")]),n("v-uni-text",{staticClass:"box"},[e._v(e._s(e.minute))]),n("v-uni-text",{staticClass:"p-0-10"},[e._v("分")]),n("v-uni-text",{staticClass:"box"},[e._v(e._s(e.second))]),n("v-uni-text",{staticClass:"p-0-10"},[e._v("秒")])]:e._e(),"text"===e.config.type?[e._v(e._s(e.title)+e._s(parseInt(24*e.day)+parseInt(e.hour))+":"+e._s(e.minute)+":"+e._s(e.second))]:e._e()],2)},o=[]},"7b8f":function(e,t,n){"use strict";n.r(t);var r=n("d198"),i=n("37eb");for(var o in i)"default"!==o&&function(e){n.d(t,e,(function(){return i[e]}))}(o);n("e70e");var a,s=n("f0c5"),c=Object(s["a"])(i["default"],r["b"],r["c"],!1,null,"1960e106",null,!1,r["a"],a);t["default"]=c.exports},"7cfa":function(e,t,n){"use strict";n("e25e"),n("ac1f"),n("5319"),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r={data:function(){return{status:0,day:"0",hour:"0",minute:"0",second:"0",timer:null,totalSeconds:0,title:"距离开始仅剩："}},props:{config:{type:Object,default:function(){return{type:"all"}}}},created:function(){},watch:{config:{deep:!0,handler:function(e,t){e!=t&&0!=e.endstamp&&(e.title&&"undefined"!=typeof e.title&&(this.title=e.title),this.setTime())},immediate:!0}},methods:{setTime:function(){var e=this;e.timer=setInterval((function(){e.init()}),1e3)},init:function(){var e=Date.now()/1e3;e<this.config.startstamp?this.status=1:e>this.config.endstamp?this.status=2:(this.totalSeconds=parseInt(this.config.endstamp-e),this.status=0,this.countDown()),this.$emit("returnVal",this.status)},countDown:function(){var e=this.totalSeconds,t=Math.floor(e/86400),n=e%86400,r=Math.floor(n/3600);n%=3600;var i=Math.floor(n/60),o=n%60;this.day=this.convertTwo(t),this.hour=this.convertTwo(r),this.minute=this.convertTwo(i),this.second=this.convertTwo(o),this.totalSeconds--},convertTwo:function(e){var t="";return t=e<10?"0"+e:e,t},getLocalTime:function(e){return new Date(1e3*parseInt(e)).toLocaleString().replace(/:\d{1,2}$/," ")}},destroyed:function(){clearInterval(this.timer)}};t.default=r},"7e6d":function(e,t,n){"use strict";n.r(t);var r=n("14bd"),i=n("33a3");for(var o in i)"default"!==o&&function(e){n.d(t,e,(function(){return i[e]}))}(o);n("f89c");var a,s=n("f0c5"),c=Object(s["a"])(i["default"],r["b"],r["c"],!1,null,"77752cf6",null,!1,r["a"],a);t["default"]=c.exports},80604:function(e,t,n){var r=n("2bab");"string"===typeof r&&(r=[[e.i,r,""]]),r.locals&&(e.exports=r.locals);var i=n("4f06").default;i("73a06c90",r,!0,{sourceMap:!1,shadowMode:!1})},"842a":function(e,t,n){var r=n("3d99");"string"===typeof r&&(r=[[e.i,r,""]]),r.locals&&(e.exports=r.locals);var i=n("4f06").default;i("450dc52a",r,!0,{sourceMap:!1,shadowMode:!1})},"843c":function(e,t,n){"use strict";var r=n("23e7"),i=n("0ccb").end,o=n("9a0c");r({target:"String",proto:!0,forced:o},{padEnd:function(e){return i(this,e,arguments.length>1?arguments[1]:void 0)}})},"84c3":function(e,t,n){var r=n("74e8");r("Uint16",(function(e){return function(t,n,r){return e(this,t,n,r)}}))},"868e":function(e,t,n){"use strict";n.r(t);var r=n("54a4"),i=n.n(r);for(var o in r)"default"!==o&&function(e){n.d(t,e,(function(){return r[e]}))}(o);t["default"]=i.a},"878d":function(e,t,n){"use strict";n.r(t);var r=n("afe3"),i=n.n(r);for(var o in r)"default"!==o&&function(e){n.d(t,e,(function(){return r[e]}))}(o);t["default"]=i.a},"87d5":function(e,t,n){"use strict";n.r(t);var r=n("1d3e"),i=n("3569");for(var o in i)"default"!==o&&function(e){n.d(t,e,(function(){return i[e]}))}(o);n("e5e9");var a,s=n("f0c5"),c=Object(s["a"])(i["default"],r["b"],r["c"],!1,null,"0efb07cb",null,!1,r["a"],a);t["default"]=c.exports},"88cf":function(e,t,n){var r=n("fd39");"string"===typeof r&&(r=[[e.i,r,""]]),r.locals&&(e.exports=r.locals);var i=n("4f06").default;i("92a80dbe",r,!0,{sourceMap:!1,shadowMode:!1})},8962:function(e,t,n){n("e439"),n("5d41");var r=n("9f70");function i(t,n,o){return"undefined"!==typeof Reflect&&Reflect.get?e.exports=i=Reflect.get:e.exports=i=function(e,t,n){var i=r(e,t);if(i){var o=Object.getOwnPropertyDescriptor(i,t);return o.get?o.get.call(n):o.value}},i(t,n,o||t)}e.exports=i},"89da":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r={data:function(){return{popupVisible:!1,liveUser:{},live_user:{},is_follow:!1}},props:["room_id","shop_supplier_id"],methods:{show:function(){this.popupVisible=!0,this.getUser()},getRequest:function(){var e=this;return e},getUser:function(){var e=this;e.data_type;e.getRequest()._get("plus.live.room/detail",{room_id:e.room_id},(function(t){e.is_follow=t.data.hasFollow,e.live_user=t.data.model}))},followFunc:function(){var e=this;e.getRequest()._post("user.Favorite/add",{shop_supplier_id:e.shop_supplier_id,pid:e.shop_supplier_id,type:10},(function(t){e.$emit("changeFollow",!e.is_follow),e.getUser()}))},gotoAnchorPage:function(){this.gotoPage("/pages/shop/shop?shop_supplier_id="+this.shop_supplier_id)},close:function(){this.popupVisible=!1}}};t.default=r},"8a79":function(e,t,n){"use strict";var r=n("23e7"),i=n("06cf").f,o=n("50c4"),a=n("5a34"),s=n("1d80"),c=n("ab13"),u=n("c430"),l="".endsWith,d=Math.min,f=c("endsWith"),h=!u&&!f&&!!function(){var e=i(String.prototype,"endsWith");return e&&!e.writable}();r({target:"String",proto:!0,forced:!h&&!f},{endsWith:function(e){var t=String(s(this));a(e);var n=arguments.length>1?arguments[1]:void 0,r=o(t.length),i=void 0===n?r:d(o(n),r),c=String(e);return l?l.call(t,c,i):t.slice(i-c.length,i)===c}})},"8ba4":function(e,t,n){var r=n("23e7"),i=n("5e89");r({target:"Number",stat:!0},{isInteger:i})},"907e":function(e,t,n){"use strict";n.r(t);var r=n("c45c"),i=n("d9c4");for(var o in i)"default"!==o&&function(e){n.d(t,e,(function(){return i[e]}))}(o);n("946c");var a,s=n("f0c5"),c=Object(s["a"])(i["default"],r["b"],r["c"],!1,null,"32ddb2f1",null,!1,r["a"],a);t["default"]=c.exports},"90d7":function(e,t,n){var r=n("23e7"),i=Math.log,o=Math.LN2;r({target:"Math",stat:!0},{log2:function(e){return i(e)/o}})},"92ac3":function(e,t,n){var r=n("3367");"string"===typeof r&&(r=[[e.i,r,""]]),r.locals&&(e.exports=r.locals);var i=n("4f06").default;i("fa9eb7d2",r,!0,{sourceMap:!1,shadowMode:!1})},"946c":function(e,t,n){"use strict";var r=n("bdd6"),i=n.n(r);i.a},"970b":function(e,t){function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}e.exports=n},"97cc":function(e,t,n){"use strict";var r=n("4ea4");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=r(n("728a")),o={data:function(){return{popupVisible:!1,shareConfig:{},logo:""}},created:function(){this.getData()},props:["appParams"],methods:{show:function(){this.popupVisible=!0,this.getData()},getRequest:function(){var e=this;return e},getData:function(){var e=this;e.getRequest()._get("settings/appShare",{},(function(t){e.shareConfig=t.data.appshare,e.logo=t.data.logo,console.log(e.shareConfig)}))},closePopup:function(e){this.popupVisible=!1},share:function(e,t){var n={provider:"weixin",scene:t,type:e,success:function(e){console.log("success:"+JSON.stringify(e))},fail:function(e){console.log("fail:"+JSON.stringify(e))}};2!=this.shareConfig.type?(n.summary=this.appParams.summary,n.imageUrl=this.logo,n.title=this.appParams.title,1==this.shareConfig.type?n.href=this.shareConfig.open_site+this.appParams.path:3==this.shareConfig.type&&(1==this.shareConfig.bind_type?n.href=this.shareConfig.down_url:n.href=i.default.app_url+"/index.php/api/user.useropen/invite?app_id="+i.default.app_id+"&referee_id="+uni.getStorageSync("user_id"))):(n.scene="WXSceneSession",n.type=5,n.imageUrl=this.appParams.image?this.appParams.image:this.logo,n.title=this.appParams.title,n.miniProgram={id:this.shareConfig.gh_id,path:this.appParams.path,webUrl:this.shareConfig.web_url,type:0}),uni.share(n)}}};t.default=o},"9a0c":function(e,t,n){var r=n("342f");e.exports=/Version\/10\.\d+(\.\d+)?( Mobile\/\w+)? Safari\//.test(r)},"9b42":function(e,t,n){function r(e,t){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(e)){var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done);r=!0)if(n.push(a.value),t&&n.length===t)break}catch(err){i=!0,o=err}finally{try{r||null==s["return"]||s["return"]()}finally{if(i)throw o}}return n}}n("a4d3"),n("e01a"),n("d28b"),n("d3b7"),n("3ca3"),n("ddb0"),e.exports=r},"9c35":function(e,t,n){"use strict";var r=n("164d"),i=n.n(r);i.a},"9f70":function(e,t,n){var r=n("36c6");function i(e,t){while(!Object.prototype.hasOwnProperty.call(e,t))if(e=r(e),null===e)break;return e}e.exports=i},a128:function(e,t,n){n("4ec9"),n("d3b7"),n("3ca3"),n("ddb0");var r=n("36c6"),i=n("4a4b"),o=n("c5f7"),a=n("b17c");function s(t){var n="function"===typeof Map?new Map:void 0;return e.exports=s=function(e){if(null===e||!o(e))return e;if("function"!==typeof e)throw new TypeError("Super expression must either be null or a function");if("undefined"!==typeof n){if(n.has(e))return n.get(e);n.set(e,t)}function t(){return a(e,arguments,r(this).constructor)}return t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),i(t,e)},s(t)}e.exports=s},a2ba:function(e,t,n){var r=n("24fb");t=r(!1),t.push([e.i,".iconfont[data-v-660d6338]{font-family:iconfont}.nlv_borT[data-v-660d6338]{border-color:#ebebeb;border-style:solid;border-top-width:%?1?%}.wrapgift-mask[data-v-660d6338]{background-color:#000;opacity:.1;position:fixed;left:0;right:0;top:0;bottom:0;z-index:201910}.pop__ui_child[data-v-660d6338]{background-color:#fbfbfb;border-top-left-radius:12px;border-top-right-radius:12px;font-size:14px;overflow:hidden;position:fixed;bottom:0;left:0;right:0;z-index:201911}.more-box[data-v-660d6338]{background-color:#2a2634;width:%?750?%;height:%?350?%;position:fixed;bottom:0;border-top-left-radius:%?16?%;border-top-right-radius:%?16?%;display:flex;flex-direction:row;align-items:center;justify-content:center;padding:0 %?20?%;z-index:9999}.more-list[data-v-660d6338]{display:flex;flex-direction:column;justify-content:center;flex:1;align-items:center;padding:%?50?% 0;background-color:#2a2634;border-width:0}.more-icont[data-v-660d6338]{font-size:%?76?%}.more-list-active[data-v-660d6338]{border-width:%?1?%;border-color:#ea4678;border-style:solid;border-radius:%?16?%}.Progress[data-v-660d6338]{background-color:rgba(0,0,0,.3);\n\t/* opacity: 0.3; */height:%?100?%;width:%?700?%;position:fixed;bottom:%?370?%;border-radius:%?16?%;left:%?25?%;display:flex;flex-direction:row;align-items:center;justify-content:center;padding:0 %?30?%}.progress-bar[data-v-660d6338]{position:fixed;bottom:%?360?%;width:%?750?%;justify-content:center}.wrap__giftPanel[data-v-660d6338]{z-index:100}",""]),e.exports=t},a58a7:function(e,t,n){"use strict";n.r(t);var r=n("d9b1"),i=n("d8c5");for(var o in i)"default"!==o&&function(e){n.d(t,e,(function(){return i[e]}))}(o);n("29548");var a,s=n("f0c5"),c=Object(s["a"])(i["default"],r["b"],r["c"],!1,null,"49660634",null,!1,r["a"],a);t["default"]=c.exports},a623:function(e,t,n){"use strict";var r=n("23e7"),i=n("b727").every,o=n("a640"),a=n("ae40"),s=o("every"),c=a("every");r({target:"Array",proto:!0,forced:!s||!c},{every:function(e){return i(this,e,arguments.length>1?arguments[1]:void 0)}})},a6fd:function(e,t,n){var r=n("23e7"),i=n("d066"),o=n("1c0b"),a=n("825a"),s=n("d039"),c=i("Reflect","apply"),u=Function.apply,l=!s((function(){c((function(){}))}));r({target:"Reflect",stat:!0,forced:l},{apply:function(e,t,n){return o(e),a(n),c?c(e,t,n):u.call(e,t,n)}})},a80b:function(e,t,n){"use strict";n.r(t);var r=n("ba1d"),i=n.n(r);for(var o in r)"default"!==o&&function(e){n.d(t,e,(function(){return r[e]}))}(o);t["default"]=i.a},a9b8:function(e,t,n){"use strict";n.r(t);var r=n("496c"),i=n("0f10");for(var o in i)"default"!==o&&function(e){n.d(t,e,(function(){return i[e]}))}(o);n("0660");var a,s=n("f0c5"),c=Object(s["a"])(i["default"],r["b"],r["c"],!1,null,"6b1b353b",null,!1,r["a"],a);t["default"]=c.exports},a9f7:function(e,t,n){var r=n("4ebe");"string"===typeof r&&(r=[[e.i,r,""]]),r.locals&&(e.exports=r.locals);var i=n("4f06").default;i("6724e348",r,!0,{sourceMap:!1,shadowMode:!1})},ad8b:function(e,t,n){var r=n("24fb");t=r(!1),t.push([e.i,".pop__ui_mask[data-v-32ddb2f1]{background-color:#000;opacity:.1;position:fixed;left:0;right:0;top:0;bottom:0;z-index:1000}.pop__ui_child[data-v-32ddb2f1]{background-color:#fbfbfb;border-top-left-radius:12px;border-top-right-radius:12px;font-size:14px;overflow:hidden;position:fixed;bottom:0;left:0;right:0;z-index:9999}.pop__ui_head[data-v-32ddb2f1]{border-style:solid;border-color:#ebebeb;border-bottom-width:%?1?%;font-size:%?28?%;font-weight:700;padding:%?30?%;text-align:left}.add-product-head[data-v-32ddb2f1]{background-color:#eee;flex-direction:row}.add-product-list[data-v-32ddb2f1]{width:%?750?%;height:%?700?%}.add-product-item[data-v-32ddb2f1]{display:flex;flex-direction:row;align-items:center;border-bottom-width:1px;border-bottom-color:#f6f6f6;border-bottom-style:solid;padding:%?15?% 0}.gift-num[data-v-32ddb2f1]{width:%?50?%;height:%?50?%;display:flex;justify-content:center;align-items:center;border-radius:%?50?%;background-color:#e3416d;text-align:center;line-height:%?50?%;margin-top:%?10?%}.add-product-picture-image[data-v-32ddb2f1]{width:%?100?%;height:%?100?%;border-radius:50%}.user-name[data-v-32ddb2f1]{display:flex;flex:1;margin-top:%?30?%}.gift-null[data-v-32ddb2f1]{text-align:center;display:flex;flex-direction:column;align-items:center;justify-content:center;height:%?600?%}.fir[data-v-32ddb2f1]{background-color:#df372a}.sec[data-v-32ddb2f1]{background-color:#ff721b}.thr[data-v-32ddb2f1]{background-color:#e4a347}",""]),e.exports=t},ae45:function(e,t,n){var r=n("076b");"string"===typeof r&&(r=[[e.i,r,""]]),r.locals&&(e.exports=r.locals);var i=n("4f06").default;i("08e949cc",r,!0,{sourceMap:!1,shadowMode:!1})},aea5:function(e,t,n){"use strict";
/*!
 * iny-bus.js v1.1.0
 * (c) 2019-2020 landluck
 * Released under the MIT License.
 */function r(){return Math.random().toString().substr(2)}function i(e){var t=!1;return function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];t||(t=!0,e.apply(this,n))}}n("7db0"),n("c740"),n("4160"),n("d81d"),n("a434"),n("b64b"),n("d3b7"),n("25f0"),n("159b");var o=function(){function e(){this.events=[]}return e.prototype.on=function(e,t,n){return this.addEvent(e,t,n)},e.prototype.once=function(e,t,n){return this.addEvent(e,i(t),n)},e.prototype.remove=function(e,t){var n=this.events,r=n.findIndex((function(t){return t.name===e}));if(-1===r)return this;if(!t)return n.splice(r,1),this;var i=n[r].executes.findIndex((function(e){return e.id===t}));return-1!==i&&n[r].executes.splice(i,1),this},e.prototype.emit=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];var r=this.find(e);if(!r)return this;var i=r.executes;return i.forEach((function(e){if(e.ctx)return e.execute.apply(e.ctx,t);e.execute.apply(e,t)})),this},e.prototype.find=function(e){for(var t=this.events,n=0;n<t.length;n++)if(e===t[n].name)return t[n];return null},e.prototype.clear=function(){return this.events.length=0,this},e.prototype.addEvent=function(e,t,n){var i=r(),o=this.events,a=this.find(e);return null!==a?(a.executes.push({id:i,execute:t,ctx:n}),i):(o.push({name:e,executes:[{id:i,execute:t,ctx:n}]}),i)},e}();function a(){var e=new o;return e}var s=a();function c(){return"undefined"!==typeof my&&my.getSystemInfo}s.create=function(){return a()};var u={onLoad:"onLoad",onUnload:"onUnload"},l={onLoad:"onLaunch",onUnload:""},d=c()?{onLoad:"onInit",onUnload:"didUnmount"}:{onLoad:"created",onUnload:"detached"};function f(e){return!!e}function h(e,t){var n=e[t];e[t]=function(t){var r=_(e.busEvents,this);e.__inyEventIds=r,n&&n.call(this,t)}}function p(e,t){if(t){var n=e[t];e[t]=function(){e.__inyEventIds.forEach((function(e){return s.remove(e.name,e.id)})),e.__inyEventIds=void 0,n&&n.call(this)}}}function _(e,t){return Object.keys(e).map((function(n){var r=e[n];return"function"===typeof r?{id:s.on(n,r,t),name:n}:r.once?{id:s.once(n,r.handler,t),name:n}:{id:s.on(n,r.handler,t),name:n}}))}function v(e){var t=e.busEvents;return f(t)?(h(e,l.onLoad),p(e,l.onUnload),e):e}function g(e){var t=e.busEvents;return f(t)?(h(e,u.onLoad),p(e,u.onUnload),e):e}function b(e){var t=e.busEvents;return f(t)?(h(e,d.onLoad),p(e,d.onUnload),e):e}s.app=v,s.page=g,s.component=b,e.exports=s},afa6:function(e,t,n){var r=n("24fb");t=r(!1),t.push([e.i,".countdown[data-v-8bef6f6a]{flex-direction:row;height:%?45?%;line-height:%?45?%}.box[data-v-8bef6f6a]{display:inline-block;width:%?34?%;border-radius:%?8?%;background:#fb4d70;text-align:center;height:%?50?%;line-height:%?45?%;color:#fff}",""]),e.exports=t},afe3:function(e,t,n){"use strict";n("99af"),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r={data:function(){return{popupVisible:!1,total:0,no_more:!1,listData:[],page:1,list_rows:10}},props:["shop_supplier_id","room_id"],methods:{show:function(){this.popupVisible=!0,this.start()},start:function(){this.loading=!0,this.no_more=!1,this.listData=[],this.page=1,this.list_rows=10,this.getData()},getData:function(){var e=this,t=e.page,n=e.list_rows;e.loading=!0,e._get("plus.live.RoomApply/orderList",{page:t||1,list_rows:n,shop_supplier_id:e.shop_supplier_id,room_id:e.room_id,pay_status:20},(function(t){e.loading=!1,e.listData=e.listData.concat(t.data.list.data),e.last_page=t.data.list.last_page,t.data.list.last_page<=1&&(e.no_more=!0)}))},loadmoreFunc:function(){var e=this;if(e.bottomRefresh=!0,e.page++,e.loading=!0,e.page>e.last_page)return e.loading=!1,void(e.no_more=!0);e.getData()},close:function(){this.popupVisible=!1,this.$emit("closeOrder")}}};t.default=r},afe7:function(e,t,n){"use strict";var r=n("5312"),i=n.n(r);i.a},aff5:function(e,t,n){var r=n("23e7");r({target:"Number",stat:!0},{MAX_SAFE_INTEGER:9007199254740991})},b17c:function(e,t,n){n("4ae1");var r=n("4a4b"),i=n("6f8f");function o(t,n,a){return i()?e.exports=o=Reflect.construct:e.exports=o=function(e,t,n){var i=[null];i.push.apply(i,t);var o=Function.bind.apply(e,i),a=new o;return n&&r(a,n.prototype),a},o.apply(null,arguments)}e.exports=o},b3877:function(e,t,n){"use strict";n.r(t);var r=n("23fd"),i=n("bf57");for(var o in i)"default"!==o&&function(e){n.d(t,e,(function(){return i[e]}))}(o);n("afe7");var a,s=n("f0c5"),c=Object(s["a"])(i["default"],r["b"],r["c"],!1,null,"7445f8ed",null,!1,r["a"],a);t["default"]=c.exports},b615:function(e,t,n){"use strict";var r=n("842a"),i=n.n(r);i.a},b636:function(e,t,n){var r=n("746f");r("asyncIterator")},ba1d:function(e,t,n){"use strict";n("99af"),n("4160"),n("a434"),n("a9e3"),n("159b"),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r={data:function(){return{viewList:[],pageDate:new Date}},beforeCreate:function(){},onShow:function(){},methods:{move:function(){var e=this.$refs.test,t=e[e.length-1];animation.transition(t,{styles:{color:"#FF0000",transform:"translate(0, -200px)",opacity:"0",transformOrigin:"center center"},duration:3e3,timingFunction:"ease",delay:0},(function(){modal.toast({message:"animation finished."})}))},random:function(){var e=Math.floor(256*Math.random()),t=Math.floor(256*Math.random()),n=Math.floor(256*Math.random());return"rgb(".concat(e,",").concat(t,",").concat(n,")")},handleClick:function(){var e=this,t=["-",""],n=["/static/qunzi.png","/static/aixin.png","/static/yusan.png","/static/zan.png","/static/hua.png","/static/haixing.png"],r=Math.floor(Math.random()*n.length),i={src:n[r],back:this.random(),index:!1,time:5e3,animationData:{},x:Math.ceil(50*Math.random()),q:Math.floor(Math.random()*t.length),lastIndex:5,timer:null,lastTime:1e3};new Date-this.pageDate<300||(this.pageDate=new Date,this.viewList.push(i),this.viewList.forEach((function(n,r,i){var o=uni.createAnimation({duration:n.time,timingFunction:"ease-out"});e.animation=o;var a=t[n.q]+n.x;setTimeout((function(){e.animation.translateY(-200).step(),e.animation.opacity(0).step(),e.animation.translateX(Number(a)).step(),n.animationData=e.animation.export(),clearInterval(n.timer),n.timer=setInterval((function(){n.lastIndex--,n.lastIndex<0&&(i.splice(n,1),clearInterval(n.timer))}),n.lastTime)}),100)})))}}};t.default=r},bb2f:function(e,t,n){var r=n("d039");e.exports=!r((function(){return Object.isExtensible(Object.preventExtensions({}))}))},bdd6:function(e,t,n){var r=n("ad8b");"string"===typeof r&&(r=[[e.i,r,""]]),r.locals&&(e.exports=r.locals);var i=n("4f06").default;i("2c51e9ab",r,!0,{sourceMap:!1,shadowMode:!1})},bf19:function(e,t,n){"use strict";var r=n("23e7");r({target:"URL",proto:!0,enumerable:!0},{toJSON:function(){return URL.prototype.toString.call(this)}})},bf57:function(e,t,n){"use strict";n.r(t);var r=n("1bfa"),i=n.n(r);for(var o in r)"default"!==o&&function(e){n.d(t,e,(function(){return r[e]}))}(o);t["default"]=i.a},c135:function(e,t){function n(e){if(Array.isArray(e))return e}e.exports=n},c240:function(e,t){function n(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}e.exports=n},c45c:function(e,t,n){"use strict";var r;n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return o})),n.d(t,"a",(function(){return r}));var i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return e.popupVisible?n("v-uni-view",{staticClass:"popup-footer"},[n("v-uni-view",{staticClass:"pop__ui_panel"},[n("v-uni-view",{staticClass:"pop__ui_mask",on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.close.apply(void 0,arguments)}}}),n("v-uni-view",{staticClass:"pop__ui_child anim-footer",on:{click:function(t){t.stopPropagation(),arguments[0]=t=e.$handleEvent(t)}}},[n("div",[n("div",{staticClass:"add-product-head p20 f30"},[n("v-uni-text",{staticClass:"f30"},[e._v("礼物排行")])],1),n("v-uni-scroll-view",{staticStyle:{height:"700rpx"},attrs:{"scroll-y":"true"}},[e.listData.length>0?n("list",{staticClass:"add-product-list",attrs:{loadmoreoffset:10},on:{loadmore:function(t){arguments[0]=t=e.$handleEvent(t),e.loadmoreFunc.apply(void 0,arguments)}}},e._l(e.listData,(function(t,r){return n("cell",{key:r,staticClass:"add-product-item d-s-s"},[0==r?n("v-uni-text",{staticClass:"gift-num ml20 white f26 fir"},[e._v(e._s(r+1))]):e._e(),1==r?n("v-uni-text",{staticClass:"gift-num ml20 white f26 sec"},[e._v(e._s(r+1))]):e._e(),2==r?n("v-uni-text",{staticClass:"gift-num ml20 white f26 thr"},[e._v(e._s(r+1))]):e._e(),0!=r&&1!=r&&2!=r?n("v-uni-text",{staticClass:"gift-num ml20 white f26"},[e._v(e._s(r+1))]):e._e(),n("v-uni-view",[n("v-uni-image",{staticClass:"add-product-picture-image ml20",attrs:{src:t.user.avatarUrl,mode:"aspectFill"}})],1),n("v-uni-text",{staticClass:"user-name f30 ml20"},[e._v(e._s(t.user.nickName))]),n("v-uni-text",{staticClass:"rose f30 f-w mr20 red mt30"},[e._v("+"+e._s(t.gift_num))])],1)})),1):e._e(),e.listData.length<=0&&""!=e.listData?n("div",{staticClass:"gift-null"},[n("v-uni-text",{staticClass:"f32"},[e._v("暂无记录")])],1):e._e()],1)],1)])],1)],1):e._e()},o=[]},c4d6:function(e,t,n){"use strict";var r=n("a9f7"),i=n.n(r);i.a},c5f7:function(e,t,n){function r(e){return-1!==Function.toString.call(e).indexOf("[native code]")}n("c975"),n("d3b7"),n("25f0"),e.exports=r},c8c3:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=["😀","😁","😃","😄","😅","😆","😉","😊","😋","😎","😍","😘","😗","😙","😚","☺","😇","😐","😑","😶","😏","😣","😥","😮","😯","😪","😫","😴","😌","😛","😜","😝","😒","😓","😔","😕","😲","😷","😖","😞","😟","😤","😢","😭","😦","😧","😨","😬","😰","😱","😳","😵","😡","😠","👦","👧","👨","👩","👴","👵","👶","👱","👮","👲","👳","👷","👸","💂","🎅","👰","👼","💆","💇","🙍","🙎","🙅","🙆","💁","🙋","🙇","🙌","🙏","👤","👥","🚶","🏃","👯","💃","👫","👬","👭","💏","💑","👪","💪","👈","👉","☝","👆","👇","✌","✋","👌","👍","👎","✊","👊","👋","👏","👐","✍","👣","👀","👂","👃","👅","👄","💋","👓","👔","👕","👖","👗","👘","👙","👛","👜","👝","🎒","💼","👞","👟","👠","👡","👢","👑","👒","🎩","🎓","💄","💅","💍","🌂","📶","📳","📴","♻","🏧","🚮","🚰","♿","🚹","🚺","🚻","🚼","🚾","⚠","🚸","⛔","🚫","🚳","🚭","🚯","🚱","🚷","🔞","💈","🙈","🙉","🙊","🐵","🐒","🐶","🐕","🐩","🐺","🐱","😺","😸","😹","😻","😼","😽","🙀","😿","😾","🐈","🐯","🐅","🐆","🐴","🐎","🐮","🐂","🐃","🐄","🐷","🐖","🐗","🐽","🐏","🐑","🐐","🐪","🐫","🐘","🐭","🐁","🐀","🐹","🐰","🐇","🐻","🐨","🐼","🐾","🐔","🐓","🐣","🐤","🐥","🐦","🐧","🐸","🐊","🐢","🐍","🐲","🐉","🐳","🐋","🐬","🐟","🐠","🐡","🐙","🐚","🐌","🐛","🐜","🐝","🐞","🦋","💐","🌸","💮","🌹","🌺","🌻","🌼","🌷","🌱","🌲","🌳","🌴","🌵","🌾","🌿","🍀","🍁","🍂","🍃","🌍","🌎","🌏","🌐","🌑","🌒","🌓","🌔","🌕","🌖","🌗","🌘","🌙","🌚","🌛","🌜","☀","🌝","🌞","⭐","🌟","🌠","☁","⛅","☔","⚡","❄","🔥","💧","🌊","🍅","🍆","🌽","🍄","🌰","🍞","🍖","🍗","🍔","🍟","🍕","🍳","🍲","🍱","🍘","🍙","🍚","🍛","🍜","🍝","🍠","🍢","🍣","🍤","🍥","🍡","🍦","🍧","🍨","🍩","🍪","🎂","🍰","🍫","🍬","🍭","🍮","🍯","🍼","☕","🍵","🍶","🍷","🍸","🍹","🍺","🍻","🍴","🎪","🎭","🎨","🎰","🚣","🛀","🎫","🏆","⚽","⚾","🏀","🏈","🏉","🎾","🎱","🎳","⛳","🎣","🎽","🎿","🏂","🏄","🏇","🏊","🚴","🚵","🎯","🎮","🎲","🎷","🎸","🎺","🎻","🎬","😈","👿","👹","👺","💀","☠","👻","👽","👾","💣","🌋","🗻","🏠","🏡","🏢","🏣","🏤","🏥","🏦","🏨","🏩","🏪","🏫","🏬","🏭","🏯","🏰","💒","🗼","🗽","⛪","⛲","🌁","🌃","🌆","🌇","🌉","🌌","🎠","🎡","🎢","🚂","🚃","🚄","🚅","🚆","🚇","🚈","🚉","🚊","🚝","🚞","🚋","🚌","🚍","🚎","🚏","🚐","🚑","🚒","🚓","🚔","🚕","🚖","🚗","🚘","🚚","🚛","🚜","🚲","⛽","🚨","🚥","🚦","🚧","⚓","⛵","🚤","🚢","✈","💺","🚁","🚟","🚠","🚡","🚀","🎑","🗿","🛂","🛃","🛄","🛅","💌","💎","🔪","💈","🚪","🚽","🚿","🛁","⌛","⏳","⌚","⏰","🎈","🎉","🎊","🎎","🎏","🎐","🎀","🎁","📯","📻","📱","📲","☎","📞","📟","📠","🔋","🔌","💻","💽","💾","💿","📀","🎥","📺","📷","📹","📼","🔍","🔎","🔬","🔭","📡","💡","🔦","🏮","📔","📕","📖","📗","📘","📙","📚","📓","📃","📜","📄","📰","📑","🔖","💰","💴","💵","💶","💷","💸","💳","✉","📧","📨","📩","📤","📥","📦","📫","📪","📬","📭","📮","✏","✒📝","📁","📂","📅","📆","📇","📈","📉","📊","📋","📌","📍","📎📏📐","✂","🔒","🔓","🔏","🔐","🔑","🔨","🔫","🔧","🔩","🔗","💉","💊","🚬","🔮🚩","🎌","💦","💨","♠","♥","♦","♣","🀄","🎴","🔇","🔈","🔉","🔊","📢","📣","💤","💢","💬","💭","♨","🌀","🔔","🔕","✡","✝","🔯","📛","🔰","🔱","⭕","✅","☑","✔","✖","❌","❎","➕","➖","➗","➰","➿","〽","✳","✴","❇","‼","⁉","❓","❔","❕","❗","©®","™🎦🔅","🔆","💯","🔠","🔡","🔢","🔣","🔤","🅰","🆎","🅱","🆑","🆒","🆓","ℹ🆔","Ⓜ","🆕","🆖","🅾","🆗","🅿","🆘","🆙","🆚","🈁","🈂","🈷","🈶","🈯","🉐","🈹","🈚","🈲","🉑","🈸","🈴","🈳","㊗","㊙","🈺","🈵","▪","▫","◻","◼◽","◾","⬛","⬜","🔶","🔷","🔸","🔹","🔺","🔻","💠","🔲","🔳","⚪","⚫","🔴","🔵","♈","♉","♊","♋","♌","♍","♎","♏","♐","♑","♒","♓","⛎","🕛","🕧","🕐","🕜","🕑","🕝","🕒","🕞","🕓","🕟","🕔","🕠","🕕","🕡","🕖","🕢","🕗","🕣","🕘","🕤","🕙","🕥","🕚","🕦","⏱","⏲","🕰","💘","❤","💓","💔","💕","💖","💗","💙","💚","💛","💜","💝","💞","💟❣","🍇","🍈","🍉","🍊","🍋","🍌","🍍","🍎","🍏","🍐","🍑","🍒","🍓","⬆","↗","➡","↘","⬇","↙","⬅","↖","↕","↔","↩","↪","⤴","⤵","🔃","🔄","🔙","🔚","🔛","🔜","🔝","♚","♛","♝","♞","♜","♟","♔","♕","♗","♘","♖"];t.default=r},c973:function(e,t,n){function r(e,t,n,r,i,o,a){try{var s=e[o](a),c=s.value}catch(u){return void n(u)}s.done?t(c):Promise.resolve(c).then(r,i)}function i(e){return function(){var t=this,n=arguments;return new Promise((function(i,o){var a=e.apply(t,n);function s(e){r(a,i,o,s,c,"next",e)}function c(e){r(a,i,o,s,c,"throw",e)}s(void 0)}))}}n("d3b7"),e.exports=i},ca4a:function(e,t,n){"use strict";n.r(t);var r=n("fd15"),i=n("878d");for(var o in i)"default"!==o&&function(e){n.d(t,e,(function(){return i[e]}))}(o);n("ff61");var a,s=n("f0c5"),c=Object(s["a"])(i["default"],r["b"],r["c"],!1,null,"28d56186",null,!1,r["a"],a);t["default"]=c.exports},cfc3:function(e,t,n){var r=n("74e8");r("Float32",(function(e){return function(t,n,r){return e(this,t,n,r)}}))},d198:function(e,t,n){"use strict";var r;n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return o})),n.d(t,"a",(function(){return r}));var i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return e.showPlanView?n("v-uni-view",{staticClass:"wrap__giftPanel"},[n("v-uni-view",{staticClass:"wrapgift-mask",on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.close.apply(void 0,arguments)}}}),n("v-uni-scroll-view",{staticClass:"wrapgift-body"},[n("div",[n("div",{staticClass:"plan-box"},[n("div",{staticClass:"gift-container-head plan-box-head"},[n("v-uni-text",{staticClass:"f30"},[e._v(e._s(e.gift_name)+"：")]),n("v-uni-text",{staticClass:"f30 yellow"},[e._v(e._s(e.userInfo.gift_money))])],1),n("div",{staticClass:"plan-cells"},e._l(e.planList,(function(t,r){return n("div",{key:r,class:e.choose_id==t.plan_id?"active_border":"plan-cell-list",on:{click:function(n){arguments[0]=n=e.$handleEvent(n),e.chooseplan(t)}}},[n("div",{staticClass:"plan-list-title"},[n("v-uni-text",{staticClass:"rose f30"},[e._v(e._s(t.real_money))]),n("v-uni-text",{staticClass:"f28"},[e._v(e._s(e.gift_name))])],1),n("div",{staticClass:"plan-list-rmb"},[n("v-uni-text",{staticClass:"f30 gray9"},[e._v(e._s(t.money)+"元")])],1)])})),0),n("div",{staticClass:"w100"},[n("v-uni-button",{staticClass:"pan_btn",on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.submit.apply(void 0,arguments)}}},[n("v-uni-text",{staticClass:"white"},[e._v("立即充值")])],1)],1),n("div",{staticClass:"plan-xieyi"},[n("v-uni-text",{staticClass:"f28"},[e._v("充值代表已阅读并同意")]),n("v-uni-text",{staticClass:"f28 yellow"},[e._v("《用户充值协议》")])],1)])])])],1):e._e()},o=[]},d246:function(e,t,n){"use strict";n.r(t);var r=n("e92d"),i=n("25a6");for(var o in i)"default"!==o&&function(e){n.d(t,e,(function(){return i[e]}))}(o);var a,s=n("f0c5"),c=Object(s["a"])(i["default"],r["b"],r["c"],!1,null,"505b4671",null,!1,r["a"],a);t["default"]=c.exports},d4d7:function(e,t,n){"use strict";var r;n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return o})),n.d(t,"a",(function(){return r}));var i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-uni-view",{staticClass:"animate-wrap"},e._l(e.viewList,(function(e,t){return n("v-uni-view",{key:t,ref:"test",refInFor:!0,staticClass:"aa",class:{bb:e.index}},[n("v-uni-image",{staticStyle:{width:"65rpx",height:"65rpx"},attrs:{mode:"widthFix",src:e.src,animation:e.animationData}})],1)})),1)},o=[]},d8c5:function(e,t,n){"use strict";n.r(t);var r=n("0665"),i=n.n(r);for(var o in r)"default"!==o&&function(e){n.d(t,e,(function(){return r[e]}))}(o);t["default"]=i.a},d8ff:function(e,t,n){"use strict";n.r(t);var r=n("4efa"),i=n("fd43");for(var o in i)"default"!==o&&function(e){n.d(t,e,(function(){return i[e]}))}(o);n("c4d6");var a,s=n("f0c5"),c=Object(s["a"])(i["default"],r["b"],r["c"],!1,null,"0c585e63",null,!1,r["a"],a);t["default"]=c.exports},d923:function(e,t,n){"use strict";n("99af"),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r={data:function(){return{popupVisible:!1,loading:!0,no_more:!1,listData:[],page:1,list_rows:10}},props:["room_id"],methods:{getRequest:function(){var e=this;return e},show:function(){this.popupVisible=!0,this.getRank()},getRank:function(){this.loading=!0,this.no_more=!1,this.listData=[],this.page=1,this.list_rows=10,this.getData()},getData:function(){var e=this,t=e.page,n=e.list_rows;console.log(e.room_id),e.getRequest()._get("plus.live.room/user_gift",{page:t||1,list_rows:n,room_id:e.room_id},(function(t){e.loading=!1,e.listData=e.listData.concat(t.data.list.data),e.last_page=t.data.list.last_page,t.data.list.last_page<=1&&(e.no_more=!0)}))},loadmoreFunc:function(){var e=this;if(e.bottomRefresh=!0,e.page++,e.loading=!0,e.page>e.last_page)return e.loading=!1,void(e.no_more=!0);e.getData()},close:function(){this.popupVisible=!1}}};t.default=r},d9b1:function(e,t,n){"use strict";var r;n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return o})),n.d(t,"a",(function(){return r}));var i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return e.popupVisible?n("v-uni-view",{staticClass:"popup-footer"},[n("v-uni-view",{staticClass:"pop__ui_panel"},[n("v-uni-view",{staticClass:"pop__ui_mask",on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.close.apply(void 0,arguments)}}}),n("v-uni-view",{staticClass:"pop__ui_child anim-footer",on:{click:function(t){t.stopPropagation(),arguments[0]=t=e.$handleEvent(t)}}},[n("v-uni-view",{staticClass:"pop__ui_body"},[n("v-uni-view",{staticClass:"wrap_commentPanel"},[n("v-uni-view",{staticClass:"wrap_cmtFoot",style:"bottom:"+e.inputBottom+"px;"},[n("v-uni-view",{staticClass:"wrap__editorPanel uni_borT uni__editorPanel"},[n("v-uni-view",{staticClass:"wrap_editor uni_editor"},[n("v-uni-input",{staticClass:"editor",attrs:{"auto-focus":"true",value:"","adjust-position":!1,"confirm-type":"send",placeholder:"说点什么..."},on:{confirm:function(t){arguments[0]=t=e.$handleEvent(t),e.sendTextMsg()},focus:function(t){arguments[0]=t=e.$handleEvent(t),e.inputFocus.apply(void 0,arguments)},blur:function(t){arguments[0]=t=e.$handleEvent(t),e.inputBlur.apply(void 0,arguments)}},model:{value:e.content,callback:function(t){e.content=t},expression:"content"}})],1),n("v-uni-view",{staticClass:"uni_editor_btn",on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.emojiShow=!e.emojiShow}}},[n("v-uni-text",{staticClass:"icon iconfont icon-biaoqing"})],1),n("v-uni-view",{staticClass:"uni_editor_btn btn_submit uni__btn-primary bg_linear2",on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.sendTextMsg.apply(void 0,arguments)}}},[n("v-uni-text",{staticClass:"icon iconfont icon-fasong"})],1)],1),n("v-uni-view",{directives:[{name:"show",rawName:"v-show",value:e.emojiShow,expression:"emojiShow"}],staticClass:"bc-white"},[n("v-uni-swiper",{staticClass:"slider"},e._l(e.emojiData,(function(t,r){return n("v-uni-swiper-item",{key:r,staticClass:"slider-emoji",class:[r==e.emojiData.length-1?"lastbox":""]},e._l(t,(function(t,r){return n("v-uni-text",{key:r,staticClass:"slider-emoji-icon",on:{click:function(n){arguments[0]=n=e.$handleEvent(n),e.selemoji(t)}}},[e._v(e._s(t))])})),1)})),1)],1)],1)],1)],1)],1)],1)],1):e._e()},o=[]},d9c4:function(e,t,n){"use strict";n.r(t);var r=n("d923"),i=n.n(r);for(var o in r)"default"!==o&&function(e){n.d(t,e,(function(){return r[e]}))}(o);t["default"]=i.a},dbb3:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r={data:function(){return{popupVisible:!1}},beforeCreate:function(){},methods:{show:function(){this.popupVisible=!0},getPoster:function(){this.$emit("livePoster")},close:function(){this.popupVisible=!1},share:function(){}}};t.default=r},dca8:function(e,t,n){var r=n("23e7"),i=n("bb2f"),o=n("d039"),a=n("861d"),s=n("f183").onFreeze,c=Object.freeze,u=o((function(){c(1)}));r({target:"Object",stat:!0,forced:u,sham:!i},{freeze:function(e){return c&&a(e)?c(s(e)):e}})},dcea:function(e,t,n){"use strict";var r=n("36ee"),i=n.n(r);i.a},ded3:function(e,t,n){n("a4d3"),n("4de4"),n("4160"),n("e439"),n("dbb4"),n("b64b"),n("159b");var r=n("9523");function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}e.exports=o},df7c:function(e,t,n){(function(e){function n(e,t){for(var n=0,r=e.length-1;r>=0;r--){var i=e[r];"."===i?e.splice(r,1):".."===i?(e.splice(r,1),n++):n&&(e.splice(r,1),n--)}if(t)for(;n--;n)e.unshift("..");return e}function r(e){"string"!==typeof e&&(e+="");var t,n=0,r=-1,i=!0;for(t=e.length-1;t>=0;--t)if(47===e.charCodeAt(t)){if(!i){n=t+1;break}}else-1===r&&(i=!1,r=t+1);return-1===r?"":e.slice(n,r)}function i(e,t){if(e.filter)return e.filter(t);for(var n=[],r=0;r<e.length;r++)t(e[r],r,e)&&n.push(e[r]);return n}t.resolve=function(){for(var t="",r=!1,o=arguments.length-1;o>=-1&&!r;o--){var a=o>=0?arguments[o]:e.cwd();if("string"!==typeof a)throw new TypeError("Arguments to path.resolve must be strings");a&&(t=a+"/"+t,r="/"===a.charAt(0))}return t=n(i(t.split("/"),(function(e){return!!e})),!r).join("/"),(r?"/":"")+t||"."},t.normalize=function(e){var r=t.isAbsolute(e),a="/"===o(e,-1);return e=n(i(e.split("/"),(function(e){return!!e})),!r).join("/"),e||r||(e="."),e&&a&&(e+="/"),(r?"/":"")+e},t.isAbsolute=function(e){return"/"===e.charAt(0)},t.join=function(){var e=Array.prototype.slice.call(arguments,0);return t.normalize(i(e,(function(e,t){if("string"!==typeof e)throw new TypeError("Arguments to path.join must be strings");return e})).join("/"))},t.relative=function(e,n){function r(e){for(var t=0;t<e.length;t++)if(""!==e[t])break;for(var n=e.length-1;n>=0;n--)if(""!==e[n])break;return t>n?[]:e.slice(t,n-t+1)}e=t.resolve(e).substr(1),n=t.resolve(n).substr(1);for(var i=r(e.split("/")),o=r(n.split("/")),a=Math.min(i.length,o.length),s=a,c=0;c<a;c++)if(i[c]!==o[c]){s=c;break}var u=[];for(c=s;c<i.length;c++)u.push("..");return u=u.concat(o.slice(s)),u.join("/")},t.sep="/",t.delimiter=":",t.dirname=function(e){if("string"!==typeof e&&(e+=""),0===e.length)return".";for(var t=e.charCodeAt(0),n=47===t,r=-1,i=!0,o=e.length-1;o>=1;--o)if(t=e.charCodeAt(o),47===t){if(!i){r=o;break}}else i=!1;return-1===r?n?"/":".":n&&1===r?"/":e.slice(0,r)},t.basename=function(e,t){var n=r(e);return t&&n.substr(-1*t.length)===t&&(n=n.substr(0,n.length-t.length)),n},t.extname=function(e){"string"!==typeof e&&(e+="");for(var t=-1,n=0,r=-1,i=!0,o=0,a=e.length-1;a>=0;--a){var s=e.charCodeAt(a);if(47!==s)-1===r&&(i=!1,r=a+1),46===s?-1===t?t=a:1!==o&&(o=1):-1!==t&&(o=-1);else if(!i){n=a+1;break}}return-1===t||-1===r||0===o||1===o&&t===r-1&&t===n+1?"":e.slice(t,r)};var o="b"==="ab".substr(-1)?function(e,t,n){return e.substr(t,n)}:function(e,t,n){return t<0&&(t=e.length+t),e.substr(t,n)}}).call(this,n("4362"))},e2b2:function(e,t,n){"use strict";var r;n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return o})),n.d(t,"a",(function(){return r}));var i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return e.popupVisible?n("v-uni-view",{staticClass:"wrap__giftPanel"},[n("v-uni-view",{staticClass:"wrapgift-mask",on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.close.apply(void 0,arguments)}}}),n("v-uni-view",{staticClass:"pop__ui_child anim-footer"},[e.showSlider?n("div",{staticClass:"progress-bar",on:{click:function(t){t.stopPropagation(),arguments[0]=t=e.$handleEvent(t)}}},[n("v-uni-slider",{attrs:{value:e.value,activeColor:"#f72b6c",backgroundColor:"#FFFFFF","block-color":"#FFFFFF",min:0,max:9,"show-value":!0},on:{change:function(t){arguments[0]=t=e.$handleEvent(t),e.sliderChange.apply(void 0,arguments)}}})],1):e._e(),n("div",{staticClass:"more-box",on:{click:function(t){t.stopPropagation(),arguments[0]=t=e.$handleEvent(t)}}},[n("div",{staticClass:"more-list",class:{"more-list-active":0==e.activeIndex},on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.setBeauty.apply(void 0,arguments)}}},[n("v-uni-text",{staticClass:"icon iconfont icon-meiyan i-btntool more-icont"}),n("v-uni-text",{staticClass:"f28 white mt20"},[e._v("美颜")])],1),n("div",{staticClass:"more-list",class:{"more-list-active":1==e.activeIndex},on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.setWhiteness.apply(void 0,arguments)}}},[n("v-uni-text",{staticClass:"icon iconfont icon-meibai i-btntool more-icont"}),n("v-uni-text",{staticClass:"f28 white mt20"},[e._v("美白")])],1),n("div",{staticClass:"more-list",class:{"more-list-active":2==e.activeIndex},on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.setDevice.apply(void 0,arguments)}}},[n("v-uni-text",{staticClass:"icon iconfont icon-iconset0243 i-btntool more-icont"}),n("v-uni-text",{staticClass:"f28 white mt20"},[e._v("相机切换")])],1)])])],1):e._e()},o=[]},e4f8:function(e,t,n){var r=n("24fb");t=r(!1),t.push([e.i,".nlv_borT[data-v-6b1b353b]{border-color:#ebebeb;border-style:solid;border-top-width:%?1?%}.wrapgift-mask[data-v-6b1b353b]{background-color:#000;opacity:.1;position:fixed;left:0;right:0;top:0;bottom:0;z-index:201910}.wrapgift-body[data-v-6b1b353b]{overflow:hidden;position:fixed;bottom:0;left:0;right:0;z-index:201911}.gift-head[data-v-6b1b353b]{border-color:hsla(0,0%,100%,.3);border-style:solid;border-bottom-width:%?1?%;flex-direction:row;align-items:center;height:%?100?%}.gift-menu[data-v-6b1b353b]{flex:1;flex-direction:row}.gm-item[data-v-6b1b353b]{color:#999;font-size:%?32?%;margin-left:%?40?%;line-height:%?100?%}.gm-item-on[data-v-6b1b353b]{color:#fff;border-color:#ff0f33;border-style:solid;border-bottom-width:2px}.gift-coins[data-v-6b1b353b]{color:#fff;font-size:%?28?%;flex-direction:row;align-items:center;padding-right:%?30?%}.gc-coin[data-v-6b1b353b]{color:#fff;font-size:%?25?%}.gc-num[data-v-6b1b353b]{color:#feb719;font-size:12px}.gc-recharge[data-v-6b1b353b]{color:#ff0f33;font-size:12px;margin-left:%?30?%}.wrap_giftlist[data-v-6b1b353b]{background-color:#1f253e;border-top-left-radius:12px;border-top-right-radius:12px;height:%?700?%;position:relative}.gift-swiper[data-v-6b1b353b]{flex:1}.gift__cells[data-v-6b1b353b]{flex-direction:row;flex-wrap:wrap}.giftitem[data-v-6b1b353b]{flex-direction:column;align-items:center;justify-content:center;margin-top:%?20?%;width:%?186?%}.giftitem-rect[data-v-6b1b353b]{align-items:center;justify-content:center;height:%?150?%;width:%?150?%;position:relative}.giftimg[data-v-6b1b353b]{height:%?100?%;width:%?100?%}.giftimg_active[data-v-6b1b353b]{height:%?100?%;width:%?100?%;-webkit-transform:scale(1.2);transform:scale(1.2)}.giftname[data-v-6b1b353b]{color:#fff;font-size:%?30?%}.giftcoin[data-v-6b1b353b]{color:hsla(0,0%,100%,.3);font-size:%?22?%;margin-top:2px}.sendbtn[data-v-6b1b353b]{width:%?150?%;height:%?40?%;background-color:red;border-radius:%?20?%;text-align:center;padding:0;border-width:0}.btntext[data-v-6b1b353b]{font-size:%?22?%;color:#fff;line-height:%?40?%}.giftitem_active[data-v-6b1b353b]{flex-direction:column;align-items:center;justify-content:center;background-image:linear-gradient(180deg,hsla(0,0%,100%,0),hsla(0,0%,100%,.3));border-radius:%?20?%}.giftitem_active .giftcoin[data-v-6b1b353b]{margin-top:%?-6?%;margin-bottom:%?6?%}",""]),e.exports=t},e5e9:function(e,t,n){"use strict";var r=n("ae45"),i=n.n(r);i.a},e70e:function(e,t,n){"use strict";var r=n("92ac3"),i=n.n(r);i.a},e92d:function(e,t,n){"use strict";var r;n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return o})),n.d(t,"a",(function(){return r}));var i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-uni-view",[e.is_replay?[n("v-uni-view",{staticClass:"video-detail"},[n("v-uni-video",{style:{height:e.winHeight,width:e.winWidth},attrs:{id:"myVideo",src:e.replay_url,autoplay:!0,loop:!0,controls:!1,"show-fullscreen-btn":!1,"show-play-btn":!1,"show-center-play-btn":!1,"object-fit":"cover"},on:{error:function(t){arguments[0]=t=e.$handleEvent(t),e.videoErrorCallback.apply(void 0,arguments)}}})],1)]:e._e(),"audience"==e.role&&""!=e.player_url?[n("v-uni-live-player",{style:{height:e.winHeight,width:e.winWidth},attrs:{id:"livePlayer","picture-in-picture-mode":e.picture_mode,src:e.player_url,autoplay:"true",mode:"RTC","object-fit":"fillCrop"}})]:e._e(),"broadcaster"==e.role?[n("v-uni-live-pusher",{ref:"livePusher1",staticClass:"livePusher",style:{height:e.winHeight,width:e.winWidth},attrs:{id:"livePusher1",url:e.mainPusherInfo_url,mode:"RTC","enable-camera":"true","enable-mic":"true","auto-focus":"true",aspect:"9:16",objectFit:"fill","max-bitrate":"500","min-bitrate":"200","waiting-image":"../../../static/temporarily.jpg",beauty:e.beauty,whiteness:e.whiteness},on:{statechange:function(t){arguments[0]=t=e.$handleEvent(t),e.recorderStateChange.apply(void 0,arguments)},netstatus:function(t){arguments[0]=t=e.$handleEvent(t),e.recorderNetChange.apply(void 0,arguments)}}})]:e._e()],2)},o=[]},ed06:function(e,t,n){var r=n("24fb");t=r(!1),t.push([e.i,".pop__ui_mask[data-v-77752cf6]{background-color:#000;opacity:.1;position:fixed;left:0;right:0;top:0;bottom:0;z-index:1000}.pop__ui_child[data-v-77752cf6]{background-color:#fbfbfb;border-top-left-radius:12px;border-top-right-radius:12px;font-size:14px;position:fixed;bottom:0;left:0;right:0;z-index:9998}.pop__ui_head[data-v-77752cf6]{border-style:solid;border-color:#ebebeb;border-bottom-width:%?1?%;font-size:%?28?%;font-weight:700;padding:%?30?%;text-alig:left}.foot-anchorinfo-wrap-anchorinfo[data-v-77752cf6]{margin-top:%?150?%;height:%?120?%}.foot-anchorinfo-wrap-photo-box[data-v-77752cf6]{position:fixed;bottom:%?280?%;left:%?275?%;width:%?200?%;height:%?200?%;z-index:9999}.foot-anchorinfo-wrap-photo[data-v-77752cf6]{width:%?200?%;height:%?200?%;border-radius:50%}.foot-anchorinfo-wrap-bottom[data-v-77752cf6]{height:%?100?%;background-color:#f4f4f4}.foot-anchorinfo-guanzhu[data-v-77752cf6]{color:#e34470}.foot-anchorinfo-zhuye[data-v-77752cf6]{color:#545454}",""]),e.exports=t},ed28:function(e,t,n){"use strict";n.r(t);var r=n("76c7"),i=n("5b92");for(var o in i)"default"!==o&&function(e){n.d(t,e,(function(){return i[e]}))}(o);n("dcea");var a,s=n("f0c5"),c=Object(s["a"])(i["default"],r["b"],r["c"],!1,null,"8bef6f6a",null,!1,r["a"],a);t["default"]=c.exports},ed6d:function(e,t,n){var r=n("4a4b");function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&r(e,t)}e.exports=i},f0e4:function(e,t,n){function r(e,t){if(null==e)return{};var n,r,i={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(i[n]=e[n]);return i}n("c975"),n("b64b"),e.exports=r},f183:function(e,t,n){var r=n("d012"),i=n("861d"),o=n("5135"),a=n("9bf2").f,s=n("90e3"),c=n("bb2f"),u=s("meta"),l=0,d=Object.isExtensible||function(){return!0},f=function(e){a(e,u,{value:{objectID:"O"+ ++l,weakData:{}}})},h=function(e,t){if(!i(e))return"symbol"==typeof e?e:("string"==typeof e?"S":"P")+e;if(!o(e,u)){if(!d(e))return"F";if(!t)return"E";f(e)}return e[u].objectID},p=function(e,t){if(!o(e,u)){if(!d(e))return!0;if(!t)return!1;f(e)}return e[u].weakData},_=function(e){return c&&v.REQUIRED&&d(e)&&!o(e,u)&&f(e),e},v=e.exports={REQUIRED:!1,fastKey:h,getWeakData:p,onFreeze:_};r[u]=!0},f295:function(e,t,n){"use strict";var r=n("88cf"),i=n.n(r);i.a},f2aa:function(e,t,n){"use strict";var r;n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return o})),n.d(t,"a",(function(){return r}));var i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return""==e.winHeight||e.loading?e._e():n("div",{staticClass:"nlv__container",style:"height:"+e.winHeight+" ;"},[e.is_start?e._e():n("v-uni-view",{staticClass:"nlv_main"},[n("v-uni-view",[n("v-uni-view",{staticClass:"notice_back_back",on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.goBack.apply(void 0,arguments)}}},[n("v-uni-text",{staticClass:"icon iconfont icon-guanbi notice_jiantou"})],1),n("v-uni-view",{staticClass:"notice_back"},[n("v-uni-image",{staticClass:"notice_back_image",style:"height:"+e.winHeight+" ;",attrs:{src:e.roomDetail.share.file_path,mode:"aspectFill"}})],1),n("v-uni-view",{staticClass:"notice_content",style:"height:"+e.winHeight+" ;"},[n("v-uni-view",{staticClass:"notice_content_imgbox"},[n("v-uni-image",{staticClass:"notice_content_img",attrs:{src:e.roomDetail.share.file_path,mode:""}})],1),n("v-uni-text",{staticClass:"notice_title_t"},[e._v(e._s(e.roomDetail.name))]),n("v-uni-text",{staticClass:"notice_title_c"},[e._v("——敬请期待——")]),n("v-uni-view",{staticClass:"notice_title_b"},[n("Countdown",{attrs:{config:e.countdownConfig}})],1),n("v-uni-view",{staticClass:"d-a-c notice_btns"},[n("v-uni-button",{staticClass:"notice_btn",attrs:{"open-type":"share"}},[n("v-uni-text",{staticClass:"notice_btn_txt"},[e._v("分享朋友")])],1),n("v-uni-button",{staticClass:"notice_btn",on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.livePoster.apply(void 0,arguments)}}},[n("v-uni-text",{staticClass:"notice_btn_txt"},[e._v("生成海报")])],1)],1)],1),n("v-uni-view",{staticClass:"notice_share"},[null!=e.qrcode&!e.is_start?n("share",{attrs:{winHeight:e.winHeight,qrcode:e.qrcode},on:{close:function(t){arguments[0]=t=e.$handleEvent(t),e.closeShare.apply(void 0,arguments)}}}):e._e()],1)],1)],1),e.is_start?n("v-uni-view",{staticClass:"nlv_main"},[n("v-uni-view",{staticClass:"nlv-playerbox"},[n("live-room",{ref:"liveRoom",attrs:{winHeight:e.winHeight,winWidth:e.winWidth,role:e.role,is_replay:e.is_replay,replay_url:e.replay_url},on:{showMsg:function(t){arguments[0]=t=e.$handleEvent(t),e.showMsg.apply(void 0,arguments)}}}),n("v-uni-view",{staticClass:"nlv_topbar",style:{height:e.headerBarH,"padding-top":e.statusBarH}},[n("v-uni-view",{staticClass:"topbar-right"},[n("v-uni-text",{staticClass:"topbar_ico icon iconfont icon-guanbi",on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.closeLive.apply(void 0,arguments)}}})],1),n("v-uni-view",{staticClass:"topbar-info"},[n("v-uni-view",{staticClass:"avator-box"},[n("v-uni-image",{staticClass:"ta-avator",attrs:{src:e.roomDetail.supplier.logo.file_path,mode:"aspectFill"},on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.openAnchor.apply(void 0,arguments)}}}),n("v-uni-view",{staticClass:"tabox"},[n("v-uni-text",{staticClass:"ta-name"},[e._v(e._s(e.roomDetail.supplier.name))]),n("v-uni-text",{staticClass:"ta-num"},[e._v(e._s(e.roomDetail.view_num)+"观看")])],1),e.isCaster?e._e():n("v-uni-text",{staticClass:"ta-gz",class:e.hasFollow?"ta-gz-on":"",on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.followFunc()}}},[e._v(e._s(e.hasFollow?"已关注":"关注"))])],1)],1)],1),n("v-uni-view",{staticClass:"nlv-rankbox",style:{top:e.headerBarH}},[n("v-uni-view",{staticClass:"nlv-rkls",on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.openRank.apply(void 0,arguments)}}},[n("v-uni-text",{staticClass:"rkitem"},[e._v(e._s(e.gift_name)+"："+e._s(e.roomDetail.gift_num))])],1),n("v-uni-view",{staticClass:"nlv-rkls"},[n("v-uni-text",{staticClass:"rkitem ml30"},[e._v("人气值："+e._s(e.digg_num))])],1)],1),n("v-uni-view",{staticClass:"nlv-footToolbar"},[""!=e.giftInfo.nickName?n("v-uni-view",{staticClass:"nlv-giftTipPanel"},[n("v-uni-view",{staticClass:"giftip-item"},[n("v-uni-image",{staticClass:"gt-avator",attrs:{src:e.giftInfo.avatarUrl,mode:"aspectFill"}}),n("v-uni-view",{staticClass:"gt-info"},[n("v-uni-text",{staticClass:"gt-tit"},[e._v(e._s(e.giftInfo.nickName))]),n("v-uni-text",{staticClass:"gt-subtit"},[e._v("送主播"+e._s(e.giftInfo.giftName))])],1),n("v-uni-image",{staticClass:"gt-gift",attrs:{src:e.giftInfo.giftImage,mode:"aspectFill"}})],1)],1):e._e(),n("v-uni-scroll-view",{staticClass:"nlv-rollMsgPanel",attrs:{"scroll-into-view":e.toMsg,"scroll-y":!0,"show-scrollbar":"false"}},[e._l(e.commentsList,(function(t,r){return[n("v-uni-view",{key:r+"_0",staticClass:"nlv-msglist"},[n("v-uni-view",{staticClass:"msg_bg",attrs:{id:"comment"+r}},["text"==t.type?n("v-uni-view",{staticClass:"msg_text"},[n("v-uni-text",{staticClass:"msg_name"},[e._v(e._s(t.nickName)+":")]),n("v-uni-text",{staticClass:"msg_txt"},[e._v(e._s(t.msg))])],1):e._e(),"enter"==t.type?n("v-uni-view",{staticClass:"msg_text"},[n("v-uni-text",{staticClass:"msg_name "},[e._v(e._s(t.nickName))]),n("v-uni-text",{staticClass:"msg_txt"},[e._v("来了")])],1):e._e()],1)],1)]}))],2),n("v-uni-view",{staticClass:"nlv-infobox"},[n("v-uni-view",{staticClass:"nlv_reply",on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.handleRollMsg(e.index)}}},[n("v-uni-text",{staticClass:"nlv_reply_text"},[e._v("说点什么...")])],1),n("v-uni-view",{staticClass:"nlv_btntool"},[n("v-uni-view",{staticClass:"btn-toolitem",on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.handleLiveCart()}}},[n("v-uni-text",{staticClass:"icon iconfont icon-gouwu i-btntool",staticStyle:{color:"#ff4e0e","font-size":"20px"}})],1),e.isCaster?e._e():n("v-uni-view",{staticClass:"btn-toolitem btn-toolitem-cart",on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.handleLiveGift.apply(void 0,arguments)}}},[n("v-uni-text",{staticClass:"iconfont icon icon-libao i-btntool"})],1),n("v-uni-button",{staticClass:"btn-toolitem",on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.openShare.apply(void 0,arguments)}}},[n("v-uni-text",{staticClass:"icon iconfont icon-share1 i-btntool"})],1),e.isCaster?n("v-uni-view",{staticClass:"btn-toolitem",on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.openMore.apply(void 0,arguments)}}},[n("v-uni-text",{staticClass:"icon iconfont icon-caidan i-btntool"})],1):e._e(),e.isCaster?e._e():n("v-uni-button",{staticClass:"btn-toolitem",on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.digg.apply(void 0,arguments)}}},[n("v-uni-text",{staticClass:"icon iconfont icon-31guanzhu1xuanzhong i-btntool"})],1)],1)],1)],1)],1),null==e.explain_product||e.is_replay?e._e():n("div",{staticClass:"product",on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.gotoProduct.apply(void 0,arguments)}}},[n("div",{staticClass:"product-pic"},[n("v-uni-image",{staticClass:"product-img",attrs:{src:e.explain_product.product_image}})],1),n("div",{staticClass:"product-price"},[n("v-uni-text",{staticClass:"f24 rose"},[e._v("￥")]),n("v-uni-text",{staticClass:"rose f28"},[e._v(e._s(e.explain_product.product_price))])],1)]),null!=e.qrcode?n("share",{attrs:{winHeight:e.winHeight,qrcode:e.qrcode},on:{close:function(t){arguments[0]=t=e.$handleEvent(t),e.closeShare.apply(void 0,arguments)}}}):e._e()],1):e._e(),n("Likes",{ref:"likes"}),n("live-cart",{ref:"liveCart",attrs:{isCaster:e.isCaster,shop_supplier_id:e.roomDetail.shop_supplier_id,room_id:e.room_id},on:{openOrder:function(t){arguments[0]=t=e.$handleEvent(t),e.openOrder.apply(void 0,arguments)},setProduct:function(t){arguments[0]=t=e.$handleEvent(t),e.setProduct.apply(void 0,arguments)}}}),n("live-gift",{ref:"liveGift",attrs:{room_id:e.room_id,gift_name:e.gift_name,giftList:e.giftList},on:{openPlan:function(t){arguments[0]=t=e.$handleEvent(t),e.openPlan.apply(void 0,arguments)},sendGift:function(t){arguments[0]=t=e.$handleEvent(t),e.sendGift.apply(void 0,arguments)}}}),n("live-msg",{ref:"liveMsg",attrs:{emojiData:e.emojiData},on:{closeMsg:function(t){arguments[0]=t=e.$handleEvent(t),e.closeMsg.apply(void 0,arguments)}}}),n("live-plan",{ref:"livePlan",attrs:{gift_name:e.gift_name},on:{closePlan:function(t){arguments[0]=t=e.$handleEvent(t),e.closePlan.apply(void 0,arguments)}}}),n("live-order",{ref:"liveOrder",attrs:{shop_supplier_id:e.roomDetail.shop_supplier_id,room_id:e.room_id},on:{closeOrder:function(t){arguments[0]=t=e.$handleEvent(t),e.closeOrder.apply(void 0,arguments)}}}),n("live-anchor",{ref:"liveAnchor",attrs:{room_id:e.room_id,shop_supplier_id:e.roomDetail.shop_supplier_id},on:{changeFollow:function(t){arguments[0]=t=e.$handleEvent(t),e.changeFollow.apply(void 0,arguments)}}}),n("live-more",{ref:"liveMore",on:{liveSet:function(t){arguments[0]=t=e.$handleEvent(t),e.liveSet.apply(void 0,arguments)}}}),n("live-share",{ref:"liveShare",on:{livePoster:function(t){arguments[0]=t=e.$handleEvent(t),e.livePoster.apply(void 0,arguments)}}}),n("live-rank",{ref:"liveRank",attrs:{room_id:e.room_id}}),n("AppShare",{ref:"appShare",attrs:{appParams:e.appParams}})],1)},o=[]},f4b3:function(e,t,n){"use strict";var r=n("23e7"),i=n("d039"),o=n("7b0b"),a=n("c04e"),s=i((function(){return null!==new Date(NaN).toJSON()||1!==Date.prototype.toJSON.call({toISOString:function(){return 1}})}));r({target:"Date",proto:!0,forced:s},{toJSON:function(e){var t=o(this),n=a(t);return"number"!=typeof n||isFinite(n)?t.toISOString():null}})},f5ac:function(module,exports,__webpack_require__){__webpack_require__("a4d3"),__webpack_require__("e01a"),__webpack_require__("b636"),__webpack_require__("d28b"),__webpack_require__("944a"),__webpack_require__("99af"),__webpack_require__("4de4"),__webpack_require__("4160"),__webpack_require__("a630"),__webpack_require__("c975"),__webpack_require__("d81d"),__webpack_require__("26e9"),__webpack_require__("fb6a"),__webpack_require__("a434"),__webpack_require__("ace4"),__webpack_require__("0c47"),__webpack_require__("4ec9"),__webpack_require__("23dc"),__webpack_require__("a9e3"),__webpack_require__("8ba4"),__webpack_require__("aff5"),__webpack_require__("25eb"),__webpack_require__("dca8"),__webpack_require__("3410"),__webpack_require__("b64b"),__webpack_require__("131a"),__webpack_require__("d3b7"),__webpack_require__("e25e"),__webpack_require__("4d63"),__webpack_require__("ac1f"),__webpack_require__("25f0"),__webpack_require__("6062"),__webpack_require__("3ca3"),__webpack_require__("5319"),__webpack_require__("1276"),__webpack_require__("498a"),__webpack_require__("cfc3"),__webpack_require__("4a9b"),__webpack_require__("5cc6"),__webpack_require__("9a8c"),__webpack_require__("a975"),__webpack_require__("735e"),__webpack_require__("c1ac"),__webpack_require__("d139"),__webpack_require__("3a7b"),__webpack_require__("d5d6"),__webpack_require__("20bf"),__webpack_require__("82f8"),__webpack_require__("e91f"),__webpack_require__("60bd"),__webpack_require__("5f96"),__webpack_require__("3280"),__webpack_require__("3fcc"),__webpack_require__("ca91"),__webpack_require__("25a1"),__webpack_require__("cd26"),__webpack_require__("2954"),__webpack_require__("649e"),__webpack_require__("219c"),__webpack_require__("b39a"),__webpack_require__("72f7"),__webpack_require__("159b"),__webpack_require__("ddb0"),__webpack_require__("130f"),__webpack_require__("96cf");var _classCallCheck=__webpack_require__("970b"),_createClass=__webpack_require__("5bc3"),_assertThisInitialized=__webpack_require__("3c96"),_inherits=__webpack_require__("ed6d"),_createSuper=__webpack_require__("2d0d");!function(e,t){module.exports=t()}(window,(function(){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(r,i,function(t){return e[t]}.bind(null,i));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=54)}([function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var o=i(n(36)),a=n(5),s=i(n(1)),c=n(6),u=n(4),l=function(){},d=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,i){var o;return _classCallCheck(this,n),o=t.call(this),o._state=_.RELAY_STATE_IDLE,o._onStatus=function(e){s.default.debug("[".concat(o.clientId,"] ChannelMediaStatus: ").concat(JSON.stringify(e))),e&&e.command&&("onAudioPacketReceived"===e.command&&o.emit("event",p.PACKET_RECEIVED_AUDIO_FROM_SRC),"onVideoPacketReceived"===e.command&&o.emit("event",p.PACKET_RECEIVED_VIDEO_FROM_SRC),"onSrcTokenPrivilegeDidExpire"===e.command&&(o._state=_.RELAY_STATE_FAILURE,o.emit("state",_.RELAY_STATE_FAILURE,v.SRC_TOKEN_EXPIRED)),"onDestTokenPrivilegeDidExpire"===e.command&&(o._state=_.RELAY_STATE_FAILURE,o.emit("state",_.RELAY_STATE_FAILURE,v.DEST_TOKEN_EXPIRED,e.channelName?{came:e.channelName}:null)))},o._onClose=function(){return r(_assertThisInitialized(o),void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(s.default.debug("[".concat(this.clientId,"] ChannelMediaSocket onClose")),this.emit("event",p.NETWORK_DISCONNECTED),this.state=_.RELAY_STATE_IDLE,!this._prevChannelMediaConfig){e.next=11;break}return e.prev=1,e.next=4,this.startChannelMediaRelay(this._prevChannelMediaConfig);case 4:e.next=11;break;case 6:if(e.prev=6,e.t0=e["catch"](1),!(e.t0 instanceof b)||e.t0.message!==f.WS_ABORT&&e.t0.message!==f.AP_REQUEST_ABORT){e.next=10;break}return e.abrupt("return");case 10:this.emit("state",_.RELAY_STATE_FAILURE,v.SERVER_CONNECTION_LOST);case 11:case"end":return e.stop()}}),e,this,[[1,6]])})))},o.token=e.appId,o.appId=e.appId,o.cname=e.cname,o.uid=e.uid,o.sid=e.sid,o.clientId=i,o}return _createClass(n,[{key:"startChannelMediaRelay",value:function(e){return r(this,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(this.state===_.RELAY_STATE_IDLE){t.next=2;break}throw new b(f.BAD_STATE);case 2:return this.state=_.RELAY_STATE_CONNECTING,t.next=5,this._connect();case 5:return s.default.debug("[".concat(this.clientId,"] startChannelMediaRelay: connect success")),t.next=8,this._sendStartRelayMessage(e);case 8:this._prevChannelMediaConfig=e;case 9:case"end":return t.stop()}}),t,this)})))}},{key:"updateChannelMediaRelay",value:function(e){return r(this,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(this.state===_.RELAY_STATE_RUNNING){t.next=2;break}throw new b(f.BAD_STATE);case 2:return t.next=4,this._sendUpdateMessage(e);case 4:this._prevChannelMediaConfig=e;case 5:case"end":return t.stop()}}),t,this)})))}},{key:"stopChannelMediaRelay",value:function(){return r(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this._sendStopRelayMessage();case 2:s.default.debug("[".concat(this.clientId,"] stopChannelMediaRelay: send stop message success")),this.state=_.RELAY_STATE_IDLE,this.dispose();case 5:case"end":return e.stop()}}),e,this)})))}},{key:"dispose",value:function(){s.default.debug("[".concat(this.clientId,"] disposeChannelMediaRelay")),this.state=_.RELAY_STATE_IDLE,this.emit("dispose"),this._signal&&this._signal.dispose(),this._prevChannelMediaConfig=null,this.removeEvent()}},{key:"_requestOneAP",value:function(e){var t=this;return new Promise((function(n,r){var i={command:"convergeAllocateEdge",sid:t.sid,appId:t.appId,token:"",ts:+new Date,version:a.VERSION,cname:t.cname,uid:t.uid+"",seq:1,requestId:1},o={service_name:"tele_channel",json_body:JSON.stringify(i)},s="https://"+e;wx.request({url:s,data:o,header:{"content-type":"application/json","X-Packet-Service-Type":0,"X-Packet-URI":61},method:"POST",success:function(e){var t=null,i=null;try{t=e.data}catch(e){r(new b(f.AP_JSON_PARSE_ERROR,e))}0!==t.code&&r(new b(f.AP_REQUEST_ERROR,t));try{i=JSON.parse(t.json_body)}catch(e){r(new b(f.AP_JSON_PARSE_ERROR,e))}200!==i.code&&r(new b(f.AP_REQUEST_ERROR,i)),i.servers?n(i.servers):r(new b(f.AP_JSON_PARSE_ERROR,i))},fail:function(e){return r(e)}})}))}},{key:"_requestAP",value:function(){var e=this,t=["uap-ap-web-1.agora.io","uap-ap-web-2.agoraio.cn","uap-ap-web-3.agora.io","uap-ap-web-4.agoraio.cn"];return new Promise((function(n,r){setTimeout((function(){r(new b(f.AP_REQUEST_TIMEOUT))}),3e3),e.on("dispose",(function(){r(new b(f.AP_REQUEST_ABORT))})),t.forEach((function(t){t+="/api/v1",e._requestOneAP(t).then((function(r){s.default.debug("[".concat(e.clientId,"] startChannelMediaRelay request AP ").concat(t," success: ").concat(JSON.stringify(r)));var i=r[0],o=(t=i.address).split("."),a=o.length,c="wss://miniapp.agoraio.cn/".concat(o[a-4],"-").concat(o[a-3],"-").concat(o[a-2],"-").concat(o[a-1],"-").concat(i.ws,"/");n(c)})).catch((function(n){s.default.debug("[".concat(e.clientId,"] startChannelMediaRelay request AP ").concat(t," failed: ").concat(JSON.stringify(n)))}))}))}))}},{key:"_connectWebsocket",value:function(e){return this._signal=new g(this.appId,this.cname,this.uid,this.sid),this._signal.connect(e)}},{key:"_connect",value:function(){return r(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this._requestAP();case 2:return t=e.sent,e.next=5,this._connectWebsocket(t);case 5:this._signal.on("close",this._onClose.bind(this)),this._signal.on("status",this._onStatus.bind(this)),this.emit("event",p.NETWORK_CONNECTED);case 8:case"end":return e.stop()}}),e,this)})))}},{key:"_sendStartRelayMessage",value:function(e){return r(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n,r,i,o,a,c;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return this._checkSignal(),n=this._genMessage(h.StopPacketTransfer),t.next=4,Promise.all([this._signal.request(n),this._signal.waitStatus("Normal Quit")]);case 4:return s.default.debug("[".concat(this.clientId,"] startChannelMediaRelay: StopPacketTransfer success")),r=this._genMessage(h.SetSdkProfile,e),t.next=8,this._signal.request(r);case 8:return s.default.debug("[".concat(this.clientId,"] startChannelMediaRelay: SetSdkProfile success")),i=this._genMessage(h.SetSourceChannel,e),t.next=12,Promise.all([this._signal.request(i),this._signal.waitStatus("SetSourceChannelStatus")]);case 12:return this.emit("event",p.PACKET_JOINED_SRC_CHANNEL),s.default.debug("[".concat(this.clientId,"] startChannelMediaRelay: SetSourceChannel success")),o=this._genMessage(h.SetSourceUserId,e),t.next=17,this._signal.request(o);case 17:return s.default.debug("[".concat(this.clientId,"] startChannelMediaRelay: SetSourceUserId success")),a=this._genMessage(h.SetDestChannel,e),t.next=21,Promise.all([this._signal.request(a),this._signal.waitStatus("SetDestChannelStatus")]);case 21:return this.emit("event",p.PACKET_JOINED_DEST_CHANNEL),s.default.debug("[".concat(this.clientId,"] startChannelMediaRelay: SetDestChannel success")),c=this._genMessage(h.StartPacketTransfer,e),t.next=26,this._signal.request(c);case 26:this.emit("event",p.PACKET_SENT_TO_DEST_CHANNEL),this.state=_.RELAY_STATE_RUNNING,s.default.debug("[".concat(this.clientId,"] startChannelMediaRelay: StartPacketTransfer success"));case 29:case"end":return t.stop()}}),t,this)})))}},{key:"_sendReconnectMessage",value:function(e){return r(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return this._checkSignal(),n=this._genMessage(h.Reconnect,e),t.next=4,this._signal.request(n);case 4:case"end":return t.stop()}}),t,this)})))}},{key:"_sendUpdateMessage",value:function(e){return r(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return this._checkSignal(),n=this._genMessage(h.UpdateDestChannel,e),t.next=4,this._signal.request(n);case 4:this.emit("event",p.PACKET_UPDATE_DEST_CHANNEL),s.default.debug("[".concat(this.clientId,"] sendUpdateMessage: UpdateDestChannel success"));case 6:case"end":return t.stop()}}),t,this)})))}},{key:"_sendStopRelayMessage",value:function(){return r(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return this._checkSignal(),t=this._genMessage(h.StopPacketTransfer),e.next=4,this._signal.request(t);case 4:s.default.debug("[".concat(this.clientId,"] sendStopRelayMessage: StopPacketTransfer success"));case 5:case"end":return e.stop()}}),e,this)})))}},{key:"_genMessage",value:function(e,t){var n=this,r=[],i=[],o=[],s={appId:this.appId,cname:this.cname,uid:this.uid+"",sdkVersion:a.VERSION,sid:this.sid,ts:+new Date,requestId:0,seq:0,allocate:!0,clientRequest:{}},c=null,u=null;switch(e){case h.SetSdkProfile:return s.clientRequest={command:"SetSdkProfile",type:"multi_channel"},s;case h.SetSourceChannel:return u=t.getSrcChannelMediaInfo(),s.clientRequest={command:"SetSourceChannel",uid:u.uid+"",channelName:u.channelName,token:u.token||this.appId},s;case h.SetSourceUserId:return u=t.getSrcChannelMediaInfo(),s.clientRequest={command:"SetSourceUserId",uid:this.uid+""},s;case h.SetDestChannel:return c=t.getDestChannelMediaInfos(),c.forEach((function(e){r.push(e.channelName),i.push(e.uid+""),o.push(e.token||n.appId)})),s.clientRequest={command:"SetDestChannel",channelName:r,uid:i,token:o},s;case h.StartPacketTransfer:return s.clientRequest={command:"StartPacketTransfer"},s;case h.Reconnect:return s.clientRequest={command:"Reconnect"},s;case h.StopPacketTransfer:return s.clientRequest={command:"StopPacketTransfer"},s;case h.UpdateDestChannel:return c=t.getDestChannelMediaInfos(),c.forEach((function(e){r.push(e.channelName),i.push(e.uid+""),o.push(e.token||n.appId)})),s.clientRequest={command:"UpdateDestChannel",channelName:r,uid:i,token:o},s}}},{key:"_checkSignal",value:function(){if(!this._signal||!this._signal.isConnect())throw new b(f.WS_DISCONNECTED)}},{key:"state",set:function(e){var t=this._state;this._state=e,t!==e&&this.emit("state",e)},get:function(){return this._state}}]),n}(o.default);t.default=d,t.ChannelMediaRelayConfiguration=function(){function e(){_classCallCheck(this,e),this.destChannelMediaInfos=new Map}return _createClass(e,[{key:"setSrcChannelInfo",value:function(e){c.checkValidObject(e,"srcInfo");var t=e.uid,n=e.channelName,r=e.token;if(r&&!c.isValidToken(r))throw new Error("Invalid token in SrcChannelInfo");if(!c.isValidChannelName(n))throw new Error("Invalid channelName in SrcChannelInfo");if(!u.is32Uint(t))throw new Error("Invalid uid in SrcChannelInfo");s.default.debug("[setSrcChannelInfo]: srcInfo: ",e),this.srcChannelMediaInfo=e}},{key:"setDestChannelInfo",value:function(e,t){if(!c.isValidChannelName(e))throw new Error("Invalid channelName in DestChannelInfo");c.checkValidObject(t,"destInfo");var n=t.uid,r=t.token,i=t.channelName;if(r&&!c.isValidToken(r))throw new Error("Invalid token in DestChannelInfo");if(!c.isValidChannelName(i))throw new Error("Invalid channelName in DestChannelInfo");if(!u.is32Uint(n))throw new Error("Invalid uid in DestChannelInfo");s.default.debug("[setDestChannelInfo]: destInfo: ",t,"channelName: ",e),this.destChannelMediaInfos.set(e,t)}},{key:"removeDestChannelInfo",value:function(e){if(!c.isValidChannelName(e))throw new Error("Invalid channelName when invoke removeDestChannelInfo");s.default.debug("[removeDestChannelInfo]: channelName: ",e),this.destChannelMediaInfos.delete(e)}},{key:"getSrcChannelMediaInfo",value:function(){return this.srcChannelMediaInfo}},{key:"getDestChannelMediaInfos",value:function(){return this.destChannelMediaInfos}}]),e}();var f,h,p,_,v,g=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,r,i,o){var a;return _classCallCheck(this,n),a=t.call(this),a._onOpen=function(){s.default.debug("[ChannelMediaRelay] onOpen"),a.emit("open")},a._onClose=function(e){s.default.debug("[ChannelMediaRelay] onClose"),a.emit("close"),a.dispose()},a._onMessage=function(e){s.default.blind("ChannelMediaRelay receive message",e);var t=JSON.parse(e.data);if(!t||"serverResponse"!==t.command||!t.requestId)return t&&"serverStatus"===t.command&&t.serverStatus&&t.serverStatus.command?(a.emit("status",t.serverStatus),void a.emit(t.serverStatus.command,t.serverStatus)):void 0;a.emit("req_"+t.requestId,t)},a._requestId=1,a.appId=e,a.cname=r,a.uid=i,a.sid=o,a}return _createClass(n,[{key:"isConnect",value:function(){return this._ws&&1===this._ws.readyState}},{key:"sendMessage",value:function(e){if(!this._ws||1!==this._ws.readyState)throw new b(f.WS_DISCONNECTED);var t=this._requestId++;return e.requestId=t,e.seq=t,this._ws.send({data:JSON.stringify(e)}),t}},{key:"waitStatus",value:function(e){var t=this;return new Promise((function(n,r){var i=setTimeout((function(){r(new b(f.WAIT_STATUS_TIMEOUT,e))}),5e3);t.once(e,(function(t){clearTimeout(i),t.state&&0!==t.state?r(new b(f.WAIT_STATUS_ERROR,e)):n()})),t.once("dispose",(function(){clearTimeout(i),r(new b(f.WS_ABORT))}))}))}},{key:"request",value:function(e){var t=this;return new Promise((function(n,r){var i=t.sendMessage(e),o=setTimeout((function(){t.removeAllListeners("req_"+i),r(new b(f.REQUEST_TIMEOUT))}),3e3);t.once("req_"+i,(function(e){clearTimeout(o),e&&200===e.code?n(e):r(new b(f.REQUEST_FAILED,e))})),t.once("dispose",(function(){clearTimeout(o),r(new b(f.WS_ABORT))}))}))}},{key:"connect",value:function(e){var t=this;return new Promise((function(n,r){t._ws=wx.connectSocket({url:e}),t._ws.onOpen((function(r,i){s.default.debug("[ChannelMediaRelay] ws.onOpen"),t._onOpen(),t._prvUrl=e,t._ws.onMessage(t._onMessage),t._ws.onClose(t._onClose),t._startHeartBeatCheck(),n()})),t._ws.onClose((function(e){s.default.debug("[ChannelMediaRelay] ws.onClose",e),t.dispose(),r(new b(f.CONNECT_FAILED,"websocket error code: "+e.code))})),setTimeout((function(){t._ws&&1!==t._ws.readyState&&(t._ws.onMessage(l),t._ws.onClose(l),t._ws.close(),t._ws=null,r(new b(f.CONNECT_TIMEOUT)))}),5e3),t.once("dispose",(function(){r(new b(f.WS_ABORT))}))}))}},{key:"dispose",value:function(){s.default.debug("[ChannelMediaRelay] dispose"),this._clearHeartBeatCheck(),this.emit("dispose"),this.removeEvent(),this._ws&&(this._ws.onOpen(l),this._ws.onClose(l),this._ws.onMessage(l),this._ws.close(l)),this._ws=null}},{key:"_sendPing",value:function(e){if(!this._ws||1!==this._ws.readyState)throw new b(f.WS_DISCONNECTED);var t=this._requestId++;return e.requestId=t,this._ws.send({data:JSON.stringify(e)}),t}},{key:"_startHeartBeatCheck",value:function(){var e=this;this._heartBeatTimer=setInterval((function(){e._sendPing({command:"ping",appId:e.appId,cname:e.cname,uid:e.uid+"",sid:e.sid,ts:+new Date,requestId:0})}),3e3)}},{key:"_clearHeartBeatCheck",value:function(){clearInterval(this._heartBeatTimer)}}]),n}(o.default),b=function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",n=arguments.length>1?arguments[1]:void 0,r=arguments.length>2?arguments[2]:void 0;_classCallCheck(this,e),this.code=r,this.data=n,this.message=t};t.ChannelMediaError=b,function(e){e.CONNECT_FAILED="connect failed",e.CONNECT_TIMEOUT="connect timeout",e.WS_DISCONNECTED="websocket disconnected",e.REQUEST_TIMEOUT="request timeout",e.REQUEST_FAILED="request failed",e.WAIT_STATUS_TIMEOUT="wait status timeout",e.WAIT_STATUS_ERROR="wait status error",e.BAD_STATE="bad state",e.WS_ABORT="ws abort",e.AP_REQUEST_TIMEOUT="AP request timeout",e.AP_JSON_PARSE_ERROR="AP json parse error",e.AP_REQUEST_ERROR="AP request error",e.AP_REQUEST_ABORT="AP request abort"}(f=t.CHANNEL_MEDIA_ERROR||(t.CHANNEL_MEDIA_ERROR={})),function(e){e[e.SetSdkProfile=0]="SetSdkProfile",e[e.SetSourceChannel=1]="SetSourceChannel",e[e.SetSourceUserId=2]="SetSourceUserId",e[e.SetDestChannel=3]="SetDestChannel",e[e.StartPacketTransfer=4]="StartPacketTransfer",e[e.StopPacketTransfer=5]="StopPacketTransfer",e[e.UpdateDestChannel=6]="UpdateDestChannel",e[e.Reconnect=7]="Reconnect",e[e.SetVideoProfile=8]="SetVideoProfile"}(h||(h={})),function(e){e[e.NETWORK_DISCONNECTED=0]="NETWORK_DISCONNECTED",e[e.NETWORK_CONNECTED=1]="NETWORK_CONNECTED",e[e.PACKET_JOINED_SRC_CHANNEL=2]="PACKET_JOINED_SRC_CHANNEL",e[e.PACKET_JOINED_DEST_CHANNEL=3]="PACKET_JOINED_DEST_CHANNEL",e[e.PACKET_SENT_TO_DEST_CHANNEL=4]="PACKET_SENT_TO_DEST_CHANNEL",e[e.PACKET_RECEIVED_VIDEO_FROM_SRC=5]="PACKET_RECEIVED_VIDEO_FROM_SRC",e[e.PACKET_RECEIVED_AUDIO_FROM_SRC=6]="PACKET_RECEIVED_AUDIO_FROM_SRC",e[e.PACKET_UPDATE_DEST_CHANNEL=7]="PACKET_UPDATE_DEST_CHANNEL",e[e.PACKET_UPDATE_DEST_CHANNEL_REFUSED=8]="PACKET_UPDATE_DEST_CHANNEL_REFUSED",e[e.PACKET_UPDATE_DEST_CHANNEL_NOT_CHANGE=9]="PACKET_UPDATE_DEST_CHANNEL_NOT_CHANGE"}(p=t.CHANNEL_MEDIA_RELAY_EVENT||(t.CHANNEL_MEDIA_RELAY_EVENT={})),function(e){e[e.RELAY_STATE_IDLE=0]="RELAY_STATE_IDLE",e[e.RELAY_STATE_CONNECTING=1]="RELAY_STATE_CONNECTING",e[e.RELAY_STATE_RUNNING=2]="RELAY_STATE_RUNNING",e[e.RELAY_STATE_FAILURE=3]="RELAY_STATE_FAILURE"}(_=t.CHANNEL_MEDIA_RELAY_STATE||(t.CHANNEL_MEDIA_RELAY_STATE={})),function(e){e[e.RELAY_OK=0]="RELAY_OK",e[e.SERVER_ERROR_RESPONSE=1]="SERVER_ERROR_RESPONSE",e[e.SERVER_NO_RESPONSE=2]="SERVER_NO_RESPONSE",e[e.NO_RESOURCE_AVAILABLE=3]="NO_RESOURCE_AVAILABLE",e[e.FAILED_JOIN_SRC=4]="FAILED_JOIN_SRC",e[e.FAILED_JOIN_DEST=5]="FAILED_JOIN_DEST",e[e.FAILED_PACKET_RECEIVED_FROM_SRC=6]="FAILED_PACKET_RECEIVED_FROM_SRC",e[e.FAILED_PACKET_SENT_TO_DEST=7]="FAILED_PACKET_SENT_TO_DEST",e[e.SERVER_CONNECTION_LOST=8]="SERVER_CONNECTION_LOST",e[e.INTERNAL_ERROR=9]="INTERNAL_ERROR",e[e.SRC_TOKEN_EXPIRED=10]="SRC_TOKEN_EXPIRED",e[e.DEST_TOKEN_EXPIRED=11]="DEST_TOKEN_EXPIRED",e[e.RELAY_ALREADY_START=12]="RELAY_ALREADY_START",e[e.RELAY_NOT_START=13]="RELAY_NOT_START",e[e.OPERATION_ABORT=14]="OPERATION_ABORT"}(v=t.CHANNEL_MEDIA_RELAY_ERROR||(t.CHANNEL_MEDIA_RELAY_ERROR={}))},function(e,t,n){"use strict";n.r(t),n.d(t,"Log",(function(){return u}));var r=n(10),i=n.n(r),o=n(2),a=n.n(o),s=n(3),c=n.n(s),u=function(){function e(){a()(this,e),this.level=3,this.onLog=null}return c()(e,[{key:"setLogLevel",value:function(e){if("number"!=typeof e||!(e<=4&&e>=-1))throw Error("Invaild level");this.level=e}},{key:"log",value:function(){var e,t=Array.prototype.slice.call(arguments);this.onLog&&this.onLog(JSON.stringify(t)),(e=console).log.apply(e,i()(t))}},{key:"err",value:function(){var e,t=Array.prototype.slice.call(arguments);this.onLog&&this.onLog(JSON.stringify(t)),(e=console).error.apply(e,i()(t))}},{key:"blind",value:function(){var e=Array.prototype.slice.call(arguments);this.level<=-1&&this.log.apply(this,["".concat(new Date," [BLIND]: ")].concat(i()(e)))}},{key:"debug",value:function(){var e=Array.prototype.slice.call(arguments);this.level<=0&&this.log.apply(this,["".concat(new Date," [DEBUG]: ")].concat(i()(e)))}},{key:"info",value:function(e){this.level<=1&&this.log("".concat(new Date," [INFO]: ").concat(e))}},{key:"warn",value:function(e){this.level<=2&&this.log("".concat(new Date," [WARN]: ").concat(e))}},{key:"error",value:function(e){this.level<=3&&this.err("".concat(new Date," [ERROR]: ").concat(e))}}]),e}(),l=new u;t.default=l},function(e,t){e.exports=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}},function(e,t){function n(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}e.exports=function(e,t,r){return t&&n(e.prototype,t),r&&n(e,r),e}},function(e,t,n){"use strict";n.r(t),n.d(t,"generateSessionId",(function(){return a})),n.d(t,"shouldUseHttps",(function(){return s})),n.d(t,"random",(function(){return o})),n.d(t,"isWeiXin",(function(){return c})),n.d(t,"is32Uint",(function(){return u}));var r=n(20),i=n.n(r),o=function(e){isNaN(e)&&(e=1e3);var t=+new Date,n=(t=(9301*t+49297)%233280)/233280;return Math.ceil(n*e)},a=function(){return i()().replace(/-/g,"").toUpperCase()},s=function(){return"https:"==document.location.protocol},c=function(){try{return wx,!0}catch(e){return!1}},u=function(e){return!!(0<=e&&e<=4294967295)}},function(e,t,n){"use strict";n.r(t),n.d(t,"VERSION",(function(){return r})),n.d(t,"SDK_VERSION",(function(){return i})),n.d(t,"DOMAIN_NAME",(function(){return o}));var r="1.1.0",i="2.5.3",o="mini-app.broadcastapp.agoraio.cn"},function(e,t,n){"use strict";n.r(t),n.d(t,"checkValidObject",(function(){return a})),n.d(t,"checkValidString",(function(){return s})),n.d(t,"checkValidNumber",(function(){return c})),n.d(t,"checkValidFloatNumber",(function(){return u})),n.d(t,"checkValidBoolean",(function(){return l})),n.d(t,"checkValidEnum",(function(){return o})),n.d(t,"isValidString",(function(){return d})),n.d(t,"isValidNumber",(function(){return f})),n.d(t,"isValidBoolean",(function(){return p})),n.d(t,"isASCII",(function(){return g})),n.d(t,"isInteger",(function(){return b})),n.d(t,"isNumber",(function(){return m})),n.d(t,"isString",(function(){return y})),n.d(t,"isArray",(function(){return E})),n.d(t,"isEmpty",(function(){return w})),n.d(t,"isValidToken",(function(){return _})),n.d(t,"isValidChannelName",(function(){return v}));var r=n(22),i=n.n(r),o=function(e,t,n){for(var r=0;r<n.length;r++)if(e===n[r])return!0;throw new Error("".concat(t," can only be set as ").concat(JSON.stringify(n)))},a=function(e,t){if(!e)throw new Error("Invalid param: ".concat(t||"param"," cannot be empty"));if("object"!==i()(e))throw new Error("".concat(t||"This paramter"," is of the object type"));return!0},s=function(e,t,n,r,i){if(w(n)&&(n=1),r=r||255,w(i)&&(i=!0),w(e))throw new Error("".concat(t||"param"," cannot be empty"));if(!d(e,n,r,i))throw new Error("Invalid ".concat(t||"string param",": Length of the string: [").concat(n,",").concat(r,"].").concat(i?" ASCII characters only.":""))},c=function(e,t,n,r){if(w(n)&&(n=1),r=r||1e4,w(e))throw new Error("".concat(t||"param"," cannot be empty"));if(!f(e,n,r))throw new Error("Invalid ".concat(t||"number param",": The value range is [").concat(n,",").concat(r,"]. integer only"))},u=function(e,t,n,r){if(null==e)throw new Error("".concat(t||"param"," cannot be null"));if(w(n)&&(n=0),r=r||1e4,w(e))throw new Error("".concat(t||"param"," cannot be empty"));if(!h(e,n,r))throw new Error("Invalid ".concat(t||"number param",": The value range is [").concat(n,",").concat(r,"]."))},l=function(e,t){if(w(e))throw new Error("".concat(t||"param"," cannot be empty"));if(!p(e))throw new Error("Invalid ".concat(t||"boolean param",": The value is of the boolean type."))},d=function(e,t,n,r){return t||(t=0),n||(n=Number.MAX_SAFE_INTEGER),w(r)&&(r=!0),y(e)&&(!r||g(e))&&e.length>=t&&e.length<=n},f=function(e,t,n){return b(e)&&e>=t&&e<=n},h=function(e,t,n){return m(e)&&e>=t&&e<=n},p=function(e){return"boolean"==typeof e},_=function(e){return d(e,1,2047)},v=function(e){return y(e)&&/^[a-zA-Z0-9 \!\#\$\%\&\(\)\+\-\:\;\<\=\.\>\?\@\[\]\^\_\{\}\|\~\,]{1,64}$/.test(e)},g=function(e){if("string"==typeof e){for(var t=0;t<e.length;t++){var n=e.charCodeAt(t);if(n<0||n>255)return!1}return!0}},b=function(e){return"number"==typeof e&&e%1==0},m=function(e){return"number"==typeof e},y=function(e){return"string"==typeof e},E=function(e){return e instanceof Array},w=function(e){return null==e}},function(e,t,n){"use strict";(function(e){var r=t;function i(e,t,n){for(var r=Object.keys(t),i=0;i<r.length;++i)void 0!==e[r[i]]&&n||(e[r[i]]=t[r[i]]);return e}function o(e){function t(e,n){if(!(this instanceof t))return new t(e,n);Object.defineProperty(this,"message",{get:function(){return e}}),Error.captureStackTrace?Error.captureStackTrace(this,t):Object.defineProperty(this,"stack",{value:(new Error).stack||""}),n&&i(this,n)}return(t.prototype=Object.create(Error.prototype)).constructor=t,Object.defineProperty(t.prototype,"name",{get:function(){return e}}),t.prototype.toString=function(){return this.name+": "+this.message},t}r.asPromise=n(41),r.base64=n(42),r.EventEmitter=n(43),r.float=n(44),r.inquire=n(45),r.utf8=n(46),r.pool=n(47),r.LongBits=n(48),r.isNode=Boolean(void 0!==e&&e&&e.process&&e.process.versions&&e.process.versions.node),r.global=r.isNode&&e||"undefined"!=typeof window&&window||"undefined"!=typeof self&&self||this,r.emptyArray=Object.freeze?Object.freeze([]):[],r.emptyObject=Object.freeze?Object.freeze({}):{},r.isInteger=Number.isInteger||function(e){return"number"==typeof e&&isFinite(e)&&Math.floor(e)===e},r.isString=function(e){return"string"==typeof e||e instanceof String},r.isObject=function(e){return e&&"object"==typeof e},r.isset=r.isSet=function(e,t){var n=e[t];return!(null==n||!e.hasOwnProperty(t))&&("object"!=typeof n||(Array.isArray(n)?n.length:Object.keys(n).length)>0)},r.Buffer=function(){try{var e=r.inquire("buffer").Buffer;return e.prototype.utf8Write?e:null}catch(e){return null}}(),r._Buffer_from=null,r._Buffer_allocUnsafe=null,r.newBuffer=function(e){return"number"==typeof e?r.Buffer?r._Buffer_allocUnsafe(e):new r.Array(e):r.Buffer?r._Buffer_from(e):"undefined"==typeof Uint8Array?e:new Uint8Array(e)},r.Array="undefined"!=typeof Uint8Array?Uint8Array:Array,r.Long=r.global.dcodeIO&&r.global.dcodeIO.Long||r.global.Long||r.inquire("long"),r.key2Re=/^true|false|0|1$/,r.key32Re=/^-?(?:0|[1-9][0-9]*)$/,r.key64Re=/^(?:[\\x00-\\xff]{8}|-?(?:0|[1-9][0-9]*))$/,r.longToHash=function(e){return e?r.LongBits.from(e).toHash():r.LongBits.zeroHash},r.longFromHash=function(e,t){var n=r.LongBits.fromHash(e);return r.Long?r.Long.fromBits(n.lo,n.hi,t):n.toNumber(Boolean(t))},r.merge=i,r.lcFirst=function(e){return e.charAt(0).toLowerCase()+e.substring(1)},r.newError=o,r.ProtocolError=o("ProtocolError"),r.oneOfGetter=function(e){for(var t={},n=0;n<e.length;++n)t[e[n]]=1;return function(){for(var e=Object.keys(this),n=e.length-1;n>-1;--n)if(1===t[e[n]]&&void 0!==this[e[n]]&&null!==this[e[n]])return e[n]}},r.oneOfSetter=function(e){return function(t){for(var n=0;n<e.length;++n)e[n]!==t&&delete this[e[n]]}},r.toJSONOptions={longs:String,enums:String,bytes:String,json:!0},r._configure=function(){var e=r.Buffer;e?(r._Buffer_from=e.from!==Uint8Array.from&&e.from||function(t,n){return new e(t,n)},r._Buffer_allocUnsafe=e.allocUnsafe||function(t){return new e(t)}):r._Buffer_from=r._Buffer_allocUnsafe=null}}).call(this,n(13))},function(e,t,n){e.exports=n(26)},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var Thrift={Version:"0.11.0",Type:{STOP:0,VOID:1,BOOL:2,BYTE:3,I08:3,DOUBLE:4,I16:6,I32:8,I64:10,STRING:11,UTF7:11,STRUCT:12,MAP:13,SET:14,LIST:15,UTF8:16,UTF16:17},MessageType:{CALL:1,REPLY:2,EXCEPTION:3,ONEWAY:4},objectLength:function(e){var t=0;for(var n in e)e.hasOwnProperty(n)&&t++;return t},inherits:function(e,t,n){function r(){}r.prototype=t.prototype,e.prototype=new r,e.prototype.name=n||""}},_copyList2,_copyMap2;Thrift.TException=function(e){this.message=e},Thrift.inherits(Thrift.TException,Error,"TException"),Thrift.TException.prototype.getMessage=function(){return this.message},Thrift.TApplicationExceptionType={UNKNOWN:0,UNKNOWN_METHOD:1,INVALID_MESSAGE_TYPE:2,WRONG_METHOD_NAME:3,BAD_SEQUENCE_ID:4,MISSING_RESULT:5,INTERNAL_ERROR:6,PROTOCOL_ERROR:7,INVALID_TRANSFORM:8,INVALID_PROTOCOL:9,UNSUPPORTED_CLIENT_TYPE:10},Thrift.TApplicationException=function(e,t){this.message=e,this.code="number"==typeof t?t:0},Thrift.inherits(Thrift.TApplicationException,Thrift.TException,"TApplicationException"),Thrift.TApplicationException.prototype.read=function(e){for(;;){var t=e.readFieldBegin();if(t.ftype==Thrift.Type.STOP)break;switch(t.fid){case 1:t.ftype==Thrift.Type.STRING?(t=e.readString(),this.message=t.value):t=e.skip(t.ftype);break;case 2:t.ftype==Thrift.Type.I32?(t=e.readI32(),this.code=t.value):t=e.skip(t.ftype);break;default:t=e.skip(t.ftype)}e.readFieldEnd()}e.readStructEnd()},Thrift.TApplicationException.prototype.write=function(e){e.writeStructBegin("TApplicationException"),this.message&&(e.writeFieldBegin("message",Thrift.Type.STRING,1),e.writeString(this.getMessage()),e.writeFieldEnd()),this.code&&(e.writeFieldBegin("type",Thrift.Type.I32,2),e.writeI32(this.code),e.writeFieldEnd()),e.writeFieldStop(),e.writeStructEnd()},Thrift.TApplicationException.prototype.getCode=function(){return this.code},Thrift.TProtocolExceptionType={UNKNOWN:0,INVALID_DATA:1,NEGATIVE_SIZE:2,SIZE_LIMIT:3,BAD_VERSION:4,NOT_IMPLEMENTED:5,DEPTH_LIMIT:6},Thrift.TProtocolException=function(e,t){Error.call(this),Error.captureStackTrace(this,this.constructor),this.name=this.constructor.name,this.type=e,this.message=t},Thrift.inherits(Thrift.TProtocolException,Thrift.TException,"TProtocolException"),Thrift.Transport=Thrift.TXHRTransport=function(e,t){this.url=e,this.wpos=0,this.rpos=0,this.useCORS=t&&t.useCORS,this.customHeaders=t&&t.customHeaders?t.customHeaders:{},this.send_buf="",this.recv_buf=""},Thrift.TXHRTransport.prototype={getXmlHttpRequestObject:function(){try{return new XMLHttpRequest}catch(e){}try{return new ActiveXObject("Msxml2.XMLHTTP")}catch(e){}try{return new ActiveXObject("Microsoft.XMLHTTP")}catch(e){}throw"Your browser doesn't support XHR."},flush:function(e,t){var n=this;if(e&&!t||void 0===this.url||""===this.url)return this.send_buf;var r,i={header:{},method:"POST"};i.header.MediaType="application/vnd.apache.thrift.json; charset=utf-8",t&&(i.success=(r=t,function(e){if(n.responseText=JSON.stringify(e.data),n.setRecvBuffer(n.responseText),e&&200!==e.statusCode)return r(e.statusCode);r()}),i.fail=function(){var e=t;return function(t){e(t)}}()),Object.keys(n.customHeaders).forEach((function(e){i.header[e]=n.customHeaders[e]})),i.header.Accept="application/vnd.apache.thrift.json; charset=utf-8",i.header["Content-Type"]="application/vnd.apache.thrift.json; charset=utf-8",i.data=this.send_buf,i.url=this.url,wx.request(i)},jqRequest:function(e,t,n,r){if("undefined"==typeof jQuery||void 0===jQuery.Deferred)throw"Thrift.js requires jQuery 1.5+ to use asynchronous requests";var i=this;return jQuery.ajax({url:this.url,data:t,type:"POST",cache:!1,contentType:"application/vnd.apache.thrift.json; charset=utf-8",dataType:"text thrift",converters:{"text thrift":function(t){return i.setRecvBuffer(t),r.call(e)}},context:e,success:jQuery.makeArray(n).pop()})},setRecvBuffer:function(e){this.recv_buf=e,this.recv_buf_sz=this.recv_buf.length,this.wpos=this.recv_buf.length,this.rpos=0},isOpen:function(){return!0},open:function(){},close:function(){},read:function(e){var t=this.wpos-this.rpos;if(0===t)return"";var n=e;t<e&&(n=t);var r=this.read_buf.substr(this.rpos,n);return this.rpos+=n,r},readAll:function(){return this.recv_buf},write:function(e){this.send_buf=e},getSendBuffer:function(){return this.send_buf}},Thrift.TWebSocketTransport=function(e){this.__reset(e)},Thrift.TWebSocketTransport.prototype={__reset:function(e){this.url=e,this.socket=null,this.callbacks=[],this.send_pending=[],this.send_buf="",this.recv_buf="",this.rb_wpos=0,this.rb_rpos=0},flush:function(e,t){var n,r=this;this.isOpen()?(this.socket.send(this.send_buf),this.callbacks.push((n=t,function(e){r.setRecvBuffer(e),n()})),t&&this.callbacks.push(function(){var e=t;return function(t){r.setRecvBuffer(t),e()}}())):this.send_pending.push({buf:this.send_buf,cb:t})},__onOpen:function(){var e=this;this.send_pending.length>0&&(this.send_pending.forEach((function(t){var n;this.socket.send(t.buf),this.callbacks.push((n=t.cb,function(t){e.setRecvBuffer(t),n()}))})),this.send_pending=[])},__onClose:function(e){this.__reset(this.url)},__onMessage:function(e){this.callbacks.length&&this.callbacks.shift()(e.data)},__onError:function(e){console.log("Thrift WebSocket Error: "+e.toString()),this.socket.close()},setRecvBuffer:function(e){this.recv_buf=e,this.recv_buf_sz=this.recv_buf.length,this.wpos=this.recv_buf.length,this.rpos=0},isOpen:function(){return this.socket&&this.socket.readyState==this.socket.OPEN},open:function(){this.socket&&this.socket.readyState!=this.socket.CLOSED||(this.socket=new WebSocket(this.url),this.socket.onopen=this.__onOpen.bind(this),this.socket.onmessage=this.__onMessage.bind(this),this.socket.onerror=this.__onError.bind(this),this.socket.onclose=this.__onClose.bind(this))},close:function(){this.socket.close()},read:function(e){var t=this.wpos-this.rpos;if(0===t)return"";var n=e;t<e&&(n=t);var r=this.read_buf.substr(this.rpos,n);return this.rpos+=n,r},readAll:function(){return this.recv_buf},write:function(e){this.send_buf=e},getSendBuffer:function(){return this.send_buf}},Thrift.TJSONProtocol=Thrift.Protocol=function(e){this.tstack=[],this.tpos=[],this.transport=e},Thrift.Protocol.Type={},Thrift.Protocol.Type[Thrift.Type.BOOL]='"tf"',Thrift.Protocol.Type[Thrift.Type.BYTE]='"i8"',Thrift.Protocol.Type[Thrift.Type.I16]='"i16"',Thrift.Protocol.Type[Thrift.Type.I32]='"i32"',Thrift.Protocol.Type[Thrift.Type.I64]='"i64"',Thrift.Protocol.Type[Thrift.Type.DOUBLE]='"dbl"',Thrift.Protocol.Type[Thrift.Type.STRUCT]='"rec"',Thrift.Protocol.Type[Thrift.Type.STRING]='"str"',Thrift.Protocol.Type[Thrift.Type.MAP]='"map"',Thrift.Protocol.Type[Thrift.Type.LIST]='"lst"',Thrift.Protocol.Type[Thrift.Type.SET]='"set"',Thrift.Protocol.RType={},Thrift.Protocol.RType.tf=Thrift.Type.BOOL,Thrift.Protocol.RType.i8=Thrift.Type.BYTE,Thrift.Protocol.RType.i16=Thrift.Type.I16,Thrift.Protocol.RType.i32=Thrift.Type.I32,Thrift.Protocol.RType.i64=Thrift.Type.I64,Thrift.Protocol.RType.dbl=Thrift.Type.DOUBLE,Thrift.Protocol.RType.rec=Thrift.Type.STRUCT,Thrift.Protocol.RType.str=Thrift.Type.STRING,Thrift.Protocol.RType.map=Thrift.Type.MAP,Thrift.Protocol.RType.lst=Thrift.Type.LIST,Thrift.Protocol.RType.set=Thrift.Type.SET,Thrift.Protocol.Version=1,Thrift.Protocol.prototype={getTransport:function(){return this.transport},writeMessageBegin:function(e,t,n){this.tstack=[],this.tpos=[],this.tstack.push([Thrift.Protocol.Version,'"'+e+'"',t,n])},writeMessageEnd:function(){var e=this.tstack.pop();this.wobj=this.tstack.pop(),this.wobj.push(e),this.wbuf="["+this.wobj.join(",")+"]",this.transport.write(this.wbuf)},writeStructBegin:function(e){this.tpos.push(this.tstack.length),this.tstack.push({})},writeStructEnd:function(){var e=this.tpos.pop(),t=this.tstack[e],n="{",r=!0;for(var i in t)r?r=!1:n+=",",n+=i+":"+t[i];n+="}",this.tstack[e]=n},writeFieldBegin:function(e,t,n){this.tpos.push(this.tstack.length),this.tstack.push({fieldId:'"'+n+'"',fieldType:Thrift.Protocol.Type[t]})},writeFieldEnd:function(){var e=this.tstack.pop(),t=this.tstack.pop();this.tstack[this.tstack.length-1][t.fieldId]="{"+t.fieldType+":"+e+"}",this.tpos.pop()},writeFieldStop:function(){},writeMapBegin:function(e,t,n){this.tpos.push(this.tstack.length),this.tstack.push([Thrift.Protocol.Type[e],Thrift.Protocol.Type[t],0])},writeMapEnd:function(){var e=this.tpos.pop();if(e!=this.tstack.length){(this.tstack.length-e-1)%2!=0&&this.tstack.push("");var t=(this.tstack.length-e-1)/2;this.tstack[e][this.tstack[e].length-1]=t;for(var n="}",r=!0;this.tstack.length>e+1;){var i=this.tstack.pop(),o=this.tstack.pop();r?r=!1:n=","+n,isNaN(o)||(o='"'+o+'"'),n=o+":"+i+n}n="{"+n,this.tstack[e].push(n),this.tstack[e]="["+this.tstack[e].join(",")+"]"}},writeListBegin:function(e,t){this.tpos.push(this.tstack.length),this.tstack.push([Thrift.Protocol.Type[e],t])},writeListEnd:function(){for(var e=this.tpos.pop();this.tstack.length>e+1;){var t=this.tstack[e+1];this.tstack.splice(e+1,1),this.tstack[e].push(t)}this.tstack[e]="["+this.tstack[e].join(",")+"]"},writeSetBegin:function(e,t){this.tpos.push(this.tstack.length),this.tstack.push([Thrift.Protocol.Type[e],t])},writeSetEnd:function(){for(var e=this.tpos.pop();this.tstack.length>e+1;){var t=this.tstack[e+1];this.tstack.splice(e+1,1),this.tstack[e].push(t)}this.tstack[e]="["+this.tstack[e].join(",")+"]"},writeBool:function(e){this.tstack.push(e?1:0)},writeByte:function(e){this.tstack.push(e)},writeI16:function(e){this.tstack.push(e)},writeI32:function(e){this.tstack.push(e)},writeI64:function(e){this.tstack.push(e)},writeDouble:function(e){this.tstack.push(e)},writeString:function(e){if(null===e)this.tstack.push(null);else{for(var t="",n=0;n<e.length;n++){var r=e.charAt(n);t+='"'===r?'\\"':"\\"===r?"\\\\":"\b"===r?"\\b":"\f"===r?"\\f":"\n"===r?"\\n":"\r"===r?"\\r":"\t"===r?"\\t":r}this.tstack.push('"'+t+'"')}},writeBinary:function(e){var t="";if("string"==typeof e)t=e;else{if(!(e instanceof Uint8Array))throw new TypeError("writeBinary only accepts String or Uint8Array.");for(var n=e,r=0;r<n.length;++r)t+=String.fromCharCode(n[r])}this.tstack.push('"'+btoa(t)+'"')},readMessageBegin:function readMessageBegin(){if(this.rstack=[],this.rpos=[],"undefined"!=typeof JSON&&"function"==typeof JSON.parse){var a=this.transport.readAll();this.robj=JSON.parse(a)}else"undefined"!=typeof jQuery?this.robj=jQuery.parseJSON(this.transport.readAll()):this.robj=eval(this.transport.readAll());this.robj instanceof Array==0&&(this.robj=[this.robj]);var r={},version=this.robj.shift();if(version!=Thrift.Protocol.Version)throw"Wrong thrift protocol version: "+version;return r.fname=this.robj.shift(),r.mtype=this.robj.shift(),r.rseqid=this.robj.shift(),this.rstack.push(this.robj.shift()),r},readMessageEnd:function(){},readStructBegin:function(e){var t={fname:""};return this.rstack[this.rstack.length-1]instanceof Array&&this.rstack.push(this.rstack[this.rstack.length-1].shift()),t},readStructEnd:function(){this.rstack[this.rstack.length-2]instanceof Array&&this.rstack.pop()},readFieldBegin:function(){var e={},t=-1,n=Thrift.Type.STOP;for(var r in this.rstack[this.rstack.length-1])if(null!==r){t=parseInt(r,10),this.rpos.push(this.rstack.length);var i=this.rstack[this.rstack.length-1][t];delete this.rstack[this.rstack.length-1][t],this.rstack.push(i);break}if(-1!=t)for(var o in this.rstack[this.rstack.length-1])null!==Thrift.Protocol.RType[o]&&(n=Thrift.Protocol.RType[o],this.rstack[this.rstack.length-1]=this.rstack[this.rstack.length-1][o]);return e.fname="",e.ftype=n,e.fid=t,e},readFieldEnd:function(){for(var e=this.rpos.pop();this.rstack.length>e;)this.rstack.pop()},readMapBegin:function(){var e=this.rstack.pop(),t=e.shift();t instanceof Array&&(this.rstack.push(e),t=(e=t).shift());var n={};return n.ktype=Thrift.Protocol.RType[t],n.vtype=Thrift.Protocol.RType[e.shift()],n.size=e.shift(),this.rpos.push(this.rstack.length),this.rstack.push(e.shift()),n},readMapEnd:function(){this.readFieldEnd()},readListBegin:function(){var e=this.rstack[this.rstack.length-1],t={};return t.etype=Thrift.Protocol.RType[e.shift()],t.size=e.shift(),this.rpos.push(this.rstack.length),this.rstack.push(e.shift()),t},readListEnd:function(){this.readFieldEnd()},readSetBegin:function(e,t){return this.readListBegin(e,t)},readSetEnd:function(){return this.readListEnd()},readBool:function(){var e=this.readI32();return null!==e&&"1"==e.value?e.value=!0:e.value=!1,e},readByte:function(){return this.readI32()},readI16:function(){return this.readI32()},readI32:function(e){void 0===e&&(e=this.rstack[this.rstack.length-1]);var t={};if(e instanceof Array)0===e.length?t.value=void 0:t.value=e.shift();else if(e instanceof Object){for(var n in e)if(null!==n){this.rstack.push(e[n]),delete e[n],t.value=n;break}}else t.value=e,this.rstack.pop();return t},readI64:function(){return this.readI32()},readDouble:function(){return this.readI32()},readString:function(){return this.readI32()},readBinary:function(){var e=this.readI32();return e.value=atob(e.value),e},skip:function(e){var t,n;switch(e){case Thrift.Type.STOP:return null;case Thrift.Type.BOOL:return this.readBool();case Thrift.Type.BYTE:return this.readByte();case Thrift.Type.I16:return this.readI16();case Thrift.Type.I32:return this.readI32();case Thrift.Type.I64:return this.readI64();case Thrift.Type.DOUBLE:return this.readDouble();case Thrift.Type.STRING:return this.readString();case Thrift.Type.STRUCT:for(this.readStructBegin();(t=this.readFieldBegin()).ftype!=Thrift.Type.STOP;)this.skip(t.ftype),this.readFieldEnd();return this.readStructEnd(),null;case Thrift.Type.MAP:for(t=this.readMapBegin(),n=0;n<t.size;n++)n>0&&this.rstack.length>this.rpos[this.rpos.length-1]+1&&this.rstack.pop(),this.skip(t.ktype),this.skip(t.vtype);return this.readMapEnd(),null;case Thrift.Type.SET:for(t=this.readSetBegin(),n=0;n<t.size;n++)this.skip(t.etype);return this.readSetEnd(),null;case Thrift.Type.LIST:for(t=this.readListBegin(),n=0;n<t.size;n++)this.skip(t.etype);return this.readListEnd(),null}}},Thrift.MultiplexProtocol=function(e,t,n,r){Thrift.Protocol.call(this,t,n,r),this.serviceName=e},Thrift.inherits(Thrift.MultiplexProtocol,Thrift.Protocol,"multiplexProtocol"),Thrift.MultiplexProtocol.prototype.writeMessageBegin=function(e,t,n){t===Thrift.MessageType.CALL||t===Thrift.MessageType.ONEWAY?Thrift.Protocol.prototype.writeMessageBegin.call(this,this.serviceName+":"+e,t,n):Thrift.Protocol.prototype.writeMessageBegin.call(this,e,t,n)},Thrift.Multiplexer=function(){this.seqid=0},Thrift.Multiplexer.prototype.createClient=function(e,t,n){t.Client&&(t=t.Client);var r=this;return t.prototype.new_seqid=function(){return r.seqid+=1,r.seqid},new t(new Thrift.MultiplexProtocol(e,n))},_copyList2=function(e,t){if(!e)return e;var n,r,i,o=n=void 0===t.shift?t:t[0],a=e.length,s=[];for(r=0;r<a;r++)i=e[r],null===n?s.push(i):n===_copyMap2||n===_copyList2?s.push(n(i,t.slice(1))):s.push(new o(i));return s},_copyMap2=function(e,t){if(!e)return e;var n,r,i=n=void 0===t.shift?t:t[0],o={};for(var a in e)e.hasOwnProperty(a)&&(r=e[a],o[a]=null===n?r:n===_copyMap2||n===_copyList2?n(r,t.slice(1)):new i(r));return o},Thrift.copyMap=_copyMap2,Thrift.copyList=_copyList2,__webpack_exports__.default=Thrift},function(e,t,n){var r=n(27),i=n(28),o=n(29),a=n(30);e.exports=function(e){return r(e)||i(e)||o(e)||a()}},function(e,t,n){var r,i,o,a,s;r=n(34),i=n(15).utf8,o=n(35),a=n(15).bin,(s=function(e,t){e.constructor==String?e=t&&"binary"===t.encoding?a.stringToBytes(e):i.stringToBytes(e):o(e)?e=Array.prototype.slice.call(e,0):Array.isArray(e)||e.constructor===Uint8Array||(e=e.toString());for(var n=r.bytesToWords(e),c=8*e.length,u=1732584193,l=-271733879,d=-1732584194,f=271733878,h=0;h<n.length;h++)n[h]=16711935&(n[h]<<8|n[h]>>>24)|4278255360&(n[h]<<24|n[h]>>>8);n[c>>>5]|=128<<c%32,n[14+(c+64>>>9<<4)]=c;var p=s._ff,_=s._gg,v=s._hh,g=s._ii;for(h=0;h<n.length;h+=16){var b=u,m=l,y=d,E=f;u=p(u,l,d,f,n[h+0],7,-680876936),f=p(f,u,l,d,n[h+1],12,-389564586),d=p(d,f,u,l,n[h+2],17,606105819),l=p(l,d,f,u,n[h+3],22,-1044525330),u=p(u,l,d,f,n[h+4],7,-176418897),f=p(f,u,l,d,n[h+5],12,1200080426),d=p(d,f,u,l,n[h+6],17,-1473231341),l=p(l,d,f,u,n[h+7],22,-45705983),u=p(u,l,d,f,n[h+8],7,1770035416),f=p(f,u,l,d,n[h+9],12,-1958414417),d=p(d,f,u,l,n[h+10],17,-42063),l=p(l,d,f,u,n[h+11],22,-1990404162),u=p(u,l,d,f,n[h+12],7,1804603682),f=p(f,u,l,d,n[h+13],12,-40341101),d=p(d,f,u,l,n[h+14],17,-1502002290),u=_(u,l=p(l,d,f,u,n[h+15],22,1236535329),d,f,n[h+1],5,-165796510),f=_(f,u,l,d,n[h+6],9,-1069501632),d=_(d,f,u,l,n[h+11],14,643717713),l=_(l,d,f,u,n[h+0],20,-373897302),u=_(u,l,d,f,n[h+5],5,-701558691),f=_(f,u,l,d,n[h+10],9,38016083),d=_(d,f,u,l,n[h+15],14,-660478335),l=_(l,d,f,u,n[h+4],20,-405537848),u=_(u,l,d,f,n[h+9],5,568446438),f=_(f,u,l,d,n[h+14],9,-1019803690),d=_(d,f,u,l,n[h+3],14,-187363961),l=_(l,d,f,u,n[h+8],20,1163531501),u=_(u,l,d,f,n[h+13],5,-1444681467),f=_(f,u,l,d,n[h+2],9,-51403784),d=_(d,f,u,l,n[h+7],14,1735328473),u=v(u,l=_(l,d,f,u,n[h+12],20,-1926607734),d,f,n[h+5],4,-378558),f=v(f,u,l,d,n[h+8],11,-2022574463),d=v(d,f,u,l,n[h+11],16,1839030562),l=v(l,d,f,u,n[h+14],23,-35309556),u=v(u,l,d,f,n[h+1],4,-1530992060),f=v(f,u,l,d,n[h+4],11,1272893353),d=v(d,f,u,l,n[h+7],16,-155497632),l=v(l,d,f,u,n[h+10],23,-1094730640),u=v(u,l,d,f,n[h+13],4,681279174),f=v(f,u,l,d,n[h+0],11,-358537222),d=v(d,f,u,l,n[h+3],16,-722521979),l=v(l,d,f,u,n[h+6],23,76029189),u=v(u,l,d,f,n[h+9],4,-640364487),f=v(f,u,l,d,n[h+12],11,-421815835),d=v(d,f,u,l,n[h+15],16,530742520),u=g(u,l=v(l,d,f,u,n[h+2],23,-995338651),d,f,n[h+0],6,-198630844),f=g(f,u,l,d,n[h+7],10,1126891415),d=g(d,f,u,l,n[h+14],15,-1416354905),l=g(l,d,f,u,n[h+5],21,-57434055),u=g(u,l,d,f,n[h+12],6,1700485571),f=g(f,u,l,d,n[h+3],10,-1894986606),d=g(d,f,u,l,n[h+10],15,-1051523),l=g(l,d,f,u,n[h+1],21,-2054922799),u=g(u,l,d,f,n[h+8],6,1873313359),f=g(f,u,l,d,n[h+15],10,-30611744),d=g(d,f,u,l,n[h+6],15,-1560198380),l=g(l,d,f,u,n[h+13],21,1309151649),u=g(u,l,d,f,n[h+4],6,-145523070),f=g(f,u,l,d,n[h+11],10,-1120210379),d=g(d,f,u,l,n[h+2],15,718787259),l=g(l,d,f,u,n[h+9],21,-343485551),u=u+b>>>0,l=l+m>>>0,d=d+y>>>0,f=f+E>>>0}return r.endian([u,l,d,f])})._ff=function(e,t,n,r,i,o,a){var s=e+(t&n|~t&r)+(i>>>0)+a;return(s<<o|s>>>32-o)+t},s._gg=function(e,t,n,r,i,o,a){var s=e+(t&r|n&~r)+(i>>>0)+a;return(s<<o|s>>>32-o)+t},s._hh=function(e,t,n,r,i,o,a){var s=e+(t^n^r)+(i>>>0)+a;return(s<<o|s>>>32-o)+t},s._ii=function(e,t,n,r,i,o,a){var s=e+(n^(t|~r))+(i>>>0)+a;return(s<<o|s>>>32-o)+t},s._blocksize=16,s._digestsize=16,e.exports=function(e,t){if(null==e)throw new Error("Illegal argument "+e);var n=r.wordsToBytes(s(e,t));return t&&t.asBytes?n:t&&t.asString?a.bytesToString(n):r.bytesToHex(n)}},function(e,t){function n(e,t,n,r,i,o,a){try{var s=e[o](a),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,i)}e.exports=function(e){return function(){var t=this,r=arguments;return new Promise((function(i,o){var a=e.apply(t,r);function s(e){n(a,i,o,s,c,"next",e)}function c(e){n(a,i,o,s,c,"throw",e)}s(void 0)}))}}},function(e,t){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(e){"object"==typeof window&&(n=window)}e.exports=n},function(e,t){e.exports=function(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}},function(e,t){var n={utf8:{stringToBytes:function(e){return n.bin.stringToBytes(unescape(encodeURIComponent(e)))},bytesToString:function(e){return decodeURIComponent(escape(n.bin.bytesToString(e)))}},bin:{stringToBytes:function(e){for(var t=[],n=0;n<e.length;n++)t.push(255&e.charCodeAt(n));return t},bytesToString:function(e){for(var t=[],n=0;n<e.length;n++)t.push(String.fromCharCode(e[n]));return t.join("")}}};e.exports=n},function(e,t,n){var r=n(9).default,i=n(38),o=i.MiniappSession,a=i.MiniappJoinChooseServer,s=i.MiniappConnectWebSocket,c=i.MiniappJoin,u=i.MiniappPublish,l=i.MiniappUnpublish,d=i.MiniappSubscribe,f=i.MiniappUnsubscribe,h=i.MiniappLeave,p=i.MiniappServerEvent,_=i.MiniappPusherState,v=i.MiniappPlayerState,g=function(e){this.uri=null,this.miniappSession=null,this.miniappJoinChooseServer=null,this.miniappConnectWebSocket=null,this.miniappJoin=null,this.miniappPublish=null,this.miniappUnpublish=null,this.miniappSubscribe=null,this.miniappUnsubscribe=null,this.miniappLeave=null,this.miniappServerEvent=null,this.miniappPusherState=null,this.miniappPlayerState=null,e&&(void 0!==e.uri&&null!==e.uri&&(this.uri=e.uri),void 0!==e.miniappSession&&null!==e.miniappSession&&(this.miniappSession=new o(e.miniappSession)),void 0!==e.miniappJoinChooseServer&&null!==e.miniappJoinChooseServer&&(this.miniappJoinChooseServer=new a(e.miniappJoinChooseServer)),void 0!==e.miniappConnectWebSocket&&null!==e.miniappConnectWebSocket&&(this.miniappConnectWebSocket=new s(e.miniappConnectWebSocket)),void 0!==e.miniappJoin&&null!==e.miniappJoin&&(this.miniappJoin=new c(e.miniappJoin)),void 0!==e.miniappPublish&&null!==e.miniappPublish&&(this.miniappPublish=new u(e.miniappPublish)),void 0!==e.miniappUnpublish&&null!==e.miniappUnpublish&&(this.miniappUnpublish=new l(e.miniappUnpublish)),void 0!==e.miniappSubscribe&&null!==e.miniappSubscribe&&(this.miniappSubscribe=new d(e.miniappSubscribe)),void 0!==e.miniappUnsubscribe&&null!==e.miniappUnsubscribe&&(this.miniappUnsubscribe=new f(e.miniappUnsubscribe)),void 0!==e.miniappLeave&&null!==e.miniappLeave&&(this.miniappLeave=new h(e.miniappLeave)),void 0!==e.miniappServerEvent&&null!==e.miniappServerEvent&&(this.miniappServerEvent=new p(e.miniappServerEvent)),void 0!==e.miniappPusherState&&null!==e.miniappPusherState&&(this.miniappPusherState=new _(e.miniappPusherState)),void 0!==e.miniappPlayerState&&null!==e.miniappPlayerState&&(this.miniappPlayerState=new v(e.miniappPlayerState)))};(g.prototype={}).read=function(e){for(e.readStructBegin();;){var t=e.readFieldBegin(),n=(t.fname,t.ftype),i=t.fid;if(n==r.Type.STOP)break;switch(i){case 1:n==r.Type.I32?this.uri=e.readI32().value:e.skip(n);break;case 8e3:n==r.Type.STRUCT?(this.miniappSession=new o,this.miniappSession.read(e)):e.skip(n);break;case 8001:n==r.Type.STRUCT?(this.miniappJoinChooseServer=new a,this.miniappJoinChooseServer.read(e)):e.skip(n);break;case 8002:n==r.Type.STRUCT?(this.miniappConnectWebSocket=new s,this.miniappConnectWebSocket.read(e)):e.skip(n);break;case 8003:n==r.Type.STRUCT?(this.miniappJoin=new c,this.miniappJoin.read(e)):e.skip(n);break;case 8004:n==r.Type.STRUCT?(this.miniappPublish=new u,this.miniappPublish.read(e)):e.skip(n);break;case 8005:n==r.Type.STRUCT?(this.miniappUnpublish=new l,this.miniappUnpublish.read(e)):e.skip(n);break;case 8006:n==r.Type.STRUCT?(this.miniappSubscribe=new d,this.miniappSubscribe.read(e)):e.skip(n);break;case 8007:n==r.Type.STRUCT?(this.miniappUnsubscribe=new f,this.miniappUnsubscribe.read(e)):e.skip(n);break;case 8008:n==r.Type.STRUCT?(this.miniappLeave=new h,this.miniappLeave.read(e)):e.skip(n);break;case 8009:n==r.Type.STRUCT?(this.miniappServerEvent=new p,this.miniappServerEvent.read(e)):e.skip(n);break;case 8010:n==r.Type.STRUCT?(this.miniappPusherStateEvent=new MiniappPusherStateEvent,this.miniappPusherStateEvent.read(e)):e.skip(n);break;case 8011:n==r.Type.STRUCT?(this.miniappPlayerStateEvent=new MiniappPlayerStateEvent,this.miniappPlayerStateEvent.read(e)):e.skip(n);break;default:e.skip(n)}e.readFieldEnd()}e.readStructEnd()},g.prototype.write=function(e){e.writeStructBegin("ReportItem"),null!==this.uri&&void 0!==this.uri&&(e.writeFieldBegin("uri",r.Type.I32,1),e.writeI32(this.uri),e.writeFieldEnd()),null!==this.miniappSession&&void 0!==this.miniappSession&&(e.writeFieldBegin("miniappSession",r.Type.STRUCT,8e3),this.miniappSession.write(e),e.writeFieldEnd()),null!==this.miniappJoinChooseServer&&void 0!==this.miniappJoinChooseServer&&(e.writeFieldBegin("miniappJoinChooseServer",r.Type.STRUCT,8001),this.miniappJoinChooseServer.write(e),e.writeFieldEnd()),null!==this.miniappConnectWebSocket&&void 0!==this.miniappConnectWebSocket&&(e.writeFieldBegin("miniappConnectWebSocket",r.Type.STRUCT,8002),this.miniappConnectWebSocket.write(e),e.writeFieldEnd()),null!==this.miniappJoin&&void 0!==this.miniappJoin&&(e.writeFieldBegin("miniappJoin",r.Type.STRUCT,8003),this.miniappJoin.write(e),e.writeFieldEnd()),null!==this.miniappPublish&&void 0!==this.miniappPublish&&(e.writeFieldBegin("miniappPublish",r.Type.STRUCT,8004),this.miniappPublish.write(e),e.writeFieldEnd()),null!==this.miniappUnpublish&&void 0!==this.miniappUnpublish&&(e.writeFieldBegin("miniappUnpublish",r.Type.STRUCT,8005),this.miniappUnpublish.write(e),e.writeFieldEnd()),null!==this.miniappSubscribe&&void 0!==this.miniappSubscribe&&(e.writeFieldBegin("miniappSubscribe",r.Type.STRUCT,8006),this.miniappSubscribe.write(e),e.writeFieldEnd()),null!==this.miniappUnsubscribe&&void 0!==this.miniappUnsubscribe&&(e.writeFieldBegin("miniappUnsubscribe",r.Type.STRUCT,8007),this.miniappUnsubscribe.write(e),e.writeFieldEnd()),null!==this.miniappLeave&&void 0!==this.miniappLeave&&(e.writeFieldBegin("miniappLeave",r.Type.STRUCT,8008),this.miniappLeave.write(e),e.writeFieldEnd()),null!==this.miniappServerEvent&&void 0!==this.miniappServerEvent&&(e.writeFieldBegin("miniappServerEvent",r.Type.STRUCT,8009),this.miniappServerEvent.write(e),e.writeFieldEnd()),null!==this.miniappPusherStateEvent&&void 0!==this.miniappPusherStateEvent&&(e.writeFieldBegin("miniappPusherStateEvent",r.Type.STRUCT,8010),this.miniappPusherStateEvent.write(e),e.writeFieldEnd()),null!==this.miniappPlayerStateEvent&&void 0!==this.miniappPlayerStateEvent&&(e.writeFieldBegin("miniappPlayerStateEvent",r.Type.STRUCT,8011),this.miniappPlayerStateEvent.write(e),e.writeFieldEnd()),e.writeFieldStop(),e.writeStructEnd()},e.exports=g},function(e,t,n){var r=n(9).default,i=function(e){this.sid=null,this.cname=null,this.cid=null,this.lts=null,this.ip=null,this.uid=null,this.success=null,this.elapse=null,this.peer=null,e&&(void 0!==e.sid&&null!==e.sid&&(this.sid=e.sid),void 0!==e.cname&&null!==e.cname&&(this.cname=e.cname),void 0!==e.cid&&null!==e.cid&&(this.cid=e.cid),void 0!==e.lts&&null!==e.lts&&(this.lts=e.lts),void 0!==e.ip&&null!==e.ip&&(this.ip=e.ip),void 0!==e.uid&&null!==e.uid&&(this.uid=e.uid),void 0!==e.success&&null!==e.success&&(this.success=e.success),void 0!==e.elapse&&null!==e.elapse&&(this.elapse=e.elapse),void 0!==e.peer&&null!==e.peer&&(this.peer=e.peer))};(i.prototype={}).read=function(e){for(e.readStructBegin();;){var t=e.readFieldBegin(),n=(t.fname,t.ftype),i=t.fid;if(n==r.Type.STOP)break;switch(i){case 1:n==r.Type.STRING?this.sid=e.readString().value:e.skip(n);break;case 2:n==r.Type.STRING?this.cname=e.readString().value:e.skip(n);break;case 3:n==r.Type.I64?this.cid=e.readI64().value:e.skip(n);break;case 4:n==r.Type.I64?this.lts=e.readI64().value:e.skip(n);break;case 5:n==r.Type.STRING?this.ip=e.readString().value:e.skip(n);break;case 6:n==r.Type.I64?this.uid=e.readI64().value:e.skip(n);break;case 7:n==r.Type.BOOL?this.success=e.readBool().value:e.skip(n);break;case 8:n==r.Type.I64?this.elapse=e.readI64().value:e.skip(n);break;case 9:n==r.Type.I64?this.peer=e.readI64().value:e.skip(n);break;default:e.skip(n)}e.readFieldEnd()}e.readStructEnd()},i.prototype.write=function(e){e.writeStructBegin("VosdkHeader"),null!==this.sid&&void 0!==this.sid&&(e.writeFieldBegin("sid",r.Type.STRING,1),e.writeString(this.sid),e.writeFieldEnd()),null!==this.cname&&void 0!==this.cname&&(e.writeFieldBegin("cname",r.Type.STRING,2),e.writeString(this.cname),e.writeFieldEnd()),null!==this.cid&&void 0!==this.cid&&(e.writeFieldBegin("cid",r.Type.I64,3),e.writeI64(this.cid),e.writeFieldEnd()),null!==this.lts&&void 0!==this.lts&&(e.writeFieldBegin("lts",r.Type.I64,4),e.writeI64(this.lts),e.writeFieldEnd()),null!==this.ip&&void 0!==this.ip&&(e.writeFieldBegin("ip",r.Type.STRING,5),e.writeString(this.ip),e.writeFieldEnd()),null!==this.uid&&void 0!==this.uid&&(e.writeFieldBegin("uid",r.Type.I64,6),e.writeI64(this.uid),e.writeFieldEnd()),null!==this.success&&void 0!==this.success&&(e.writeFieldBegin("success",r.Type.BOOL,7),e.writeBool(this.success),e.writeFieldEnd()),null!==this.elapse&&void 0!==this.elapse&&(e.writeFieldBegin("elapse",r.Type.I64,8),e.writeI64(this.elapse),e.writeFieldEnd()),null!==this.peer&&void 0!==this.peer&&(e.writeFieldBegin("peer",r.Type.I64,9),e.writeI64(this.peer),e.writeFieldEnd()),e.writeFieldStop(),e.writeStructEnd()};var o=function(e){this.name=null,this.lts=null,this.value=null,this.id=null,this.tagErrorCode=null,e&&(void 0!==e.name&&null!==e.name&&(this.name=e.name),void 0!==e.lts&&null!==e.lts&&(this.lts=e.lts),void 0!==e.value&&null!==e.value&&(this.value=e.value),void 0!==e.id&&null!==e.id&&(this.id=e.id),void 0!==e.tagErrorCode&&null!==e.tagErrorCode&&(this.tagErrorCode=e.tagErrorCode))};(o.prototype={}).read=function(e){for(e.readStructBegin();;){var t=e.readFieldBegin(),n=(t.fname,t.ftype),i=t.fid;if(n==r.Type.STOP)break;switch(i){case 1:n==r.Type.STRING?this.name=e.readString().value:e.skip(n);break;case 2:n==r.Type.I64?this.lts=e.readI64().value:e.skip(n);break;case 3:n==r.Type.I32?this.value=e.readI32().value:e.skip(n);break;case 4:n==r.Type.I32?this.id=e.readI32().value:e.skip(n);break;case 5:n==r.Type.I32?this.tagErrorCode=e.readI32().value:e.skip(n);break;default:e.skip(n)}e.readFieldEnd()}e.readStructEnd()},o.prototype.write=function(e){e.writeStructBegin("VosdkCounterItem"),null!==this.name&&void 0!==this.name&&(e.writeFieldBegin("name",r.Type.STRING,1),e.writeString(this.name),e.writeFieldEnd()),null!==this.lts&&void 0!==this.lts&&(e.writeFieldBegin("lts",r.Type.I64,2),e.writeI64(this.lts),e.writeFieldEnd()),null!==this.value&&void 0!==this.value&&(e.writeFieldBegin("value",r.Type.I32,3),e.writeI32(this.value),e.writeFieldEnd()),null!==this.id&&void 0!==this.id&&(e.writeFieldBegin("id",r.Type.I32,4),e.writeI32(this.id),e.writeFieldEnd()),null!==this.tagErrorCode&&void 0!==this.tagErrorCode&&(e.writeFieldBegin("tagErrorCode",r.Type.I32,5),e.writeI32(this.tagErrorCode),e.writeFieldEnd()),e.writeFieldStop(),e.writeStructEnd()};var a=function(e){this.header=null,this.items=null,e&&(void 0!==e.header&&null!==e.header&&(this.header=new i(e.header)),void 0!==e.items&&null!==e.items&&(this.items=r.copyList(e.items,[o])))};(a.prototype={}).read=function(e){for(e.readStructBegin();;){var t=e.readFieldBegin(),n=(t.fname,t.ftype),a=t.fid;if(n==r.Type.STOP)break;switch(a){case 1:n==r.Type.STRUCT?(this.header=new i,this.header.read(e)):e.skip(n);break;case 2:if(n==r.Type.LIST){var s,c;this.items=[],(c=e.readListBegin()).etype,s=c.size;for(var u=0;u<s;++u){var l=null;(l=new o).read(e),this.items.push(l)}e.readListEnd()}else e.skip(n);break;default:e.skip(n)}e.readFieldEnd()}e.readStructEnd()},a.prototype.write=function(e){if(e.writeStructBegin("VosdkCounter"),null!==this.header&&void 0!==this.header&&(e.writeFieldBegin("header",r.Type.STRUCT,1),this.header.write(e),e.writeFieldEnd()),null!==this.items&&void 0!==this.items){for(var t in e.writeFieldBegin("items",r.Type.LIST,2),e.writeListBegin(r.Type.STRUCT,this.items.length),this.items)this.items.hasOwnProperty(t)&&(t=this.items[t]).write(e);e.writeListEnd(),e.writeFieldEnd()}e.writeFieldStop(),e.writeStructEnd()},e.exports={VosdkHeader:i,VosdkCounter:a,VosdkCounterItem:o}},function(e,t,n){"use strict";e.exports=d;var r,i=n(7),o=i.LongBits,a=i.base64,s=i.utf8;function c(e,t,n){this.fn=e,this.len=t,this.next=void 0,this.val=n}function u(){}function l(e){this.head=e.head,this.tail=e.tail,this.len=e.len,this.next=e.states}function d(){this.len=0,this.head=new c(u,0,0),this.tail=this.head,this.states=null}var f=function(){return i.Buffer?function(){return(d.create=function(){return new r})()}:function(){return new d}};function h(e,t,n){t[n]=255&e}function p(e,t){this.len=e,this.next=void 0,this.val=t}function _(e,t,n){for(;e.hi;)t[n++]=127&e.lo|128,e.lo=(e.lo>>>7|e.hi<<25)>>>0,e.hi>>>=7;for(;e.lo>127;)t[n++]=127&e.lo|128,e.lo=e.lo>>>7;t[n++]=e.lo}function v(e,t,n){t[n]=255&e,t[n+1]=e>>>8&255,t[n+2]=e>>>16&255,t[n+3]=e>>>24}d.create=f(),d.alloc=function(e){return new i.Array(e)},i.Array!==Array&&(d.alloc=i.pool(d.alloc,i.Array.prototype.subarray)),d.prototype._push=function(e,t,n){return this.tail=this.tail.next=new c(e,t,n),this.len+=t,this},p.prototype=Object.create(c.prototype),p.prototype.fn=function(e,t,n){for(;e>127;)t[n++]=127&e|128,e>>>=7;t[n]=e},d.prototype.uint32=function(e){return this.len+=(this.tail=this.tail.next=new p((e>>>=0)<128?1:e<16384?2:e<2097152?3:e<268435456?4:5,e)).len,this},d.prototype.int32=function(e){return e<0?this._push(_,10,o.fromNumber(e)):this.uint32(e)},d.prototype.sint32=function(e){return this.uint32((e<<1^e>>31)>>>0)},d.prototype.uint64=function(e){var t=o.from(e);return this._push(_,t.length(),t)},d.prototype.int64=d.prototype.uint64,d.prototype.sint64=function(e){var t=o.from(e).zzEncode();return this._push(_,t.length(),t)},d.prototype.bool=function(e){return this._push(h,1,e?1:0)},d.prototype.fixed32=function(e){return this._push(v,4,e>>>0)},d.prototype.sfixed32=d.prototype.fixed32,d.prototype.fixed64=function(e){var t=o.from(e);return this._push(v,4,t.lo)._push(v,4,t.hi)},d.prototype.sfixed64=d.prototype.fixed64,d.prototype.float=function(e){return this._push(i.float.writeFloatLE,4,e)},d.prototype.double=function(e){return this._push(i.float.writeDoubleLE,8,e)};var g=i.Array.prototype.set?function(e,t,n){t.set(e,n)}:function(e,t,n){for(var r=0;r<e.length;++r)t[n+r]=e[r]};d.prototype.bytes=function(e){var t=e.length>>>0;if(!t)return this._push(h,1,0);if(i.isString(e)){var n=d.alloc(t=a.length(e));a.decode(e,n,0),e=n}return this.uint32(t)._push(g,t,e)},d.prototype.string=function(e){var t=s.length(e);return t?this.uint32(t)._push(s.write,t,e):this._push(h,1,0)},d.prototype.fork=function(){return this.states=new l(this),this.head=this.tail=new c(u,0,0),this.len=0,this},d.prototype.reset=function(){return this.states?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new c(u,0,0),this.len=0),this},d.prototype.ldelim=function(){var e=this.head,t=this.tail,n=this.len;return this.reset().uint32(n),n&&(this.tail.next=e.next,this.tail=t,this.len+=n),this},d.prototype.finish=function(){for(var e=this.head.next,t=this.constructor.alloc(this.len),n=0;e;)e.fn(e.val,t,n),n+=e.len,e=e.next;return t},d._configure=function(e){r=e,d.create=f(),r._configure()}},function(e,t,n){"use strict";e.exports=c;var r,i=n(7),o=i.LongBits,a=i.utf8;function s(e,t){return RangeError("index out of range: "+e.pos+" + "+(t||1)+" > "+e.len)}function c(e){this.buf=e,this.pos=0,this.len=e.length}var u,l="undefined"!=typeof Uint8Array?function(e){if(e instanceof Uint8Array||Array.isArray(e))return new c(e);throw Error("illegal buffer")}:function(e){if(Array.isArray(e))return new c(e);throw Error("illegal buffer")},d=function(){return i.Buffer?function(e){return(c.create=function(e){return i.Buffer.isBuffer(e)?new r(e):l(e)})(e)}:l};function f(){var e=new o(0,0),t=0;if(!(this.len-this.pos>4)){for(;t<3;++t){if(this.pos>=this.len)throw s(this);if(e.lo=(e.lo|(127&this.buf[this.pos])<<7*t)>>>0,this.buf[this.pos++]<128)return e}return e.lo=(e.lo|(127&this.buf[this.pos++])<<7*t)>>>0,e}for(;t<4;++t)if(e.lo=(e.lo|(127&this.buf[this.pos])<<7*t)>>>0,this.buf[this.pos++]<128)return e;if(e.lo=(e.lo|(127&this.buf[this.pos])<<28)>>>0,e.hi=(e.hi|(127&this.buf[this.pos])>>4)>>>0,this.buf[this.pos++]<128)return e;if(t=0,this.len-this.pos>4){for(;t<5;++t)if(e.hi=(e.hi|(127&this.buf[this.pos])<<7*t+3)>>>0,this.buf[this.pos++]<128)return e}else for(;t<5;++t){if(this.pos>=this.len)throw s(this);if(e.hi=(e.hi|(127&this.buf[this.pos])<<7*t+3)>>>0,this.buf[this.pos++]<128)return e}throw Error("invalid varint encoding")}function h(e,t){return(e[t-4]|e[t-3]<<8|e[t-2]<<16|e[t-1]<<24)>>>0}function p(){if(this.pos+8>this.len)throw s(this,8);return new o(h(this.buf,this.pos+=4),h(this.buf,this.pos+=4))}c.create=d(),c.prototype._slice=i.Array.prototype.subarray||i.Array.prototype.slice,c.prototype.uint32=(u=4294967295,function(){if(u=(127&this.buf[this.pos])>>>0,this.buf[this.pos++]<128)return u;if(u=(u|(127&this.buf[this.pos])<<7)>>>0,this.buf[this.pos++]<128)return u;if(u=(u|(127&this.buf[this.pos])<<14)>>>0,this.buf[this.pos++]<128)return u;if(u=(u|(127&this.buf[this.pos])<<21)>>>0,this.buf[this.pos++]<128)return u;if(u=(u|(15&this.buf[this.pos])<<28)>>>0,this.buf[this.pos++]<128)return u;if((this.pos+=5)>this.len)throw this.pos=this.len,s(this,10);return u}),c.prototype.int32=function(){return 0|this.uint32()},c.prototype.sint32=function(){var e=this.uint32();return e>>>1^-(1&e)|0},c.prototype.bool=function(){return 0!==this.uint32()},c.prototype.fixed32=function(){if(this.pos+4>this.len)throw s(this,4);return h(this.buf,this.pos+=4)},c.prototype.sfixed32=function(){if(this.pos+4>this.len)throw s(this,4);return 0|h(this.buf,this.pos+=4)},c.prototype.float=function(){if(this.pos+4>this.len)throw s(this,4);var e=i.float.readFloatLE(this.buf,this.pos);return this.pos+=4,e},c.prototype.double=function(){if(this.pos+8>this.len)throw s(this,4);var e=i.float.readDoubleLE(this.buf,this.pos);return this.pos+=8,e},c.prototype.bytes=function(){var e=this.uint32(),t=this.pos,n=this.pos+e;if(n>this.len)throw s(this,e);return this.pos+=e,Array.isArray(this.buf)?this.buf.slice(t,n):t===n?new this.buf.constructor(0):this._slice.call(this.buf,t,n)},c.prototype.string=function(){var e=this.bytes();return a.read(e,0,e.length)},c.prototype.skip=function(e){if("number"==typeof e){if(this.pos+e>this.len)throw s(this,e);this.pos+=e}else do{if(this.pos>=this.len)throw s(this)}while(128&this.buf[this.pos++]);return this},c.prototype.skipType=function(e){switch(e){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;4!=(e=7&this.uint32());)this.skipType(e);break;case 5:this.skip(4);break;default:throw Error("invalid wire type "+e+" at offset "+this.pos)}return this},c._configure=function(e){r=e,c.create=d(),r._configure();var t=i.Long?"toLong":"toNumber";i.merge(c.prototype,{int64:function(){return f.call(this)[t](!1)},uint64:function(){return f.call(this)[t](!0)},sint64:function(){return f.call(this).zzDecode()[t](!1)},fixed64:function(){return p.call(this)[t](!0)},sfixed64:function(){return p.call(this)[t](!1)}})}},function(e,t,n){var r=n(24),i=n(25);e.exports=function(e,t,n){var o=t&&n||0;"string"==typeof e&&(t="binary"===e?new Array(16):null,e=null);var a=(e=e||{}).random||(e.rng||r)();if(a[6]=15&a[6]|64,a[8]=63&a[8]|128,t)for(var s=0;s<16;++s)t[o+s]=a[s];return t||i(a)}},function(e,t){function n(){return e.exports=n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},n.apply(this,arguments)}e.exports=n},function(e,t){function n(t){return"function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?e.exports=n=function(e){return typeof e}:e.exports=n=function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(t)}e.exports=n},function(e,t,n){"use strict";var r,i,o,a,s,c=n(39),u=c.Writer,l=c.util,d=c.roots.default||(c.roots.default={});d.io=((s={}).agora=((a={}).pb=((o={}).CounterCompact=function(){function e(e){if(this.items=[],e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.sid="",e.prototype.peer=l.Long?l.Long.fromBits(0,0,!1):0,e.prototype.items=l.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=u.create()),null!=e.sid&&Object.hasOwnProperty.call(e,"sid")&&t.uint32(10).string(e.sid),null!=e.peer&&Object.hasOwnProperty.call(e,"peer")&&t.uint32(16).int64(e.peer),null!=e.items&&e.items.length)for(var n=0;n<e.items.length;++n)d.io.agora.pb.Item.encode(e.items[n],t.uint32(26).fork()).ldelim();return t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e}(),o.Item=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.lts=l.Long?l.Long.fromBits(0,0,!1):0,e.prototype.id=11001,e.prototype.value=0,e.prototype.tagErrorCode=0,e.prototype.streamId=0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=u.create()),null!=e.lts&&Object.hasOwnProperty.call(e,"lts")&&t.uint32(8).int64(e.lts),null!=e.id&&Object.hasOwnProperty.call(e,"id")&&t.uint32(16).int32(e.id),null!=e.value&&Object.hasOwnProperty.call(e,"value")&&t.uint32(24).int32(e.value),null!=e.tagErrorCode&&Object.hasOwnProperty.call(e,"tagErrorCode")&&t.uint32(32).int32(e.tagErrorCode),null!=e.streamId&&Object.hasOwnProperty.call(e,"streamId")&&t.uint32(40).uint32(e.streamId),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e}(),o.Id=(r={},(i=Object.create(r))[r[11001]="Miniapp_SDK_Pusher_Video_Bitrate"]=11001,i[r[11002]="Miniapp_SDK_Pusher_Audio_Bitrate"]=11002,i[r[11003]="Miniapp_SDK_Pusher_Video_FPS"]=11003,i[r[11004]="Miniapp_SDK_Pusher_Video_GOP"]=11004,i[r[11005]="Miniapp_SDK_Pusher_Net_Speed"]=11005,i[r[11006]="Miniapp_SDK_Pusher_Video_Cache"]=11006,i[r[11007]="Miniapp_SDK_Pusher_Audio_Cache"]=11007,i[r[11008]="Miniapp_SDK_Player_Video_Bitrate"]=11008,i[r[11009]="Miniapp_SDK_Player_Audio_Bitrate"]=11009,i[r[11010]="Miniapp_SDK_Player_Video_FPS"]=11010,i[r[11011]="Miniapp_SDK_Player_Video_GOP"]=11011,i[r[11012]="Miniapp_SDK_Player_Net_Speed"]=11012,i[r[11013]="Miniapp_SDK_Player_Video_Cache"]=11013,i[r[11014]="Miniapp_SDK_Player_Audio_Cache"]=11014,i[r[11015]="Miniapp_SDK_Player_V_Dec_Cache_Size"]=11015,i[r[11016]="Miniapp_SDK_Player_V_Sum_Cache_Size"]=11016,i[r[11017]="Miniapp_SDK_Player_AV_Play_Interval"]=11017,i[r[11018]="Miniapp_SDK_Player_AV_Recv_Interval"]=11018,i[r[11019]="Miniapp_SDK_Player_Audio_Cache_Threshold"]=11019,i[r[11022]="Miniapp_SDK_Pusher_Video_Height"]=11022,i[r[11023]="Miniapp_SDK_Pusher_Video_Width"]=11023,i[r[11024]="Miniapp_SDK_Player_Video_Width"]=11024,i[r[11025]="Miniapp_SDK_Player_Video_Height"]=11025,i),o),a),s),e.exports=d},function(e,t){var n="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof window.msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto);if(n){var r=new Uint8Array(16);e.exports=function(){return n(r),r}}else{var i=new Array(16);e.exports=function(){for(var e,t=0;t<16;t++)0==(3&t)&&(e=4294967296*Math.random()),i[t]=e>>>((3&t)<<3)&255;return i}}},function(e,t){for(var n=[],r=0;r<256;++r)n[r]=(r+256).toString(16).substr(1);e.exports=function(e,t){var r=t||0,i=n;return[i[e[r++]],i[e[r++]],i[e[r++]],i[e[r++]],"-",i[e[r++]],i[e[r++]],"-",i[e[r++]],i[e[r++]],"-",i[e[r++]],i[e[r++]],"-",i[e[r++]],i[e[r++]],i[e[r++]],i[e[r++]],i[e[r++]],i[e[r++]]].join("")}},function(e,t,n){var r=function(e){"use strict";var t=Object.prototype,n=t.hasOwnProperty,r="function"==typeof Symbol?Symbol:{},i=r.iterator||"@@iterator",o=r.asyncIterator||"@@asyncIterator",a=r.toStringTag||"@@toStringTag";function s(e,t,n,r){var i=t&&t.prototype instanceof l?t:l,o=Object.create(i.prototype),a=new w(r||[]);return o._invoke=function(e,t,n){var r="suspendedStart";return function(i,o){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===i)throw o;return R()}for(n.method=i,n.arg=o;;){var a=n.delegate;if(a){var s=m(a,n);if(s){if(s===u)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var l=c(e,t,n);if("normal"===l.type){if(r=n.done?"completed":"suspendedYield",l.arg===u)continue;return{value:l.arg,done:n.done}}"throw"===l.type&&(r="completed",n.method="throw",n.arg=l.arg)}}}(e,n,a),o}function c(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}e.wrap=s;var u={};function l(){}function d(){}function f(){}var h={};h[i]=function(){return this};var p=Object.getPrototypeOf,_=p&&p(p(T([])));_&&_!==t&&n.call(_,i)&&(h=_);var v=f.prototype=l.prototype=Object.create(h);function g(e){["next","throw","return"].forEach((function(t){e[t]=function(e){return this._invoke(t,e)}}))}function b(e,t){var r;this._invoke=function(i,o){function a(){return new t((function(r,a){!function r(i,o,a,s){var u=c(e[i],e,o);if("throw"!==u.type){var l=u.arg,d=l.value;return d&&"object"==typeof d&&n.call(d,"__await")?t.resolve(d.__await).then((function(e){r("next",e,a,s)}),(function(e){r("throw",e,a,s)})):t.resolve(d).then((function(e){l.value=e,a(l)}),(function(e){return r("throw",e,a,s)}))}s(u.arg)}(i,o,r,a)}))}return r=r?r.then(a,a):a()}}function m(e,t){var n=e.iterator[t.method];if(void 0===n){if(t.delegate=null,"throw"===t.method){if(e.iterator.return&&(t.method="return",t.arg=void 0,m(e,t),"throw"===t.method))return u;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return u}var r=c(n,e.iterator,t.arg);if("throw"===r.type)return t.method="throw",t.arg=r.arg,t.delegate=null,u;var i=r.arg;return i?i.done?(t[e.resultName]=i.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,u):i:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,u)}function y(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function E(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function w(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(y,this),this.reset(!0)}function T(e){if(e){var t=e[i];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,o=function t(){for(;++r<e.length;)if(n.call(e,r))return t.value=e[r],t.done=!1,t;return t.value=void 0,t.done=!0,t};return o.next=o}}return{next:R}}function R(){return{value:void 0,done:!0}}return d.prototype=v.constructor=f,f.constructor=d,f[a]=d.displayName="GeneratorFunction",e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===d||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,f):(e.__proto__=f,a in e||(e[a]="GeneratorFunction")),e.prototype=Object.create(v),e},e.awrap=function(e){return{__await:e}},g(b.prototype),b.prototype[o]=function(){return this},e.AsyncIterator=b,e.async=function(t,n,r,i,o){void 0===o&&(o=Promise);var a=new b(s(t,n,r,i),o);return e.isGeneratorFunction(n)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},g(v),v[a]="Generator",v[i]=function(){return this},v.toString=function(){return"[object Generator]"},e.keys=function(e){var t=[];for(var n in e)t.push(n);return t.reverse(),function n(){for(;t.length;){var r=t.pop();if(r in e)return n.value=r,n.done=!1,n}return n.done=!0,n}},e.values=T,w.prototype={constructor:w,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(E),!e)for(var t in this)"t"===t.charAt(0)&&n.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function r(n,r){return a.type="throw",a.arg=e,t.next=n,r&&(t.method="next",t.arg=void 0),!!r}for(var i=this.tryEntries.length-1;i>=0;--i){var o=this.tryEntries[i],a=o.completion;if("root"===o.tryLoc)return r("end");if(o.tryLoc<=this.prev){var s=n.call(o,"catchLoc"),c=n.call(o,"finallyLoc");if(s&&c){if(this.prev<o.catchLoc)return r(o.catchLoc,!0);if(this.prev<o.finallyLoc)return r(o.finallyLoc)}else if(s){if(this.prev<o.catchLoc)return r(o.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return r(o.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,u):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),u},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),E(n),u}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var i=r.arg;E(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:T(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=void 0),u}},e}(e.exports);try{regeneratorRuntime=r}catch(e){Function("r","regeneratorRuntime = r")(r)}},function(e,t,n){var r=n(14);e.exports=function(e){if(Array.isArray(e))return r(e)}},function(e,t){e.exports=function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}},function(e,t,n){var r=n(14);e.exports=function(e,t){if(e){if("string"==typeof e)return r(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?r(e,t):void 0}}},function(e,t){e.exports=function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}},function(e,t,n){(function(e){var r=void 0!==e&&e||"undefined"!=typeof self&&self||window,i=Function.prototype.apply;function o(e,t){this._id=e,this._clearFn=t}t.setTimeout=function(){return new o(i.call(setTimeout,r,arguments),clearTimeout)},t.setInterval=function(){return new o(i.call(setInterval,r,arguments),clearInterval)},t.clearTimeout=t.clearInterval=function(e){e&&e.close()},o.prototype.unref=o.prototype.ref=function(){},o.prototype.close=function(){this._clearFn.call(r,this._id)},t.enroll=function(e,t){clearTimeout(e._idleTimeoutId),e._idleTimeout=t},t.unenroll=function(e){clearTimeout(e._idleTimeoutId),e._idleTimeout=-1},t._unrefActive=t.active=function(e){clearTimeout(e._idleTimeoutId);var t=e._idleTimeout;t>=0&&(e._idleTimeoutId=setTimeout((function(){e._onTimeout&&e._onTimeout()}),t))},n(32),t.setImmediate="undefined"!=typeof self&&self.setImmediate||void 0!==e&&e.setImmediate||this&&this.setImmediate,t.clearImmediate="undefined"!=typeof self&&self.clearImmediate||void 0!==e&&e.clearImmediate||this&&this.clearImmediate}).call(this,n(13))},function(e,t,n){(function(e,t){!function(e,n){"use strict";if(!e.setImmediate){var r,i,o,a,s,c=1,u={},l=!1,d=e.document,f=Object.getPrototypeOf&&Object.getPrototypeOf(e);f=f&&f.setTimeout?f:e,"[object process]"==={}.toString.call(e.process)?r=function(e){t.nextTick((function(){p(e)}))}:function(){if(e.postMessage&&!e.importScripts){var t=!0,n=e.onmessage;return e.onmessage=function(){t=!1},e.postMessage("","*"),e.onmessage=n,t}}()?(a="setImmediate$"+Math.random()+"$",s=function(t){t.source===e&&"string"==typeof t.data&&0===t.data.indexOf(a)&&p(+t.data.slice(a.length))},e.addEventListener?e.addEventListener("message",s,!1):e.attachEvent("onmessage",s),r=function(t){e.postMessage(a+t,"*")}):e.MessageChannel?((o=new MessageChannel).port1.onmessage=function(e){p(e.data)},r=function(e){o.port2.postMessage(e)}):d&&"onreadystatechange"in d.createElement("script")?(i=d.documentElement,r=function(e){var t=d.createElement("script");t.onreadystatechange=function(){p(e),t.onreadystatechange=null,i.removeChild(t),t=null},i.appendChild(t)}):r=function(e){setTimeout(p,0,e)},f.setImmediate=function(e){"function"!=typeof e&&(e=new Function(""+e));for(var t=new Array(arguments.length-1),n=0;n<t.length;n++)t[n]=arguments[n+1];var i={callback:e,args:t};return u[c]=i,r(c),c++},f.clearImmediate=h}function h(e){delete u[e]}function p(e){if(l)setTimeout(p,0,e);else{var t=u[e];if(t){l=!0;try{!function(e){var t=e.callback,n=e.args;switch(n.length){case 0:t();break;case 1:t(n[0]);break;case 2:t(n[0],n[1]);break;case 3:t(n[0],n[1],n[2]);break;default:t.apply(void 0,n)}}(t)}finally{h(e),l=!1}}}}}("undefined"==typeof self?void 0===e?this:e:self)}).call(this,n(13),n(33))},function(e,t){var n,r,i=e.exports={};function o(){throw new Error("setTimeout has not been defined")}function a(){throw new Error("clearTimeout has not been defined")}function s(e){if(n===setTimeout)return setTimeout(e,0);if((n===o||!n)&&setTimeout)return n=setTimeout,setTimeout(e,0);try{return n(e,0)}catch(t){try{return n.call(null,e,0)}catch(t){return n.call(this,e,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:o}catch(e){n=o}try{r="function"==typeof clearTimeout?clearTimeout:a}catch(e){r=a}}();var c,u=[],l=!1,d=-1;function f(){l&&c&&(l=!1,c.length?u=c.concat(u):d=-1,u.length&&h())}function h(){if(!l){var e=s(f);l=!0;for(var t=u.length;t;){for(c=u,u=[];++d<t;)c&&c[d].run();d=-1,t=u.length}c=null,l=!1,function(e){if(r===clearTimeout)return clearTimeout(e);if((r===a||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(e);try{r(e)}catch(t){try{return r.call(null,e)}catch(t){return r.call(this,e)}}}(e)}}function p(e,t){this.fun=e,this.array=t}function _(){}i.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];u.push(new p(e,t)),1!==u.length||l||s(h)},p.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=_,i.addListener=_,i.once=_,i.off=_,i.removeListener=_,i.removeAllListeners=_,i.emit=_,i.prependListener=_,i.prependOnceListener=_,i.listeners=function(e){return[]},i.binding=function(e){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(e){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},function(e,t){var n,r;n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",r={rotl:function(e,t){return e<<t|e>>>32-t},rotr:function(e,t){return e<<32-t|e>>>t},endian:function(e){if(e.constructor==Number)return 16711935&r.rotl(e,8)|4278255360&r.rotl(e,24);for(var t=0;t<e.length;t++)e[t]=r.endian(e[t]);return e},randomBytes:function(e){for(var t=[];e>0;e--)t.push(Math.floor(256*Math.random()));return t},bytesToWords:function(e){for(var t=[],n=0,r=0;n<e.length;n++,r+=8)t[r>>>5]|=e[n]<<24-r%32;return t},wordsToBytes:function(e){for(var t=[],n=0;n<32*e.length;n+=8)t.push(e[n>>>5]>>>24-n%32&255);return t},bytesToHex:function(e){for(var t=[],n=0;n<e.length;n++)t.push((e[n]>>>4).toString(16)),t.push((15&e[n]).toString(16));return t.join("")},hexToBytes:function(e){for(var t=[],n=0;n<e.length;n+=2)t.push(parseInt(e.substr(n,2),16));return t},bytesToBase64:function(e){for(var t=[],r=0;r<e.length;r+=3)for(var i=e[r]<<16|e[r+1]<<8|e[r+2],o=0;o<4;o++)8*r+6*o<=8*e.length?t.push(n.charAt(i>>>6*(3-o)&63)):t.push("=");return t.join("")},base64ToBytes:function(e){e=e.replace(/[^A-Z0-9+\/]/gi,"");for(var t=[],r=0,i=0;r<e.length;i=++r%4)0!=i&&t.push((n.indexOf(e.charAt(r-1))&Math.pow(2,-2*i+8)-1)<<2*i|n.indexOf(e.charAt(r))>>>6-2*i);return t}},e.exports=r},function(e,t){function n(e){return!!e.constructor&&"function"==typeof e.constructor.isBuffer&&e.constructor.isBuffer(e)}
/*!
     * Determine if an object is a Buffer
     *
     * @author   Feross Aboukhadijeh <https://feross.org>
     * @license  MIT
     */e.exports=function(e){return null!=e&&(n(e)||function(e){return"function"==typeof e.readFloatLE&&"function"==typeof e.slice&&n(e.slice(0,0))}(e)||!!e._isBuffer)}},function(e,t,n){var r;
/*!
     * EventEmitter v5.2.9 - git.io/ee
     * Unlicense - http://unlicense.org/
     * Oliver Caldwell - https://oli.me.uk/
     * @preserve
     */!function(t){"use strict";function i(){}var o=i.prototype,a=t.EventEmitter;function s(e,t){for(var n=e.length;n--;)if(e[n].listener===t)return n;return-1}function c(e){return function(){return this[e].apply(this,arguments)}}o.getListeners=function(e){var t,n,r=this._getEvents();if(e instanceof RegExp)for(n in t={},r)r.hasOwnProperty(n)&&e.test(n)&&(t[n]=r[n]);else t=r[e]||(r[e]=[]);return t},o.flattenListeners=function(e){var t,n=[];for(t=0;t<e.length;t+=1)n.push(e[t].listener);return n},o.getListenersAsObject=function(e){var t,n=this.getListeners(e);return n instanceof Array&&((t={})[e]=n),t||n},o.addListener=function(e,t){if(!function e(t){return"function"==typeof t||t instanceof RegExp||!(!t||"object"!=typeof t)&&e(t.listener)}(t))throw new TypeError("listener must be a function");var n,r=this.getListenersAsObject(e),i="object"==typeof t;for(n in r)r.hasOwnProperty(n)&&-1===s(r[n],t)&&r[n].push(i?t:{listener:t,once:!1});return this},o.on=c("addListener"),o.addOnceListener=function(e,t){return this.addListener(e,{listener:t,once:!0})},o.once=c("addOnceListener"),o.defineEvent=function(e){return this.getListeners(e),this},o.defineEvents=function(e){for(var t=0;t<e.length;t+=1)this.defineEvent(e[t]);return this},o.removeListener=function(e,t){var n,r,i=this.getListenersAsObject(e);for(r in i)i.hasOwnProperty(r)&&-1!==(n=s(i[r],t))&&i[r].splice(n,1);return this},o.off=c("removeListener"),o.addListeners=function(e,t){return this.manipulateListeners(!1,e,t)},o.removeListeners=function(e,t){return this.manipulateListeners(!0,e,t)},o.manipulateListeners=function(e,t,n){var r,i,o=e?this.removeListener:this.addListener,a=e?this.removeListeners:this.addListeners;if("object"!=typeof t||t instanceof RegExp)for(r=n.length;r--;)o.call(this,t,n[r]);else for(r in t)t.hasOwnProperty(r)&&(i=t[r])&&("function"==typeof i?o.call(this,r,i):a.call(this,r,i));return this},o.removeEvent=function(e){var t,n=typeof e,r=this._getEvents();if("string"===n)delete r[e];else if(e instanceof RegExp)for(t in r)r.hasOwnProperty(t)&&e.test(t)&&delete r[t];else delete this._events;return this},o.removeAllListeners=c("removeEvent"),o.emitEvent=function(e,t){var n,r,i,o,a=this.getListenersAsObject(e);for(o in a)if(a.hasOwnProperty(o))for(n=a[o].slice(0),i=0;i<n.length;i++)!0===(r=n[i]).once&&this.removeListener(e,r.listener),r.listener.apply(this,t||[])===this._getOnceReturnValue()&&this.removeListener(e,r.listener);return this},o.trigger=c("emitEvent"),o.emit=function(e){var t=Array.prototype.slice.call(arguments,1);return this.emitEvent(e,t)},o.setOnceReturnValue=function(e){return this._onceReturnValue=e,this},o._getOnceReturnValue=function(){return!this.hasOwnProperty("_onceReturnValue")||this._onceReturnValue},o._getEvents=function(){return this._events||(this._events={})},i.noConflict=function(){return t.EventEmitter=a,i},void 0===(r=function(){return i}.call(t,n,t,e))||(e.exports=r)}("undefined"!=typeof window?window:this||{})},function(e,t,n){var r=n(9).default,i=n(16),o=function(e){this.item=null,e&&void 0!==e.item&&null!==e.item&&(this.item=new i(e.item))};(o.prototype={}).read=function(e){for(e.readStructBegin();;){var t=e.readFieldBegin(),n=(t.fname,t.ftype),o=t.fid;if(n==r.Type.STOP)break;switch(o){case 1:n==r.Type.STRUCT?(this.item=new i,this.item.read(e)):e.skip(n);break;case 0:e.skip(n);break;default:e.skip(n)}e.readFieldEnd()}e.readStructEnd()},o.prototype.write=function(e){e.writeStructBegin("ReportService_Report_args"),null!==this.item&&void 0!==this.item&&(e.writeFieldBegin("item",r.Type.STRUCT,1),this.item.write(e),e.writeFieldEnd()),e.writeFieldStop(),e.writeStructEnd()};var a=function(e){};(a.prototype={}).read=function(e){for(e.readStructBegin();;){var t=e.readFieldBegin(),n=(t.fname,t.ftype);if(t.fid,n==r.Type.STOP)break;e.skip(n),e.readFieldEnd()}e.readStructEnd()},a.prototype.write=function(e){e.writeStructBegin("ReportService_Report_result"),e.writeFieldStop(),e.writeStructEnd()};var s=function(e,t){this.input=e,this.output=t||e,this.seqid=0};(s.prototype={}).Report=function(e,t){this.send_Report(e,t),t||this.recv_Report()},s.prototype.send_Report=function(e,t){if(this.output.writeMessageBegin("Report",r.MessageType.CALL,this.seqid),new o({item:e}).write(this.output),this.output.writeMessageEnd(),!t)return this.output.getTransport().flush();this.output.getTransport().flush(!0,(function(e){t(e)}))},s.prototype.recv_Report=function(){var e=this.input.readMessageBegin(),t=(e.fname,e.mtype);if(e.rseqid,t==r.MessageType.EXCEPTION){var n=new r.TApplicationException;throw n.read(this.input),this.input.readMessageEnd(),n}(new a).read(this.input),this.input.readMessageEnd()},e.exports={ReportService_Report_args:o,ReportService_Report_result:a,ReportServiceClient:s}},function(e,t,n){var r=n(9).default,i=n(17).VosdkHeader,o=function(e){this.header=null,this.appid=null,this.uname=null,this.ver=null,this.dk=null,this.details=null,e&&(void 0!==e.header&&null!==e.header&&(this.header=new i(e.header)),void 0!==e.appid&&null!==e.appid&&(this.appid=e.appid),void 0!==e.uname&&null!==e.uname&&(this.uname=e.uname),void 0!==e.ver&&null!==e.ver&&(this.ver=e.ver),void 0!==e.dk&&null!==e.dk&&(this.dk=e.dk),void 0!==e.details&&null!==e.details&&(this.details=e.details))};(o.prototype={}).read=function(e){for(e.readStructBegin();;){var t=e.readFieldBegin(),n=(t.fname,t.ftype),o=t.fid;if(n==r.Type.STOP)break;switch(o){case 1:n==r.Type.STRUCT?(this.header=new i,this.header.read(e)):e.skip(n);break;case 2:n==r.Type.STRING?this.appid=e.readString().value:e.skip(n);break;case 3:n==r.Type.STRING?this.uname=e.readString().value:e.skip(n);break;case 4:n==r.Type.STRING?this.ver=e.readString().value:e.skip(n);break;case 5:n==r.Type.STRING?this.dk=e.readString().value:e.skip(n);break;case 6:n==r.Type.STRING?this.details=e.readString().value:e.skip(n);break;default:e.skip(n)}e.readFieldEnd()}e.readStructEnd()},o.prototype.write=function(e){e.writeStructBegin("MiniappSession"),null!==this.header&&void 0!==this.header&&(e.writeFieldBegin("header",r.Type.STRUCT,1),this.header.write(e),e.writeFieldEnd()),null!==this.appid&&void 0!==this.appid&&(e.writeFieldBegin("appid",r.Type.STRING,2),e.writeString(this.appid),e.writeFieldEnd()),null!==this.uname&&void 0!==this.uname&&(e.writeFieldBegin("uname",r.Type.STRING,3),e.writeString(this.uname),e.writeFieldEnd()),null!==this.ver&&void 0!==this.ver&&(e.writeFieldBegin("ver",r.Type.STRING,4),e.writeString(this.ver),e.writeFieldEnd()),null!==this.dk&&void 0!==this.dk&&(e.writeFieldBegin("dk",r.Type.STRING,5),e.writeString(this.dk),e.writeFieldEnd()),null!==this.details&&void 0!==this.details&&(e.writeFieldBegin("details",r.Type.STRING,6),e.writeString(this.details),e.writeFieldEnd()),e.writeFieldStop(),e.writeStructEnd()};var a=function(e){this.header=null,this.csurl=null,this.ec=null,this.gatewaylist=null,this.details=null,e&&(void 0!==e.header&&null!==e.header&&(this.header=new i(e.header)),void 0!==e.csurl&&null!==e.csurl&&(this.csurl=e.csurl),void 0!==e.ec&&null!==e.ec&&(this.ec=e.ec),void 0!==e.gatewaylist&&null!==e.gatewaylist&&(this.gatewaylist=r.copyList(e.gatewaylist,[null])),void 0!==e.details&&null!==e.details&&(this.details=e.details))};(a.prototype={}).read=function(e){for(e.readStructBegin();;){var t=e.readFieldBegin(),n=(t.fname,t.ftype),o=t.fid;if(n==r.Type.STOP)break;switch(o){case 1:n==r.Type.STRUCT?(this.header=new i,this.header.read(e)):e.skip(n);break;case 2:n==r.Type.STRING?this.csurl=e.readString().value:e.skip(n);break;case 3:n==r.Type.STRING?this.ec=e.readString().value:e.skip(n);break;case 4:if(n==r.Type.LIST){var a,s;this.gatewaylist=[],(s=e.readListBegin()).etype,a=s.size;for(var c=0;c<a;++c){var u;u=e.readString().value,this.gatewaylist.push(u)}e.readListEnd()}else e.skip(n);break;case 5:n==r.Type.STRING?this.details=e.readString().value:e.skip(n);break;default:e.skip(n)}e.readFieldEnd()}e.readStructEnd()},a.prototype.write=function(e){if(e.writeStructBegin("MiniappJoinChooseServer"),null!==this.header&&void 0!==this.header&&(e.writeFieldBegin("header",r.Type.STRUCT,1),this.header.write(e),e.writeFieldEnd()),null!==this.csurl&&void 0!==this.csurl&&(e.writeFieldBegin("csurl",r.Type.STRING,2),e.writeString(this.csurl),e.writeFieldEnd()),null!==this.ec&&void 0!==this.ec&&(e.writeFieldBegin("ec",r.Type.STRING,3),e.writeString(this.ec),e.writeFieldEnd()),null!==this.gatewaylist&&void 0!==this.gatewaylist){for(var t in e.writeFieldBegin("gatewaylist",r.Type.LIST,4),e.writeListBegin(r.Type.STRING,this.gatewaylist.length),this.gatewaylist)this.gatewaylist.hasOwnProperty(t)&&(t=this.gatewaylist[t],e.writeString(t));e.writeListEnd(),e.writeFieldEnd()}null!==this.details&&void 0!==this.details&&(e.writeFieldBegin("details",r.Type.STRING,5),e.writeString(this.details),e.writeFieldEnd()),e.writeFieldStop(),e.writeStructEnd()};var s=function(e){this.header=null,this.gateway=null,this.ec=null,this.wsurl=null,this.details=null,e&&(void 0!==e.header&&null!==e.header&&(this.header=new i(e.header)),void 0!==e.gateway&&null!==e.gateway&&(this.gateway=e.gateway),void 0!==e.ec&&null!==e.ec&&(this.ec=e.ec),void 0!==e.wsurl&&null!==e.wsurl&&(this.wsurl=e.wsurl),void 0!==e.details&&null!==e.details&&(this.details=e.details))};(s.prototype={}).read=function(e){for(e.readStructBegin();;){var t=e.readFieldBegin(),n=(t.fname,t.ftype),o=t.fid;if(n==r.Type.STOP)break;switch(o){case 1:n==r.Type.STRUCT?(this.header=new i,this.header.read(e)):e.skip(n);break;case 2:n==r.Type.STRING?this.gateway=e.readString().value:e.skip(n);break;case 3:n==r.Type.STRING?this.ec=e.readString().value:e.skip(n);break;case 4:n==r.Type.STRING?this.wsurl=e.readString().value:e.skip(n);break;case 5:n==r.Type.STRING?this.details=e.readString().value:e.skip(n);break;default:e.skip(n)}e.readFieldEnd()}e.readStructEnd()},s.prototype.write=function(e){e.writeStructBegin("MiniappConnectWebSocket"),null!==this.header&&void 0!==this.header&&(e.writeFieldBegin("header",r.Type.STRUCT,1),this.header.write(e),e.writeFieldEnd()),null!==this.gateway&&void 0!==this.gateway&&(e.writeFieldBegin("gateway",r.Type.STRING,2),e.writeString(this.gateway),e.writeFieldEnd()),null!==this.ec&&void 0!==this.ec&&(e.writeFieldBegin("ec",r.Type.STRING,3),e.writeString(this.ec),e.writeFieldEnd()),null!==this.wsurl&&void 0!==this.wsurl&&(e.writeFieldBegin("wsurl",r.Type.STRING,4),e.writeString(this.wsurl),e.writeFieldEnd()),null!==this.details&&void 0!==this.details&&(e.writeFieldBegin("details",r.Type.STRING,5),e.writeString(this.details),e.writeFieldEnd()),e.writeFieldStop(),e.writeStructEnd()};var c=function(e){this.header=null,this.uid=null,this.ec=null,this.isrejoin=null,this.details=null,e&&(void 0!==e.header&&null!==e.header&&(this.header=new i(e.header)),void 0!==e.uid&&null!==e.uid&&(this.uid=e.uid),void 0!==e.ec&&null!==e.ec&&(this.ec=e.ec),void 0!==e.isrejoin&&null!==e.isrejoin&&(this.isrejoin=e.isrejoin),void 0!==e.details&&null!==e.details&&(this.details=e.details))};(c.prototype={}).read=function(e){for(e.readStructBegin();;){var t=e.readFieldBegin(),n=(t.fname,t.ftype),o=t.fid;if(n==r.Type.STOP)break;switch(o){case 1:n==r.Type.STRUCT?(this.header=new i,this.header.read(e)):e.skip(n);break;case 2:n==r.Type.STRING?this.uid=e.readString().value:e.skip(n);break;case 3:n==r.Type.STRING?this.ec=e.readString().value:e.skip(n);break;case 4:n==r.Type.BOOL?this.isrejoin=e.readBool().value:e.skip(n);break;case 5:n==r.Type.STRING?this.details=e.readString().value:e.skip(n);break;default:e.skip(n)}e.readFieldEnd()}e.readStructEnd()},c.prototype.write=function(e){e.writeStructBegin("MiniappJoin"),null!==this.header&&void 0!==this.header&&(e.writeFieldBegin("header",r.Type.STRUCT,1),this.header.write(e),e.writeFieldEnd()),null!==this.uid&&void 0!==this.uid&&(e.writeFieldBegin("uid",r.Type.STRING,2),e.writeString(this.uid),e.writeFieldEnd()),null!==this.ec&&void 0!==this.ec&&(e.writeFieldBegin("ec",r.Type.STRING,3),e.writeString(this.ec),e.writeFieldEnd()),null!==this.isrejoin&&void 0!==this.isrejoin&&(e.writeFieldBegin("isrejoin",r.Type.BOOL,4),e.writeBool(this.isrejoin),e.writeFieldEnd()),null!==this.details&&void 0!==this.details&&(e.writeFieldBegin("details",r.Type.STRING,5),e.writeString(this.details),e.writeFieldEnd()),e.writeFieldStop(),e.writeStructEnd()};var u=function(e){this.header=null,this.ec=null,this.pushurl=null,this.uid=null,this.details=null,e&&(void 0!==e.header&&null!==e.header&&(this.header=new i(e.header)),void 0!==e.ec&&null!==e.ec&&(this.ec=e.ec),void 0!==e.pushurl&&null!==e.pushurl&&(this.pushurl=e.pushurl),void 0!==e.uid&&null!==e.uid&&(this.uid=e.uid),void 0!==e.details&&null!==e.details&&(this.details=e.details))};(u.prototype={}).read=function(e){for(e.readStructBegin();;){var t=e.readFieldBegin(),n=(t.fname,t.ftype),o=t.fid;if(n==r.Type.STOP)break;switch(o){case 1:n==r.Type.STRUCT?(this.header=new i,this.header.read(e)):e.skip(n);break;case 2:n==r.Type.STRING?this.ec=e.readString().value:e.skip(n);break;case 3:n==r.Type.STRING?this.pushurl=e.readString().value:e.skip(n);break;case 4:n==r.Type.STRING?this.uid=e.readString().value:e.skip(n);break;case 5:n==r.Type.STRING?this.details=e.readString().value:e.skip(n);break;default:e.skip(n)}e.readFieldEnd()}e.readStructEnd()},u.prototype.write=function(e){e.writeStructBegin("MiniappPublish"),null!==this.header&&void 0!==this.header&&(e.writeFieldBegin("header",r.Type.STRUCT,1),this.header.write(e),e.writeFieldEnd()),null!==this.ec&&void 0!==this.ec&&(e.writeFieldBegin("ec",r.Type.STRING,2),e.writeString(this.ec),e.writeFieldEnd()),null!==this.pushurl&&void 0!==this.pushurl&&(e.writeFieldBegin("pushurl",r.Type.STRING,3),e.writeString(this.pushurl),e.writeFieldEnd()),null!==this.uid&&void 0!==this.uid&&(e.writeFieldBegin("uid",r.Type.STRING,4),e.writeString(this.uid),e.writeFieldEnd()),null!==this.details&&void 0!==this.details&&(e.writeFieldBegin("details",r.Type.STRING,5),e.writeString(this.details),e.writeFieldEnd()),e.writeFieldStop(),e.writeStructEnd()};var l=function(e){this.header=null,this.ec=null,this.uid=null,this.details=null,e&&(void 0!==e.header&&null!==e.header&&(this.header=new i(e.header)),void 0!==e.ec&&null!==e.ec&&(this.ec=e.ec),void 0!==e.uid&&null!==e.uid&&(this.uid=e.uid),void 0!==e.details&&null!==e.details&&(this.details=e.details))};(l.prototype={}).read=function(e){for(e.readStructBegin();;){var t=e.readFieldBegin(),n=(t.fname,t.ftype),o=t.fid;if(n==r.Type.STOP)break;switch(o){case 1:n==r.Type.STRUCT?(this.header=new i,this.header.read(e)):e.skip(n);break;case 2:n==r.Type.STRING?this.ec=e.readString().value:e.skip(n);break;case 3:n==r.Type.STRING?this.uid=e.readString().value:e.skip(n);break;case 5:n==r.Type.STRING?this.details=e.readString().value:e.skip(n);break;default:e.skip(n)}e.readFieldEnd()}e.readStructEnd()},l.prototype.write=function(e){e.writeStructBegin("MiniappUnpublish"),null!==this.header&&void 0!==this.header&&(e.writeFieldBegin("header",r.Type.STRUCT,1),this.header.write(e),e.writeFieldEnd()),null!==this.ec&&void 0!==this.ec&&(e.writeFieldBegin("ec",r.Type.STRING,2),e.writeString(this.ec),e.writeFieldEnd()),null!==this.uid&&void 0!==this.uid&&(e.writeFieldBegin("uid",r.Type.STRING,3),e.writeString(this.uid),e.writeFieldEnd()),null!==this.details&&void 0!==this.details&&(e.writeFieldBegin("details",r.Type.STRING,5),e.writeString(this.details),e.writeFieldEnd()),e.writeFieldStop(),e.writeStructEnd()};var d=function(e){this.header=null,this.ec=null,this.pullurl=null,this.peerid=null,this.details=null,e&&(void 0!==e.header&&null!==e.header&&(this.header=new i(e.header)),void 0!==e.ec&&null!==e.ec&&(this.ec=e.ec),void 0!==e.pullurl&&null!==e.pullurl&&(this.pullurl=e.pullurl),void 0!==e.peerid&&null!==e.peerid&&(this.peerid=e.peerid),void 0!==e.details&&null!==e.details&&(this.details=e.details))};(d.prototype={}).read=function(e){for(e.readStructBegin();;){var t=e.readFieldBegin(),n=(t.fname,t.ftype),o=t.fid;if(n==r.Type.STOP)break;switch(o){case 1:n==r.Type.STRUCT?(this.header=new i,this.header.read(e)):e.skip(n);break;case 2:n==r.Type.STRING?this.ec=e.readString().value:e.skip(n);break;case 3:n==r.Type.STRING?this.pullurl=e.readString().value:e.skip(n);break;case 4:n==r.Type.STRING?this.peerid=e.readString().value:e.skip(n);break;case 5:n==r.Type.STRING?this.details=e.readString().value:e.skip(n);break;default:e.skip(n)}e.readFieldEnd()}e.readStructEnd()},d.prototype.write=function(e){e.writeStructBegin("MiniappSubscribe"),null!==this.header&&void 0!==this.header&&(e.writeFieldBegin("header",r.Type.STRUCT,1),this.header.write(e),e.writeFieldEnd()),null!==this.ec&&void 0!==this.ec&&(e.writeFieldBegin("ec",r.Type.STRING,2),e.writeString(this.ec),e.writeFieldEnd()),null!==this.pullurl&&void 0!==this.pullurl&&(e.writeFieldBegin("pullurl",r.Type.STRING,3),e.writeString(this.pullurl),e.writeFieldEnd()),null!==this.peerid&&void 0!==this.peerid&&(e.writeFieldBegin("peerid",r.Type.STRING,4),e.writeString(this.peerid),e.writeFieldEnd()),null!==this.details&&void 0!==this.details&&(e.writeFieldBegin("details",r.Type.STRING,5),e.writeString(this.details),e.writeFieldEnd()),e.writeFieldStop(),e.writeStructEnd()};var f=function(e){this.header=null,this.ec=null,this.peerid=null,this.details=null,e&&(void 0!==e.header&&null!==e.header&&(this.header=new i(e.header)),void 0!==e.ec&&null!==e.ec&&(this.ec=e.ec),void 0!==e.peerid&&null!==e.peerid&&(this.peerid=e.peerid),void 0!==e.details&&null!==e.details&&(this.details=e.details))};(f.prototype={}).read=function(e){for(e.readStructBegin();;){var t=e.readFieldBegin(),n=(t.fname,t.ftype),o=t.fid;if(n==r.Type.STOP)break;switch(o){case 1:n==r.Type.STRUCT?(this.header=new i,this.header.read(e)):e.skip(n);break;case 2:n==r.Type.STRING?this.ec=e.readString().value:e.skip(n);break;case 3:n==r.Type.STRING?this.peerid=e.readString().value:e.skip(n);break;case 4:n==r.Type.STRING?this.details=e.readString().value:e.skip(n);break;default:e.skip(n)}e.readFieldEnd()}e.readStructEnd()},f.prototype.write=function(e){e.writeStructBegin("MiniappUnsubscribe"),null!==this.header&&void 0!==this.header&&(e.writeFieldBegin("header",r.Type.STRUCT,1),this.header.write(e),e.writeFieldEnd()),null!==this.ec&&void 0!==this.ec&&(e.writeFieldBegin("ec",r.Type.STRING,2),e.writeString(this.ec),e.writeFieldEnd()),null!==this.peerid&&void 0!==this.peerid&&(e.writeFieldBegin("peerid",r.Type.STRING,3),e.writeString(this.peerid),e.writeFieldEnd()),null!==this.details&&void 0!==this.details&&(e.writeFieldBegin("details",r.Type.STRING,4),e.writeString(this.details),e.writeFieldEnd()),e.writeFieldStop(),e.writeStructEnd()};var h=function(e){this.header=null,this.uid=null,this.details=null,e&&(void 0!==e.header&&null!==e.header&&(this.header=new i(e.header)),void 0!==e.uid&&null!==e.uid&&(this.uid=e.uid),void 0!==e.details&&null!==e.details&&(this.details=e.details))};(h.prototype={}).read=function(e){for(e.readStructBegin();;){var t=e.readFieldBegin(),n=(t.fname,t.ftype),o=t.fid;if(n==r.Type.STOP)break;switch(o){case 1:n==r.Type.STRUCT?(this.header=new i,this.header.read(e)):e.skip(n);break;case 2:n==r.Type.STRING?this.uid=e.readString().value:e.skip(n);break;case 3:n==r.Type.STRING?this.details=e.readString().value:e.skip(n);break;default:e.skip(n)}e.readFieldEnd()}e.readStructEnd()},h.prototype.write=function(e){e.writeStructBegin("MiniappLeave"),null!==this.header&&void 0!==this.header&&(e.writeFieldBegin("header",r.Type.STRUCT,1),this.header.write(e),e.writeFieldEnd()),null!==this.uid&&void 0!==this.uid&&(e.writeFieldBegin("uid",r.Type.STRING,2),e.writeString(this.uid),e.writeFieldEnd()),null!==this.details&&void 0!==this.details&&(e.writeFieldBegin("details",r.Type.STRING,3),e.writeString(this.details),e.writeFieldEnd()),e.writeFieldStop(),e.writeStructEnd()};var p=function(e){this.header=null,this.action=null,this.details=null,this.req_ts=null,e&&(void 0!==e.header&&null!==e.header&&(this.header=new i(e.header)),void 0!==e.action&&null!==e.action&&(this.action=e.action),void 0!==e.details&&null!==e.details&&(this.details=e.details),void 0!==e.req_ts&&null!==e.req_ts&&(this.req_ts=e.req_ts))};(p.prototype={}).read=function(e){for(e.readStructBegin();;){var t=e.readFieldBegin(),n=(t.fname,t.ftype),o=t.fid;if(n==r.Type.STOP)break;switch(o){case 1:n==r.Type.STRUCT?(this.header=new i,this.header.read(e)):e.skip(n);break;case 2:n==r.Type.STRING?this.action=e.readString().value:e.skip(n);break;case 3:n==r.Type.STRING?this.details=e.readString().value:e.skip(n);break;case 4:n==r.Type.I64?this.req_ts=e.readI64().value:e.skip(n);break;default:e.skip(n)}e.readFieldEnd()}e.readStructEnd()},p.prototype.write=function(e){e.writeStructBegin("MiniappServerEvent"),null!==this.header&&void 0!==this.header&&(e.writeFieldBegin("header",r.Type.STRUCT,1),this.header.write(e),e.writeFieldEnd()),null!==this.action&&void 0!==this.action&&(e.writeFieldBegin("action",r.Type.STRING,2),e.writeString(this.action),e.writeFieldEnd()),null!==this.details&&void 0!==this.details&&(e.writeFieldBegin("details",r.Type.STRING,3),e.writeString(this.details),e.writeFieldEnd()),null!==this.req_ts&&void 0!==this.req_ts&&(e.writeFieldBegin("req_ts",r.Type.I64,4),e.writeI64(this.req_ts),e.writeFieldEnd()),e.writeFieldStop(),e.writeStructEnd()};var _=function(e){this.header=null,this.url=null,this.code=null,this.status=null,this.error=null,this.details=null,e&&(void 0!==e.header&&null!==e.header&&(this.header=new i(e.header)),void 0!==e.url&&null!==e.url&&(this.url=e.url),void 0!==e.code&&null!==e.code&&(this.code=e.code),void 0!==e.status&&null!==e.status&&(this.status=e.status),void 0!==e.error&&null!==e.error&&(this.error=e.error),void 0!==e.details&&null!==e.details&&(this.details=e.details))};(_.prototype={}).read=function(e){for(e.readStructBegin();;){var t=e.readFieldBegin(),n=(t.fname,t.ftype),o=t.fid;if(n==r.Type.STOP)break;switch(o){case 1:n==r.Type.STRUCT?(this.header=new i,this.header.read(e)):e.skip(n);break;case 2:n==r.Type.STRING?this.url=e.readString().value:e.skip(n);break;case 3:n==r.Type.STRING?this.code=e.readString().value:e.skip(n);break;case 4:n==r.Type.STRING?this.status=e.readString().value:e.skip(n);break;case 5:n==r.Type.STRING?this.error=e.readString().value:e.skip(n);break;case 6:n==r.Type.STRING?this.details=e.readString().value:e.skip(n);break;default:e.skip(n)}e.readFieldEnd()}e.readStructEnd()},_.prototype.write=function(e){e.writeStructBegin("MiniappPusherState"),null!==this.header&&void 0!==this.header&&(e.writeFieldBegin("header",r.Type.STRUCT,1),this.header.write(e),e.writeFieldEnd()),null!==this.url&&void 0!==this.url&&(e.writeFieldBegin("url",r.Type.STRING,2),e.writeString(this.url),e.writeFieldEnd()),null!==this.code&&void 0!==this.code&&(e.writeFieldBegin("code",r.Type.STRING,3),e.writeString(this.code),e.writeFieldEnd()),null!==this.status&&void 0!==this.status&&(e.writeFieldBegin("status",r.Type.STRING,4),e.writeString(this.status),e.writeFieldEnd()),null!==this.error&&void 0!==this.error&&(e.writeFieldBegin("error",r.Type.STRING,5),e.writeString(this.error),e.writeFieldEnd()),null!==this.details&&void 0!==this.details&&(e.writeFieldBegin("details",r.Type.STRING,6),e.writeString(this.details),e.writeFieldEnd()),e.writeFieldStop(),e.writeStructEnd()};var v=function(e){this.header=null,this.url=null,this.code=null,this.status=null,this.error=null,this.details=null,e&&(void 0!==e.header&&null!==e.header&&(this.header=new i(e.header)),void 0!==e.url&&null!==e.url&&(this.url=e.url),void 0!==e.code&&null!==e.code&&(this.code=e.code),void 0!==e.status&&null!==e.status&&(this.status=e.status),void 0!==e.error&&null!==e.error&&(this.error=e.error),void 0!==e.details&&null!==e.details&&(this.details=e.details))};(v.prototype={}).read=function(e){for(e.readStructBegin();;){var t=e.readFieldBegin(),n=(t.fname,t.ftype),o=t.fid;if(n==r.Type.STOP)break;switch(o){case 1:n==r.Type.STRUCT?(this.header=new i,this.header.read(e)):e.skip(n);break;case 2:n==r.Type.STRING?this.url=e.readString().value:e.skip(n);break;case 3:n==r.Type.STRING?this.code=e.readString().value:e.skip(n);break;case 4:n==r.Type.STRING?this.status=e.readString().value:e.skip(n);break;case 5:n==r.Type.STRING?this.error=e.readString().value:e.skip(n);break;case 6:n==r.Type.STRING?this.details=e.readString().value:e.skip(n);break;default:e.skip(n)}e.readFieldEnd()}e.readStructEnd()},v.prototype.write=function(e){e.writeStructBegin("MiniappPlayerState"),null!==this.header&&void 0!==this.header&&(e.writeFieldBegin("header",r.Type.STRUCT,1),this.header.write(e),e.writeFieldEnd()),null!==this.url&&void 0!==this.url&&(e.writeFieldBegin("url",r.Type.STRING,2),e.writeString(this.url),e.writeFieldEnd()),null!==this.code&&void 0!==this.code&&(e.writeFieldBegin("code",r.Type.STRING,3),e.writeString(this.code),e.writeFieldEnd()),null!==this.status&&void 0!==this.status&&(e.writeFieldBegin("status",r.Type.STRING,4),e.writeString(this.status),e.writeFieldEnd()),null!==this.error&&void 0!==this.error&&(e.writeFieldBegin("error",r.Type.STRING,5),e.writeString(this.error),e.writeFieldEnd()),null!==this.details&&void 0!==this.details&&(e.writeFieldBegin("details",r.Type.STRING,6),e.writeString(this.details),e.writeFieldEnd()),e.writeFieldStop(),e.writeStructEnd()},e.exports={MiniappSession:o,MiniappJoinChooseServer:a,MiniappConnectWebSocket:s,MiniappJoin:c,MiniappPublish:u,MiniappUnpublish:l,MiniappSubscribe:d,MiniappUnsubscribe:f,MiniappLeave:h,MiniappServerEvent:p,MiniappPusherState:_,MiniappPlayerState:v}},function(e,t,n){"use strict";e.exports=n(40)},function(e,t,n){"use strict";var r=t;function i(){r.util._configure(),r.Writer._configure(r.BufferWriter),r.Reader._configure(r.BufferReader)}r.build="minimal",r.Writer=n(18),r.BufferWriter=n(49),r.Reader=n(19),r.BufferReader=n(50),r.util=n(7),r.rpc=n(51),r.roots=n(53),r.configure=i,i()},function(e,t,n){"use strict";e.exports=function(e,t){for(var n=new Array(arguments.length-1),r=0,i=2,o=!0;i<arguments.length;)n[r++]=arguments[i++];return new Promise((function(i,a){n[r]=function(e){if(o)if(o=!1,e)a(e);else{for(var t=new Array(arguments.length-1),n=0;n<t.length;)t[n++]=arguments[n];i.apply(null,t)}};try{e.apply(t||null,n)}catch(e){o&&(o=!1,a(e))}}))}},function(e,t,n){"use strict";var r=t;r.length=function(e){var t=e.length;if(!t)return 0;for(var n=0;--t%4>1&&"="===e.charAt(t);)++n;return Math.ceil(3*e.length)/4-n};for(var i=new Array(64),o=new Array(123),a=0;a<64;)o[i[a]=a<26?a+65:a<52?a+71:a<62?a-4:a-59|43]=a++;r.encode=function(e,t,n){for(var r,o=null,a=[],s=0,c=0;t<n;){var u=e[t++];switch(c){case 0:a[s++]=i[u>>2],r=(3&u)<<4,c=1;break;case 1:a[s++]=i[r|u>>4],r=(15&u)<<2,c=2;break;case 2:a[s++]=i[r|u>>6],a[s++]=i[63&u],c=0}s>8191&&((o||(o=[])).push(String.fromCharCode.apply(String,a)),s=0)}return c&&(a[s++]=i[r],a[s++]=61,1===c&&(a[s++]=61)),o?(s&&o.push(String.fromCharCode.apply(String,a.slice(0,s))),o.join("")):String.fromCharCode.apply(String,a.slice(0,s))},r.decode=function(e,t,n){for(var r,i=n,a=0,s=0;s<e.length;){var c=e.charCodeAt(s++);if(61===c&&a>1)break;if(void 0===(c=o[c]))throw Error("invalid encoding");switch(a){case 0:r=c,a=1;break;case 1:t[n++]=r<<2|(48&c)>>4,r=c,a=2;break;case 2:t[n++]=(15&r)<<4|(60&c)>>2,r=c,a=3;break;case 3:t[n++]=(3&r)<<6|c,a=0}}if(1===a)throw Error("invalid encoding");return n-i},r.test=function(e){return/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(e)}},function(e,t,n){"use strict";function r(){this._listeners={}}e.exports=r,r.prototype.on=function(e,t,n){return(this._listeners[e]||(this._listeners[e]=[])).push({fn:t,ctx:n||this}),this},r.prototype.off=function(e,t){if(void 0===e)this._listeners={};else if(void 0===t)this._listeners[e]=[];else for(var n=this._listeners[e],r=0;r<n.length;)n[r].fn===t?n.splice(r,1):++r;return this},r.prototype.emit=function(e){var t=this._listeners[e];if(t){for(var n=[],r=1;r<arguments.length;)n.push(arguments[r++]);for(r=0;r<t.length;)t[r].fn.apply(t[r++].ctx,n)}return this}},function(e,t,n){"use strict";function r(e){return"undefined"!=typeof Float32Array?function(){var t=new Float32Array([-0]),n=new Uint8Array(t.buffer),r=128===n[3];function i(e,r,i){t[0]=e,r[i]=n[0],r[i+1]=n[1],r[i+2]=n[2],r[i+3]=n[3]}function o(e,r,i){t[0]=e,r[i]=n[3],r[i+1]=n[2],r[i+2]=n[1],r[i+3]=n[0]}function a(e,r){return n[0]=e[r],n[1]=e[r+1],n[2]=e[r+2],n[3]=e[r+3],t[0]}function s(e,r){return n[3]=e[r],n[2]=e[r+1],n[1]=e[r+2],n[0]=e[r+3],t[0]}e.writeFloatLE=r?i:o,e.writeFloatBE=r?o:i,e.readFloatLE=r?a:s,e.readFloatBE=r?s:a}():function(){function t(e,t,n,r){var i=t<0?1:0;if(i&&(t=-t),0===t)e(1/t>0?0:2147483648,n,r);else if(isNaN(t))e(2143289344,n,r);else if(t>34028234663852886e22)e((i<<31|2139095040)>>>0,n,r);else if(t<11754943508222875e-54)e((i<<31|Math.round(t/1401298464324817e-60))>>>0,n,r);else{var o=Math.floor(Math.log(t)/Math.LN2);e((i<<31|o+127<<23|8388607&Math.round(t*Math.pow(2,-o)*8388608))>>>0,n,r)}}function n(e,t,n){var r=e(t,n),i=2*(r>>31)+1,o=r>>>23&255,a=8388607&r;return 255===o?a?NaN:i*(1/0):0===o?1401298464324817e-60*i*a:i*Math.pow(2,o-150)*(a+8388608)}e.writeFloatLE=t.bind(null,i),e.writeFloatBE=t.bind(null,o),e.readFloatLE=n.bind(null,a),e.readFloatBE=n.bind(null,s)}(),"undefined"!=typeof Float64Array?function(){var t=new Float64Array([-0]),n=new Uint8Array(t.buffer),r=128===n[7];function i(e,r,i){t[0]=e,r[i]=n[0],r[i+1]=n[1],r[i+2]=n[2],r[i+3]=n[3],r[i+4]=n[4],r[i+5]=n[5],r[i+6]=n[6],r[i+7]=n[7]}function o(e,r,i){t[0]=e,r[i]=n[7],r[i+1]=n[6],r[i+2]=n[5],r[i+3]=n[4],r[i+4]=n[3],r[i+5]=n[2],r[i+6]=n[1],r[i+7]=n[0]}function a(e,r){return n[0]=e[r],n[1]=e[r+1],n[2]=e[r+2],n[3]=e[r+3],n[4]=e[r+4],n[5]=e[r+5],n[6]=e[r+6],n[7]=e[r+7],t[0]}function s(e,r){return n[7]=e[r],n[6]=e[r+1],n[5]=e[r+2],n[4]=e[r+3],n[3]=e[r+4],n[2]=e[r+5],n[1]=e[r+6],n[0]=e[r+7],t[0]}e.writeDoubleLE=r?i:o,e.writeDoubleBE=r?o:i,e.readDoubleLE=r?a:s,e.readDoubleBE=r?s:a}():function(){function t(e,t,n,r,i,o){var a=r<0?1:0;if(a&&(r=-r),0===r)e(0,i,o+t),e(1/r>0?0:2147483648,i,o+n);else if(isNaN(r))e(0,i,o+t),e(2146959360,i,o+n);else if(r>17976931348623157e292)e(0,i,o+t),e((a<<31|2146435072)>>>0,i,o+n);else{var s;if(r<22250738585072014e-324)e((s=r/5e-324)>>>0,i,o+t),e((a<<31|s/4294967296)>>>0,i,o+n);else{var c=Math.floor(Math.log(r)/Math.LN2);1024===c&&(c=1023),e(4503599627370496*(s=r*Math.pow(2,-c))>>>0,i,o+t),e((a<<31|c+1023<<20|1048576*s&1048575)>>>0,i,o+n)}}}function n(e,t,n,r,i){var o=e(r,i+t),a=e(r,i+n),s=2*(a>>31)+1,c=a>>>20&2047,u=4294967296*(1048575&a)+o;return 2047===c?u?NaN:s*(1/0):0===c?5e-324*s*u:s*Math.pow(2,c-1075)*(u+4503599627370496)}e.writeDoubleLE=t.bind(null,i,0,4),e.writeDoubleBE=t.bind(null,o,4,0),e.readDoubleLE=n.bind(null,a,0,4),e.readDoubleBE=n.bind(null,s,4,0)}(),e}function i(e,t,n){t[n]=255&e,t[n+1]=e>>>8&255,t[n+2]=e>>>16&255,t[n+3]=e>>>24}function o(e,t,n){t[n]=e>>>24,t[n+1]=e>>>16&255,t[n+2]=e>>>8&255,t[n+3]=255&e}function a(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16|e[t+3]<<24)>>>0}function s(e,t){return(e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3])>>>0}e.exports=r(r)},function(module,exports,__webpack_require__){"use strict";function inquire(moduleName){try{var mod=eval("quire".replace(/^/,"re"))(moduleName);if(mod&&(mod.length||Object.keys(mod).length))return mod}catch(e){}return null}module.exports=inquire},function(e,t,n){"use strict";var r=t;r.length=function(e){for(var t=0,n=0,r=0;r<e.length;++r)(n=e.charCodeAt(r))<128?t+=1:n<2048?t+=2:55296==(64512&n)&&56320==(64512&e.charCodeAt(r+1))?(++r,t+=4):t+=3;return t},r.read=function(e,t,n){if(n-t<1)return"";for(var r,i=null,o=[],a=0;t<n;)(r=e[t++])<128?o[a++]=r:r>191&&r<224?o[a++]=(31&r)<<6|63&e[t++]:r>239&&r<365?(r=((7&r)<<18|(63&e[t++])<<12|(63&e[t++])<<6|63&e[t++])-65536,o[a++]=55296+(r>>10),o[a++]=56320+(1023&r)):o[a++]=(15&r)<<12|(63&e[t++])<<6|63&e[t++],a>8191&&((i||(i=[])).push(String.fromCharCode.apply(String,o)),a=0);return i?(a&&i.push(String.fromCharCode.apply(String,o.slice(0,a))),i.join("")):String.fromCharCode.apply(String,o.slice(0,a))},r.write=function(e,t,n){for(var r,i,o=n,a=0;a<e.length;++a)(r=e.charCodeAt(a))<128?t[n++]=r:r<2048?(t[n++]=r>>6|192,t[n++]=63&r|128):55296==(64512&r)&&56320==(64512&(i=e.charCodeAt(a+1)))?(r=65536+((1023&r)<<10)+(1023&i),++a,t[n++]=r>>18|240,t[n++]=r>>12&63|128,t[n++]=r>>6&63|128,t[n++]=63&r|128):(t[n++]=r>>12|224,t[n++]=r>>6&63|128,t[n++]=63&r|128);return n-o}},function(e,t,n){"use strict";e.exports=function(e,t,n){var r=n||8192,i=r>>>1,o=null,a=r;return function(n){if(n<1||n>i)return e(n);a+n>r&&(o=e(r),a=0);var s=t.call(o,a,a+=n);return 7&a&&(a=1+(7|a)),s}}},function(e,t,n){"use strict";e.exports=i;var r=n(7);function i(e,t){this.lo=e>>>0,this.hi=t>>>0}var o=i.zero=new i(0,0);o.toNumber=function(){return 0},o.zzEncode=o.zzDecode=function(){return this},o.length=function(){return 1};var a=i.zeroHash="\0\0\0\0\0\0\0\0";i.fromNumber=function(e){if(0===e)return o;var t=e<0;t&&(e=-e);var n=e>>>0,r=(e-n)/4294967296>>>0;return t&&(r=~r>>>0,n=~n>>>0,++n>4294967295&&(n=0,++r>4294967295&&(r=0))),new i(n,r)},i.from=function(e){if("number"==typeof e)return i.fromNumber(e);if(r.isString(e)){if(!r.Long)return i.fromNumber(parseInt(e,10));e=r.Long.fromString(e)}return e.low||e.high?new i(e.low>>>0,e.high>>>0):o},i.prototype.toNumber=function(e){if(!e&&this.hi>>>31){var t=1+~this.lo>>>0,n=~this.hi>>>0;return t||(n=n+1>>>0),-(t+4294967296*n)}return this.lo+4294967296*this.hi},i.prototype.toLong=function(e){return r.Long?new r.Long(0|this.lo,0|this.hi,Boolean(e)):{low:0|this.lo,high:0|this.hi,unsigned:Boolean(e)}};var s=String.prototype.charCodeAt;i.fromHash=function(e){return e===a?o:new i((s.call(e,0)|s.call(e,1)<<8|s.call(e,2)<<16|s.call(e,3)<<24)>>>0,(s.call(e,4)|s.call(e,5)<<8|s.call(e,6)<<16|s.call(e,7)<<24)>>>0)},i.prototype.toHash=function(){return String.fromCharCode(255&this.lo,this.lo>>>8&255,this.lo>>>16&255,this.lo>>>24,255&this.hi,this.hi>>>8&255,this.hi>>>16&255,this.hi>>>24)},i.prototype.zzEncode=function(){var e=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^e)>>>0,this.lo=(this.lo<<1^e)>>>0,this},i.prototype.zzDecode=function(){var e=-(1&this.lo);return this.lo=((this.lo>>>1|this.hi<<31)^e)>>>0,this.hi=(this.hi>>>1^e)>>>0,this},i.prototype.length=function(){var e=this.lo,t=(this.lo>>>28|this.hi<<4)>>>0,n=this.hi>>>24;return 0===n?0===t?e<16384?e<128?1:2:e<2097152?3:4:t<16384?t<128?5:6:t<2097152?7:8:n<128?9:10}},function(e,t,n){"use strict";e.exports=o;var r=n(18);(o.prototype=Object.create(r.prototype)).constructor=o;var i=n(7);function o(){r.call(this)}function a(e,t,n){e.length<40?i.utf8.write(e,t,n):t.utf8Write?t.utf8Write(e,n):t.write(e,n)}o._configure=function(){o.alloc=i._Buffer_allocUnsafe,o.writeBytesBuffer=i.Buffer&&i.Buffer.prototype instanceof Uint8Array&&"set"===i.Buffer.prototype.set.name?function(e,t,n){t.set(e,n)}:function(e,t,n){if(e.copy)e.copy(t,n,0,e.length);else for(var r=0;r<e.length;)t[n++]=e[r++]}},o.prototype.bytes=function(e){i.isString(e)&&(e=i._Buffer_from(e,"base64"));var t=e.length>>>0;return this.uint32(t),t&&this._push(o.writeBytesBuffer,t,e),this},o.prototype.string=function(e){var t=i.Buffer.byteLength(e);return this.uint32(t),t&&this._push(a,t,e),this},o._configure()},function(e,t,n){"use strict";e.exports=o;var r=n(19);(o.prototype=Object.create(r.prototype)).constructor=o;var i=n(7);function o(e){r.call(this,e)}o._configure=function(){i.Buffer&&(o.prototype._slice=i.Buffer.prototype.slice)},o.prototype.string=function(){var e=this.uint32();return this.buf.utf8Slice?this.buf.utf8Slice(this.pos,this.pos=Math.min(this.pos+e,this.len)):this.buf.toString("utf-8",this.pos,this.pos=Math.min(this.pos+e,this.len))},o._configure()},function(e,t,n){"use strict";t.Service=n(52)},function(e,t,n){"use strict";e.exports=i;var r=n(7);function i(e,t,n){if("function"!=typeof e)throw TypeError("rpcImpl must be a function");r.EventEmitter.call(this),this.rpcImpl=e,this.requestDelimited=Boolean(t),this.responseDelimited=Boolean(n)}(i.prototype=Object.create(r.EventEmitter.prototype)).constructor=i,i.prototype.rpcCall=function e(t,n,i,o,a){if(!o)throw TypeError("request must be specified");var s=this;if(!a)return r.asPromise(e,s,t,n,i,o);if(s.rpcImpl)try{return s.rpcImpl(t,n[s.requestDelimited?"encodeDelimited":"encode"](o).finish(),(function(e,n){if(e)return s.emit("error",e,t),a(e);if(null!==n){if(!(n instanceof i))try{n=i[s.responseDelimited?"decodeDelimited":"decode"](n)}catch(e){return s.emit("error",e,t),a(e)}return s.emit("data",n,t),a(null,n)}s.end(!0)}))}catch(e){return s.emit("error",e,t),void setTimeout((function(){a(e)}),0)}else setTimeout((function(){a(Error("already ended"))}),0)},i.prototype.end=function(e){return this.rpcImpl&&(e||this.rpcImpl(null,null,null),this.rpcImpl=null,this.emit("end").off()),this}},function(e,t,n){"use strict";e.exports={}},function(e,t,n){"use strict";n.r(t);var r=n(2),i=n.n(r),o=n(3),a=n.n(o),s=n(4),c=n(5),u=n(8),l=n.n(u),d=n(12),f=n.n(d),h=n(1),p=function(e){return e=e||Object.create(null),{on:function(t,n){(e[t]||(e[t]=[])).push(n)},off:function(t,n){e[t]&&e[t].splice(e[t].indexOf(n)>>>0,1)},emit:function(t,n){(e[t]||[]).slice().map((function(e){e(n)})),(e["*"]||[]).slice().map((function(e){e(t,n)}))}}},_=(n(31),n(21)),v=n.n(_),g=n(11),b=n.n(g),m="success",y="fail",E=function(){function e(){i()(this,e),this.vid=T().vid,this.url="https://report-ad.agoralab.co/v1/report",this.sdk_version=c.SDK_VERSION,this.onlineTimer=null}return a()(e,[{key:"onlineUser",value:function(){var e=this;this.onlineTimer=setInterval((function(){e.report("online_user")}),2e4)}},{key:"destroy",value:function(){null!==this.onlineTimer&&clearInterval(this.onlineTimer)}},{key:"report",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",i=Date.now(),o={pts:[{m:"online_user"===e?"online_user":"event",ls:{vid:this.vid,version:this.sdk_version},vs:{count:1}}],sign:b()("src=miniapp&ts=".concat(i)),src:"miniapp",ts:i};if("online_user"!==e){var a={event:e,result:"success"===t?"1":"0",err_code:n.toString()};"pusher_state_change"!==e&&"player_state_change"!==e||void 0!==r&&("string"==typeof r?a.message=r:(a.wx_version=r.version,a.user_mobile_model=r.model,a.user_IP=r.ip,a.system=r.system)),v()(o.pts[0].ls,a)}return this.request({body:o,url:this.url})}},{key:"request",value:function(e){return new Promise((function(t,n){wx.request({url:e.url,data:e.body,header:{"content-type":"application/json"},method:"POST",success:function(e){h.default.info("weixin request report success"),200===e.statusCode?(h.default.info("response success"),t(e)):h.default.info("response fail: ".concat(e.statusCode))},fail:function(e){h.default.warn("weixin request report fail"),n(e)}})}))}}]),e}(),w={};function T(){return w}var R=["https://uap-ap-web-1.agora.io/api/v1","https://uap-ap-web-3.agora.io/api/v1","https://uap-ap-web-2.agoraio.cn/api/v1","https://uap-ap-web-4.agoraio.cn/api/v1"],S=function(e){var t=e.reportManager,n=e.grafanaReport,r={command:"convergeAllocateEdge",sid:e.sid,appId:e.appId,token:e.appId,uid:e.uid+"",cname:e.channel,ts:Math.floor(Date.now()/1e3),version:c.VERSION,seq:0,requestId:1};return new Promise((function(i,o){var a=0,s=function(n,r){try{t.report("chooseServer",{header:{sid:e.sid,cname:e.channel,uid:e.uid,success:!1},body:{csurl:r,ec:JSON.stringify(n)}})}catch(e){}4===++a&&o(n)},c=function(o){var a=R[o];wx.request({url:a,data:{service_name:"miniapp",json_body:JSON.stringify(r)},header:{"content-type":"application/json","X-Packet-URI":61,"X-Packet-Service-Type":0},method:"POST",success:function(r){var o,c,u=r.data;if(h.default.debug("From choose server",r),r.profile){var l=r.profile.peerIP;o=l,w.ip=o}else h.default.debug("skip user IP report!");if(200!==r.statusCode){s({code:901,reason:u.error||"choose server fail"},a);try{n.report("chooseServer",y,r.statusCode)}catch(e){}}else{var d=JSON.parse(u.json_body),f=d.vid;c=f,w.vid=c;var p=function(e){if(void 0!==e)return e.map((function(e){var t=e.address.split("."),n=t.length;return"wss://miniapp.agoraio.cn/".concat(t[n-4],"-").concat(t[n-3],"-").concat(t[n-2],"-").concat(t[n-1],"/api")}));h.default.error("miniapp service is not enabled for this AppID")}(d.servers);t.report("chooseServer",{header:{sid:e.sid,cname:e.channel,uid:e.uid,success:!0},body:{csurl:a,gatewaylist:p}});try{n.report("chooseServer",m)}catch(e){}i({serverlist:p,url:a})}},fail:function(e){s({code:901,reason:e.errMsg||"choose server fail"},a)}})};R.map((function(e,t){c(t)}))}))},I=function(){function e(t,n){i()(this,e),this.serverlist=[],this.option=t,this.index=0,this.isInit=!0,this.state="disconnected",this.hasInvokeClose=!1,this.emitter=n,this.on=this.emitter.on,this.off=this.emitter.off,this.emit=this.emitter.emit}return a()(e,[{key:"connect",value:function(){var e=this;"disconnected"!==this.state&&this.close(),S(this.option).then((function(t){var n=t.serverlist,r=t.url;h.default.debug("Get server list from "+r),e.index=0,e.serverlist=n,e.option&&e.option.servers&&(e.serverlist=e.option.servers),h.default.debug("Connect server with list: ",e.serverlist),e.connectWorker(e.serverlist[e.index])})).catch((function(t){e.emit&&e.emit("socketError",t)}))}},{key:"connectWorker",value:function(){var e=this;this.state="connecting";var t=this.serverlist[this.index];h.default.debug("Connect server: ",t);var n=this.option,r=n.sid,i=n.channel,o=n.uid,a=n.reportManager,s=n.grafanaReport;this.ws=wx.connectSocket({url:t,complete:function(e){return h.default.debug("wxSocket: complete: ",e)},fail:function(e){h.default.debug("wxSocket: fail: ",e),a&&a.report("connectWebSocket",{header:{sid:r,cname:i,uid:o,success:!1},body:{wsurl:t,ec:JSON.stringify(e)}}),s&&s.report("connectWebSocket",y,e.statusCode)},success:function(e){h.default.debug("wxSocket success: ",e),a&&a.report("connectWebSocket",{header:{sid:r,cname:i,uid:o,success:!0},body:{wsurl:t}}),s&&s.report("connectWebSocket",m)}}),this.ws.onOpen(this._onopen.bind(this)),this.ws.onMessage(this._onmessage.bind(this)),this.establishWSTimeoutTimer=setTimeout((function(){"connected"!==e.state&&e.connectNextWorker()}),5e3)}},{key:"connectNextWorker",value:function(){"disconnected"!==this.state&&this.close(),h.default.debug(this.index,this.serverlist.length),this.index>=this.serverlist.length-1?this.emit&&this.emit("socketError",{code:905,reason:"connect websocket failed",wsurl:JSON.stringify(this.serverlist)}):(this.index++,this.connectWorker())}},{key:"_onopen",value:function(){h.default.info("websocket onopen"),clearTimeout(this.establishWSTimeoutTimer),this.state="connected",this.isInit=!1,this.hasInvokeClose?h.default.debug("Alread invoke ws.Close, will not throw onopen event"):(this.ws.onClose(this._onclose.bind(this)),this.emit&&this.emit("onopen"))}},{key:"_onclose",value:function(e){h.default.info("websocket onclose:"+JSON.stringify(e)),this.emitter.emit("_wsClose"),clearTimeout(this.establishWSTimeoutTimer),this.state="disconnected",e&&"close"==e.reason||this.hasInvokeClose||(this.isInit?this.connectNextWorker():this.emit&&this.emit("onclose"))}},{key:"_onmessage",value:function(e){this.hasInvokeClose||(h.default.blind("receive message: ",JSON.stringify(e)),this.isConnected()&&this.emit&&this.emit("onmessage",e))}},{key:"isConnected",value:function(){return"connected"===this.state}},{key:"sendMessage",value:function(e){h.default.blind("send message: ",e),this.isConnected()&&this.ws&&this.ws.send({data:e})}},{key:"_checkServerList",value:function(e){return e instanceof Array!=0&&0!=e.length}},{key:"destroy",value:function(e){var t=this;"disconnected"!==this.state&&this.close(),this.on("_wsClose",(function n(){t.off("_wsClose",n),t.serverlist=null,t.ws=null,t.emitter=null,t.on=null,t.off=null,t.emit=null,e&&e()}))}},{key:"close",value:function(){h.default.debug("Close websocket"),clearTimeout(this.establishWSTimeoutTimer),this.hasInvokeClose=!0,this.state="disconnected",this.ws&&this.ws.close({reason:"close"}),this.ws=null}}]),e}(),O=function(){function e(t){i()(this,e),this.appId=t.appId,this.channel=t.channel,this.uid=t.uid+"",this.sid=t.sid,this.seq=1,this.requestId=2}return a()(e,[{key:"setSid",value:function(e){this.sid=e}},{key:"_getWorkerManagerMsg",value:function(){return{appId:this.appId,cname:this.channel,uid:this.uid,sid:this.sid,sdkVersion:c.VERSION,seq:++this.seq,requestId:++this.requestId,ts:Math.floor(Date.now()/1e3)}}},{key:"send",value:function(e){var t=this._getWorkerManagerMsg();return t.clientRequest=e,t}},{key:"updatePushUrl",value:function(){var e=this._getWorkerManagerMsg();return e.clientRequest={action:"update_url",role:"publish",uid:+this.uid},e}},{key:"ping",value:function(){return{command:"ping",requestId:++this.requestId,appId:this.appId,cname:this.channel,uid:this.uid+"",sid:this.sid,ts:Math.floor(Date.now()/1e3)}}},{key:"ping2",value:function(){var e=this._getWorkerManagerMsg();return e.clientRequest={action:"ping"},e}},{key:"setRole",value:function(e){var t=this._getWorkerManagerMsg();return t.clientRequest={action:"set_role",role:e},t}},{key:"rejoin",value:function(e,t,n,r,i,o){var a=this._getWorkerManagerMsg();return a.clientRequest={action:"join",role:o,appId:e,key_vocs:r||e,key_vos:r||e,channel_name:t,uid:n+"",known_speakers:i,clientType:"undefined"==typeof qq?"wechat":"qq"},a}},{key:"join",value:function(e,t,n,r,i,o,a){var s=this._getWorkerManagerMsg();return s.clientRequest={action:"join",role:i,appId:e,key_vocs:r||e,key_vos:r||e,channel_name:t,uid:n+"",vid:T().vid.toString(),device:o,os:a,version:c.SDK_VERSION,clientType:"undefined"==typeof qq?"wechat":"qq"},s}},{key:"muteLocal",value:function(e,t){var n=this._getWorkerManagerMsg();return n.clientRequest={action:"mute_local",uid:+e,target:t,mute:!0},n}},{key:"unmuteLocal",value:function(e,t){var n=this._getWorkerManagerMsg();return n.clientRequest={action:"mute_local",uid:+e,target:t,mute:!1},n}},{key:"mute",value:function(e,t){var n=this._getWorkerManagerMsg();return n.clientRequest={action:"mute",uid:+e,target:t},n}},{key:"unmute",value:function(e,t){var n=this._getWorkerManagerMsg();return n.clientRequest={action:"unmute",uid:+e,target:t},n}},{key:"publish",value:function(e){var t=this._getWorkerManagerMsg();return t.clientRequest={action:"publish",uid:+e},t}},{key:"unpublish",value:function(e){var t=this._getWorkerManagerMsg();return t.clientRequest={action:"unpublish",uid:+e},t}},{key:"subscribe",value:function(e,t){var n=this._getWorkerManagerMsg();return n.clientRequest={action:"subscribe",uid:+e,options:{audio:t.audio,video:t.video}},n}},{key:"unsubscribe",value:function(e){var t=this._getWorkerManagerMsg();return t.clientRequest={action:"unsubscribe",uid:[+e]},t}},{key:"setRemoteVideoStreamType",value:function(e,t){var n=this._getWorkerManagerMsg();return n.clientRequest={action:"set_remote_stream_type",uid:+e,type:t},n}},{key:"renewToken",value:function(e){var t=this._getWorkerManagerMsg();return t.clientRequest={action:"update_key",key_vos:e},t}},{key:"leave",value:function(e){var t=this._getWorkerManagerMsg();return t.clientRequest={action:"leave",uid:+e},t}}]),e}(),A=n(0),C=n.n(A),k=function(){function e(t,n){i()(this,e),this.appId=t.appId,this.channel=t.channel,this.uid=t.uid,this.sid=t.sid,this.role=t.role,this.channelKey=t.channelKey,this.clientId="client",this.option=t,this.timers=new Set,this.reportManager=t.reportManager,this.grafanaReport=t.grafanaReport,this.clientEmitter=n,this.emitter=new p,this.on=this.emitter.on,this.off=this.emitter.off,this.emit=this.emitter.emit,this.join=this.join.bind(this),this.msgManager=new O(t)}var t,n,r;return a()(e,[{key:"connect",value:function(){var e=this;return new Promise((function(t,n){e.ws=new I(e.option,e.emitter),e.ws.connect(),e.on("onmessage",e._onMessage.bind(e)),e.on("socketError",n),e.on("onopen",(function n(){e.off&&e.off("onopen",n),e._ping(),t()})),e.on("onclose",(function(){return e.clientEmitter.emit("error",{code:904,reason:"websocket disconnected"})}))}))}},{key:"_onMessage",value:function(e){if(e&&e.data){var t=JSON.parse(e.data);if(t&&"pong"!==t.command){h.default.debug("worker message: ",t),h.default.debug("code message:",t);try{this.reportManager.report("serverEvent",{header:{sid:this.sid,cname:this.channel,uid:this.uid,success:!0},body:{action:"serverEvent",details:t,req_ts:+new Date}})}catch(e){}}if(t.requestId&&this.emit(t.requestId,t),"serverStatus"===t.command){if(t.code&&200!==t.code){if(503===t.code)return;this.clientEmitter.emit("error",{code:t.code,reason:t.reason||"server error"})}if(t.serverStatus){h.default.info("Receive message from server: ".concat(JSON.stringify(t.serverStatus)));var n=t.serverStatus.action;if("audio-mute"==n)return t.serverStatus.mute?this.clientEmitter.emit("mute-audio",{uid:t.serverStatus.uid}):this.clientEmitter.emit("unmute-audio",{uid:t.serverStatus.uid});if("video-mute"==n)return t.serverStatus.mute?this.clientEmitter.emit("mute-video",{uid:t.serverStatus.uid}):this.clientEmitter.emit("unmute-video",{uid:t.serverStatus.uid});if("key-expired"===n)return this.clientEmitter.emit("token-privilege-did-expire");if("key-will-expire"===n)return this.clientEmitter.emit("token-privilege-will-expire");this.clientEmitter.emit(n,t.serverStatus)}}}}},{key:"_sendMessage",value:function(e){var t=this;if(this.ws)return new Promise((function(n,r){if(!t.isWSConnected())return r({code:904,reason:"websocket disconnected",wsurl:t.getWSUrl()});"ping"!==e.command&&h.default.debug("send to woker: ",e);var i,o=e?e.requestId:null,a=function e(a){if(t.ws)return t.off(o,e),clearTimeout(i),t.timers.delete(i),200==a.code?n(a.serverResponse):r({code:a.code,reason:a.msg||a.reason,serverResponse:a.serverResponse,wsurl:t.getWSUrl()})};if(!o)return r({code:902,reason:"no requestid"});t.ws.sendMessage(JSON.stringify(e)),t.on(o,a),i=setTimeout((function(){return a({code:903,reason:"time out"})}),1e4),t.timers.add(i)}))}},{key:"_ping",value:function(){var e=this;this.pingTimer=setInterval((function(){e.ws.sendMessage(JSON.stringify(e.msgManager.ping()))}),3e3)}},{key:"setRole",value:function(e){return this._sendMessage(this.msgManager.setRole(e))}},{key:"rejoin",value:function(e){return this._sendMessage(this.msgManager.rejoin(this.appId,this.channel,this.uid,this.channelKey,e,this.role))}},{key:"join",value:function(e,t){return this._sendMessage(this.msgManager.join(this.appId,this.channel,this.uid,this.channelKey,this.role,e,t))}},{key:"send",value:function(e){return this._sendMessage(this.msgManager.send(e))}},{key:"updatePushUrl",value:function(){return this._sendMessage(this.msgManager.updatePushUrl())}},{key:"publish",value:function(){return this._sendMessage(this.msgManager.publish(this.uid))}},{key:"unpublish",value:function(){return this._sendMessage(this.msgManager.unpublish(this.uid))}},{key:"subscribe",value:function(e,t){return this._sendMessage(this.msgManager.subscribe(e,t))}},{key:"unsubscribe",value:function(e){return this._sendMessage(this.msgManager.unsubscribe(e))}},{key:"setRemoteVideoStreamType",value:function(e,t){return this._sendMessage(this.msgManager.setRemoteVideoStreamType(e,t))}},{key:"mute",value:function(e,t){return this._sendMessage(this.msgManager.mute(e,t))}},{key:"unmute",value:function(e,t){return this._sendMessage(this.msgManager.unmute(e,t))}},{key:"muteLocal",value:function(e){return this._sendMessage(this.msgManager.muteLocal(this.uid,e))}},{key:"unmuteLocal",value:function(e){return this._sendMessage(this.msgManager.unmuteLocal(this.uid,e))}},{key:"renewToken",value:function(e){return this._sendMessage(this.msgManager.renewToken(e))}},{key:"leave",value:function(){return this._sendMessage(this.msgManager.leave(this.uid))}},{key:"isWSConnected",value:function(){return!!this.ws&&this.ws.isConnected()}},{key:"getWSUrl",value:function(){return this.ws.serverlist[this.ws.index]}},{key:"destroy",value:function(e){var t=this;clearInterval(this.pingTimer),this.timers.forEach((function(e){clearInterval(e)})),this.timers=null,this.ws&&this.ws.destroy((function(){t.ws=null,t.emitter=null,t.on=null,t.off=null,t.emit=null,e&&e()}))}},{key:"startChannelMediaRelay",value:(r=f()(l.a.mark((function e(t){var n,r,i,o,a,s=this;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.channelMediaRelayController){e.next=2;break}throw new A.ChannelMediaError("RELAY_ALREADY_START","",A.CHANNEL_MEDIA_RELAY_ERROR.RELAY_ALREADY_START);case 2:return n=function(e){s.clientEmitter.emit({type:"channel-media-relay-event",code:e})},r=function(e,t,n){e===A.CHANNEL_MEDIA_RELAY_STATE.RELAY_STATE_FAILURE&&t===A.CHANNEL_MEDIA_RELAY_ERROR.SERVER_CONNECTION_LOST&&(s.channelMediaRelayController.dispose(),s.channelMediaRelayController=null),s.clientEmitter.emit({type:"channel-media-relay-state",state:e,code:t,data:n})},i={token:this.appId,appId:this.appId,cname:this.channel,uid:this.uid,sid:this.sid,clientId:this.clientId},this.channelMediaRelayController=new C.a(i,this.clientId),this.channelMediaRelayController.on("event",n),this.channelMediaRelayController.on("state",r),e.prev=8,e.next=11,this.channelMediaRelayController.startChannelMediaRelay(t);case 11:e.next=23;break;case 13:throw e.prev=13,e.t0=e.catch(8),h.default.debug("[".concat(this.clientId,"] startChannelMediaRelay exception: ").concat(JSON.stringify(e.t0))),o=A.CHANNEL_MEDIA_RELAY_STATE.RELAY_STATE_FAILURE,a="",a=e.t0 instanceof A.ChannelMediaError?"SetSourceChannelStatus"===e.t0.data||e.t0.data&&e.t0.data.serverResponse&&"SetSourceChannel"===e.t0.data.serverResponse.command?"FAILED_JOIN_SRC":"SetDestChannelStatus"===e.t0.data||e.t0.data&&e.t0.data.serverResponse&&"SetDestChannel"===e.t0.data.serverResponse.command?"FAILED_JOIN_DEST":e.t0.data&&e.t0.data.serverResponse&&"StartPacketTransfer"===e.t0.data.serverResponse.command?"FAILED_PACKET_SENT_TO_DEST":e.t0.message===A.CHANNEL_MEDIA_ERROR.REQUEST_TIMEOUT||e.t0.message===A.CHANNEL_MEDIA_ERROR.WAIT_STATUS_TIMEOUT?"SERVER_NO_RESPONSE":e.t0.message===A.CHANNEL_MEDIA_ERROR.REQUEST_FAILED||e.t0.message===A.CHANNEL_MEDIA_ERROR.WAIT_STATUS_ERROR?"SERVER_ERROR_RESPONSE":e.t0.message===A.CHANNEL_MEDIA_ERROR.AP_REQUEST_TIMEOUT?"NO_RESOURCE_AVAILABLE":e.t0.message===A.CHANNEL_MEDIA_ERROR.WS_ABORT||e.t0.message===A.CHANNEL_MEDIA_ERROR.AP_REQUEST_ABORT?"OPERATION_ABORT":"INTERNAL_ERROR":"INTERNAL_ERROR",this.clientEmitter.emit({type:"channel-media-relay-state",state:o,code:A.CHANNEL_MEDIA_RELAY_ERROR[a]}),this.channelMediaRelayController&&(this.channelMediaRelayController.dispose(),this.channelMediaConfig=null,this.channelMediaRelayController=null),this.clientEmitter.emit({type:"channel-media-relay-state",state:A.CHANNEL_MEDIA_RELAY_STATE.RELAY_STATE_IDLE}),new A.ChannelMediaError(a,null,A.CHANNEL_MEDIA_RELAY_ERROR[a]);case 23:this.clientEmitter.emit({type:"channel-media-relay-state",state:A.CHANNEL_MEDIA_RELAY_STATE.RELAY_STATE_RUNNING,code:A.CHANNEL_MEDIA_RELAY_ERROR.RELAY_OK}),this.channelMediaConfig=t;case 25:case"end":return e.stop()}}),e,this,[[8,13]])}))),function(e){return r.apply(this,arguments)})},{key:"updateChannelMediaRelay",value:(n=f()(l.a.mark((function e(t){var n,r;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.channelMediaRelayController){e.next=2;break}throw new A.ChannelMediaError("RELAY_NOT_START",null,A.CHANNEL_MEDIA_RELAY_ERROR.RELAY_NOT_START);case 2:return e.prev=2,e.next=5,this.channelMediaRelayController.updateChannelMediaRelay(t);case 5:e.next=18;break;case 7:throw e.prev=7,e.t0=e.catch(2),h.default.debug("[".concat(this.clientId,"] updateChannelMediaRelay exception: ").concat(JSON.stringify(e.t0))),n=A.CHANNEL_MEDIA_RELAY_STATE.RELAY_STATE_FAILURE,r="",r=e.t0 instanceof A.ChannelMediaError?e.t0.message===A.CHANNEL_MEDIA_ERROR.REQUEST_TIMEOUT||e.t0.message===A.CHANNEL_MEDIA_ERROR.WAIT_STATUS_TIMEOUT?"SERVER_NO_RESPONSE":e.t0.message===A.CHANNEL_MEDIA_ERROR.REQUEST_FAILED||e.t0.message===A.CHANNEL_MEDIA_ERROR.WAIT_STATUS_ERROR?"SERVER_ERROR_RESPONSE":e.t0.message===A.CHANNEL_MEDIA_ERROR.WS_ABORT||e.t0.message===A.CHANNEL_MEDIA_ERROR.AP_REQUEST_ABORT?"OPERATION_ABORT":"INTERNAL_ERROR":"INTERNAL_ERROR",this.clientEmitter.emit({type:"channel-media-relay-event",code:A.CHANNEL_MEDIA_RELAY_EVENT.PACKET_UPDATE_DEST_CHANNEL_REFUSED}),this.clientEmitter.emit({type:"channel-media-relay-state",state:n,code:A.CHANNEL_MEDIA_RELAY_ERROR[r]}),this.channelMediaRelayController&&(this.channelMediaRelayController.dispose(),this.channelMediaConfig=null,this.channelMediaRelayController=null),this.clientEmitter.emit({type:"channel-media-relay-state",state:A.CHANNEL_MEDIA_RELAY_STATE.RELAY_STATE_IDLE}),new A.ChannelMediaError(r,null,A.CHANNEL_MEDIA_RELAY_ERROR[r]);case 18:this.channelMediaConfig=t;case 19:case"end":return e.stop()}}),e,this,[[2,7]])}))),function(e){return n.apply(this,arguments)})},{key:"stopChannelMediaRelay",value:(t=f()(l.a.mark((function e(){var t,n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.channelMediaRelayController){e.next=2;break}throw new A.ChannelMediaError("RELAY_NOT_START",null,A.CHANNEL_MEDIA_RELAY_ERROR.RELAY_NOT_START);case 2:return e.prev=2,e.next=5,this.channelMediaRelayController.stopChannelMediaRelay();case 5:e.next=17;break;case 7:throw e.prev=7,e.t0=e.catch(2),h.default.debug("[".concat(this.clientId,"] stopChannelMediaRelay exception: ").concat(JSON.stringify(e.t0))),t=A.CHANNEL_MEDIA_RELAY_STATE.RELAY_STATE_FAILURE,n="",n=e.t0 instanceof A.ChannelMediaError?e.t0.message===A.CHANNEL_MEDIA_ERROR.REQUEST_TIMEOUT||e.t0.message===A.CHANNEL_MEDIA_ERROR.WAIT_STATUS_TIMEOUT?"SERVER_NO_RESPONSE":e.t0.message===A.CHANNEL_MEDIA_ERROR.REQUEST_FAILED||e.t0.message===A.CHANNEL_MEDIA_ERROR.WAIT_STATUS_ERROR?"SERVER_ERROR_RESPONSE":"INTERNAL_ERROR":"INTERNAL_ERROR",this.clientEmitter.emit({type:"channel-media-relay-state",state:t,code:A.CHANNEL_MEDIA_RELAY_ERROR[n]}),this.channelMediaRelayController&&(this.channelMediaRelayController.dispose(),this.channelMediaConfig=null,this.channelMediaRelayController=null),this.emit({type:"channel-media-relay-state",state:A.CHANNEL_MEDIA_RELAY_STATE.RELAY_STATE_IDLE}),new A.ChannelMediaError(n,null,A.CHANNEL_MEDIA_RELAY_ERROR[n]);case 17:this.channelMediaConfig=null,this.channelMediaRelayController=null;case 19:case"end":return e.stop()}}),e,this,[[2,7]])}))),function(){return t.apply(this,arguments)})}]),e}(),N=n(37).ReportServiceClient,L=n(9).default,M=n(17).VosdkHeader,x=n(16),P=function(){function e(){i()(this,e),this.transport=new L.TXHRTransport("https://uni-webcollector.agora.io/report"),this.protocol=new L.TJSONProtocol(this.transport),this.client=new N(this.protocol),this.seqId=0,this._cache=[],this.isReporting=!1,this.retryCount=0}return a()(e,[{key:"generateHeader",value:function(e){if(e&&e.sid)return new M({sid:e.sid,cname:e.cname||"",lts:e.lts,elapse:e.lts-this.startTime,uid:e.uid,success:e.success})}},{key:"report",value:function(e,t){var n=null;if(t.header&&(t.header.lts=+new Date,"sessionStart"===e&&(this.startTime=t.header.lts),n=this.generateHeader(t.header)),t.body&&n){var r=t.body;switch(e){case"sessionStart":(i=new x({miniappSession:!0})).uri=8e3,i.miniappSession.header=n,i.miniappSession.appid=r.appId,i.miniappSession.uname=r.uname,i.miniappSession.ver=c.SDK_VERSION,i.miniappSession.dk=r.dk,i.miniappSession.details=JSON.stringify({seq:this.seqId++});break;case"chooseServer":(i=new x({miniappJoinChooseServer:!0})).uri=8001,i.miniappJoinChooseServer.header=n,i.miniappJoinChooseServer.csurl=r.csurl,i.miniappJoinChooseServer.ec=r.ec,i.miniappJoinChooseServer.gatewaylist=r.gatewaylist,i.miniappJoinChooseServer.details=JSON.stringify({seq:this.seqId++});break;case"connectWebSocket":(i=new x({miniappConnectWebSocket:!0})).uri=8002,i.miniappConnectWebSocket.header=n,i.miniappConnectWebSocket.ec=r.ec,i.miniappConnectWebSocket.wsurl=r.wsurl,i.miniappConnectWebSocket.details=JSON.stringify({seq:this.seqId++});break;case"join":(i=new x({miniappJoin:!0})).uri=8003,i.miniappJoin.header=n,i.miniappJoin.ec=r.ec,i.miniappJoin.isrejoin=r.isrejoin,i.miniappJoin.details=JSON.stringify({seq:this.seqId++,appId:r.appId,wsurl:r.wsurl});break;case"publish":(i=new x({miniappPublish:!0})).uri=8004,i.miniappPublish.header=n,i.miniappPublish.ec=r.ec,i.miniappPublish.pushurl=r.pushurl,i.miniappPublish.details=JSON.stringify({seq:this.seqId++});break;case"unpublish":(i=new x({miniappUnpublish:!0})).uri=8005,i.miniappUnpublish.header=n,i.miniappUnpublish.ec=r.ec,i.miniappUnpublish.details=JSON.stringify({seq:this.seqId++});break;case"subscribe":(i=new x({miniappSubscribe:!0})).uri=8006,i.miniappSubscribe.header=n,i.miniappSubscribe.ec=r.ec,i.miniappSubscribe.pullurl=r.pullurl,i.miniappSubscribe.peerid=r.peerid,i.miniappSubscribe.details=JSON.stringify({seq:this.seqId++});break;case"unsubscribe":(i=new x({miniappUnsubscribe:!0})).uri=8007,i.miniappUnsubscribe.header=n,i.miniappUnsubscribe.ec=r.ec,i.miniappUnsubscribe.peerid=r.peerid,i.miniappUnsubscribe.details=JSON.stringify({seq:this.seqId++});break;case"leave":(i=new x({miniappLeave:!0})).uri=8008,i.miniappLeave.header=n,i.miniappLeave.ec=r.ec,i.miniappLeave.details=JSON.stringify({seq:this.seqId++});break;case"pusherState":(i=new x({miniappPusherState:!0})).uri=8010,i.miniappPusherState.header=n,i.miniappPusherState.url=r.url,i.miniappPusherState.code=r.code,i.miniappPusherState.status=r.status,i.miniappPusherState.error=r.error,i.miniappPusherState.details=JSON.stringify({seq:this.seqId++});break;case"playerState":(i=new x({miniappPlayerState:!0})).uri=8011,i.miniappPlayerState.header=n,i.miniappPlayerState.url=r.url,i.miniappPlayerState.code=r.code,i.miniappPlayerState.status=r.status,i.miniappPlayerState.error=r.error,i.miniappPlayerState.details=JSON.stringify({seq:this.seqId++});break;case"serverEvent":(i=new x({miniappServerEvent:!0})).uri=8009,i.miniappServerEvent.header=n,i.miniappServerEvent.action=r.action,i.miniappServerEvent.details=JSON.stringify(r.details),i.miniappServerEvent.req_ts=r.req_ts}}if(this._cache.push(i),!this.isReporting&&this._cache.length>0){var i=this._cache.shift();this._report(i)}}},{key:"_report",value:function(e){var t=this;this.isReporting=!0,this.client.Report(e,(function(n){if(n){h.default.debug("Report failed: ",n,e);var r=t.retryCount++<2?200:1e4;setTimeout((function(){t._report(e)}),r)}else{h.default.debug("Report succcess: ",e);var i=t._cache.shift();i?t._report(i):t.isReporting=!1}}))}}]),e}(),D={videoBitrate:"Miniapp_SDK_Pusher_Video_Bitrate",audioBitrate:"Miniapp_SDK_Pusher_Audio_Bitrate",videoFPS:"Miniapp_SDK_Pusher_Video_FPS",videoGOP:"Miniapp_SDK_Pusher_Video_GOP",netSpeed:"Miniapp_SDK_Pusher_Net_Speed",videoCache:"Miniapp_SDK_Pusher_Video_Cache",audioCache:"Miniapp_SDK_Pusher_Audio_Cache",videoWidth:"Miniapp_SDK_Pusher_Video_Width",videoHeight:"Miniapp_SDK_Pusher_Video_Height"},$={videoBitrate:"Miniapp_SDK_Player_Video_Bitrate",audioBitrate:"Miniapp_SDK_Player_Audio_Bitrate",videoFPS:"Miniapp_SDK_Player_Video_FPS",videoGOP:"Miniapp_SDK_Player_Video_GOP",netSpeed:"Miniapp_SDK_Player_Video_Cache",videoCache:"Miniapp_SDK_Player_Video_Cache",audioCache:"Miniapp_SDK_Player_Audio_Cache",vDecCacheSize:"Miniapp_SDK_Player_V_Dec_Cache_Size",vSumCacheSize:"Miniapp_SDK_Player_V_Sum_Cache_Size",avPlayInterval:"Miniapp_SDK_Player_AV_Play_Interval",avRecvInterval:"Miniapp_SDK_Player_AV_Recv_Interval",audioCacheThreshold:"Miniapp_SDK_Player_Audio_Cache_Threshold",videoWidth:"Miniapp_SDK_Player_Video_Width",videoHeight:"Miniapp_SDK_Player_Video_Height"},U=n(23),j=n.n(U).a.io.agora.pb,F=j.CounterCompact,B=j.Id,G=(j.Item,function(){function e(){i()(this,e),this.url="https://rest-argus-ad.agoralab.co/v2/report",this.sid=Object(s.generateSessionId)(),this.pusherNet=null,this.playerNetMap={},this.pusherTimer=null,this.playerTimer=null,this.startPusherReport(),this.startPlayerReport()}return a()(e,[{key:"setPusherNetData",value:function(e){this.pusherNet=e}},{key:"setPlayerNetData",value:function(e,t){this.playerNetMap[e]=t}},{key:"getMessageTypeId",value:function(e){return B[e]}},{key:"shiftPb",value:function(e,t,n){var r=this,i=Date.now(),o=t.map((function(e){return{lts:i,id:r.getMessageTypeId(n[e.type]),value:e.value,tagErrorCode:6,streamId:0}})),a={sid:this.sid,peer:e,items:o},s=F.create(a);return F.encode(s).finish()}},{key:"startPusherReport",value:function(){var e=this;this.pusherTimer=setInterval((function(){if(e.pusherNet){var t=Object.keys(e.pusherNet).map((function(t){return void 0!==D[t]?{type:t,value:e.pusherNet[t]}:null}));t=t.filter((function(e){return null!==e}));var n=e.shiftPb(0,t,D);e.report(n)}}),6e3)}},{key:"startPlayerReport",value:function(){var e=this;this.playerTimer=setInterval((function(){if(e.playerNetMap){var t=function(t){var n=e.playerNetMap[t],r=Object.keys(n).map((function(e){return void 0!==$[e]?{type:e,value:n[e]}:null}));r=r.filter((function(e){return null!==e}));var i=e.shiftPb(t,r,$);e.report(i)};for(var n in e.playerNetMap)t(n)}e.playerNetMap={}}),6e3)}},{key:"destroy",value:function(){null!==this.pusherTimer&&clearInterval(this.pusherTimer),null!==this.playerTimer&&clearInterval(this.playerTimer),this.pusherNet=null,this.playerNet=null}},{key:"report",value:function(e){var t=Date.now();t=Math.floor(t/1e3);var n=wx.arrayBufferToBase64(e),r={id:1,payload:n,qos:1,sign:b()("payload=".concat(n,"&src=miniapp_sdk&ts=").concat(t)),src:"miniapp_sdk",ts:t};return this.request({body:r,url:this.url})}},{key:"request",value:function(e){return new Promise((function(t,n){wx.request({url:e.url,data:e.body,header:{"Content-Type":"application/json"},method:"POST",success:function(e){h.default.info("weixin request argus report success"),200===e.statusCode?(h.default.info("response success"),t(e)):h.default.info("response fail: ".concat(e.statusCode))},fail:function(e){h.default.warn("weixin request argus report fail"),n(e)}})}))}}]),e}()),q=n(6),V=function(){function e(t){var n=this;i()(this,e),this.emitter=new p,this.on=this.emitter.on,this.off=this.emitter.off,this.sid=Object(s.generateSessionId)(),this.pushUrl=null,this.playUrls=new Map,this.servers=t&&t.servers,this.reportManager=new P,this.role="broadcaster",this.grafanaReport=new E,this.argusReport=new G,this.systemInfo=null,this.emitter.on("stream-removed",(function(e){n.playUrls&&n.playUrls.delete(e.uid)}))}return a()(e,[{key:"init",value:function(e,t,n){if(!e||"string"!=typeof e||"null"===e.toLowerCase())throw Error("Invalid appId");this.appId=e.trim(),this.argusReport.sid=this.sid,this.grafanaReport.vid="",this.grafanaReport.onlineUser();try{this.systemInfo=wx.getSystemInfoSync()}catch(e){}this.reportManager.report("sessionStart",{header:{sid:this.sid,lts:+new Date,success:!0},body:{appId:e}}),t&&t()}},{key:"setRole",value:function(e,t,n){var r=this;if("broadcaster"===!e&&"audience"===!e)throw Error("Invalid role");this.role=e,this.worker&&this.worker.setRole(e).then((function(e){try{r.grafanaReport.report("set_role",m)}catch(e){}setTimeout((function(){if(!e)return t&&t();t&&t({updateURL:e["update-url"]})}),1)})).catch((function(){try{r.grafanaReport.report("set_role",y,err.code)}catch(e){}n&&n()}))}},{key:"rejoin",value:function(e,t,n,r,i,o){var a=this;if(!this.worker){if(e){if("string"!=typeof e||"null"===e.toLowerCase())throw Error("Invalid channelKey")}else e=this.appId;if(!t||"string"!=typeof t||"null"===t.toLowerCase()||t.length>128)throw Error("Invalid channel");if(this.uid=n||Object(s.random)(1e7),this.uid=Number.parseInt(this.uid),!Object(s.is32Uint)(this.uid))throw new Error("Invalid uid type");this.channel=t,this.worker=new k({appId:this.appId,channel:this.channel,uid:this.uid,sid:this.sid,role:this.role,servers:this.servers,channelKey:e,reportManager:this.reportManager,grafanaReport:this.grafanaReport},this.emitter),this.worker.connect().then((function(){return a.worker.rejoin(r)})).then((function(){try{a.reportManager.report("join",{header:{sid:a.sid,cname:a.channel,uid:a.uid,success:!0},body:{isrejoin:!0,appId:a.appId,wsurl:a.worker&&a.worker.getWSUrl()}})}catch(e){}try{a.grafanaReport.report("join",m)}catch(e){}setTimeout((function(){i&&i(this.uid)}),1)})).catch((function(e){try{a.reportManager.report("join",{header:{sid:a.sid,cname:a.channel,uid:a.uid,success:!1},body:{ec:JSON.stringify(e),appId:a.appId,wsurl:a.worker&&a.worker.getWSUrl()}})}catch(e){}try{a.grafanaReport.report("join",y,e.code)}catch(e){}a.destroy(),o&&o(e)}))}}},{key:"join",value:function(e,t,n,r,i){var o=this;if(!this.worker){if(e){if("string"!=typeof e||"null"===e.toLowerCase())throw Error("Invalid channelKey")}else e=this.appId;if(!t||"string"!=typeof t||"null"===t.toLowerCase()||t.length>128)throw Error("Invalid channel");if(this.uid=n||Object(s.random)(1e7),this.uid=Number.parseInt(this.uid),!Object(s.is32Uint)(this.uid))throw new Error("Invalid uid type");this.channel=t,this.worker=new k({appId:this.appId,channel:this.channel,uid:this.uid,sid:this.sid,role:this.role,servers:this.servers,channelKey:e,reportManager:this.reportManager,grafanaReport:this.grafanaReport},this.emitter),this.worker.connect().then((function(){return o.worker.join(o.systemInfo.model,o.systemInfo.system)})).then((function(e){try{o.reportManager.report("join",{header:{sid:o.sid,cname:o.channel,uid:o.uid,success:!0},body:{isrejoin:!1,appId:o.appId,wsurl:o.worker&&o.worker.getWSUrl()}})}catch(e){}try{o.grafanaReport.report("join",m,"",{model:o.systemInfo.model,version:o.systemInfo.version,system:o.systemInfo.system,ip:T().ip})}catch(e){}setTimeout((function(){r&&r(this.uid)}),1)})).catch((function(e){try{o.reportManager.report("join",{header:{sid:o.sid,cname:o.channel,uid:o.uid,success:!1},body:{ec:JSON.stringify(e),appId:o.appId,wsurl:e.wsurl||o.worker&&o.worker.getWSUrl()}})}catch(e){}try{o.grafanaReport.report("join",y,e.code,{model:o.systemInfo.model,version:o.systemInfo.version,system:o.systemInfo.system,ip:T().ip})}catch(e){}o.destroy(),i&&i(e)}))}}},{key:"publish",value:function(e,t){var n=this;this._checkWorker(),this.worker.publish().then((function(t){n.pushUrl=t.url;try{n.reportManager.report("publish",{header:{sid:n.sid,cname:n.channel,uid:n.uid,success:!0},body:{pushurl:t.url}})}catch(e){}try{n.grafanaReport.report("publish",m)}catch(e){}setTimeout((function(){e&&e(t.url)}),1)})).catch((function(e){n.reportManager.report("publish",{header:{sid:n.sid,cname:n.channel,uid:n.uid,success:!1},body:{ec:JSON.stringify(e)}});try{n.grafanaReport.report("publish",y,e.code)}catch(e){}t&&t(e)}))}},{key:"unpublish",value:function(e,t){var n=this;this._checkWorker(),this.worker.unpublish().then((function(t){n.pushUrl=null;try{n.reportManager.report("unpublish",{header:{sid:n.sid,cname:n.channel,uid:n.uid,success:!0},body:{}})}catch(e){}try{n.grafanaReport.report("unpublish",m)}catch(e){}setTimeout((function(){e&&e()}),1)})).catch((function(e){n.reportManager.report("unpublish",{header:{sid:n.sid,cname:n.channel,uid:n.uid,success:!1},body:{ec:JSON.stringify(e)}});try{n.grafanaReport.report("unpublish",y,e.code)}catch(e){}t&&t(e)}))}},{key:"subscribe",value:function(e,t,n){var r=this,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{audio:!0,video:!0};this._checkUid(e),this._checkWorker(),this.worker.subscribe(e,i).then((function(n){r.playUrls.set(e,n.url);try{r.reportManager.report("subscribe",{header:{sid:r.sid,cname:r.channel,uid:r.uid,success:!0},body:{pullurl:n.url}})}catch(e){}try{r.grafanaReport.report("subscribe",m)}catch(e){}setTimeout((function(){t&&t(n.url,n.rotation)}),1)})).catch((function(e){r.reportManager.report("subscribe",{header:{sid:r.sid,cname:r.channel,uid:r.uid,success:!1},body:{ec:JSON.stringify(e)}});try{r.grafanaReport.report("subscribe",y,e.code)}catch(e){}n&&n(e)}))}},{key:"unsubscribe",value:function(e,t,n){var r=this;this._checkUid(e),this._checkWorker(),this.worker.unsubscribe(e).then((function(n){r.playUrls.delete(e);try{r.reportManager.report("unsubscribe",{header:{sid:r.sid,cname:r.channel,uid:r.uid,success:!1},body:{}})}catch(e){}try{r.grafanaReport.report("unsubscribe",m)}catch(e){}setTimeout((function(){t&&t()}),1)})).catch((function(e){r.reportManager.report("unsubscribe",{header:{sid:r.sid,cname:r.channel,uid:r.uid,success:!1},body:{ec:JSON.stringify(e)}});try{r.grafanaReport.report("unsubscribe",y,e.code)}catch(e){}n&&n(e)}))}},{key:"mute",value:function(e,t,n,r){var i=this;if(this._checkUid(e),this._checkWorker(),"video"!==t&&"audio"!==t&&"all"!==t)throw new Error('target should be "video", "audio" or "all"');this.worker.mute(e,t).then((function(e){try{i.grafanaReport.report("mute",m)}catch(e){}setTimeout((function(){n&&n()}),1)})).catch((function(e){try{i.grafanaReport.report("mute",y,e.code)}catch(e){}r&&r(e)}))}},{key:"unmute",value:function(e,t,n,r){var i=this;if(this._checkUid(e),this._checkWorker(),"video"!==t&&"audio"!==t&&"all"!==t)throw new Error('target should be "video", "audio" or "all"');this.worker.unmute(e,t).then((function(e){try{i.grafanaReport.report("unmute",m)}catch(e){}setTimeout((function(){n&&n()}),1)})).catch((function(e){try{i.grafanaReport.report("unmute",y,e.code)}catch(e){}r&&r(e)}))}},{key:"setRemoteVideoStreamType",value:function(e,t,n,r){var i=this;this._checkUid(e),this._checkWorker(),this.worker.setRemoteVideoStreamType(e,t).then((function(e){try{i.grafanaReport.report("set_remote_stream_type",m)}catch(e){}setTimeout((function(){n&&n()}),1)})).catch((function(e){try{i.grafanaReport.report("set_remote_stream_type",y,e.code)}catch(e){}r&&r(e)}))}},{key:"renewToken",value:function(e,t,n){var r=this;this._checkWorker(),this.worker.renewToken(e).then((function(e){try{r.grafanaReport.report("update_token",m)}catch(e){}setTimeout((function(){t&&t()}),1)})).catch((function(e){try{r.grafanaReport.report("update_token",y,e.code)}catch(e){}n&&n(e)}))}},{key:"muteLocal",value:function(e,t,n){var r=this;if(this._checkWorker(),"video"!==e&&"audio"!==e&&"all"!==e)throw new Error('target should be "video", "audio" or "all"');this.worker.muteLocal(e).then((function(e){try{r.grafanaReport.report("mute_local",m)}catch(e){}setTimeout((function(){t&&t()}),1)})).catch((function(e){try{r.grafanaReport.report("mute_local",y,e.code)}catch(e){}n&&n(e)}))}},{key:"unmuteLocal",value:function(e,t,n){var r=this;if(this._checkWorker(),"video"!==e&&"audio"!==e&&"all"!==e)throw new Error('target should be "video", "audio" or "all"');this.worker.unmuteLocal(e).then((function(e){try{r.grafanaReport.report("unmute_local",m)}catch(e){}setTimeout((function(){t&&t()}),1)})).catch((function(e){try{r.grafanaReport.report("unmute_local",y,e.code)}catch(e){}n&&n(e)}))}},{key:"leave",value:function(e,t){var n=this;this.worker&&this.worker.isWSConnected()&&this.worker.leave().then((function(t){try{n.reportManager.report("leave",{header:{sid:n.sid,cname:n.channel,uid:n.uid,success:!0},body:{}})}catch(e){}try{n.grafanaReport.report("leave",m)}catch(e){}n.destroy((function(){setTimeout((function(){e&&e()}),1)}))})).catch((function(e){try{n.grafanaReport.report("leave",y,e.code)}catch(e){}t&&t(e)}))}},{key:"_checkUid",value:function(e){if(!e||"number"!=typeof e||!Object(s.is32Uint)(e))throw new Error("Invalid uid type")}},{key:"_checkWorker",value:function(){if(!this.worker||!this.worker.isWSConnected())throw new Error("Disconnected from server")}},{key:"isConnected",value:function(){return!(!this.worker||!this.worker.isWSConnected())}},{key:"updatePusherStateChange",value:function(e){if(this.pushUrl){var t=e.detail.code,n=e.detail.message;if(1002===t)try{this.grafanaReport.report("pusher_state_change",m,t)}catch(e){}if(-1307===t)try{this.grafanaReport.report("pusher_state_change",y,t,n)}catch(e){}}}},{key:"updatePlayerStateChange",value:function(e,t){if(this.playUrls.get(Number(e))){var n=t.detail.code,r=t.detail.message;if(2003===n||-2301===n){var i=2003===n?m:y;try{this.grafanaReport.report("player_state_change",i,n,r)}catch(e){}}}}},{key:"updatePusherNetStatus",value:function(e){if(this.pushUrl){var t=e.detail.info;this.argusReport.setPusherNetData(t)}}},{key:"updatePlayerNetStatus",value:function(e,t){if(this.playUrls.get(Number(e))){var n=t.detail.info;this.argusReport.setPlayerNetData(e,n)}}},{key:"send",value:function(e,t,n){this._checkWorker(),this.worker.send(e).then((function(e){t&&t(e)})).catch((function(e){n&&n(e)}))}},{key:"updatePushUrl",value:function(e,t){var n=this;this._checkWorker(),this.worker.updatePushUrl().then((function(t){setTimeout((function(){try{this.grafanaReport.report("update_url",m)}catch(e){}e&&e(t)}),1)})).catch((function(e){try{n.grafanaReport.report("update_url",y,e.code)}catch(e){}t&&t(e)}))}},{key:"destroy",value:function(e,t){var n=this;this.worker?(this.worker.destroy((function(){n.pushUrl=null,n.playUrls=null,e&&e()})),this.worker=null):(this.pushUrl=null,this.playUrls=null,e&&e()),this.grafanaReport.destroy(),this.argusReport.destroy()}},{key:"startChannelMediaRelay",value:function(e,t){if(!(e instanceof A.ChannelMediaRelayConfiguration))throw"Configration should be instance of [ChannelMediaRelayConfiguration]";var n=e.getSrcChannelMediaInfo(),r=e.getDestChannelMediaInfos();if(Object(q.isEmpty)(n))throw"srcChannelMediaInfo should not be empty";if(Object(q.isEmpty)(r)||0===r.length)throw"destChannelMediaInfos should not be empty";if(h.default.debug("[startChannelMediaRelay]: srcInfo: ",n," destInfo: ",r),!Object(s.is32Uint)(n.uid))throw"Invalid uid in srcChannelMediaInfo";if(!Object(q.isValidChannelName)(n.channelName))throw"Invalid channelName in srcChannelMediaInfo";if(n.token&&!Object(q.isValidToken)(n.token))throw"Invalid token in srcChannelMediaInfo";if(r.forEach((function(e){if(!Object(s.is32Uint)(e.uid))throw"Invalid uid in destChannelMediaInfo";if(!Object(q.isValidChannelName)(e.channelName))throw"Invalid channelName in destChannelMediaInfo";if(e.token&&!Object(q.isValidToken)(e.token))throw"Invalid token in destChannelMediaInfo"})),!this.worker)throw"startChannelMediaRelay should be used after join";this.worker.startChannelMediaRelay(e).then((function(){t&&t()})).catch((function(e){t&&t(e)}))}},{key:"updateChannelMediaRelay",value:function(e,t){if(!(e instanceof A.ChannelMediaRelayConfiguration))throw"Configration should be instance of [ChannelMediaRelayConfiguration]";var n=e.getSrcChannelMediaInfo(),r=e.getDestChannelMediaInfos();if(Object(q.isEmpty)(n))throw"srcChannelMediaInfo should not be empty";if(Object(q.isEmpty)(r)||0===r.length)throw"destChannelMediaInfos should not be empty";if(h.default.debug("[updateChannelMediaRelay]: srcInfo: ",n," destInfo: ",r),!Object(s.is32Uint)(n.uid))throw"Invalid uid in srcChannelMediaInfo";if(!Object(q.isValidChannelName)(n.channelName))throw"Invalid channelName in srcChannelMediaInfo";if(n.token&&!Object(q.isValidToken)(n.token))throw"Invalid token in srcChannelMediaInfo";if(r.forEach((function(e){if(!Object(s.is32Uint)(e.uid))throw"Invalid uid in destChannelMediaInfo";if(!Object(q.isValidChannelName)(e.channelName))throw"Invalid channelName in destChannelMediaInfo";if(e.token&&!Object(q.isValidToken)(e.token))throw"Invalid token in destChannelMediaInfo"})),!this.worker)throw"updateChannelMediaRelay should be used after join";this.worker.updateChannelMediaRelay(e).then((function(){t&&t()})).catch((function(e){t&&t(e)}))}},{key:"stopChannelMediaRelay",value:function(e){h.default.debug("[stopChannelMediaRelay]"),this.worker.stopChannelMediaRelay().then((function(){e&&e()})).catch((function(t){e&&e(t)}))}}]),e}();n.d(t,"Client",(function(){return V})),n.d(t,"LOG",(function(){return h.default})),n.d(t,"Log",(function(){return h.Log})),n.d(t,"ChannelMediaRelayConfiguration",(function(){return A.ChannelMediaRelayConfiguration})),n.d(t,"SDK_VERSION",(function(){return c.SDK_VERSION}))}])}))},f89c:function(e,t,n){"use strict";var r=n("5445"),i=n.n(r);i.a},fae4:function(e,t,n){var r=n("24fb");t=r(!1),t.push([e.i,".pop__ui_mask[data-v-28d56186]{background-color:#000;opacity:.1;position:fixed;left:0;right:0;top:0;bottom:0;z-index:1000}.pop__ui_child[data-v-28d56186]{background-color:#fbfbfb;border-top-left-radius:12px;border-top-right-radius:12px;font-size:14px;overflow:hidden;position:fixed;bottom:0;left:0;right:0;z-index:1001}.pop__ui_head[data-v-28d56186]{border-style:solid;border-color:#ebebeb;border-bottom-width:%?1?%;font-size:%?28?%;font-weight:700;padding:%?30?%;text-align:left}.product-head[data-v-28d56186]{flex-direction:row}.product-head-btn[data-v-28d56186],\n.add-product-head-btn[data-v-28d56186]{height:%?60?%;line-height:%?60?%;background-color:#fff;border-color:#f72b6c}.add-product-list[data-v-28d56186]{width:%?750?%;height:%?700?%}.add-product-container[data-v-28d56186]{position:absolute;width:%?750?%;height:%?900?%;right:0;bottom:0;left:0;border-radius:%?16?% %?16?% 0 0;background-color:#fff;transition:-webkit-transform .2s ease;transition:transform .2s ease;transition:transform .2s ease,-webkit-transform .2s ease;-webkit-transform:translate(0);transform:translate(0)}.add-product-container-close[data-v-28d56186]{transition:-webkit-transform 0s ease;transition:transform 0s ease;transition:transform 0s ease,-webkit-transform 0s ease;-webkit-transform:translateY(100%);transform:translateY(100%)}.add-product-head[data-v-28d56186]{flex-direction:row}.add-product-item[data-v-28d56186]{flex-direction:row;padding:%?20?%}.add-product-picture[data-v-28d56186]{width:%?160?%;height:%?160?%}.text-ellipsis-2[data-v-28d56186]{height:%?70?%}.add-product-relation[data-v-28d56186]{height:%?60?%;line-height:%?60?%;background-color:#51a938;color:#fff;border-color:#51a938;font-size:12px}.add-product-relation-hover[data-v-28d56186]{background-color:#abd7a2;border-color:#abd7a2}.order-close[data-v-28d56186]{width:%?40?%;height:%?40?%}.add-order-head[data-v-28d56186]{background-color:#eee;flex-direction:row}.order-num[data-v-28d56186]{font-size:28px;color:#ababab;margin-bottom:%?10?%}.order-title[data-v-28d56186]{text-overflow:ellipsis;overflow:hidden}.order-money[data-v-28d56186]{margin-top:%?20?%}.add-product-picture-image[data-v-28d56186]{width:%?160?%;height:%?160?%}",""]),e.exports=t},fb2c:function(e,t,n){var r=n("74e8");r("Uint32",(function(e){return function(t,n,r){return e(this,t,n,r)}}))},fbe4:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r={data:function(){return{showGiftView:!1,open_plan:!1,userInfo:{},isGift:0}},props:["gift_name","giftList","room_id"],methods:{show:function(){this.showGiftView=!0,this.getUser()},getRequest:function(){var e=this;return e},getUser:function(){var e=this;e.getRequest()._get("user.user/detail",{},(function(t){e.userInfo=t.data.userInfo}))},chooseGift:function(e){this.isGift=e.gift_id},sendGift:function(e){var t=this;t.getRequest()._post("plus.live.room/send_gift",{room_id:t.room_id,gift_id:e.gift_id},(function(n){uni.showToast({title:n.msg}),t.userInfo.gift_money=n.data.gift_money,t.$emit("sendGift",e.gift_id+","+n.data.gift_num)}))},PlanFunc:function(){this.showGiftView=!1,this.$emit("openPlan")},close:function(){this.showGiftView=!1}}};t.default=r},fc7e:function(e,t,n){"use strict";n.r(t);var r=n("e2b2"),i=n("649f");for(var o in i)"default"!==o&&function(e){n.d(t,e,(function(){return i[e]}))}(o);n("b615");var a,s=n("f0c5"),c=Object(s["a"])(i["default"],r["b"],r["c"],!1,null,"e4d0b1ba",null,!1,r["a"],a);t["default"]=c.exports},fcde:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.pay=void 0;var r=function(e,t,n,r){if(-10===e.code)return t.showError(e.msg),!1;if(20==e.data.pay_type){if(!t.isWeixin())return void uni.navigateTo({url:"/pages/order/pay-h5/pay-h5?order_id="+e.data.order_id+"&order_type="+e.data.order_type});WeixinJSBridge.invoke("getBrandWCPayRequest",JSON.parse(e.data.payment),(function(o){"get_brand_wcpay_request:ok"==o.err_msg?i(e,t,n):"get_brand_wcpay_request:cancel"==o.err_msg?t.showSuccess("支付取消",(function(){a(e,r)})):t.showError("订单未支付成功",(function(){a(e,r)}))}))}10==e.data.pay_type&&i(e,t,n),30==e.data.pay_type&&uni.navigateTo({url:"/pages/order/alipay-h5/alipay-h5?order_id="+e.data.order_id+"&order_type="+e.data.order_type})};function i(e,t,n){n?n(e):o(e)}function o(e){uni.reLaunch({url:"/pages/order/pay-success/pay-success?order_id="+e.data.order_id})}function a(e,t){t?t(e):uni.redirectTo({url:"/pages/order/order-detail?order_id="+e.data.order_id})}t.pay=r},fd15:function(e,t,n){"use strict";var r;n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return o})),n.d(t,"a",(function(){return r}));var i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return e.popupVisible?n("v-uni-view",{staticClass:"popup-footer"},[n("v-uni-view",{staticClass:"pop__ui_panel"},[n("v-uni-view",{staticClass:"pop__ui_mask",on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.close.apply(void 0,arguments)}}}),n("v-uni-view",{staticClass:"pop__ui_child anim-footer",on:{click:function(t){t.stopPropagation(),arguments[0]=t=e.$handleEvent(t)}}},[n("div",[n("div",{staticClass:"add-order-head d-b-c p20 f30"},[n("v-uni-text",{staticClass:"f30"},[e._v("我的订单")]),n("v-uni-text",{staticClass:"topbar_ico icon iconfont icon-guanbi order-close",on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.close.apply(void 0,arguments)}}})],1),n("list",{staticClass:"add-product-list"},e._l(e.listData,(function(t,r){return n("cell",{key:r,staticClass:"add-product-item d-s-s"},[n("div",{staticClass:"add-product-picture"},[n("v-uni-image",{staticClass:"add-product-picture-image",attrs:{src:t.product[0].image.file_path,mode:"aspectFill"}})],1),n("div",{staticClass:"flex-1 ml20"},[n("div",{staticClass:"order-num"},[n("v-uni-text",{staticClass:"f28 gray9"},[e._v("订单号："+e._s(t.order_no))])],1),n("div",{staticClass:"order-title"},[n("div",{staticClass:"text-ellipsis-2"},[n("v-uni-text",{staticClass:"f28"},[e._v(e._s(t.product[0].product_name))])],1)]),n("div",{staticClass:"order-money"},[n("v-uni-text",{staticClass:"rose f28",staticStyle:{"font-weight":"700"}},[e._v("￥"+e._s(t.product[0].product_price))])],1)]),n("div",{staticClass:"order-statu"},[1==t.is_settled?n("v-uni-text",{staticClass:"rose f28"},[e._v("已结算")]):e._e(),0==t.is_settled?n("v-uni-text",{staticClass:"rose f28"},[e._v("未结算")]):e._e()],1)])})),1)],1)])],1)],1):e._e()},o=[]},fd39:function(e,t,n){var r=n("24fb");t=r(!1),t.push([e.i,".iconfont[data-v-92fd8c86]{font-family:iconfont}.animate-wrap[data-v-92fd8c86]{display:inline-block;margin-right:10px;position:absolute;width:%?74?%;height:%?800?%;\n\t/* top: -110rpx; */bottom:%?100?%;right:0;z-index:10}.content[data-v-92fd8c86]{position:absolute;right:0;z-index:14}.content_box[data-v-92fd8c86]{position:absolute;bottom:0;right:0}.logo[data-v-92fd8c86]{display:inline-block;position:absolute;right:0;width:%?70?%;height:%?70?%}.aa[data-v-92fd8c86]{position:absolute;bottom:0;font-size:%?30?%;color:#fff;text-align:center;line-height:%?50?%;width:%?80?%;-webkit-transform:translateY(0);transform:translateY(0)}.icon-31guanzhu1xuanzhong[data-v-92fd8c86]{font-size:%?40?%}",""]),e.exports=t},fd43:function(e,t,n){"use strict";n.r(t);var r=n("0927"),i=n.n(r);for(var o in r)"default"!==o&&function(e){n.d(t,e,(function(){return r[e]}))}(o);t["default"]=i.a},fd4b:function(module,exports,__webpack_require__){(function(global,process){__webpack_require__("a4d3"),__webpack_require__("e01a"),__webpack_require__("d28b"),__webpack_require__("944a"),__webpack_require__("99af"),__webpack_require__("a623"),__webpack_require__("4de4"),__webpack_require__("4160"),__webpack_require__("caad"),__webpack_require__("c975"),__webpack_require__("d81d"),__webpack_require__("13d5"),__webpack_require__("26e9"),__webpack_require__("fb6a"),__webpack_require__("45fc"),__webpack_require__("4e82"),__webpack_require__("a434"),__webpack_require__("c19f"),__webpack_require__("ace4"),__webpack_require__("f4b3"),__webpack_require__("6c57"),__webpack_require__("0c47"),__webpack_require__("4ec9"),__webpack_require__("40d9"),__webpack_require__("90d7"),__webpack_require__("23dc"),__webpack_require__("a9e3"),__webpack_require__("8ba4"),__webpack_require__("aff5"),__webpack_require__("4fad"),__webpack_require__("dca8"),__webpack_require__("e439"),__webpack_require__("7039"),__webpack_require__("3410"),__webpack_require__("b64b"),__webpack_require__("131a"),__webpack_require__("d3b7"),__webpack_require__("acd8"),__webpack_require__("e25e"),__webpack_require__("a6fd"),__webpack_require__("4ae1"),__webpack_require__("5d41"),__webpack_require__("1bf2"),__webpack_require__("4d63"),__webpack_require__("ac1f"),__webpack_require__("5377"),__webpack_require__("25f0"),__webpack_require__("6062"),__webpack_require__("8a79"),__webpack_require__("2532"),__webpack_require__("3ca3"),__webpack_require__("466d"),__webpack_require__("843c"),__webpack_require__("4d90"),__webpack_require__("5319"),__webpack_require__("1276"),__webpack_require__("2ca0"),__webpack_require__("cfc3"),__webpack_require__("4a9b"),__webpack_require__("143c"),__webpack_require__("5cc6"),__webpack_require__("84c3"),__webpack_require__("fb2c"),__webpack_require__("9a8c"),__webpack_require__("a975"),__webpack_require__("735e"),__webpack_require__("c1ac"),__webpack_require__("d139"),__webpack_require__("3a7b"),__webpack_require__("d5d6"),__webpack_require__("20bf"),__webpack_require__("82f8"),__webpack_require__("e91f"),__webpack_require__("60bd"),__webpack_require__("5f96"),__webpack_require__("3280"),__webpack_require__("3fcc"),__webpack_require__("ca91"),__webpack_require__("25a1"),__webpack_require__("cd26"),__webpack_require__("2954"),__webpack_require__("649e"),__webpack_require__("219c"),__webpack_require__("b39a"),__webpack_require__("72f7"),__webpack_require__("159b"),__webpack_require__("ddb0"),__webpack_require__("bf19");var _objectSpread=__webpack_require__("ded3"),_objectWithoutProperties=__webpack_require__("4082"),_possibleConstructorReturn=__webpack_require__("6b58"),_assertThisInitialized=__webpack_require__("3c96"),_asyncToGenerator=__webpack_require__("c973"),_slicedToArray=__webpack_require__("278c"),_get=__webpack_require__("8962"),_getPrototypeOf=__webpack_require__("36c6"),_createForOfIteratorHelper=__webpack_require__("6374");__webpack_require__("96cf");var _createClass=__webpack_require__("5bc3"),_classCallCheck=__webpack_require__("970b"),_inherits=__webpack_require__("ed6d"),_createSuper=__webpack_require__("2d0d"),_wrapNativeSuper=__webpack_require__("a128"),_toConsumableArray=__webpack_require__("448a"),_marked=regeneratorRuntime.mark(iterator1),RtmStatusCode;!function(e){var t,n,r,i,o,a,s;!function(e){e.LOGIN="LOGIN",e.LOGIN_SUCCESS="LOGIN_SUCCESS",e.LOGIN_FAILURE="LOGIN_FAILURE",e.LOGIN_TIMEOUT="LOGIN_TIMEOUT",e.INTERRUPTED="INTERRUPTED",e.LOGOUT="LOGOUT",e.BANNED_BY_SERVER="BANNED_BY_SERVER",e.REMOTE_LOGIN="REMOTE_LOGIN"}(t||(t={})),e.ConnectionChangeReason=t,function(e){e.DISCONNECTED="DISCONNECTED",e.CONNECTING="CONNECTING",e.CONNECTED="CONNECTED",e.RECONNECTING="RECONNECTING",e.ABORTED="ABORTED"}(n||(n={})),e.ConnectionState=n,function(e){e.TEXT="TEXT"}(r||(r={})),e.MessageType=r,function(e){e.IDLE="IDLE",e.SENT_TO_REMOTE="SENT_TO_REMOTE",e.RECEIVED_BY_REMOTE="RECEIVED_BY_REMOTE",e.ACCEPTED_BY_REMOTE="ACCEPTED_BY_REMOTE",e.REFUSED_BY_REMOTE="REFUSED_BY_REMOTE",e.CANCELED="CANCELED",e.FAILURE="FAILURE"}(i||(i={})),e.LocalInvitationState=i,function(e){e.INVITATION_RECEIVED="INVITATION_RECEIVED",e.ACCEPT_SENT_TO_LOCAL="ACCEPT_SENT_TO_LOCAL",e.REFUSED="REFUSED",e.ACCEPTED="ACCEPTED",e.CANCELED="CANCELED",e.FAILURE="FAILURE"}(o||(o={})),e.RemoteInvitationState=o,function(e){e.UNKNOWN="UNKNOWN",e.PEER_NO_RESPONSE="PEER_NO_RESPONSE",e.INVITATION_EXPIRE="INVITATION_EXPIRE",e.PEER_OFFLINE="PEER_OFFLINE",e.NOT_LOGGEDIN="NOT_LOGGEDIN"}(a||(a={})),e.LocalInvitationFailureReason=a,function(e){e.UNKNOWN="UNKNOWN",e.PEER_OFFLINE="PEER_OFFLINE",e.ACCEPT_FAILURE="ACCEPT_FAILURE",e.INVITATION_EXPIRE="INVITATION_EXPIRE"}(s||(s={})),e.RemoteInvitationFailureReason=s}(RtmStatusCode||(RtmStatusCode={}));var RtmStatusCode$1=RtmStatusCode;function _applyDecoratedDescriptor(e,t,n,r,i){var o={};return Object.keys(r).forEach((function(e){o[e]=r[e]})),o.enumerable=!!o.enumerable,o.configurable=!!o.configurable,("value"in o||o.initializer)&&(o.writable=!0),o=n.slice().reverse().reduce((function(n,r){return r(e,t,n)||n}),o),i&&void 0!==o.initializer&&(o.value=o.initializer?o.initializer.call(i):void 0,o.initializer=void 0),void 0===o.initializer&&(Object.defineProperty(e,t,o),o=null),o}var R="object"==typeof Reflect?Reflect:null,ReflectApply=R&&"function"==typeof R.apply?R.apply:function(e,t,n){return Function.prototype.apply.call(e,t,n)},ReflectOwnKeys;function ProcessEmitWarning(e){console&&console.warn&&console.warn(e)}ReflectOwnKeys=R&&"function"==typeof R.ownKeys?R.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)};var NumberIsNaN=Number.isNaN||function(e){return e!=e};function EventEmitter(){EventEmitter.init.call(this)}var events=EventEmitter,once_1=once;EventEmitter.EventEmitter=EventEmitter,EventEmitter.prototype._events=void 0,EventEmitter.prototype._eventsCount=0,EventEmitter.prototype._maxListeners=void 0;var defaultMaxListeners=10;function checkListener(e){if("function"!=typeof e)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}function _getMaxListeners(e){return void 0===e._maxListeners?EventEmitter.defaultMaxListeners:e._maxListeners}function _addListener(e,t,n,r){var i,o,a;if(checkListener(n),void 0===(o=e._events)?(o=e._events=Object.create(null),e._eventsCount=0):(void 0!==o.newListener&&(e.emit("newListener",t,n.listener?n.listener:n),o=e._events),a=o[t]),void 0===a)a=o[t]=n,++e._eventsCount;else if("function"==typeof a?a=o[t]=r?[n,a]:[a,n]:r?a.unshift(n):a.push(n),(i=_getMaxListeners(e))>0&&a.length>i&&!a.warned){a.warned=!0;var s=new Error("Possible EventEmitter memory leak detected. "+a.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");s.name="MaxListenersExceededWarning",s.emitter=e,s.type=t,s.count=a.length,ProcessEmitWarning(s)}return e}function onceWrapper(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function _onceWrap(e,t,n){var r={fired:!1,wrapFn:void 0,target:e,type:t,listener:n},i=onceWrapper.bind(r);return i.listener=n,r.wrapFn=i,i}function _listeners(e,t,n){var r=e._events;if(void 0===r)return[];var i=r[t];return void 0===i?[]:"function"==typeof i?n?[i.listener||i]:[i]:n?unwrapListeners(i):arrayClone(i,i.length)}function listenerCount(e){var t=this._events;if(void 0!==t){var n=t[e];if("function"==typeof n)return 1;if(void 0!==n)return n.length}return 0}function arrayClone(e,t){for(var n=new Array(t),r=0;r<t;++r)n[r]=e[r];return n}function spliceOne(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}function unwrapListeners(e){for(var t=new Array(e.length),n=0;n<t.length;++n)t[n]=e[n].listener||e[n];return t}function once(e,t){return new Promise((function(n,r){function i(){void 0!==o&&e.removeListener("error",o),n([].slice.call(arguments))}var o;"error"!==t&&(o=function(n){e.removeListener(t,i),r(n)},e.once("error",o)),e.once(t,i)}))}Object.defineProperty(EventEmitter,"defaultMaxListeners",{enumerable:!0,get:function(){return defaultMaxListeners},set:function(e){if("number"!=typeof e||e<0||NumberIsNaN(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");defaultMaxListeners=e}}),EventEmitter.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},EventEmitter.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||NumberIsNaN(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this},EventEmitter.prototype.getMaxListeners=function(){return _getMaxListeners(this)},EventEmitter.prototype.emit=function(e){for(var t=[],n=1;n<arguments.length;n++)t.push(arguments[n]);var r="error"===e,i=this._events;if(void 0!==i)r=r&&void 0===i.error;else if(!r)return!1;if(r){var o;if(t.length>0&&(o=t[0]),o instanceof Error)throw o;var a=new Error("Unhandled error."+(o?" ("+o.message+")":""));throw a.context=o,a}var s=i[e];if(void 0===s)return!1;if("function"==typeof s)ReflectApply(s,this,t);else{var c=s.length,u=arrayClone(s,c);for(n=0;n<c;++n)ReflectApply(u[n],this,t)}return!0},EventEmitter.prototype.addListener=function(e,t){return _addListener(this,e,t,!1)},EventEmitter.prototype.on=EventEmitter.prototype.addListener,EventEmitter.prototype.prependListener=function(e,t){return _addListener(this,e,t,!0)},EventEmitter.prototype.once=function(e,t){return checkListener(t),this.on(e,_onceWrap(this,e,t)),this},EventEmitter.prototype.prependOnceListener=function(e,t){return checkListener(t),this.prependListener(e,_onceWrap(this,e,t)),this},EventEmitter.prototype.removeListener=function(e,t){var n,r,i,o,a;if(checkListener(t),void 0===(r=this._events))return this;if(void 0===(n=r[e]))return this;if(n===t||n.listener===t)0==--this._eventsCount?this._events=Object.create(null):(delete r[e],r.removeListener&&this.emit("removeListener",e,n.listener||t));else if("function"!=typeof n){for(i=-1,o=n.length-1;o>=0;o--)if(n[o]===t||n[o].listener===t){a=n[o].listener,i=o;break}if(i<0)return this;0===i?n.shift():spliceOne(n,i),1===n.length&&(r[e]=n[0]),void 0!==r.removeListener&&this.emit("removeListener",e,a||t)}return this},EventEmitter.prototype.off=EventEmitter.prototype.removeListener,EventEmitter.prototype.removeAllListeners=function(e){var t,n,r;if(void 0===(n=this._events))return this;if(void 0===n.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==n[e]&&(0==--this._eventsCount?this._events=Object.create(null):delete n[e]),this;if(0===arguments.length){var i,o=Object.keys(n);for(r=0;r<o.length;++r)"removeListener"!==(i=o[r])&&this.removeAllListeners(i);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(t=n[e]))this.removeListener(e,t);else if(void 0!==t)for(r=t.length-1;r>=0;r--)this.removeListener(e,t[r]);return this},EventEmitter.prototype.listeners=function(e){return _listeners(this,e,!0)},EventEmitter.prototype.rawListeners=function(e){return _listeners(this,e,!1)},EventEmitter.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):listenerCount.call(e,t)},EventEmitter.prototype.listenerCount=listenerCount,EventEmitter.prototype.eventNames=function(){return this._eventsCount>0?ReflectOwnKeys(this._events):[]},events.once=once_1;var SEMAPHORE=Symbol(),NO_OP=function(){},assert=function(){try{return"1"===Object({VUE_APP_INDEX_CSS_HASH:"a5c69d49",VUE_APP_NAME:"三勾门店",VUE_APP_PLATFORM:"h5",NODE_ENV:"production",BASE_URL:"/h5/"}).UMBRELLA_ASSERTS}catch(e){}return!1}()?function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"assertion failed";if("function"==typeof e&&!e()||!e)throw new Error("function"==typeof t?t():t)}:NO_OP,implementsFunction=function(e,t){return null!=e&&"function"==typeof e[t]},isArrayLike=function(e){return null!=e&&"function"!=typeof e&&void 0!==e.length},isIterable=function(e){return null!=e&&"function"==typeof e[Symbol.iterator]},_compare=function(e,t){return e===t?0:null==e?null==t?0:-1:null==t?null==e?0:1:"function"==typeof e.compare?e.compare(t):"function"==typeof t.compare?-t.compare(e):e<t?-1:e>t?1:0},OBJP=Object.getPrototypeOf({}),FN="function",STR="string",_equiv=function(e,t){var n;return e===t||(null==e?e==t:typeof e.equiv===FN?e.equiv(t):null==t?e==t:typeof t.equiv===FN?t.equiv(e):typeof e!==STR&&typeof t!==STR&&(n=Object.getPrototypeOf(e),null!=n&&n!==OBJP||(n=Object.getPrototypeOf(t),null!=n&&n!==OBJP)?typeof e!==FN&&void 0!==e.length&&typeof t!==FN&&void 0!==t.length?equivArrayLike(e,t):e instanceof Set&&t instanceof Set?equivSet(e,t):e instanceof Map&&t instanceof Map?equivMap(e,t):e instanceof Date&&t instanceof Date?e.getTime()===t.getTime():e instanceof RegExp&&t instanceof RegExp?e.toString()===t.toString():e!=e&&t!=t:equivObject(e,t)))},equivArrayLike=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:_equiv,r=e.length;if(r===t.length)for(;--r>=0&&n(e[r],t[r]););return r<0},equivSet=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:_equiv;return e.size===t.size&&n(_toConsumableArray(e.keys()).sort(),_toConsumableArray(t.keys()).sort())},equivMap=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:_equiv;return e.size===t.size&&n(_toConsumableArray(e).sort(),_toConsumableArray(t).sort())},equivObject=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:_equiv;if(Object.keys(e).length!==Object.keys(t).length)return!1;for(var r in e)if(!t.hasOwnProperty(r)||!n(e[r],t[r]))return!1;return!0},defError=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(e){return void 0!==e?": "+e:""};return function(n){"use strict";_inherits(i,n);var r=_createSuper(i);function i(n){return _classCallCheck(this,i),r.call(this,e(n)+t(n))}return i}(_wrapNativeSuper(Error))},IllegalArgumentError=defError((function(){return"illegal argument(s)"})),illegalArgs=function(e){throw new IllegalArgumentError(e)},INV_MAX=1/4294967295,ARandom=function(){"use strict";function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"float",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return this.int()*INV_MAX*e}},{key:"norm",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return 2*(this.int()*INV_MAX-.5)*e}},{key:"minmax",value:function(e,t){return this.float()*(t-e)+e}}]),e}(),random=Math.random,SystemRandom=function(e){"use strict";_inherits(n,e);var t=_createSuper(n);function n(){return _classCallCheck(this,n),t.apply(this,arguments)}return _createClass(n,[{key:"int",value:function(){return 4294967296*random()>>>0}},{key:"float",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return random()*e}},{key:"norm",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return 2*(random()-.5)*e}}]),n}(ARandom),SYSTEM=new SystemRandom,ensureTransducer=function(e){return implementsFunction(e,"xform")?e.xform():e},Reduced=function(){"use strict";function e(t){_classCallCheck(this,e),this.value=t}return _createClass(e,[{key:"deref",value:function(){return this.value}}]),e}(),isReduced=function(e){return e instanceof Reduced},unreduced=function(e){return e instanceof Reduced?e.deref():e};function iterator1(e,t){var n,r,i,o,a;return regeneratorRuntime.wrap((function(s){while(1)switch(s.prev=s.next){case 0:n=ensureTransducer(e)([NO_OP,NO_OP,function(e,t){return t}])[2],r=_createForOfIteratorHelper(t),s.prev=2,r.s();case 4:if((i=r.n()).done){s.next=21;break}if(o=i.value,a=n(SEMAPHORE,o),!isReduced(a)){s.next=15;break}if(a=unreduced(a.deref()),s.t0=a!==SEMAPHORE,!s.t0){s.next=14;break}return s.next=13,a;case 13:s.t0=s.sent;case 14:return s.abrupt("return",void s.t0);case 15:if(s.t1=a!==SEMAPHORE,!s.t1){s.next=19;break}return s.next=19,a;case 19:s.next=4;break;case 21:s.next=26;break;case 23:s.prev=23,s.t2=s["catch"](2),r.e(s.t2);case 26:return s.prev=26,r.f(),s.finish(26);case 29:case"end":return s.stop()}}),_marked,null,[[2,23,26,29]])}var compR=function(e,t){return[e[0],e[1],t]};function map(e,t){return isIterable(t)?iterator1(map(e),t):function(t){var n=t[2];return compR(t,(function(t,r){return n(t,e(r))}))}}var DCons=function(){"use strict";function e(t){_classCallCheck(this,e),this._length=0,t&&this.into(t)}return _createClass(e,[{key:"copy",value:function(){return new e(this)}},{key:"empty",value:function(){return new e}},{key:"clear",value:function(){this.release()}},{key:"release",value:function(){for(var e,t=this.head;t;)e=t.next,delete t.value,delete t.prev,delete t.next,t=e;return delete this.head,delete this.tail,this._length=0,!0}},{key:"compare",value:function(e){var t=this._length;if(t<e._length)return-1;if(t>e._length)return 1;if(0===t)return 0;for(var n=this.head,r=e.head,i=0;n&&0==i;)i=_compare(n.value,r.value),n=n.next,r=r.next;return i}},{key:"equiv",value:function(t){if(!(t instanceof e||isArrayLike(t))||this._length!==t.length)return!1;if(!this._length||this===t)return!0;var n,r=this.head,i=_createForOfIteratorHelper(t);try{for(i.s();!(n=i.n()).done;){var o=n.value;if(!_equiv(r.value,o))return!1;r=r.next}}catch(err){i.e(err)}finally{i.f()}return!0}},{key:Symbol.iterator,value:regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:t=this.head;case 1:if(!t){e.next=7;break}return e.next=4,t.value;case 4:t=t.next;case 5:e.next=1;break;case 7:case"end":return e.stop()}}),e,this)}))},{key:"seq",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.length;if(!(e>=t||e<0)){var n=this.nthCell(e),r=this.nthCell(t-1),i=function e(t){return{first:function(){return t.value},next:function(){return t!==r&&t.next?e(t.next):void 0}}};return n?i(n):void 0}}},{key:"cycle",value:regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.delegateYield(this,"t0",1);case 1:e.next=0;break;case 3:case"end":return e.stop()}}),e,this)}))},{key:"$reduce",value:function(e,t){for(var n=this.head;n&&!isReduced(t);)t=e(t,n.value),n=n.next;return t}},{key:"drop",value:function(){var e=this.head;if(e)return this.head=e.next,this.head?delete this.head.prev:delete this.tail,this._length--,e.value}},{key:"cons",value:function(e){var t={value:e,next:this.head};return this.head?this.head.prev=t:this.tail=t,this.head=t,this._length++,this}},{key:"insertBefore",value:function(e,t){e||illegalArgs("cell is undefined");var n={value:t,next:e,prev:e.prev};return e.prev?e.prev.next=n:this.head=n,e.prev=n,this._length++,this}},{key:"insertAfter",value:function(e,t){e||illegalArgs("cell is undefined");var n={value:t,next:e.next,prev:e};return e.next?e.next.prev=n:this.tail=n,e.next=n,this._length++,this}},{key:"insertBeforeNth",value:function(e,t){return e<0&&(e+=this._length),e<=0?this.cons(t):(this.ensureIndex(e),this.insertBefore(this.nthCellUnsafe(e),t))}},{key:"insertAfterNth",value:function(e,t){return e<0&&(e+=this._length),e>=this._length-1?this.push(t):(this.ensureIndex(e),this.insertAfter(this.nthCellUnsafe(e),t))}},{key:"insertSorted",value:function(e,t){t=t||_compare;for(var n=this.head;n;){if(t(e,n.value)<=0)return this.insertBefore(n,e);n=n.next}return this.push(e)}},{key:"find",value:function(e){for(var t=this.head;t;){if(t.value===e)return t;t=t.next}}},{key:"findWith",value:function(e){for(var t=this.head;t;){if(e(t.value))return t;t=t.next}}},{key:"concat",value:function(){for(var e=this.copy(),t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(var i=0,o=n;i<o.length;i++){var a=o[i];e.into(a)}return e}},{key:"into",value:function(e){var t,n=_createForOfIteratorHelper(e);try{for(n.s();!(t=n.n()).done;){var r=t.value;this.push(r)}}catch(err){n.e(err)}finally{n.f()}}},{key:"slice",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.length,r=t<0?t+this._length:t,i=n<0?n+this._length:n;(r<0||i<0)&&illegalArgs("invalid indices: ${from} / ${to}");for(var o=new e,a=this.nthCell(r);a&&++r<=i;)o.push(a.value),a=a.next;return o}},{key:"splice",value:function(t){var n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2?arguments[2]:void 0;"number"==typeof t?(t<0&&(t+=this._length),this.ensureIndex(t),n=this.nthCellUnsafe(t)):n=t;var o=new e;if(r>0)for(;n&&r-- >0;)this.remove(n),o.push(n.value),n=n.next;else n&&(n=n.next);if(i)if(n){var a,s=_createForOfIteratorHelper(i);try{for(s.s();!(a=s.n()).done;){var c=a.value;this.insertBefore(n,c)}}catch(err){s.e(err)}finally{s.f()}}else{var u,l=_createForOfIteratorHelper(i);try{for(l.s();!(u=l.n()).done;){var d=u.value;this.push(d)}}catch(err){l.e(err)}finally{l.f()}}return o}},{key:"remove",value:function(e){return e.prev?e.prev.next=e.next:this.head=e.next,e.next?e.next.prev=e.prev:this.tail=e.prev,this._length--,this}},{key:"swap",value:function(e,t){if(e!==t){var n=e.value;e.value=t.value,t.value=n}return this}},{key:"push",value:function(e){if(this.tail){var t={value:e,prev:this.tail};return this.tail.next=t,this.tail=t,this._length++,this}return this.cons(e)}},{key:"pop",value:function(){var e=this.tail;if(e)return this.tail=e.prev,this.tail?delete this.tail.next:delete this.head,this._length--,e.value}},{key:"first",value:function(){return this.head&&this.head.value}},{key:"peek",value:function(){return this.tail&&this.tail.value}},{key:"setHead",value:function(e){return this.head?(this.head.value=e,this):this.cons(e)}},{key:"setTail",value:function(e){return this.tail?(this.tail.value=e,this):this.push(e)}},{key:"setNth",value:function(e,t){var n=this.nthCell(e);return!n&&illegalArgs("index out of bounds: ".concat(e)),n.value=t,this}},{key:"nth",value:function(e,t){var n=this.nthCell(e);return n?n.value:t}},{key:"nthCell",value:function(e){if(e<0&&(e+=this._length),!(e<0||e>=this._length))return this.nthCellUnsafe(e)}},{key:"rotateLeft",value:function(){switch(this._length){case 0:case 1:return this;case 2:return this.swap(this.head,this.tail);default:return this.push(this.drop())}}},{key:"rotateRight",value:function(){switch(this._length){case 0:case 1:return this;case 2:return this.swap(this.head,this.tail);default:var e=this.peek();return this.pop(),this.cons(e)}}},{key:"map",value:function(t){for(var n=new e,r=this.head;r;)n.push(t(r.value)),r=r.next;return n}},{key:"filter",value:function(t){for(var n=new e,r=this.head;r;)t(r.value)&&n.push(r.value),r=r.next;return n}},{key:"reduce",value:function(e,t){for(var n=t,r=this.head;r;)n=e(n,r.value),r=r.next;return n}},{key:"shuffle",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:SYSTEM;if(this._length<2)return this;for(e=null!=e?e:Math.ceil(1.5*Math.log2(this._length));e>0;e--)for(var n=this.head;n;){var r=n.next;t.float()<.5?this.asHead(n):this.asTail(n),n=r}return this}},{key:"sort",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:_compare;if(!this._length)return this;for(var t=1;;){var n=this.head;this.head=void 0,this.tail=void 0;for(var r=0;n;){r++;for(var i=n,o=0,a=0;a<t&&(o++,i=i.next,i);a++);for(var s=t;o>0||s>0&&i;){var c=void 0;0===o?(c=i,i=i.next,s--):i&&0!==s?e(n.value,i.value)<=0?(c=n,n=n.next,o--):(c=i,i=i.next,s--):(c=n,n=n.next,o--),this.tail?this.tail.next=c:this.head=c,c.prev=this.tail,this.tail=c}n=i}if(this.tail.next=void 0,r<=1)return this;t*=2}}},{key:"reverse",value:function(){for(var e=this.head,t=this.tail,n=(this._length>>>1)+(1&this._length);e&&t&&n>0;){var r=e.value;e.value=t.value,t.value=r,e=e.next,t=t.prev,n--}return this}},{key:"asHead",value:function(e){return e===this.head||(this.remove(e),this.head.prev=e,e.next=this.head,e.prev=void 0,this.head=e,this._length++),this}},{key:"asTail",value:function(e){return e===this.tail||(this.remove(e),this.tail.next=e,e.prev=this.tail,e.next=void 0,this.tail=e,this._length++),this}},{key:"toString",value:function(){for(var e=[],t=this.head;t;)e.push(null!=t.value?String(t.value):void 0===t.value?"undefined":"null"),t=t.next;return e.join(", ")}},{key:"toJSON",value:function(){return _toConsumableArray(this)}},{key:"ensureIndex",value:function(e){assert(e>=0&&e<this._length,"index out of range: ".concat(e))}},{key:"nthCellUnsafe",value:function(e){var t,n;for(e<=this._length>>1?(t=this.head,n="next"):(t=this.tail,n="prev",e=this._length-e-1);e-- >0&&t;)t=t[n];return t}},{key:"length",get:function(){return this._length}}]),e}(),LRUCache=function(){"use strict";function e(t,n){_classCallCheck(this,e);var r=Object.assign({maxlen:1/0,maxsize:1/0,map:function(){return new Map},ksize:function(){return 0},vsize:function(){return 0}},n);this.map=r.map(),this.items=new DCons,this._size=0,this.opts=r,t&&this.into(t)}return _createClass(e,[{key:Symbol.iterator,value:function(){return this.entries()}},{key:"entries",value:function(){return map((function(e){return[e.k,e]}),this.items)}},{key:"keys",value:function(){return map((function(e){return e.k}),this.items)}},{key:"values",value:function(){return map((function(e){return e.v}),this.items)}},{key:"copy",value:function(){var e=this.empty();e.items=this.items.copy();for(var t=e.items.head;t;)e.map.set(t.value.k,t),t=t.next;return e}},{key:"empty",value:function(){return new e(null,this.opts)}},{key:"release",value:function(){this._size=0,this.map.clear();var e=this.opts.release;if(e){for(var t;t=this.items.drop();)e(t.k,t.v);return!0}return this.items.release()}},{key:"has",value:function(e){return this.map.has(e)}},{key:"get",value:function(e,t){var n=this.map.get(e);return n?this.resetEntry(n):t}},{key:"set",value:function(e,t){var n=this.opts.ksize(e)+this.opts.vsize(t),r=this.map.get(e);return this._size+=Math.max(0,n-(r?r.value.s:0)),this.ensureSize()&&this.doSetEntry(r,e,t,n),t}},{key:"into",value:function(e){var t,n=_createForOfIteratorHelper(e);try{for(n.s();!(t=n.n()).done;){var r=t.value;this.set(r[0],r[1])}}catch(err){n.e(err)}finally{n.f()}return this}},{key:"getSet",value:function(e,t){var n=this,r=this.map.get(e);return r?Promise.resolve(this.resetEntry(r)):t().then((function(t){return n.set(e,t)}))}},{key:"delete",value:function(e){var t=this.map.get(e);return!!t&&(this.removeEntry(t),!0)}},{key:"resetEntry",value:function(e){return this.items.asTail(e),e.value.v}},{key:"ensureSize",value:function(){for(var e=this.opts.release,t=this.opts.maxsize,n=this.opts.maxlen;this._size>t||this.length>=n;){var r=this.items.drop();if(!r)return!1;this.map.delete(r.k),e&&e(r.k,r.v),this._size-=r.s}return!0}},{key:"removeEntry",value:function(e){var t=e.value;this.map.delete(t.k),this.items.remove(e),this.opts.release&&this.opts.release(t.k,t.v),this._size-=t.s}},{key:"doSetEntry",value:function(e,t,n,r){e?(e.value.v=n,e.value.s=r,this.items.asTail(e)):(this.items.push({k:t,v:n,s:r}),this.map.set(t,this.items.tail))}},{key:"length",get:function(){return this.items.length}},{key:"size",get:function(){return this._size}}]),e}(),TLRUCache=function(e){"use strict";_inherits(n,e);var t=_createSuper(n);function n(e,r){return _classCallCheck(this,n),t.call(this,e,r=Object.assign({ttl:36e5},r))}return _createClass(n,[{key:"empty",value:function(){return new n(null,this.opts)}},{key:"has",value:function(e){return void 0!==this.get(e)}},{key:"get",value:function(e,t){var n=this.map.get(e);if(n){if(n.value.t>=Date.now())return this.resetEntry(n);this.removeEntry(n)}return t}},{key:"set",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.opts.ttl,r=this.opts.ksize(e)+this.opts.vsize(t),i=this.map.get(e);if(this._size+=Math.max(0,r-(i?i.value.s:0)),this.ensureSize()){var o=Date.now()+n;i?(i.value.v=t,i.value.s=r,i.value.t=o,this.items.asTail(i)):(this.items.push({k:e,v:t,s:r,t:o}),this.map.set(e,this.items.tail))}return t}},{key:"getSet",value:function(e,t){var n=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.opts.ttl,i=this.get(e);return i?Promise.resolve(i):t().then((function(t){return n.set(e,t,r)}))}},{key:"prune",value:function(){for(var e=Date.now(),t=this.items.head;t;)t.value.t<e&&this.removeEntry(t),t=t.next}},{key:"ensureSize",value:function(){for(var e=this.opts.maxsize,t=this.opts.maxlen,r=Date.now(),i=this.items.head;i&&(this._size>e||this.length>=t);)i.value.t<r&&this.removeEntry(i),i=i.next;return _get(_getPrototypeOf(n.prototype),"ensureSize",this).call(this)}}]),n}(LRUCache);function getType(e){return Object.prototype.toString.call(e).slice(8,-1)}function isPlainObject(e){return"Object"===getType(e)&&e.constructor===Object&&Object.getPrototypeOf(e)===Object.prototype}function isNil(e){return null==e}var isNil_1=isNil,commonjsGlobal="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function createCommonjsModule(e,t,n){return e(n={path:t,exports:{},require:function(e,t){return commonjsRequire(e,null==t?n.path:t)}},n.exports),n.exports}function commonjsRequire(){throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}var freeGlobal="object"==typeof commonjsGlobal&&commonjsGlobal&&commonjsGlobal.Object===Object&&commonjsGlobal,_freeGlobal=freeGlobal,freeSelf="object"==typeof self&&self&&self.Object===Object&&self,root=_freeGlobal||freeSelf||Function("return this")(),_root=root,Symbol$1=_root.Symbol,_Symbol=Symbol$1,objectProto=Object.prototype,hasOwnProperty=objectProto.hasOwnProperty,nativeObjectToString=objectProto.toString,symToStringTag=_Symbol?_Symbol.toStringTag:void 0;function getRawTag(e){var t=hasOwnProperty.call(e,symToStringTag),n=e[symToStringTag];try{e[symToStringTag]=void 0;var r=!0}catch(e){}var i=nativeObjectToString.call(e);return r&&(t?e[symToStringTag]=n:delete e[symToStringTag]),i}var _getRawTag=getRawTag,objectProto$1=Object.prototype,nativeObjectToString$1=objectProto$1.toString;function objectToString(e){return nativeObjectToString$1.call(e)}var _objectToString=objectToString,nullTag="[object Null]",undefinedTag="[object Undefined]",symToStringTag$1=_Symbol?_Symbol.toStringTag:void 0;function baseGetTag(e){return null==e?void 0===e?undefinedTag:nullTag:symToStringTag$1&&symToStringTag$1 in Object(e)?_getRawTag(e):_objectToString(e)}var _baseGetTag=baseGetTag;function isObject(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}var isObject_1=isObject,asyncTag="[object AsyncFunction]",funcTag="[object Function]",genTag="[object GeneratorFunction]",proxyTag="[object Proxy]";function isFunction(e){if(!isObject_1(e))return!1;var t=_baseGetTag(e);return t==funcTag||t==genTag||t==asyncTag||t==proxyTag}var isFunction_1=isFunction,coreJsData=_root["__core-js_shared__"],_coreJsData=coreJsData,maskSrcKey=(uid=/[^.]+$/.exec(_coreJsData&&_coreJsData.keys&&_coreJsData.keys.IE_PROTO||""),uid?"Symbol(src)_1."+uid:""),uid;function isMasked(e){return!!maskSrcKey&&maskSrcKey in e}var _isMasked=isMasked,funcProto=Function.prototype,funcToString=funcProto.toString;function toSource(e){if(null!=e){try{return funcToString.call(e)}catch(e){}try{return e+""}catch(e){}}return""}var _toSource=toSource,reRegExpChar=/[\\^$.*+?()[\]{}|]/g,reIsHostCtor=/^\[object .+?Constructor\]$/,funcProto$1=Function.prototype,objectProto$2=Object.prototype,funcToString$1=funcProto$1.toString,hasOwnProperty$1=objectProto$2.hasOwnProperty,reIsNative=RegExp("^"+funcToString$1.call(hasOwnProperty$1).replace(reRegExpChar,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function baseIsNative(e){return!(!isObject_1(e)||_isMasked(e))&&(isFunction_1(e)?reIsNative:reIsHostCtor).test(_toSource(e))}var _baseIsNative=baseIsNative;function getValue(e,t){return null==e?void 0:e[t]}var _getValue=getValue;function getNative(e,t){var n=_getValue(e,t);return _baseIsNative(n)?n:void 0}var _getNative=getNative,defineProperty=function(){try{var e=_getNative(Object,"defineProperty");return e({},"",{}),e}catch(e){}}(),_defineProperty=defineProperty;function baseAssignValue(e,t,n){"__proto__"==t&&_defineProperty?_defineProperty(e,t,{configurable:!0,enumerable:!0,value:n,writable:!0}):e[t]=n}var _baseAssignValue=baseAssignValue;function createBaseFor(e){return function(t,n,r){for(var i=-1,o=Object(t),a=r(t),s=a.length;s--;){var c=a[e?s:++i];if(!1===n(o[c],c,o))break}return t}}var _createBaseFor=createBaseFor,baseFor=_createBaseFor(),_baseFor=baseFor;function baseTimes(e,t){for(var n=-1,r=Array(e);++n<e;)r[n]=t(n);return r}var _baseTimes=baseTimes;function isObjectLike(e){return null!=e&&"object"==typeof e}var isObjectLike_1=isObjectLike,argsTag="[object Arguments]";function baseIsArguments(e){return isObjectLike_1(e)&&_baseGetTag(e)==argsTag}var _baseIsArguments=baseIsArguments,objectProto$3=Object.prototype,hasOwnProperty$2=objectProto$3.hasOwnProperty,propertyIsEnumerable=objectProto$3.propertyIsEnumerable,isArguments=_baseIsArguments(function(){return arguments}())?_baseIsArguments:function(e){return isObjectLike_1(e)&&hasOwnProperty$2.call(e,"callee")&&!propertyIsEnumerable.call(e,"callee")},isArguments_1=isArguments,isArray=Array.isArray,isArray_1=isArray;function stubFalse(){return!1}var stubFalse_1=stubFalse,isBuffer_1=createCommonjsModule((function(e,t){var n=t&&!t.nodeType&&t,r=n&&e&&!e.nodeType&&e,i=r&&r.exports===n?_root.Buffer:void 0,o=(i?i.isBuffer:void 0)||stubFalse_1;e.exports=o})),MAX_SAFE_INTEGER=9007199254740991,reIsUint=/^(?:0|[1-9]\d*)$/;function isIndex(e,t){var n=typeof e;return!!(t=null==t?MAX_SAFE_INTEGER:t)&&("number"==n||"symbol"!=n&&reIsUint.test(e))&&e>-1&&e%1==0&&e<t}var _isIndex=isIndex,MAX_SAFE_INTEGER$1=9007199254740991;function isLength(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=MAX_SAFE_INTEGER$1}var isLength_1=isLength,argsTag$1="[object Arguments]",arrayTag="[object Array]",boolTag="[object Boolean]",dateTag="[object Date]",errorTag="[object Error]",funcTag$1="[object Function]",mapTag="[object Map]",numberTag="[object Number]",objectTag="[object Object]",regexpTag="[object RegExp]",setTag="[object Set]",stringTag="[object String]",weakMapTag="[object WeakMap]",arrayBufferTag="[object ArrayBuffer]",dataViewTag="[object DataView]",float32Tag="[object Float32Array]",float64Tag="[object Float64Array]",int8Tag="[object Int8Array]",int16Tag="[object Int16Array]",int32Tag="[object Int32Array]",uint8Tag="[object Uint8Array]",uint8ClampedTag="[object Uint8ClampedArray]",uint16Tag="[object Uint16Array]",uint32Tag="[object Uint32Array]",typedArrayTags={};function baseIsTypedArray(e){return isObjectLike_1(e)&&isLength_1(e.length)&&!!typedArrayTags[_baseGetTag(e)]}typedArrayTags[float32Tag]=typedArrayTags[float64Tag]=typedArrayTags[int8Tag]=typedArrayTags[int16Tag]=typedArrayTags[int32Tag]=typedArrayTags[uint8Tag]=typedArrayTags[uint8ClampedTag]=typedArrayTags[uint16Tag]=typedArrayTags[uint32Tag]=!0,typedArrayTags[argsTag$1]=typedArrayTags[arrayTag]=typedArrayTags[arrayBufferTag]=typedArrayTags[boolTag]=typedArrayTags[dataViewTag]=typedArrayTags[dateTag]=typedArrayTags[errorTag]=typedArrayTags[funcTag$1]=typedArrayTags[mapTag]=typedArrayTags[numberTag]=typedArrayTags[objectTag]=typedArrayTags[regexpTag]=typedArrayTags[setTag]=typedArrayTags[stringTag]=typedArrayTags[weakMapTag]=!1;var _baseIsTypedArray=baseIsTypedArray;function baseUnary(e){return function(t){return e(t)}}var _baseUnary=baseUnary,isTypedArray=_baseIsTypedArray,isTypedArray_1=isTypedArray,objectProto$4=Object.prototype,hasOwnProperty$3=objectProto$4.hasOwnProperty;function arrayLikeKeys(e,t){var n=isArray_1(e),r=!n&&isArguments_1(e),i=!n&&!r&&isBuffer_1(e),o=!n&&!r&&!i&&isTypedArray_1(e),a=n||r||i||o,s=a?_baseTimes(e.length,String):[],c=s.length;for(var u in e)!t&&!hasOwnProperty$3.call(e,u)||a&&("length"==u||i&&("offset"==u||"parent"==u)||o&&("buffer"==u||"byteLength"==u||"byteOffset"==u)||_isIndex(u,c))||s.push(u);return s}var _arrayLikeKeys=arrayLikeKeys,objectProto$5=Object.prototype;function isPrototype(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||objectProto$5)}var _isPrototype=isPrototype;function overArg(e,t){return function(n){return e(t(n))}}var _overArg=overArg,nativeKeys=_overArg(Object.keys,Object),_nativeKeys=nativeKeys,objectProto$6=Object.prototype,hasOwnProperty$4=objectProto$6.hasOwnProperty;function baseKeys(e){if(!_isPrototype(e))return _nativeKeys(e);var t=[];for(var n in Object(e))hasOwnProperty$4.call(e,n)&&"constructor"!=n&&t.push(n);return t}var _baseKeys=baseKeys;function isArrayLike$1(e){return null!=e&&isLength_1(e.length)&&!isFunction_1(e)}var isArrayLike_1=isArrayLike$1;function keys(e){return isArrayLike_1(e)?_arrayLikeKeys(e):_baseKeys(e)}var keys_1=keys;function baseForOwn(e,t){return e&&_baseFor(e,t,keys_1)}var _baseForOwn=baseForOwn;function listCacheClear(){this.__data__=[],this.size=0}var _listCacheClear=listCacheClear;function eq(e,t){return e===t||e!=e&&t!=t}var eq_1=eq;function assocIndexOf(e,t){for(var n=e.length;n--;)if(eq_1(e[n][0],t))return n;return-1}var _assocIndexOf=assocIndexOf,arrayProto=Array.prototype,splice=arrayProto.splice;function listCacheDelete(e){var t=this.__data__,n=_assocIndexOf(t,e);return!(n<0)&&(n==t.length-1?t.pop():splice.call(t,n,1),--this.size,!0)}var _listCacheDelete=listCacheDelete;function listCacheGet(e){var t=this.__data__,n=_assocIndexOf(t,e);return n<0?void 0:t[n][1]}var _listCacheGet=listCacheGet;function listCacheHas(e){return _assocIndexOf(this.__data__,e)>-1}var _listCacheHas=listCacheHas;function listCacheSet(e,t){var n=this.__data__,r=_assocIndexOf(n,e);return r<0?(++this.size,n.push([e,t])):n[r][1]=t,this}var _listCacheSet=listCacheSet;function ListCache(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}ListCache.prototype.clear=_listCacheClear,ListCache.prototype.delete=_listCacheDelete,ListCache.prototype.get=_listCacheGet,ListCache.prototype.has=_listCacheHas,ListCache.prototype.set=_listCacheSet;var _ListCache=ListCache;function stackClear(){this.__data__=new _ListCache,this.size=0}var _stackClear=stackClear;function stackDelete(e){var t=this.__data__,n=t.delete(e);return this.size=t.size,n}var _stackDelete=stackDelete;function stackGet(e){return this.__data__.get(e)}var _stackGet=stackGet;function stackHas(e){return this.__data__.has(e)}var _stackHas=stackHas,Map$1=_getNative(_root,"Map"),_Map=Map$1,nativeCreate=_getNative(Object,"create"),_nativeCreate=nativeCreate;function hashClear(){this.__data__=_nativeCreate?_nativeCreate(null):{},this.size=0}var _hashClear=hashClear;function hashDelete(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}var _hashDelete=hashDelete,HASH_UNDEFINED="__lodash_hash_undefined__",objectProto$7=Object.prototype,hasOwnProperty$5=objectProto$7.hasOwnProperty;function hashGet(e){var t=this.__data__;if(_nativeCreate){var n=t[e];return n===HASH_UNDEFINED?void 0:n}return hasOwnProperty$5.call(t,e)?t[e]:void 0}var _hashGet=hashGet,objectProto$8=Object.prototype,hasOwnProperty$6=objectProto$8.hasOwnProperty;function hashHas(e){var t=this.__data__;return _nativeCreate?void 0!==t[e]:hasOwnProperty$6.call(t,e)}var _hashHas=hashHas,HASH_UNDEFINED$1="__lodash_hash_undefined__";function hashSet(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=_nativeCreate&&void 0===t?HASH_UNDEFINED$1:t,this}var _hashSet=hashSet;function Hash(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}Hash.prototype.clear=_hashClear,Hash.prototype.delete=_hashDelete,Hash.prototype.get=_hashGet,Hash.prototype.has=_hashHas,Hash.prototype.set=_hashSet;var _Hash=Hash;function mapCacheClear(){this.size=0,this.__data__={hash:new _Hash,map:new(_Map||_ListCache),string:new _Hash}}var _mapCacheClear=mapCacheClear;function isKeyable(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e}var _isKeyable=isKeyable;function getMapData(e,t){var n=e.__data__;return _isKeyable(t)?n["string"==typeof t?"string":"hash"]:n.map}var _getMapData=getMapData;function mapCacheDelete(e){var t=_getMapData(this,e).delete(e);return this.size-=t?1:0,t}var _mapCacheDelete=mapCacheDelete;function mapCacheGet(e){return _getMapData(this,e).get(e)}var _mapCacheGet=mapCacheGet;function mapCacheHas(e){return _getMapData(this,e).has(e)}var _mapCacheHas=mapCacheHas;function mapCacheSet(e,t){var n=_getMapData(this,e),r=n.size;return n.set(e,t),this.size+=n.size==r?0:1,this}var _mapCacheSet=mapCacheSet;function MapCache(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}MapCache.prototype.clear=_mapCacheClear,MapCache.prototype.delete=_mapCacheDelete,MapCache.prototype.get=_mapCacheGet,MapCache.prototype.has=_mapCacheHas,MapCache.prototype.set=_mapCacheSet;var _MapCache=MapCache,LARGE_ARRAY_SIZE=200;function stackSet(e,t){var n=this.__data__;if(n instanceof _ListCache){var r=n.__data__;if(!_Map||r.length<LARGE_ARRAY_SIZE-1)return r.push([e,t]),this.size=++n.size,this;n=this.__data__=new _MapCache(r)}return n.set(e,t),this.size=n.size,this}var _stackSet=stackSet;function Stack(e){var t=this.__data__=new _ListCache(e);this.size=t.size}Stack.prototype.clear=_stackClear,Stack.prototype.delete=_stackDelete,Stack.prototype.get=_stackGet,Stack.prototype.has=_stackHas,Stack.prototype.set=_stackSet;var _Stack=Stack,HASH_UNDEFINED$2="__lodash_hash_undefined__";function setCacheAdd(e){return this.__data__.set(e,HASH_UNDEFINED$2),this}var _setCacheAdd=setCacheAdd;function setCacheHas(e){return this.__data__.has(e)}var _setCacheHas=setCacheHas;function SetCache(e){var t=-1,n=null==e?0:e.length;for(this.__data__=new _MapCache;++t<n;)this.add(e[t])}SetCache.prototype.add=SetCache.prototype.push=_setCacheAdd,SetCache.prototype.has=_setCacheHas;var _SetCache=SetCache;function arraySome(e,t){for(var n=-1,r=null==e?0:e.length;++n<r;)if(t(e[n],n,e))return!0;return!1}var _arraySome=arraySome;function cacheHas(e,t){return e.has(t)}var _cacheHas=cacheHas,COMPARE_PARTIAL_FLAG=1,COMPARE_UNORDERED_FLAG=2;function equalArrays(e,t,n,r,i,o){var a=n&COMPARE_PARTIAL_FLAG,s=e.length,c=t.length;if(s!=c&&!(a&&c>s))return!1;var u=o.get(e),l=o.get(t);if(u&&l)return u==t&&l==e;var d=-1,f=!0,h=n&COMPARE_UNORDERED_FLAG?new _SetCache:void 0;for(o.set(e,t),o.set(t,e);++d<s;){var p=e[d],_=t[d];if(r)var v=a?r(_,p,d,t,e,o):r(p,_,d,e,t,o);if(void 0!==v){if(v)continue;f=!1;break}if(h){if(!_arraySome(t,(function(e,t){if(!_cacheHas(h,t)&&(p===e||i(p,e,n,r,o)))return h.push(t)}))){f=!1;break}}else if(p!==_&&!i(p,_,n,r,o)){f=!1;break}}return o.delete(e),o.delete(t),f}var _equalArrays=equalArrays,Uint8Array$1=_root.Uint8Array,_Uint8Array=Uint8Array$1;function mapToArray(e){var t=-1,n=Array(e.size);return e.forEach((function(e,r){n[++t]=[r,e]})),n}var _mapToArray=mapToArray;function setToArray(e){var t=-1,n=Array(e.size);return e.forEach((function(e){n[++t]=e})),n}var _setToArray=setToArray,COMPARE_PARTIAL_FLAG$1=1,COMPARE_UNORDERED_FLAG$1=2,boolTag$1="[object Boolean]",dateTag$1="[object Date]",errorTag$1="[object Error]",mapTag$1="[object Map]",numberTag$1="[object Number]",regexpTag$1="[object RegExp]",setTag$1="[object Set]",stringTag$1="[object String]",symbolTag="[object Symbol]",arrayBufferTag$1="[object ArrayBuffer]",dataViewTag$1="[object DataView]",symbolProto=_Symbol?_Symbol.prototype:void 0,symbolValueOf=symbolProto?symbolProto.valueOf:void 0;function equalByTag(e,t,n,r,i,o,a){switch(n){case dataViewTag$1:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case arrayBufferTag$1:return!(e.byteLength!=t.byteLength||!o(new _Uint8Array(e),new _Uint8Array(t)));case boolTag$1:case dateTag$1:case numberTag$1:return eq_1(+e,+t);case errorTag$1:return e.name==t.name&&e.message==t.message;case regexpTag$1:case stringTag$1:return e==t+"";case mapTag$1:var s=_mapToArray;case setTag$1:var c=r&COMPARE_PARTIAL_FLAG$1;if(s||(s=_setToArray),e.size!=t.size&&!c)return!1;var u=a.get(e);if(u)return u==t;r|=COMPARE_UNORDERED_FLAG$1,a.set(e,t);var l=_equalArrays(s(e),s(t),r,i,o,a);return a.delete(e),l;case symbolTag:if(symbolValueOf)return symbolValueOf.call(e)==symbolValueOf.call(t)}return!1}var _equalByTag=equalByTag;function arrayPush(e,t){for(var n=-1,r=t.length,i=e.length;++n<r;)e[i+n]=t[n];return e}var _arrayPush=arrayPush;function baseGetAllKeys(e,t,n){var r=t(e);return isArray_1(e)?r:_arrayPush(r,n(e))}var _baseGetAllKeys=baseGetAllKeys;function arrayFilter(e,t){for(var n=-1,r=null==e?0:e.length,i=0,o=[];++n<r;){var a=e[n];t(a,n,e)&&(o[i++]=a)}return o}var _arrayFilter=arrayFilter;function stubArray(){return[]}var stubArray_1=stubArray,objectProto$9=Object.prototype,propertyIsEnumerable$1=objectProto$9.propertyIsEnumerable,nativeGetSymbols=Object.getOwnPropertySymbols,getSymbols=nativeGetSymbols?function(e){return null==e?[]:(e=Object(e),_arrayFilter(nativeGetSymbols(e),(function(t){return propertyIsEnumerable$1.call(e,t)})))}:stubArray_1,_getSymbols=getSymbols;function getAllKeys(e){return _baseGetAllKeys(e,keys_1,_getSymbols)}var _getAllKeys=getAllKeys,COMPARE_PARTIAL_FLAG$2=1,objectProto$a=Object.prototype,hasOwnProperty$7=objectProto$a.hasOwnProperty;function equalObjects(e,t,n,r,i,o){var a=n&COMPARE_PARTIAL_FLAG$2,s=_getAllKeys(e),c=s.length;if(c!=_getAllKeys(t).length&&!a)return!1;for(var u=c;u--;){var l=s[u];if(!(a?l in t:hasOwnProperty$7.call(t,l)))return!1}var d=o.get(e),f=o.get(t);if(d&&f)return d==t&&f==e;var h=!0;o.set(e,t),o.set(t,e);for(var p=a;++u<c;){var _=e[l=s[u]],v=t[l];if(r)var g=a?r(v,_,l,t,e,o):r(_,v,l,e,t,o);if(!(void 0===g?_===v||i(_,v,n,r,o):g)){h=!1;break}p||(p="constructor"==l)}if(h&&!p){var b=e.constructor,m=t.constructor;b==m||!("constructor"in e)||!("constructor"in t)||"function"==typeof b&&b instanceof b&&"function"==typeof m&&m instanceof m||(h=!1)}return o.delete(e),o.delete(t),h}var _equalObjects=equalObjects,DataView=_getNative(_root,"DataView"),_DataView=DataView,Promise$1=_getNative(_root,"Promise"),_Promise=Promise$1,Set$1=_getNative(_root,"Set"),_Set=Set$1,WeakMap=_getNative(_root,"WeakMap"),_WeakMap=WeakMap,mapTag$2="[object Map]",objectTag$1="[object Object]",promiseTag="[object Promise]",setTag$2="[object Set]",weakMapTag$1="[object WeakMap]",dataViewTag$2="[object DataView]",dataViewCtorString=_toSource(_DataView),mapCtorString=_toSource(_Map),promiseCtorString=_toSource(_Promise),setCtorString=_toSource(_Set),weakMapCtorString=_toSource(_WeakMap),getTag=_baseGetTag;(_DataView&&getTag(new _DataView(new ArrayBuffer(1)))!=dataViewTag$2||_Map&&getTag(new _Map)!=mapTag$2||_Promise&&getTag(_Promise.resolve())!=promiseTag||_Set&&getTag(new _Set)!=setTag$2||_WeakMap&&getTag(new _WeakMap)!=weakMapTag$1)&&(getTag=function(e){var t=_baseGetTag(e),n=t==objectTag$1?e.constructor:void 0,r=n?_toSource(n):"";if(r)switch(r){case dataViewCtorString:return dataViewTag$2;case mapCtorString:return mapTag$2;case promiseCtorString:return promiseTag;case setCtorString:return setTag$2;case weakMapCtorString:return weakMapTag$1}return t});var _getTag=getTag,COMPARE_PARTIAL_FLAG$3=1,argsTag$2="[object Arguments]",arrayTag$1="[object Array]",objectTag$2="[object Object]",objectProto$b=Object.prototype,hasOwnProperty$8=objectProto$b.hasOwnProperty;function baseIsEqualDeep(e,t,n,r,i,o){var a=isArray_1(e),s=isArray_1(t),c=a?arrayTag$1:_getTag(e),u=s?arrayTag$1:_getTag(t),l=(c=c==argsTag$2?objectTag$2:c)==objectTag$2,d=(u=u==argsTag$2?objectTag$2:u)==objectTag$2,f=c==u;if(f&&isBuffer_1(e)){if(!isBuffer_1(t))return!1;a=!0,l=!1}if(f&&!l)return o||(o=new _Stack),a||isTypedArray_1(e)?_equalArrays(e,t,n,r,i,o):_equalByTag(e,t,c,n,r,i,o);if(!(n&COMPARE_PARTIAL_FLAG$3)){var h=l&&hasOwnProperty$8.call(e,"__wrapped__"),p=d&&hasOwnProperty$8.call(t,"__wrapped__");if(h||p){var _=h?e.value():e,v=p?t.value():t;return o||(o=new _Stack),i(_,v,n,r,o)}}return!!f&&(o||(o=new _Stack),_equalObjects(e,t,n,r,i,o))}var _baseIsEqualDeep=baseIsEqualDeep;function baseIsEqual(e,t,n,r,i){return e===t||(null==e||null==t||!isObjectLike_1(e)&&!isObjectLike_1(t)?e!=e&&t!=t:_baseIsEqualDeep(e,t,n,r,baseIsEqual,i))}var _baseIsEqual=baseIsEqual,COMPARE_PARTIAL_FLAG$4=1,COMPARE_UNORDERED_FLAG$2=2;function baseIsMatch(e,t,n,r){var i=n.length,o=i,a=!r;if(null==e)return!o;for(e=Object(e);i--;){var s=n[i];if(a&&s[2]?s[1]!==e[s[0]]:!(s[0]in e))return!1}for(;++i<o;){var c=(s=n[i])[0],u=e[c],l=s[1];if(a&&s[2]){if(void 0===u&&!(c in e))return!1}else{var d=new _Stack;if(r)var f=r(u,l,c,e,t,d);if(!(void 0===f?_baseIsEqual(l,u,COMPARE_PARTIAL_FLAG$4|COMPARE_UNORDERED_FLAG$2,r,d):f))return!1}}return!0}var _baseIsMatch=baseIsMatch;function isStrictComparable(e){return e==e&&!isObject_1(e)}var _isStrictComparable=isStrictComparable;function getMatchData(e){for(var t=keys_1(e),n=t.length;n--;){var r=t[n],i=e[r];t[n]=[r,i,_isStrictComparable(i)]}return t}var _getMatchData=getMatchData;function matchesStrictComparable(e,t){return function(n){return null!=n&&n[e]===t&&(void 0!==t||e in Object(n))}}var _matchesStrictComparable=matchesStrictComparable;function baseMatches(e){var t=_getMatchData(e);return 1==t.length&&t[0][2]?_matchesStrictComparable(t[0][0],t[0][1]):function(n){return n===e||_baseIsMatch(n,e,t)}}var _baseMatches=baseMatches,symbolTag$1="[object Symbol]";function isSymbol(e){return"symbol"==typeof e||isObjectLike_1(e)&&_baseGetTag(e)==symbolTag$1}var isSymbol_1=isSymbol,reIsDeepProp=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,reIsPlainProp=/^\w*$/;function isKey(e,t){if(isArray_1(e))return!1;var n=typeof e;return!("number"!=n&&"symbol"!=n&&"boolean"!=n&&null!=e&&!isSymbol_1(e))||reIsPlainProp.test(e)||!reIsDeepProp.test(e)||null!=t&&e in Object(t)}var _isKey=isKey,FUNC_ERROR_TEXT="Expected a function";function memoize(e,t){if("function"!=typeof e||null!=t&&"function"!=typeof t)throw new TypeError(FUNC_ERROR_TEXT);var n=function n(){var r=arguments,i=t?t.apply(this,r):r[0],o=n.cache;if(o.has(i))return o.get(i);var a=e.apply(this,r);return n.cache=o.set(i,a)||o,a};return n.cache=new(memoize.Cache||_MapCache),n}memoize.Cache=_MapCache;var memoize_1=memoize,MAX_MEMOIZE_SIZE=500;function memoizeCapped(e){var t=memoize_1(e,(function(e){return n.size===MAX_MEMOIZE_SIZE&&n.clear(),e})),n=t.cache;return t}var _memoizeCapped=memoizeCapped,rePropName=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,reEscapeChar=/\\(\\)?/g,stringToPath=_memoizeCapped((function(e){var t=[];return 46===e.charCodeAt(0)&&t.push(""),e.replace(rePropName,(function(e,n,r,i){t.push(r?i.replace(reEscapeChar,"$1"):n||e)})),t})),_stringToPath=stringToPath;function arrayMap(e,t){for(var n=-1,r=null==e?0:e.length,i=Array(r);++n<r;)i[n]=t(e[n],n,e);return i}var _arrayMap=arrayMap,INFINITY=1/0,symbolProto$1=_Symbol?_Symbol.prototype:void 0,symbolToString=symbolProto$1?symbolProto$1.toString:void 0;function baseToString(e){if("string"==typeof e)return e;if(isArray_1(e))return _arrayMap(e,baseToString)+"";if(isSymbol_1(e))return symbolToString?symbolToString.call(e):"";var t=e+"";return"0"==t&&1/e==-INFINITY?"-0":t}var _baseToString=baseToString;function toString(e){return null==e?"":_baseToString(e)}var toString_1=toString;function castPath(e,t){return isArray_1(e)?e:_isKey(e,t)?[e]:_stringToPath(toString_1(e))}var _castPath=castPath,INFINITY$1=1/0;function toKey(e){if("string"==typeof e||isSymbol_1(e))return e;var t=e+"";return"0"==t&&1/e==-INFINITY$1?"-0":t}var _toKey=toKey;function baseGet(e,t){for(var n=0,r=(t=_castPath(t,e)).length;null!=e&&n<r;)e=e[_toKey(t[n++])];return n&&n==r?e:void 0}var _baseGet=baseGet;function get(e,t,n){var r=null==e?void 0:_baseGet(e,t);return void 0===r?n:r}var get_1=get;function baseHasIn(e,t){return null!=e&&t in Object(e)}var _baseHasIn=baseHasIn;function hasPath(e,t,n){for(var r=-1,i=(t=_castPath(t,e)).length,o=!1;++r<i;){var a=_toKey(t[r]);if(!(o=null!=e&&n(e,a)))break;e=e[a]}return o||++r!=i?o:!!(i=null==e?0:e.length)&&isLength_1(i)&&_isIndex(a,i)&&(isArray_1(e)||isArguments_1(e))}var _hasPath=hasPath;function hasIn(e,t){return null!=e&&_hasPath(e,t,_baseHasIn)}var hasIn_1=hasIn,COMPARE_PARTIAL_FLAG$5=1,COMPARE_UNORDERED_FLAG$3=2;function baseMatchesProperty(e,t){return _isKey(e)&&_isStrictComparable(t)?_matchesStrictComparable(_toKey(e),t):function(n){var r=get_1(n,e);return void 0===r&&r===t?hasIn_1(n,e):_baseIsEqual(t,r,COMPARE_PARTIAL_FLAG$5|COMPARE_UNORDERED_FLAG$3)}}var _baseMatchesProperty=baseMatchesProperty;function identity(e){return e}var identity_1=identity;function baseProperty(e){return function(t){return null==t?void 0:t[e]}}var _baseProperty=baseProperty;function basePropertyDeep(e){return function(t){return _baseGet(t,e)}}var _basePropertyDeep=basePropertyDeep;function property(e){return _isKey(e)?_baseProperty(_toKey(e)):_basePropertyDeep(e)}var property_1=property;function baseIteratee(e){return"function"==typeof e?e:null==e?identity_1:"object"==typeof e?isArray_1(e)?_baseMatchesProperty(e[0],e[1]):_baseMatches(e):property_1(e)}var _baseIteratee=baseIteratee;function mapValues(e,t){var n={};return t=_baseIteratee(t),_baseForOwn(e,(function(e,r,i){_baseAssignValue(n,r,t(e,r,i))})),n}var mapValues_1=mapValues,long_1=Long;function Long(e,t,n){this.low=0|e,this.high=0|t,this.unsigned=!!n}function isLong(e){return!0===(e&&e.__isLong__)}Long.prototype.__isLong__,Object.defineProperty(Long.prototype,"__isLong__",{value:!0}),Long.isLong=isLong;var INT_CACHE={},UINT_CACHE={};function fromInt(e,t){var n,r,i;return t?(i=0<=(e>>>=0)&&e<256)&&(r=UINT_CACHE[e])?r:(n=fromBits(e,(0|e)<0?-1:0,!0),i&&(UINT_CACHE[e]=n),n):(i=-128<=(e|=0)&&e<128)&&(r=INT_CACHE[e])?r:(n=fromBits(e,e<0?-1:0,!1),i&&(INT_CACHE[e]=n),n)}function fromNumber(e,t){if(isNaN(e))return t?UZERO:ZERO;if(t){if(e<0)return UZERO;if(e>=TWO_PWR_64_DBL)return MAX_UNSIGNED_VALUE}else{if(e<=-TWO_PWR_63_DBL)return MIN_VALUE;if(e+1>=TWO_PWR_63_DBL)return MAX_VALUE}return e<0?fromNumber(-e,t).neg():fromBits(e%TWO_PWR_32_DBL|0,e/TWO_PWR_32_DBL|0,t)}function fromBits(e,t,n){return new Long(e,t,n)}Long.fromInt=fromInt,Long.fromNumber=fromNumber,Long.fromBits=fromBits;var pow_dbl=Math.pow;function fromString(e,t,n){if(0===e.length)throw Error("empty string");if("NaN"===e||"Infinity"===e||"+Infinity"===e||"-Infinity"===e)return ZERO;if("number"==typeof t?(n=t,t=!1):t=!!t,(n=n||10)<2||36<n)throw RangeError("radix");var r;if((r=e.indexOf("-"))>0)throw Error("interior hyphen");if(0===r)return fromString(e.substring(1),t,n).neg();for(var i=fromNumber(pow_dbl(n,8)),o=ZERO,a=0;a<e.length;a+=8){var s=Math.min(8,e.length-a),c=parseInt(e.substring(a,a+s),n);if(s<8){var u=fromNumber(pow_dbl(n,s));o=o.mul(u).add(fromNumber(c))}else o=(o=o.mul(i)).add(fromNumber(c))}return o.unsigned=t,o}function fromValue(e,t){return"number"==typeof e?fromNumber(e,t):"string"==typeof e?fromString(e,t):fromBits(e.low,e.high,"boolean"==typeof t?t:e.unsigned)}Long.fromString=fromString,Long.fromValue=fromValue;var TWO_PWR_16_DBL=65536,TWO_PWR_24_DBL=1<<24,TWO_PWR_32_DBL=TWO_PWR_16_DBL*TWO_PWR_16_DBL,TWO_PWR_64_DBL=TWO_PWR_32_DBL*TWO_PWR_32_DBL,TWO_PWR_63_DBL=TWO_PWR_64_DBL/2,TWO_PWR_24=fromInt(TWO_PWR_24_DBL),ZERO=fromInt(0);Long.ZERO=ZERO;var UZERO=fromInt(0,!0);Long.UZERO=UZERO;var ONE=fromInt(1);Long.ONE=ONE;var UONE=fromInt(1,!0);Long.UONE=UONE;var NEG_ONE=fromInt(-1);Long.NEG_ONE=NEG_ONE;var MAX_VALUE=fromBits(-1,2147483647,!1);Long.MAX_VALUE=MAX_VALUE;var MAX_UNSIGNED_VALUE=fromBits(-1,-1,!0);Long.MAX_UNSIGNED_VALUE=MAX_UNSIGNED_VALUE;var MIN_VALUE=fromBits(0,-2147483648,!1);Long.MIN_VALUE=MIN_VALUE;var LongPrototype=Long.prototype;LongPrototype.toInt=function(){return this.unsigned?this.low>>>0:this.low},LongPrototype.toNumber=function(){return this.unsigned?(this.high>>>0)*TWO_PWR_32_DBL+(this.low>>>0):this.high*TWO_PWR_32_DBL+(this.low>>>0)},LongPrototype.toString=function(e){if((e=e||10)<2||36<e)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative()){if(this.eq(MIN_VALUE)){var t=fromNumber(e),n=this.div(t),r=n.mul(t).sub(this);return n.toString(e)+r.toInt().toString(e)}return"-"+this.neg().toString(e)}for(var i=fromNumber(pow_dbl(e,6),this.unsigned),o=this,a="";;){var s=o.div(i),c=(o.sub(s.mul(i)).toInt()>>>0).toString(e);if((o=s).isZero())return c+a;for(;c.length<6;)c="0"+c;a=""+c+a}},LongPrototype.getHighBits=function(){return this.high},LongPrototype.getHighBitsUnsigned=function(){return this.high>>>0},LongPrototype.getLowBits=function(){return this.low},LongPrototype.getLowBitsUnsigned=function(){return this.low>>>0},LongPrototype.getNumBitsAbs=function(){if(this.isNegative())return this.eq(MIN_VALUE)?64:this.neg().getNumBitsAbs();for(var e=0!=this.high?this.high:this.low,t=31;t>0&&0==(e&1<<t);t--);return 0!=this.high?t+33:t+1},LongPrototype.isZero=function(){return 0===this.high&&0===this.low},LongPrototype.eqz=LongPrototype.isZero,LongPrototype.isNegative=function(){return!this.unsigned&&this.high<0},LongPrototype.isPositive=function(){return this.unsigned||this.high>=0},LongPrototype.isOdd=function(){return 1==(1&this.low)},LongPrototype.isEven=function(){return 0==(1&this.low)},LongPrototype.equals=function(e){return isLong(e)||(e=fromValue(e)),(this.unsigned===e.unsigned||this.high>>>31!=1||e.high>>>31!=1)&&this.high===e.high&&this.low===e.low},LongPrototype.eq=LongPrototype.equals,LongPrototype.notEquals=function(e){return!this.eq(e)},LongPrototype.neq=LongPrototype.notEquals,LongPrototype.ne=LongPrototype.notEquals,LongPrototype.lessThan=function(e){return this.comp(e)<0},LongPrototype.lt=LongPrototype.lessThan,LongPrototype.lessThanOrEqual=function(e){return this.comp(e)<=0},LongPrototype.lte=LongPrototype.lessThanOrEqual,LongPrototype.le=LongPrototype.lessThanOrEqual,LongPrototype.greaterThan=function(e){return this.comp(e)>0},LongPrototype.gt=LongPrototype.greaterThan,LongPrototype.greaterThanOrEqual=function(e){return this.comp(e)>=0},LongPrototype.gte=LongPrototype.greaterThanOrEqual,LongPrototype.ge=LongPrototype.greaterThanOrEqual,LongPrototype.compare=function(e){if(isLong(e)||(e=fromValue(e)),this.eq(e))return 0;var t=this.isNegative(),n=e.isNegative();return t&&!n?-1:!t&&n?1:this.unsigned?e.high>>>0>this.high>>>0||e.high===this.high&&e.low>>>0>this.low>>>0?-1:1:this.sub(e).isNegative()?-1:1},LongPrototype.comp=LongPrototype.compare,LongPrototype.negate=function(){return!this.unsigned&&this.eq(MIN_VALUE)?MIN_VALUE:this.not().add(ONE)},LongPrototype.neg=LongPrototype.negate,LongPrototype.add=function(e){isLong(e)||(e=fromValue(e));var t=this.high>>>16,n=65535&this.high,r=this.low>>>16,i=65535&this.low,o=e.high>>>16,a=65535&e.high,s=e.low>>>16,c=0,u=0,l=0,d=0;return l+=(d+=i+(65535&e.low))>>>16,u+=(l+=r+s)>>>16,c+=(u+=n+a)>>>16,c+=t+o,fromBits((l&=65535)<<16|(d&=65535),(c&=65535)<<16|(u&=65535),this.unsigned)},LongPrototype.subtract=function(e){return isLong(e)||(e=fromValue(e)),this.add(e.neg())},LongPrototype.sub=LongPrototype.subtract,LongPrototype.multiply=function(e){if(this.isZero())return ZERO;if(isLong(e)||(e=fromValue(e)),e.isZero())return ZERO;if(this.eq(MIN_VALUE))return e.isOdd()?MIN_VALUE:ZERO;if(e.eq(MIN_VALUE))return this.isOdd()?MIN_VALUE:ZERO;if(this.isNegative())return e.isNegative()?this.neg().mul(e.neg()):this.neg().mul(e).neg();if(e.isNegative())return this.mul(e.neg()).neg();if(this.lt(TWO_PWR_24)&&e.lt(TWO_PWR_24))return fromNumber(this.toNumber()*e.toNumber(),this.unsigned);var t=this.high>>>16,n=65535&this.high,r=this.low>>>16,i=65535&this.low,o=e.high>>>16,a=65535&e.high,s=e.low>>>16,c=65535&e.low,u=0,l=0,d=0,f=0;return d+=(f+=i*c)>>>16,l+=(d+=r*c)>>>16,d&=65535,l+=(d+=i*s)>>>16,u+=(l+=n*c)>>>16,l&=65535,u+=(l+=r*s)>>>16,l&=65535,u+=(l+=i*a)>>>16,u+=t*c+n*s+r*a+i*o,fromBits((d&=65535)<<16|(f&=65535),(u&=65535)<<16|(l&=65535),this.unsigned)},LongPrototype.mul=LongPrototype.multiply,LongPrototype.divide=function(e){if(isLong(e)||(e=fromValue(e)),e.isZero())throw Error("division by zero");if(this.isZero())return this.unsigned?UZERO:ZERO;var t,n,r;if(this.unsigned){if(e.unsigned||(e=e.toUnsigned()),e.gt(this))return UZERO;if(e.gt(this.shru(1)))return UONE;r=UZERO}else{if(this.eq(MIN_VALUE))return e.eq(ONE)||e.eq(NEG_ONE)?MIN_VALUE:e.eq(MIN_VALUE)?ONE:(t=this.shr(1).div(e).shl(1)).eq(ZERO)?e.isNegative()?ONE:NEG_ONE:(n=this.sub(e.mul(t)),r=t.add(n.div(e)));if(e.eq(MIN_VALUE))return this.unsigned?UZERO:ZERO;if(this.isNegative())return e.isNegative()?this.neg().div(e.neg()):this.neg().div(e).neg();if(e.isNegative())return this.div(e.neg()).neg();r=ZERO}for(n=this;n.gte(e);){t=Math.max(1,Math.floor(n.toNumber()/e.toNumber()));for(var i=Math.ceil(Math.log(t)/Math.LN2),o=i<=48?1:pow_dbl(2,i-48),a=fromNumber(t),s=a.mul(e);s.isNegative()||s.gt(n);)s=(a=fromNumber(t-=o,this.unsigned)).mul(e);a.isZero()&&(a=ONE),r=r.add(a),n=n.sub(s)}return r},LongPrototype.div=LongPrototype.divide,LongPrototype.modulo=function(e){return isLong(e)||(e=fromValue(e)),this.sub(this.div(e).mul(e))},LongPrototype.mod=LongPrototype.modulo,LongPrototype.rem=LongPrototype.modulo,LongPrototype.not=function(){return fromBits(~this.low,~this.high,this.unsigned)},LongPrototype.and=function(e){return isLong(e)||(e=fromValue(e)),fromBits(this.low&e.low,this.high&e.high,this.unsigned)},LongPrototype.or=function(e){return isLong(e)||(e=fromValue(e)),fromBits(this.low|e.low,this.high|e.high,this.unsigned)},LongPrototype.xor=function(e){return isLong(e)||(e=fromValue(e)),fromBits(this.low^e.low,this.high^e.high,this.unsigned)},LongPrototype.shiftLeft=function(e){return isLong(e)&&(e=e.toInt()),0==(e&=63)?this:e<32?fromBits(this.low<<e,this.high<<e|this.low>>>32-e,this.unsigned):fromBits(0,this.low<<e-32,this.unsigned)},LongPrototype.shl=LongPrototype.shiftLeft,LongPrototype.shiftRight=function(e){return isLong(e)&&(e=e.toInt()),0==(e&=63)?this:e<32?fromBits(this.low>>>e|this.high<<32-e,this.high>>e,this.unsigned):fromBits(this.high>>e-32,this.high>=0?0:-1,this.unsigned)},LongPrototype.shr=LongPrototype.shiftRight,LongPrototype.shiftRightUnsigned=function(e){if(isLong(e)&&(e=e.toInt()),0===(e&=63))return this;var t=this.high;return e<32?fromBits(this.low>>>e|t<<32-e,t>>>e,this.unsigned):fromBits(32===e?t:t>>>e-32,0,this.unsigned)},LongPrototype.shru=LongPrototype.shiftRightUnsigned,LongPrototype.shr_u=LongPrototype.shiftRightUnsigned,LongPrototype.toSigned=function(){return this.unsigned?fromBits(this.low,this.high,!1):this},LongPrototype.toUnsigned=function(){return this.unsigned?this:fromBits(this.low,this.high,!0)},LongPrototype.toBytes=function(e){return e?this.toBytesLE():this.toBytesBE()},LongPrototype.toBytesLE=function(){var e=this.high,t=this.low;return[255&t,t>>>8&255,t>>>16&255,t>>>24,255&e,e>>>8&255,e>>>16&255,e>>>24]},LongPrototype.toBytesBE=function(){var e=this.high,t=this.low;return[e>>>24,e>>>16&255,e>>>8&255,255&e,t>>>24,t>>>16&255,t>>>8&255,255&t]},Long.fromBytes=function(e,t,n){return n?Long.fromBytesLE(e,t):Long.fromBytesBE(e,t)},Long.fromBytesLE=function(e,t){return new Long(e[0]|e[1]<<8|e[2]<<16|e[3]<<24,e[4]|e[5]<<8|e[6]<<16|e[7]<<24,t)},Long.fromBytesBE=function(e,t){return new Long(e[4]<<24|e[5]<<16|e[6]<<8|e[7],e[0]<<24|e[1]<<16|e[2]<<8|e[3],t)};var _extendStatics=function(e,t){return(_extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)};function __extends(e,t){function n(){this.constructor=e}_extendStatics(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}function isFunction$1(e){return"function"==typeof e}var _enable_super_gross_mode_that_will_cause_bad_things=!1,config={Promise:void 0,set useDeprecatedSynchronousErrorHandling(e){e&&(new Error).stack,_enable_super_gross_mode_that_will_cause_bad_things=e},get useDeprecatedSynchronousErrorHandling(){return _enable_super_gross_mode_that_will_cause_bad_things}};function hostReportError(e){setTimeout((function(){throw e}),0)}var empty={closed:!0,next:function(e){},error:function(e){if(config.useDeprecatedSynchronousErrorHandling)throw e;hostReportError(e)},complete:function(){}},isArray$1=function(){return Array.isArray||function(e){return e&&"number"==typeof e.length}}();function isObject$1(e){return null!==e&&"object"==typeof e}var UnsubscriptionErrorImpl=function(){function e(e){return Error.call(this),this.message=e?e.length+" errors occurred during unsubscription:\n"+e.map((function(e,t){return t+1+") "+e.toString()})).join("\n  "):"",this.name="UnsubscriptionError",this.errors=e,this}return e.prototype=Object.create(Error.prototype),e}(),UnsubscriptionError=UnsubscriptionErrorImpl,Subscription=function(){function e(e){this.closed=!1,this._parentOrParents=null,this._subscriptions=null,e&&(this._ctorUnsubscribe=!0,this._unsubscribe=e)}return e.prototype.unsubscribe=function(){var t;if(!this.closed){var n=this,r=n._parentOrParents,i=n._ctorUnsubscribe,o=n._unsubscribe,a=n._subscriptions;if(this.closed=!0,this._parentOrParents=null,this._subscriptions=null,r instanceof e)r.remove(this);else if(null!==r)for(var s=0;s<r.length;++s)r[s].remove(this);if(isFunction$1(o)){i&&(this._unsubscribe=void 0);try{o.call(this)}catch(e){t=e instanceof UnsubscriptionError?flattenUnsubscriptionErrors(e.errors):[e]}}if(isArray$1(a)){s=-1;for(var c=a.length;++s<c;){var u=a[s];if(isObject$1(u))try{u.unsubscribe()}catch(e){t=t||[],e instanceof UnsubscriptionError?t=t.concat(flattenUnsubscriptionErrors(e.errors)):t.push(e)}}}if(t)throw new UnsubscriptionError(t)}},e.prototype.add=function(t){var n=t;if(!t)return e.EMPTY;switch(typeof t){case"function":n=new e(t);case"object":if(n===this||n.closed||"function"!=typeof n.unsubscribe)return n;if(this.closed)return n.unsubscribe(),n;if(!(n instanceof e)){var r=n;(n=new e)._subscriptions=[r]}break;default:throw new Error("unrecognized teardown "+t+" added to Subscription.")}var i=n._parentOrParents;if(null===i)n._parentOrParents=this;else if(i instanceof e){if(i===this)return n;n._parentOrParents=[i,this]}else{if(-1!==i.indexOf(this))return n;i.push(this)}var o=this._subscriptions;return null===o?this._subscriptions=[n]:o.push(n),n},e.prototype.remove=function(e){var t=this._subscriptions;if(t){var n=t.indexOf(e);-1!==n&&t.splice(n,1)}},e.EMPTY=function(e){return e.closed=!0,e}(new e),e}();function flattenUnsubscriptionErrors(e){return e.reduce((function(e,t){return e.concat(t instanceof UnsubscriptionError?t.errors:t)}),[])}var rxSubscriber=function(){return"function"==typeof Symbol?Symbol("rxSubscriber"):"@@rxSubscriber_"+Math.random()}(),Subscriber=function(e){function t(n,r,i){var o=e.call(this)||this;switch(o.syncErrorValue=null,o.syncErrorThrown=!1,o.syncErrorThrowable=!1,o.isStopped=!1,arguments.length){case 0:o.destination=empty;break;case 1:if(!n){o.destination=empty;break}if("object"==typeof n){n instanceof t?(o.syncErrorThrowable=n.syncErrorThrowable,o.destination=n,n.add(o)):(o.syncErrorThrowable=!0,o.destination=new SafeSubscriber(o,n));break}default:o.syncErrorThrowable=!0,o.destination=new SafeSubscriber(o,n,r,i)}return o}return __extends(t,e),t.prototype[rxSubscriber]=function(){return this},t.create=function(e,n,r){var i=new t(e,n,r);return i.syncErrorThrowable=!1,i},t.prototype.next=function(e){this.isStopped||this._next(e)},t.prototype.error=function(e){this.isStopped||(this.isStopped=!0,this._error(e))},t.prototype.complete=function(){this.isStopped||(this.isStopped=!0,this._complete())},t.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,e.prototype.unsubscribe.call(this))},t.prototype._next=function(e){this.destination.next(e)},t.prototype._error=function(e){this.destination.error(e),this.unsubscribe()},t.prototype._complete=function(){this.destination.complete(),this.unsubscribe()},t.prototype._unsubscribeAndRecycle=function(){var e=this._parentOrParents;return this._parentOrParents=null,this.unsubscribe(),this.closed=!1,this.isStopped=!1,this._parentOrParents=e,this},t}(Subscription),SafeSubscriber=function(e){function t(t,n,r,i){var o,a=e.call(this)||this;a._parentSubscriber=t;var s=a;return isFunction$1(n)?o=n:n&&(o=n.next,r=n.error,i=n.complete,n!==empty&&(isFunction$1((s=Object.create(n)).unsubscribe)&&a.add(s.unsubscribe.bind(s)),s.unsubscribe=a.unsubscribe.bind(a))),a._context=s,a._next=o,a._error=r,a._complete=i,a}return __extends(t,e),t.prototype.next=function(e){if(!this.isStopped&&this._next){var t=this._parentSubscriber;config.useDeprecatedSynchronousErrorHandling&&t.syncErrorThrowable?this.__tryOrSetError(t,this._next,e)&&this.unsubscribe():this.__tryOrUnsub(this._next,e)}},t.prototype.error=function(e){if(!this.isStopped){var t=this._parentSubscriber,n=config.useDeprecatedSynchronousErrorHandling;if(this._error)n&&t.syncErrorThrowable?(this.__tryOrSetError(t,this._error,e),this.unsubscribe()):(this.__tryOrUnsub(this._error,e),this.unsubscribe());else if(t.syncErrorThrowable)n?(t.syncErrorValue=e,t.syncErrorThrown=!0):hostReportError(e),this.unsubscribe();else{if(this.unsubscribe(),n)throw e;hostReportError(e)}}},t.prototype.complete=function(){var e=this;if(!this.isStopped){var t=this._parentSubscriber;if(this._complete){var n=function(){return e._complete.call(e._context)};config.useDeprecatedSynchronousErrorHandling&&t.syncErrorThrowable?(this.__tryOrSetError(t,n),this.unsubscribe()):(this.__tryOrUnsub(n),this.unsubscribe())}else this.unsubscribe()}},t.prototype.__tryOrUnsub=function(e,t){try{e.call(this._context,t)}catch(e){if(this.unsubscribe(),config.useDeprecatedSynchronousErrorHandling)throw e;hostReportError(e)}},t.prototype.__tryOrSetError=function(e,t,n){if(!config.useDeprecatedSynchronousErrorHandling)throw new Error("bad call");try{t.call(this._context,n)}catch(t){return config.useDeprecatedSynchronousErrorHandling?(e.syncErrorValue=t,e.syncErrorThrown=!0,!0):(hostReportError(t),!0)}return!1},t.prototype._unsubscribe=function(){var e=this._parentSubscriber;this._context=null,this._parentSubscriber=null,e.unsubscribe()},t}(Subscriber);function canReportError(e){for(;e;){var t=e,n=t.closed,r=t.destination,i=t.isStopped;if(n||i)return!1;e=r&&r instanceof Subscriber?r:null}return!0}function toSubscriber(e,t,n){if(e){if(e instanceof Subscriber)return e;if(e[rxSubscriber])return e[rxSubscriber]()}return e||t||n?new Subscriber(e,t,n):new Subscriber(empty)}var observable=function(){return"function"==typeof Symbol&&Symbol.observable||"@@observable"}();function identity$1(e){return e}function pipe(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return pipeFromArray(e)}function pipeFromArray(e){return 0===e.length?identity$1:1===e.length?e[0]:function(t){return e.reduce((function(e,t){return t(e)}),t)}}var Observable=function(){function e(e){this._isScalar=!1,e&&(this._subscribe=e)}return e.prototype.lift=function(t){var n=new e;return n.source=this,n.operator=t,n},e.prototype.subscribe=function(e,t,n){var r=this.operator,i=toSubscriber(e,t,n);if(r?i.add(r.call(i,this.source)):i.add(this.source||config.useDeprecatedSynchronousErrorHandling&&!i.syncErrorThrowable?this._subscribe(i):this._trySubscribe(i)),config.useDeprecatedSynchronousErrorHandling&&i.syncErrorThrowable&&(i.syncErrorThrowable=!1,i.syncErrorThrown))throw i.syncErrorValue;return i},e.prototype._trySubscribe=function(e){try{return this._subscribe(e)}catch(t){config.useDeprecatedSynchronousErrorHandling&&(e.syncErrorThrown=!0,e.syncErrorValue=t),canReportError(e)?e.error(t):console.warn(t)}},e.prototype.forEach=function(e,t){var n=this;return new(t=getPromiseCtor(t))((function(t,r){var i;i=n.subscribe((function(t){try{e(t)}catch(e){r(e),i&&i.unsubscribe()}}),r,t)}))},e.prototype._subscribe=function(e){var t=this.source;return t&&t.subscribe(e)},e.prototype[observable]=function(){return this},e.prototype.pipe=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return 0===e.length?this:pipeFromArray(e)(this)},e.prototype.toPromise=function(e){var t=this;return new(e=getPromiseCtor(e))((function(e,n){var r;t.subscribe((function(e){return r=e}),(function(e){return n(e)}),(function(){return e(r)}))}))},e.create=function(t){return new e(t)},e}();function getPromiseCtor(e){if(e||(e=Promise),!e)throw new Error("no Promise impl found");return e}var ObjectUnsubscribedErrorImpl=function(){function e(){return Error.call(this),this.message="object unsubscribed",this.name="ObjectUnsubscribedError",this}return e.prototype=Object.create(Error.prototype),e}(),ObjectUnsubscribedError=ObjectUnsubscribedErrorImpl,SubjectSubscription=function(e){function t(t,n){var r=e.call(this)||this;return r.subject=t,r.subscriber=n,r.closed=!1,r}return __extends(t,e),t.prototype.unsubscribe=function(){if(!this.closed){this.closed=!0;var e=this.subject,t=e.observers;if(this.subject=null,t&&0!==t.length&&!e.isStopped&&!e.closed){var n=t.indexOf(this.subscriber);-1!==n&&t.splice(n,1)}}},t}(Subscription),SubjectSubscriber=function(e){function t(t){var n=e.call(this,t)||this;return n.destination=t,n}return __extends(t,e),t}(Subscriber),Subject=function(e){function t(){var t=e.call(this)||this;return t.observers=[],t.closed=!1,t.isStopped=!1,t.hasError=!1,t.thrownError=null,t}return __extends(t,e),t.prototype[rxSubscriber]=function(){return new SubjectSubscriber(this)},t.prototype.lift=function(e){var t=new AnonymousSubject(this,this);return t.operator=e,t},t.prototype.next=function(e){if(this.closed)throw new ObjectUnsubscribedError;if(!this.isStopped)for(var t=this.observers,n=t.length,r=t.slice(),i=0;i<n;i++)r[i].next(e)},t.prototype.error=function(e){if(this.closed)throw new ObjectUnsubscribedError;this.hasError=!0,this.thrownError=e,this.isStopped=!0;for(var t=this.observers,n=t.length,r=t.slice(),i=0;i<n;i++)r[i].error(e);this.observers.length=0},t.prototype.complete=function(){if(this.closed)throw new ObjectUnsubscribedError;this.isStopped=!0;for(var e=this.observers,t=e.length,n=e.slice(),r=0;r<t;r++)n[r].complete();this.observers.length=0},t.prototype.unsubscribe=function(){this.isStopped=!0,this.closed=!0,this.observers=null},t.prototype._trySubscribe=function(t){if(this.closed)throw new ObjectUnsubscribedError;return e.prototype._trySubscribe.call(this,t)},t.prototype._subscribe=function(e){if(this.closed)throw new ObjectUnsubscribedError;return this.hasError?(e.error(this.thrownError),Subscription.EMPTY):this.isStopped?(e.complete(),Subscription.EMPTY):(this.observers.push(e),new SubjectSubscription(this,e))},t.prototype.asObservable=function(){var e=new Observable;return e.source=this,e},t.create=function(e,t){return new AnonymousSubject(e,t)},t}(Observable),AnonymousSubject=function(e){function t(t,n){var r=e.call(this)||this;return r.destination=t,r.source=n,r}return __extends(t,e),t.prototype.next=function(e){var t=this.destination;t&&t.next&&t.next(e)},t.prototype.error=function(e){var t=this.destination;t&&t.error&&this.destination.error(e)},t.prototype.complete=function(){var e=this.destination;e&&e.complete&&this.destination.complete()},t.prototype._subscribe=function(e){return this.source?this.source.subscribe(e):Subscription.EMPTY},t}(Subject);function refCount(){return function(e){return e.lift(new RefCountOperator(e))}}var RefCountOperator=function(){function e(e){this.connectable=e}return e.prototype.call=function(e,t){var n=this.connectable;n._refCount++;var r=new RefCountSubscriber(e,n),i=t.subscribe(r);return r.closed||(r.connection=n.connect()),i},e}(),RefCountSubscriber=function(e){function t(t,n){var r=e.call(this,t)||this;return r.connectable=n,r}return __extends(t,e),t.prototype._unsubscribe=function(){var e=this.connectable;if(e){this.connectable=null;var t=e._refCount;if(t<=0)this.connection=null;else if(e._refCount=t-1,t>1)this.connection=null;else{var n=this.connection,r=e._connection;this.connection=null,!r||n&&r!==n||r.unsubscribe()}}else this.connection=null},t}(Subscriber),ConnectableObservable=function(e){function t(t,n){var r=e.call(this)||this;return r.source=t,r.subjectFactory=n,r._refCount=0,r._isComplete=!1,r}return __extends(t,e),t.prototype._subscribe=function(e){return this.getSubject().subscribe(e)},t.prototype.getSubject=function(){var e=this._subject;return e&&!e.isStopped||(this._subject=this.subjectFactory()),this._subject},t.prototype.connect=function(){var e=this._connection;return e||(this._isComplete=!1,(e=this._connection=new Subscription).add(this.source.subscribe(new ConnectableSubscriber(this.getSubject(),this))),e.closed&&(this._connection=null,e=Subscription.EMPTY)),e},t.prototype.refCount=function(){return refCount()(this)},t}(Observable),connectableObservableDescriptor=function(){var e=ConnectableObservable.prototype;return{operator:{value:null},_refCount:{value:0,writable:!0},_subject:{value:null,writable:!0},_connection:{value:null,writable:!0},_subscribe:{value:e._subscribe},_isComplete:{value:e._isComplete,writable:!0},getSubject:{value:e.getSubject},connect:{value:e.connect},refCount:{value:e.refCount}}}(),ConnectableSubscriber=function(e){function t(t,n){var r=e.call(this,t)||this;return r.connectable=n,r}return __extends(t,e),t.prototype._error=function(t){this._unsubscribe(),e.prototype._error.call(this,t)},t.prototype._complete=function(){this.connectable._isComplete=!0,this._unsubscribe(),e.prototype._complete.call(this)},t.prototype._unsubscribe=function(){var e=this.connectable;if(e){this.connectable=null;var t=e._connection;e._refCount=0,e._subject=null,e._connection=null,t&&t.unsubscribe()}},t}(SubjectSubscriber),Action=function(e){function t(t,n){return e.call(this)||this}return __extends(t,e),t.prototype.schedule=function(e,t){return this},t}(Subscription),AsyncAction=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.scheduler=t,r.work=n,r.pending=!1,r}return __extends(t,e),t.prototype.schedule=function(e,t){if(void 0===t&&(t=0),this.closed)return this;this.state=e;var n=this.id,r=this.scheduler;return null!=n&&(this.id=this.recycleAsyncId(r,n,t)),this.pending=!0,this.delay=t,this.id=this.id||this.requestAsyncId(r,this.id,t),this},t.prototype.requestAsyncId=function(e,t,n){return void 0!==n&&0!==n||(n=1),setInterval(e.flush.bind(e,this),n)},t.prototype.recycleAsyncId=function(e,t,n){if(void 0===n&&(n=0),null!==n&&this.delay===n&&!1===this.pending)return t;clearInterval(t)},t.prototype.execute=function(e,t){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;var n=this._execute(e,t);if(n)return n;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))},t.prototype._execute=function(e,t){var n=!1,r=void 0;try{this.work(e)}catch(e){n=!0,r=!!e&&e||new Error(e)}if(n)return this.unsubscribe(),r},t.prototype._unsubscribe=function(){var e=this.id,t=this.scheduler,n=t.actions,r=n.indexOf(this);this.work=null,this.state=null,this.pending=!1,this.scheduler=null,-1!==r&&n.splice(r,1),null!=e&&(this.id=this.recycleAsyncId(t,e,null)),this.delay=null},t}(Action),QueueAction=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.scheduler=t,r.work=n,r}return __extends(t,e),t.prototype.schedule=function(t,n){return void 0===n&&(n=0),n>0?e.prototype.schedule.call(this,t,n):(this.delay=n,this.state=t,this.scheduler.flush(this),this)},t.prototype.execute=function(t,n){return n>0||this.closed?e.prototype.execute.call(this,t,n):this._execute(t,n)},t.prototype.requestAsyncId=function(t,n,r){return void 0===r&&(r=0),null!==r&&r>0||null===r&&this.delay>0?e.prototype.requestAsyncId.call(this,t,n,r):t.flush(this)},t}(AsyncAction),Scheduler=function(){function e(t,n){void 0===n&&(n=e.now),this.SchedulerAction=t,this.now=n}return e.prototype.schedule=function(e,t,n){return void 0===t&&(t=0),new this.SchedulerAction(this,e).schedule(n,t)},e.now=function(){return Date.now()},e}(),AsyncScheduler=function(e){function t(n,r){void 0===r&&(r=Scheduler.now);var i=e.call(this,n,(function(){return t.delegate&&t.delegate!==i?t.delegate.now():r()}))||this;return i.actions=[],i.active=!1,i.scheduled=void 0,i}return __extends(t,e),t.prototype.schedule=function(n,r,i){return void 0===r&&(r=0),t.delegate&&t.delegate!==this?t.delegate.schedule(n,r,i):e.prototype.schedule.call(this,n,r,i)},t.prototype.flush=function(e){var t=this.actions;if(this.active)t.push(e);else{var n;this.active=!0;do{if(n=e.execute(e.state,e.delay))break}while(e=t.shift());if(this.active=!1,n){for(;e=t.shift();)e.unsubscribe();throw n}}},t}(Scheduler),QueueScheduler=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(AsyncScheduler),queueScheduler=new QueueScheduler(QueueAction),queue=queueScheduler,EMPTY=new Observable((function(e){return e.complete()}));function empty$1(e){return e?emptyScheduled(e):EMPTY}function emptyScheduled(e){return new Observable((function(t){return e.schedule((function(){return t.complete()}))}))}function isScheduler(e){return e&&"function"==typeof e.schedule}var subscribeToArray=function(e){return function(t){for(var n=0,r=e.length;n<r&&!t.closed;n++)t.next(e[n]);t.complete()}};function scheduleArray(e,t){return new Observable((function(n){var r=new Subscription,i=0;return r.add(t.schedule((function(){i!==e.length?(n.next(e[i++]),n.closed||r.add(this.schedule())):n.complete()}))),r}))}function fromArray(e,t){return t?scheduleArray(e,t):new Observable(subscribeToArray(e))}function of(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=e[e.length-1];return isScheduler(n)?(e.pop(),scheduleArray(e,n)):fromArray(e)}function throwError(e,t){return new Observable(t?function(n){return t.schedule(dispatch,0,{error:e,subscriber:n})}:function(t){return t.error(e)})}function dispatch(e){var t=e.error;e.subscriber.error(t)}var Notification=function(){function e(e,t,n){this.kind=e,this.value=t,this.error=n,this.hasValue="N"===e}return e.prototype.observe=function(e){switch(this.kind){case"N":return e.next&&e.next(this.value);case"E":return e.error&&e.error(this.error);case"C":return e.complete&&e.complete()}},e.prototype.do=function(e,t,n){switch(this.kind){case"N":return e&&e(this.value);case"E":return t&&t(this.error);case"C":return n&&n()}},e.prototype.accept=function(e,t,n){return e&&"function"==typeof e.next?this.observe(e):this.do(e,t,n)},e.prototype.toObservable=function(){switch(this.kind){case"N":return of(this.value);case"E":return throwError(this.error);case"C":return empty$1()}throw new Error("unexpected notification kind value")},e.createNext=function(t){return void 0!==t?new e("N",t):e.undefinedValueNotification},e.createError=function(t){return new e("E",void 0,t)},e.createComplete=function(){return e.completeNotification},e.completeNotification=new e("C"),e.undefinedValueNotification=new e("N",void 0),e}();function observeOn(e,t){return void 0===t&&(t=0),function(n){return n.lift(new ObserveOnOperator(e,t))}}var ObserveOnOperator=function(){function e(e,t){void 0===t&&(t=0),this.scheduler=e,this.delay=t}return e.prototype.call=function(e,t){return t.subscribe(new ObserveOnSubscriber(e,this.scheduler,this.delay))},e}(),ObserveOnSubscriber=function(e){function t(t,n,r){void 0===r&&(r=0);var i=e.call(this,t)||this;return i.scheduler=n,i.delay=r,i}return __extends(t,e),t.dispatch=function(e){var t=e.notification,n=e.destination;t.observe(n),this.unsubscribe()},t.prototype.scheduleMessage=function(e){this.destination.add(this.scheduler.schedule(t.dispatch,this.delay,new ObserveOnMessage(e,this.destination)))},t.prototype._next=function(e){this.scheduleMessage(Notification.createNext(e))},t.prototype._error=function(e){this.scheduleMessage(Notification.createError(e)),this.unsubscribe()},t.prototype._complete=function(){this.scheduleMessage(Notification.createComplete()),this.unsubscribe()},t}(Subscriber),ObserveOnMessage=function(){return function(e,t){this.notification=e,this.destination=t}}(),ReplaySubject=function(e){function t(t,n,r){void 0===t&&(t=Number.POSITIVE_INFINITY),void 0===n&&(n=Number.POSITIVE_INFINITY);var i=e.call(this)||this;return i.scheduler=r,i._events=[],i._infiniteTimeWindow=!1,i._bufferSize=t<1?1:t,i._windowTime=n<1?1:n,n===Number.POSITIVE_INFINITY?(i._infiniteTimeWindow=!0,i.next=i.nextInfiniteTimeWindow):i.next=i.nextTimeWindow,i}return __extends(t,e),t.prototype.nextInfiniteTimeWindow=function(t){if(!this.isStopped){var n=this._events;n.push(t),n.length>this._bufferSize&&n.shift()}e.prototype.next.call(this,t)},t.prototype.nextTimeWindow=function(t){this.isStopped||(this._events.push(new ReplayEvent(this._getNow(),t)),this._trimBufferThenGetEvents()),e.prototype.next.call(this,t)},t.prototype._subscribe=function(e){var t,n=this._infiniteTimeWindow,r=n?this._events:this._trimBufferThenGetEvents(),i=this.scheduler,o=r.length;if(this.closed)throw new ObjectUnsubscribedError;if(this.isStopped||this.hasError?t=Subscription.EMPTY:(this.observers.push(e),t=new SubjectSubscription(this,e)),i&&e.add(e=new ObserveOnSubscriber(e,i)),n)for(var a=0;a<o&&!e.closed;a++)e.next(r[a]);else for(a=0;a<o&&!e.closed;a++)e.next(r[a].value);return this.hasError?e.error(this.thrownError):this.isStopped&&e.complete(),t},t.prototype._getNow=function(){return(this.scheduler||queue).now()},t.prototype._trimBufferThenGetEvents=function(){for(var e=this._getNow(),t=this._bufferSize,n=this._windowTime,r=this._events,i=r.length,o=0;o<i&&!(e-r[o].time<n);)o++;return i>t&&(o=Math.max(o,i-t)),o>0&&r.splice(0,o),r},t}(Subject),ReplayEvent=function(){return function(e,t){this.time=e,this.value=t}}(),nextHandle=1,RESOLVED=function(){return Promise.resolve()}(),activeHandles={};function findAndClearHandle(e){return e in activeHandles&&(delete activeHandles[e],!0)}var Immediate={setImmediate:function(e){var t=nextHandle++;return activeHandles[t]=!0,RESOLVED.then((function(){return findAndClearHandle(t)&&e()})),t},clearImmediate:function(e){findAndClearHandle(e)}},AsapAction=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.scheduler=t,r.work=n,r}return __extends(t,e),t.prototype.requestAsyncId=function(t,n,r){return void 0===r&&(r=0),null!==r&&r>0?e.prototype.requestAsyncId.call(this,t,n,r):(t.actions.push(this),t.scheduled||(t.scheduled=Immediate.setImmediate(t.flush.bind(t,null))))},t.prototype.recycleAsyncId=function(t,n,r){if(void 0===r&&(r=0),null!==r&&r>0||null===r&&this.delay>0)return e.prototype.recycleAsyncId.call(this,t,n,r);0===t.actions.length&&(Immediate.clearImmediate(n),t.scheduled=void 0)},t}(AsyncAction),AsapScheduler=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.flush=function(e){this.active=!0,this.scheduled=void 0;var t,n=this.actions,r=-1,i=n.length;e=e||n.shift();do{if(t=e.execute(e.state,e.delay))break}while(++r<i&&(e=n.shift()));if(this.active=!1,t){for(;++r<i&&(e=n.shift());)e.unsubscribe();throw t}},t}(AsyncScheduler),asapScheduler=new AsapScheduler(AsapAction),asyncScheduler=new AsyncScheduler(AsyncAction),async=asyncScheduler;function noop(){}var ArgumentOutOfRangeErrorImpl=function(){function e(){return Error.call(this),this.message="argument out of range",this.name="ArgumentOutOfRangeError",this}return e.prototype=Object.create(Error.prototype),e}(),ArgumentOutOfRangeError=ArgumentOutOfRangeErrorImpl,EmptyErrorImpl=function(){function e(){return Error.call(this),this.message="no elements in sequence",this.name="EmptyError",this}return e.prototype=Object.create(Error.prototype),e}(),EmptyError=EmptyErrorImpl,TimeoutErrorImpl=function(){function e(){return Error.call(this),this.message="Timeout has occurred",this.name="TimeoutError",this}return e.prototype=Object.create(Error.prototype),e}(),TimeoutError=TimeoutErrorImpl;function map$1(e,t){return function(n){if("function"!=typeof e)throw new TypeError("argument is not a function. Are you looking for `mapTo()`?");return n.lift(new MapOperator(e,t))}}var MapOperator=function(){function e(e,t){this.project=e,this.thisArg=t}return e.prototype.call=function(e,t){return t.subscribe(new MapSubscriber(e,this.project,this.thisArg))},e}(),MapSubscriber=function(e){function t(t,n,r){var i=e.call(this,t)||this;return i.project=n,i.count=0,i.thisArg=r||i,i}return __extends(t,e),t.prototype._next=function(e){var t;try{t=this.project.call(this.thisArg,e,this.count++)}catch(e){return void this.destination.error(e)}this.destination.next(t)},t}(Subscriber),OuterSubscriber=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.notifyNext=function(e,t,n,r,i){this.destination.next(t)},t.prototype.notifyError=function(e,t){this.destination.error(e)},t.prototype.notifyComplete=function(e){this.destination.complete()},t}(Subscriber),InnerSubscriber=function(e){function t(t,n,r){var i=e.call(this)||this;return i.parent=t,i.outerValue=n,i.outerIndex=r,i.index=0,i}return __extends(t,e),t.prototype._next=function(e){this.parent.notifyNext(this.outerValue,e,this.outerIndex,this.index++,this)},t.prototype._error=function(e){this.parent.notifyError(e,this),this.unsubscribe()},t.prototype._complete=function(){this.parent.notifyComplete(this),this.unsubscribe()},t}(Subscriber),subscribeToPromise=function(e){return function(t){return e.then((function(e){t.closed||(t.next(e),t.complete())}),(function(e){return t.error(e)})).then(null,hostReportError),t}};function getSymbolIterator(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}var iterator=getSymbolIterator(),subscribeToIterable=function(e){return function(t){for(var n=e[iterator]();;){var r=void 0;try{r=n.next()}catch(e){return t.error(e),t}if(r.done){t.complete();break}if(t.next(r.value),t.closed)break}return"function"==typeof n.return&&t.add((function(){n.return&&n.return()})),t}},subscribeToObservable=function(e){return function(t){var n=e[observable]();if("function"!=typeof n.subscribe)throw new TypeError("Provided object does not correctly implement Symbol.observable");return n.subscribe(t)}},isArrayLike$2=function(e){return e&&"number"==typeof e.length&&"function"!=typeof e};function isPromise(e){return!!e&&"function"!=typeof e.subscribe&&"function"==typeof e.then}var subscribeTo=function(e){if(e&&"function"==typeof e[observable])return subscribeToObservable(e);if(isArrayLike$2(e))return subscribeToArray(e);if(isPromise(e))return subscribeToPromise(e);if(e&&"function"==typeof e[iterator])return subscribeToIterable(e);var t=isObject$1(e)?"an invalid object":"'"+e+"'";throw new TypeError("You provided "+t+" where a stream was expected. You can provide an Observable, Promise, Array, or Iterable.")};function subscribeToResult(e,t,n,r,i){if(void 0===i&&(i=new InnerSubscriber(e,n,r)),!i.closed)return t instanceof Observable?t.subscribe(i):subscribeTo(t)(i)}function scheduleObservable(e,t){return new Observable((function(n){var r=new Subscription;return r.add(t.schedule((function(){var i=e[observable]();r.add(i.subscribe({next:function(e){r.add(t.schedule((function(){return n.next(e)})))},error:function(e){r.add(t.schedule((function(){return n.error(e)})))},complete:function(){r.add(t.schedule((function(){return n.complete()})))}}))}))),r}))}function schedulePromise(e,t){return new Observable((function(n){var r=new Subscription;return r.add(t.schedule((function(){return e.then((function(e){r.add(t.schedule((function(){n.next(e),r.add(t.schedule((function(){return n.complete()})))})))}),(function(e){r.add(t.schedule((function(){return n.error(e)})))}))}))),r}))}function scheduleIterable(e,t){if(!e)throw new Error("Iterable cannot be null");return new Observable((function(n){var r,i=new Subscription;return i.add((function(){r&&"function"==typeof r.return&&r.return()})),i.add(t.schedule((function(){r=e[iterator](),i.add(t.schedule((function(){if(!n.closed){var e,t;try{var i=r.next();e=i.value,t=i.done}catch(e){return void n.error(e)}t?n.complete():(n.next(e),this.schedule())}})))}))),i}))}function isInteropObservable(e){return e&&"function"==typeof e[observable]}function isIterable$1(e){return e&&"function"==typeof e[iterator]}function scheduled(e,t){if(null!=e){if(isInteropObservable(e))return scheduleObservable(e,t);if(isPromise(e))return schedulePromise(e,t);if(isArrayLike$2(e))return scheduleArray(e,t);if(isIterable$1(e)||"string"==typeof e)return scheduleIterable(e,t)}throw new TypeError((null!==e&&typeof e||e)+" is not observable")}function from(e,t){return t?scheduled(e,t):e instanceof Observable?e:new Observable(subscribeTo(e))}var SimpleInnerSubscriber=function(e){function t(t){var n=e.call(this)||this;return n.parent=t,n}return __extends(t,e),t.prototype._next=function(e){this.parent.notifyNext(e)},t.prototype._error=function(e){this.parent.notifyError(e),this.unsubscribe()},t.prototype._complete=function(){this.parent.notifyComplete(),this.unsubscribe()},t}(Subscriber),SimpleOuterSubscriber=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.notifyNext=function(e){this.destination.next(e)},t.prototype.notifyError=function(e){this.destination.error(e)},t.prototype.notifyComplete=function(){this.destination.complete()},t}(Subscriber);function innerSubscribe(e,t){if(!t.closed)return e instanceof Observable?e.subscribe(t):subscribeTo(e)(t)}function mergeMap(e,t,n){return void 0===n&&(n=Number.POSITIVE_INFINITY),"function"==typeof t?function(r){return r.pipe(mergeMap((function(n,r){return from(e(n,r)).pipe(map$1((function(e,i){return t(n,e,r,i)})))}),n))}:("number"==typeof t&&(n=t),function(t){return t.lift(new MergeMapOperator(e,n))})}var MergeMapOperator=function(){function e(e,t){void 0===t&&(t=Number.POSITIVE_INFINITY),this.project=e,this.concurrent=t}return e.prototype.call=function(e,t){return t.subscribe(new MergeMapSubscriber(e,this.project,this.concurrent))},e}(),MergeMapSubscriber=function(e){function t(t,n,r){void 0===r&&(r=Number.POSITIVE_INFINITY);var i=e.call(this,t)||this;return i.project=n,i.concurrent=r,i.hasCompleted=!1,i.buffer=[],i.active=0,i.index=0,i}return __extends(t,e),t.prototype._next=function(e){this.active<this.concurrent?this._tryNext(e):this.buffer.push(e)},t.prototype._tryNext=function(e){var t,n=this.index++;try{t=this.project(e,n)}catch(e){return void this.destination.error(e)}this.active++,this._innerSub(t)},t.prototype._innerSub=function(e){var t=new SimpleInnerSubscriber(this),n=this.destination;n.add(t);var r=innerSubscribe(e,t);r!==t&&n.add(r)},t.prototype._complete=function(){this.hasCompleted=!0,0===this.active&&0===this.buffer.length&&this.destination.complete(),this.unsubscribe()},t.prototype.notifyNext=function(e){this.destination.next(e)},t.prototype.notifyComplete=function(){var e=this.buffer;this.active--,e.length>0?this._next(e.shift()):0===this.active&&this.hasCompleted&&this.destination.complete()},t}(SimpleOuterSubscriber);function mergeAll(e){return void 0===e&&(e=Number.POSITIVE_INFINITY),mergeMap(identity$1,e)}function concatAll(){return mergeAll(1)}function concat(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return concatAll()(of.apply(void 0,e))}function defer(e){return new Observable((function(t){var n;try{n=e()}catch(e){return void t.error(e)}return(n?from(n):empty$1()).subscribe(t)}))}function fromEvent(e,t,n,r){return isFunction$1(n)&&(r=n,n=void 0),r?fromEvent(e,t,n).pipe(map$1((function(e){return isArray$1(e)?r.apply(void 0,e):r(e)}))):new Observable((function(r){setupSubscription(e,t,(function(e){arguments.length>1?r.next(Array.prototype.slice.call(arguments)):r.next(e)}),r,n)}))}function setupSubscription(e,t,n,r,i){var o;if(isEventTarget(e)){var a=e;e.addEventListener(t,n,i),o=function(){return a.removeEventListener(t,n,i)}}else if(isJQueryStyleEventEmitter(e)){var s=e;e.on(t,n),o=function(){return s.off(t,n)}}else if(isNodeStyleEventEmitter(e)){var c=e;e.addListener(t,n),o=function(){return c.removeListener(t,n)}}else{if(!e||!e.length)throw new TypeError("Invalid event target");for(var u=0,l=e.length;u<l;u++)setupSubscription(e[u],t,n,r,i)}r.add(o)}function isNodeStyleEventEmitter(e){return e&&"function"==typeof e.addListener&&"function"==typeof e.removeListener}function isJQueryStyleEventEmitter(e){return e&&"function"==typeof e.on&&"function"==typeof e.off}function isEventTarget(e){return e&&"function"==typeof e.addEventListener&&"function"==typeof e.removeEventListener}function isNumeric(e){return!isArray$1(e)&&e-parseFloat(e)+1>=0}function interval(e,t){return void 0===e&&(e=0),void 0===t&&(t=async),(!isNumeric(e)||e<0)&&(e=0),t&&"function"==typeof t.schedule||(t=async),new Observable((function(n){return n.add(t.schedule(dispatch$1,e,{subscriber:n,counter:0,period:e})),n}))}function dispatch$1(e){var t=e.subscriber,n=e.counter,r=e.period;t.next(n),this.schedule({subscriber:t,counter:n+1,period:r},r)}function merge(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=Number.POSITIVE_INFINITY,r=null,i=e[e.length-1];return isScheduler(i)?(r=e.pop(),e.length>1&&"number"==typeof e[e.length-1]&&(n=e.pop())):"number"==typeof i&&(n=e.pop()),null===r&&1===e.length&&e[0]instanceof Observable?e[0]:mergeAll(n)(fromArray(e,r))}function filter(e,t){return function(n){return n.lift(new FilterOperator(e,t))}}var FilterOperator=function(){function e(e,t){this.predicate=e,this.thisArg=t}return e.prototype.call=function(e,t){return t.subscribe(new FilterSubscriber(e,this.predicate,this.thisArg))},e}(),FilterSubscriber=function(e){function t(t,n,r){var i=e.call(this,t)||this;return i.predicate=n,i.thisArg=r,i.count=0,i}return __extends(t,e),t.prototype._next=function(e){var t;try{t=this.predicate.call(this.thisArg,e,this.count++)}catch(e){return void this.destination.error(e)}t&&this.destination.next(e)},t}(Subscriber);function race(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(1===e.length){if(!isArray$1(e[0]))return e[0];e=e[0]}return fromArray(e,void 0).lift(new RaceOperator)}var RaceOperator=function(){function e(){}return e.prototype.call=function(e,t){return t.subscribe(new RaceSubscriber(e))},e}(),RaceSubscriber=function(e){function t(t){var n=e.call(this,t)||this;return n.hasFirst=!1,n.observables=[],n.subscriptions=[],n}return __extends(t,e),t.prototype._next=function(e){this.observables.push(e)},t.prototype._complete=function(){var e=this.observables,t=e.length;if(0===t)this.destination.complete();else{for(var n=0;n<t&&!this.hasFirst;n++){var r=subscribeToResult(this,e[n],void 0,n);this.subscriptions&&this.subscriptions.push(r),this.add(r)}this.observables=null}},t.prototype.notifyNext=function(e,t,n){if(!this.hasFirst){this.hasFirst=!0;for(var r=0;r<this.subscriptions.length;r++)if(r!==n){var i=this.subscriptions[r];i.unsubscribe(),this.remove(i)}this.subscriptions=null}this.destination.next(t)},t}(OuterSubscriber);function timer(e,t,n){void 0===e&&(e=0);var r=-1;return isNumeric(t)?r=Number(t)<1?1:Number(t):isScheduler(t)&&(n=t),isScheduler(n)||(n=async),new Observable((function(t){var i=isNumeric(e)?e:+e-n.now();return n.schedule(dispatch$2,i,{index:0,period:r,subscriber:t})}))}function dispatch$2(e){var t=e.index,n=e.period,r=e.subscriber;if(r.next(t),!r.closed){if(-1===n)return r.complete();e.index=t+1,this.schedule(e,n)}}function catchError(e){return function(t){var n=new CatchOperator(e),r=t.lift(n);return n.caught=r}}var CatchOperator=function(){function e(e){this.selector=e}return e.prototype.call=function(e,t){return t.subscribe(new CatchSubscriber(e,this.selector,this.caught))},e}(),CatchSubscriber=function(e){function t(t,n,r){var i=e.call(this,t)||this;return i.selector=n,i.caught=r,i}return __extends(t,e),t.prototype.error=function(t){if(!this.isStopped){var n=void 0;try{n=this.selector(t,this.caught)}catch(t){return void e.prototype.error.call(this,t)}this._unsubscribeAndRecycle();var r=new SimpleInnerSubscriber(this);this.add(r);var i=innerSubscribe(n,r);i!==r&&this.add(i)}},t}(SimpleOuterSubscriber);function concatMap(e,t){return mergeMap(e,t,1)}function defaultIfEmpty(e){return void 0===e&&(e=null),function(t){return t.lift(new DefaultIfEmptyOperator(e))}}var DefaultIfEmptyOperator=function(){function e(e){this.defaultValue=e}return e.prototype.call=function(e,t){return t.subscribe(new DefaultIfEmptySubscriber(e,this.defaultValue))},e}(),DefaultIfEmptySubscriber=function(e){function t(t,n){var r=e.call(this,t)||this;return r.defaultValue=n,r.isEmpty=!0,r}return __extends(t,e),t.prototype._next=function(e){this.isEmpty=!1,this.destination.next(e)},t.prototype._complete=function(){this.isEmpty&&this.destination.next(this.defaultValue),this.destination.complete()},t}(Subscriber);function isDate(e){return e instanceof Date&&!isNaN(+e)}function delay(e,t){void 0===t&&(t=async);var n=isDate(e)?+e-t.now():Math.abs(e);return function(e){return e.lift(new DelayOperator(n,t))}}var DelayOperator=function(){function e(e,t){this.delay=e,this.scheduler=t}return e.prototype.call=function(e,t){return t.subscribe(new DelaySubscriber(e,this.delay,this.scheduler))},e}(),DelaySubscriber=function(e){function t(t,n,r){var i=e.call(this,t)||this;return i.delay=n,i.scheduler=r,i.queue=[],i.active=!1,i.errored=!1,i}return __extends(t,e),t.dispatch=function(e){for(var t=e.source,n=t.queue,r=e.scheduler,i=e.destination;n.length>0&&n[0].time-r.now()<=0;)n.shift().notification.observe(i);if(n.length>0){var o=Math.max(0,n[0].time-r.now());this.schedule(e,o)}else this.unsubscribe(),t.active=!1},t.prototype._schedule=function(e){this.active=!0,this.destination.add(e.schedule(t.dispatch,this.delay,{source:this,destination:this.destination,scheduler:e}))},t.prototype.scheduleNotification=function(e){if(!0!==this.errored){var t=this.scheduler,n=new DelayMessage(t.now()+this.delay,e);this.queue.push(n),!1===this.active&&this._schedule(t)}},t.prototype._next=function(e){this.scheduleNotification(Notification.createNext(e))},t.prototype._error=function(e){this.errored=!0,this.queue=[],this.destination.error(e),this.unsubscribe()},t.prototype._complete=function(){this.scheduleNotification(Notification.createComplete()),this.unsubscribe()},t}(Subscriber),DelayMessage=function(){return function(e,t){this.time=e,this.notification=t}}();function distinct(e,t){return function(n){return n.lift(new DistinctOperator(e,t))}}var DistinctOperator=function(){function e(e,t){this.keySelector=e,this.flushes=t}return e.prototype.call=function(e,t){return t.subscribe(new DistinctSubscriber(e,this.keySelector,this.flushes))},e}(),DistinctSubscriber=function(e){function t(t,n,r){var i=e.call(this,t)||this;return i.keySelector=n,i.values=new Set,r&&i.add(innerSubscribe(r,new SimpleInnerSubscriber(i))),i}return __extends(t,e),t.prototype.notifyNext=function(){this.values.clear()},t.prototype.notifyError=function(e){this._error(e)},t.prototype._next=function(e){this.keySelector?this._useKeySelector(e):this._finalizeNext(e,e)},t.prototype._useKeySelector=function(e){var t,n=this.destination;try{t=this.keySelector(e)}catch(e){return void n.error(e)}this._finalizeNext(t,e)},t.prototype._finalizeNext=function(e,t){var n=this.values;n.has(e)||(n.add(e),this.destination.next(t))},t}(SimpleOuterSubscriber);function throwIfEmpty(e){return void 0===e&&(e=defaultErrorFactory),function(t){return t.lift(new ThrowIfEmptyOperator(e))}}var ThrowIfEmptyOperator=function(){function e(e){this.errorFactory=e}return e.prototype.call=function(e,t){return t.subscribe(new ThrowIfEmptySubscriber(e,this.errorFactory))},e}(),ThrowIfEmptySubscriber=function(e){function t(t,n){var r=e.call(this,t)||this;return r.errorFactory=n,r.hasValue=!1,r}return __extends(t,e),t.prototype._next=function(e){this.hasValue=!0,this.destination.next(e)},t.prototype._complete=function(){if(this.hasValue)return this.destination.complete();var e=void 0;try{e=this.errorFactory()}catch(t){e=t}this.destination.error(e)},t}(Subscriber);function defaultErrorFactory(){return new EmptyError}function take(e){return function(t){return 0===e?empty$1():t.lift(new TakeOperator(e))}}var TakeOperator=function(){function e(e){if(this.total=e,this.total<0)throw new ArgumentOutOfRangeError}return e.prototype.call=function(e,t){return t.subscribe(new TakeSubscriber(e,this.total))},e}(),TakeSubscriber=function(e){function t(t,n){var r=e.call(this,t)||this;return r.total=n,r.count=0,r}return __extends(t,e),t.prototype._next=function(e){var t=this.total,n=++this.count;n<=t&&(this.destination.next(e),n===t&&(this.destination.complete(),this.unsubscribe()))},t}(Subscriber);function finalize(e){return function(t){return t.lift(new FinallyOperator(e))}}var FinallyOperator=function(){function e(e){this.callback=e}return e.prototype.call=function(e,t){return t.subscribe(new FinallySubscriber(e,this.callback))},e}(),FinallySubscriber=function(e){function t(t,n){var r=e.call(this,t)||this;return r.add(new Subscription(n)),r}return __extends(t,e),t}(Subscriber);function first(e,t){var n=arguments.length>=2;return function(r){return r.pipe(e?filter((function(t,n){return e(t,n,r)})):identity$1,take(1),n?defaultIfEmpty(t):throwIfEmpty((function(){return new EmptyError})))}}function ignoreElements(){return function(e){return e.lift(new IgnoreElementsOperator)}}var IgnoreElementsOperator=function(){function e(){}return e.prototype.call=function(e,t){return t.subscribe(new IgnoreElementsSubscriber(e))},e}(),IgnoreElementsSubscriber=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype._next=function(e){},t}(Subscriber);function takeLast(e){return function(t){return 0===e?empty$1():t.lift(new TakeLastOperator(e))}}var TakeLastOperator=function(){function e(e){if(this.total=e,this.total<0)throw new ArgumentOutOfRangeError}return e.prototype.call=function(e,t){return t.subscribe(new TakeLastSubscriber(e,this.total))},e}(),TakeLastSubscriber=function(e){function t(t,n){var r=e.call(this,t)||this;return r.total=n,r.ring=new Array,r.count=0,r}return __extends(t,e),t.prototype._next=function(e){var t=this.ring,n=this.total,r=this.count++;t.length<n?t.push(e):t[r%n]=e},t.prototype._complete=function(){var e=this.destination,t=this.count;if(t>0)for(var n=this.count>=this.total?this.total:this.count,r=this.ring,i=0;i<n;i++){var o=t++%n;e.next(r[o])}e.complete()},t}(Subscriber);function mapTo(e){return function(t){return t.lift(new MapToOperator(e))}}var MapToOperator=function(){function e(e){this.value=e}return e.prototype.call=function(e,t){return t.subscribe(new MapToSubscriber(e,this.value))},e}(),MapToSubscriber=function(e){function t(t,n){var r=e.call(this,t)||this;return r.value=n,r}return __extends(t,e),t.prototype._next=function(e){this.destination.next(this.value)},t}(Subscriber);function scan(e,t){var n=!1;return arguments.length>=2&&(n=!0),function(r){return r.lift(new ScanOperator(e,t,n))}}var ScanOperator=function(){function e(e,t,n){void 0===n&&(n=!1),this.accumulator=e,this.seed=t,this.hasSeed=n}return e.prototype.call=function(e,t){return t.subscribe(new ScanSubscriber(e,this.accumulator,this.seed,this.hasSeed))},e}(),ScanSubscriber=function(e){function t(t,n,r,i){var o=e.call(this,t)||this;return o.accumulator=n,o._seed=r,o.hasSeed=i,o.index=0,o}return __extends(t,e),Object.defineProperty(t.prototype,"seed",{get:function(){return this._seed},set:function(e){this.hasSeed=!0,this._seed=e},enumerable:!0,configurable:!0}),t.prototype._next=function(e){if(this.hasSeed)return this._tryNext(e);this.seed=e,this.destination.next(e)},t.prototype._tryNext=function(e){var t,n=this.index++;try{t=this.accumulator(this.seed,e,n)}catch(e){this.destination.error(e)}this.seed=t,this.destination.next(t)},t}(Subscriber);function reduce(e,t){return arguments.length>=2?function(n){return pipe(scan(e,t),takeLast(1),defaultIfEmpty(t))(n)}:function(t){return pipe(scan((function(t,n,r){return e(t,n,r+1)})),takeLast(1))(t)}}function multicast(e,t){return function(n){var r;if(r="function"==typeof e?e:function(){return e},"function"==typeof t)return n.lift(new MulticastOperator(r,t));var i=Object.create(n,connectableObservableDescriptor);return i.source=n,i.subjectFactory=r,i}}var MulticastOperator=function(){function e(e,t){this.subjectFactory=e,this.selector=t}return e.prototype.call=function(e,t){var n=this.selector,r=this.subjectFactory(),i=n(r).subscribe(e);return i.add(t.subscribe(r)),i},e}();function retryWhen(e){return function(t){return t.lift(new RetryWhenOperator(e,t))}}var RetryWhenOperator=function(){function e(e,t){this.notifier=e,this.source=t}return e.prototype.call=function(e,t){return t.subscribe(new RetryWhenSubscriber(e,this.notifier,this.source))},e}(),RetryWhenSubscriber=function(e){function t(t,n,r){var i=e.call(this,t)||this;return i.notifier=n,i.source=r,i}return __extends(t,e),t.prototype.error=function(t){if(!this.isStopped){var n=this.errors,r=this.retries,i=this.retriesSubscription;if(r)this.errors=void 0,this.retriesSubscription=void 0;else{n=new Subject;try{r=(0,this.notifier)(n)}catch(t){return e.prototype.error.call(this,t)}i=innerSubscribe(r,new SimpleInnerSubscriber(this))}this._unsubscribeAndRecycle(),this.errors=n,this.retries=r,this.retriesSubscription=i,n.next(t)}},t.prototype._unsubscribe=function(){var e=this.errors,t=this.retriesSubscription;e&&(e.unsubscribe(),this.errors=void 0),t&&(t.unsubscribe(),this.retriesSubscription=void 0),this.retries=void 0},t.prototype.notifyNext=function(){var e=this._unsubscribe;this._unsubscribe=null,this._unsubscribeAndRecycle(),this._unsubscribe=e,this.source.subscribe(this)},t}(SimpleOuterSubscriber);function shareSubjectFactory(){return new Subject}function share(){return function(e){return refCount()(multicast(shareSubjectFactory)(e))}}function shareReplay(e,t,n){var r;return r=e&&"object"==typeof e?e:{bufferSize:e,windowTime:t,refCount:!1,scheduler:n},function(e){return e.lift(shareReplayOperator(r))}}function shareReplayOperator(e){var t,n,r=e.bufferSize,i=void 0===r?Number.POSITIVE_INFINITY:r,o=e.windowTime,a=void 0===o?Number.POSITIVE_INFINITY:o,s=e.refCount,c=e.scheduler,u=0,l=!1,d=!1;return function(e){var r;u++,!t||l?(l=!1,t=new ReplaySubject(i,a,c),r=t.subscribe(this),n=e.subscribe({next:function(e){t.next(e)},error:function(e){l=!0,t.error(e)},complete:function(){d=!0,n=void 0,t.complete()}})):r=t.subscribe(this),this.add((function(){u--,r.unsubscribe(),n&&!d&&s&&0===u&&(n.unsubscribe(),n=void 0,t=void 0)}))}}function switchMap(e,t){return"function"==typeof t?function(n){return n.pipe(switchMap((function(n,r){return from(e(n,r)).pipe(map$1((function(e,i){return t(n,e,r,i)})))})))}:function(t){return t.lift(new SwitchMapOperator(e))}}var SwitchMapOperator=function(){function e(e){this.project=e}return e.prototype.call=function(e,t){return t.subscribe(new SwitchMapSubscriber(e,this.project))},e}(),SwitchMapSubscriber=function(e){function t(t,n){var r=e.call(this,t)||this;return r.project=n,r.index=0,r}return __extends(t,e),t.prototype._next=function(e){var t,n=this.index++;try{t=this.project(e,n)}catch(e){return void this.destination.error(e)}this._innerSub(t)},t.prototype._innerSub=function(e){var t=this.innerSubscription;t&&t.unsubscribe();var n=new SimpleInnerSubscriber(this),r=this.destination;r.add(n),this.innerSubscription=innerSubscribe(e,n),this.innerSubscription!==n&&r.add(this.innerSubscription)},t.prototype._complete=function(){var t=this.innerSubscription;t&&!t.closed||e.prototype._complete.call(this),this.unsubscribe()},t.prototype._unsubscribe=function(){this.innerSubscription=void 0},t.prototype.notifyComplete=function(){this.innerSubscription=void 0,this.isStopped&&e.prototype._complete.call(this)},t.prototype.notifyNext=function(e){this.destination.next(e)},t}(SimpleOuterSubscriber);function switchAll(){return switchMap(identity$1)}function takeUntil(e){return function(t){return t.lift(new TakeUntilOperator(e))}}var TakeUntilOperator=function(){function e(e){this.notifier=e}return e.prototype.call=function(e,t){var n=new TakeUntilSubscriber(e),r=innerSubscribe(this.notifier,new SimpleInnerSubscriber(n));return r&&!n.seenValue?(n.add(r),t.subscribe(n)):n},e}(),TakeUntilSubscriber=function(e){function t(t){var n=e.call(this,t)||this;return n.seenValue=!1,n}return __extends(t,e),t.prototype.notifyNext=function(){this.seenValue=!0,this.complete()},t.prototype.notifyComplete=function(){},t}(SimpleOuterSubscriber);function tap(e,t,n){return function(r){return r.lift(new DoOperator(e,t,n))}}var DoOperator=function(){function e(e,t,n){this.nextOrObserver=e,this.error=t,this.complete=n}return e.prototype.call=function(e,t){return t.subscribe(new TapSubscriber(e,this.nextOrObserver,this.error,this.complete))},e}(),TapSubscriber=function(e){function t(t,n,r,i){var o=e.call(this,t)||this;return o._tapNext=noop,o._tapError=noop,o._tapComplete=noop,o._tapError=r||noop,o._tapComplete=i||noop,isFunction$1(n)?(o._context=o,o._tapNext=n):n&&(o._context=n,o._tapNext=n.next||noop,o._tapError=n.error||noop,o._tapComplete=n.complete||noop),o}return __extends(t,e),t.prototype._next=function(e){try{this._tapNext.call(this._context,e)}catch(e){return void this.destination.error(e)}this.destination.next(e)},t.prototype._error=function(e){try{this._tapError.call(this._context,e)}catch(e){return void this.destination.error(e)}this.destination.error(e)},t.prototype._complete=function(){try{this._tapComplete.call(this._context)}catch(e){return void this.destination.error(e)}return this.destination.complete()},t}(Subscriber);function timeoutWith(e,t,n){return void 0===n&&(n=async),function(r){var i=isDate(e),o=i?+e-n.now():Math.abs(e);return r.lift(new TimeoutWithOperator(o,i,t,n))}}var TimeoutWithOperator=function(){function e(e,t,n,r){this.waitFor=e,this.absoluteTimeout=t,this.withObservable=n,this.scheduler=r}return e.prototype.call=function(e,t){return t.subscribe(new TimeoutWithSubscriber(e,this.absoluteTimeout,this.waitFor,this.withObservable,this.scheduler))},e}(),TimeoutWithSubscriber=function(e){function t(t,n,r,i,o){var a=e.call(this,t)||this;return a.absoluteTimeout=n,a.waitFor=r,a.withObservable=i,a.scheduler=o,a.scheduleTimeout(),a}return __extends(t,e),t.dispatchTimeout=function(e){var t=e.withObservable;e._unsubscribeAndRecycle(),e.add(innerSubscribe(t,new SimpleInnerSubscriber(e)))},t.prototype.scheduleTimeout=function(){var e=this.action;e?this.action=e.schedule(this,this.waitFor):this.add(this.action=this.scheduler.schedule(t.dispatchTimeout,this.waitFor,this))},t.prototype._next=function(t){this.absoluteTimeout||this.scheduleTimeout(),e.prototype._next.call(this,t)},t.prototype._unsubscribe=function(){this.action=void 0,this.scheduler=null,this.withObservable=null},t}(SimpleOuterSubscriber);function timeout(e,t){return void 0===t&&(t=async),timeoutWith(e,throwError(new TimeoutError),t)}function withLatestFrom(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return function(t){var n;"function"==typeof e[e.length-1]&&(n=e.pop());var r=e;return t.lift(new WithLatestFromOperator(r,n))}}for(var WithLatestFromOperator=function(){function e(e,t){this.observables=e,this.project=t}return e.prototype.call=function(e,t){return t.subscribe(new WithLatestFromSubscriber(e,this.observables,this.project))},e}(),WithLatestFromSubscriber=function(e){function t(t,n,r){var i=e.call(this,t)||this;i.observables=n,i.project=r,i.toRespond=[];var o=n.length;i.values=new Array(o);for(var a=0;a<o;a++)i.toRespond.push(a);for(a=0;a<o;a++){var s=n[a];i.add(subscribeToResult(i,s,void 0,a))}return i}return __extends(t,e),t.prototype.notifyNext=function(e,t,n){this.values[n]=t;var r=this.toRespond;if(r.length>0){var i=r.indexOf(n);-1!==i&&r.splice(i,1)}},t.prototype.notifyComplete=function(){},t.prototype._next=function(e){if(0===this.toRespond.length){var t=[e].concat(this.values);this.project?this._tryProject(t):this.destination.next(t)}},t.prototype._tryProject=function(e){var t;try{t=this.project.apply(this,e)}catch(e){return void this.destination.error(e)}this.destination.next(t)},t}(OuterSubscriber),rngBrowser=createCommonjsModule((function(e){var t="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof window.msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto);if(t){var n=new Uint8Array(16);e.exports=function(){return t(n),n}}else{var r=new Array(16);e.exports=function(){for(var e,t=0;t<16;t++)0==(3&t)&&(e=4294967296*Math.random()),r[t]=e>>>((3&t)<<3)&255;return r}}})),byteToHex=[],i=0;i<256;++i)byteToHex[i]=(i+256).toString(16).substr(1);function bytesToUuid(e,t){var n=t||0,r=byteToHex;return[r[e[n++]],r[e[n++]],r[e[n++]],r[e[n++]],"-",r[e[n++]],r[e[n++]],"-",r[e[n++]],r[e[n++]],"-",r[e[n++]],r[e[n++]],"-",r[e[n++]],r[e[n++]],r[e[n++]],r[e[n++]],r[e[n++]],r[e[n++]]].join("")}var bytesToUuid_1=bytesToUuid,_nodeId,_clockseq,_lastMSecs=0,_lastNSecs=0;function v1(e,t,n){var r=t&&n||0,i=t||[],o=(e=e||{}).node||_nodeId,a=void 0!==e.clockseq?e.clockseq:_clockseq;if(null==o||null==a){var s=rngBrowser();null==o&&(o=_nodeId=[1|s[0],s[1],s[2],s[3],s[4],s[5]]),null==a&&(a=_clockseq=16383&(s[6]<<8|s[7]))}var c=void 0!==e.msecs?e.msecs:(new Date).getTime(),u=void 0!==e.nsecs?e.nsecs:_lastNSecs+1,l=c-_lastMSecs+(u-_lastNSecs)/1e4;if(l<0&&void 0===e.clockseq&&(a=a+1&16383),(l<0||c>_lastMSecs)&&void 0===e.nsecs&&(u=0),u>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");_lastMSecs=c,_lastNSecs=u,_clockseq=a;var d=(1e4*(268435455&(c+=122192928e5))+u)%4294967296;i[r++]=d>>>24&255,i[r++]=d>>>16&255,i[r++]=d>>>8&255,i[r++]=255&d;var f=c/4294967296*1e4&268435455;i[r++]=f>>>8&255,i[r++]=255&f,i[r++]=f>>>24&15|16,i[r++]=f>>>16&255,i[r++]=a>>>8|128,i[r++]=255&a;for(var h=0;h<6;++h)i[r+h]=o[h];return t||bytesToUuid_1(i)}var v1_1=v1;function v4(e,t,n){var r=t&&n||0;"string"==typeof e&&(t="binary"===e?new Array(16):null,e=null);var i=(e=e||{}).random||(e.rng||rngBrowser)();if(i[6]=15&i[6]|64,i[8]=63&i[8]|128,t)for(var o=0;o<16;++o)t[r+o]=i[o];return t||bytesToUuid_1(i)}var v4_1=v4,uuid=v4_1;uuid.v1=v1_1,uuid.v4=v4_1;var uuid_1=uuid,version="1.1.0",BUILD="miniapp-v1.1.0-0-g0385e431",processId=uuid_1.v4(),PLATFORM_TYPE=10,VERSION_NO=2,SUBVERSION=2,END_CALL_PREFIX="AgoraRTMLegacyEndcallCompatibleMessagePrefix",AttributeOperationError={ATTRIBUTE_OPERATION_ERR_FAILURE:2,ATTRIBUTE_OPERATION_ERR_INVALID_ARGUMENT:3,ATTRIBUTE_OPERATION_ERR_SIZE_OVERFLOW:4,ATTRIBUTE_OPERATION_ERR_TOO_OFTEN:5,ATTRIBUTE_OPERATION_ERR_USER_NOT_FOUND:6,ATTRIBUTE_OPERATION_ERR_TIMEOUT:7,ATTRIBUTE_OPERATION_ERR_USER_NOT_LOGGED_IN:102},ChannelMessageError={CHANNEL_MESSAGE_ERR_FAILURE:1,CHANNEL_MESSAGE_ERR_TIMEOUT:2,CHANNEL_MESSAGE_ERR_TOO_OFTEN:3,CHANNEL_MESSAGE_ERR_INVALID_MESSAGE:4,CHANNEL_MESSAGE_ERR_NOT_IN_CHANNEL:5,CHANNEL_MESSAGE_ERR_USER_NOT_LOGGED_IN:102},CreateChannelError={CREATE_CHANNEL_ERR_INVALID_ARGUMENT:1},CreateInstanceError={CREATE_INSTANCE_ERR_INVALID_ARGUMENT:1},GetMembersError={GET_MEMBERS_ERR_FAILURE:1,GET_MEMBERS_ERR_REJECTED:2,GET_MEMBERS_ERR_TIMEOUT:3,GET_MEMBERS_ERR_TOO_OFTEN:4,GET_MEMBERS_ERR_NOT_IN_CHANNEL:5,GET_MEMBERS_ERR_USER_NOT_LOGGED_IN:102},JoinChannelError={JOIN_CHANNEL_ERR_FAILURE:1,JOIN_CHANNEL_ERR_REJECTED:2,JOIN_CHANNEL_ERR_INVALID_ARGUMENT:3,JOIN_CHANNEL_TIMEOUT:4,JOIN_CHANNEL_ERR_EXCEED_LIMIT:5,JOIN_CHANNEL_ERR_ALREADY_JOINED:6,JOIN_CHANNEL_ERR_TOO_OFTEN:7,JOIN_CHANNEL_ERR_JOIN_SAME_CHANNEL_TOO_OFTEN:8,JOIN_CHANNEL_ERR_USER_NOT_LOGGED_IN:102,JOIN_CHANNEL_ERR_ABORTED_BY_LEAVE:201,JOIN_CHANNEL_ERR_ALREADY_JOINED_CHANNEL_OF_SAME_ID:202},LeaveChannelError={LEAVE_CHANNEL_ERR_FAILURE:1,LEAVE_CHANNEL_ERR_REJECTED:2,LEAVE_CHANNEL_ERR_NOT_IN_CHANNEL:3,LEAVE_CHANNEL_ERR_USER_NOT_LOGGED_IN:102},LoginError={LOGIN_ERR_UNKNOWN:1,LOGIN_ERR_REJECTED:2,LOGIN_ERR_INVALID_ARGUMENT:3,LOGIN_ERR_INVALID_APP_ID:4,LOGIN_ERR_INVALID_TOKEN:5,LOGIN_ERR_TOKEN_EXPIRED:6,LOGIN_ERR_NOT_AUTHORIZED:7,LOGIN_ERR_ALREADY_LOGIN:8,LOGIN_ERR_TIMEOUT:9,LOGIN_ERR_TOO_OFTEN:10,LOGIN_ERR_ABORTED_BY_LOGOUT:201},LogoutError={LOGOUT_ERR_USER_NOT_LOGGED_IN:102},PeerMessageError={PEER_MESSAGE_ERR_FAILURE:1,PEER_MESSAGE_ERR_TIMEOUT:2,PEER_MESSAGE_ERR_TOO_OFTEN:5,PEER_MESSAGE_ERR_INVALID_USERID:6,PEER_MESSAGE_ERR_INVALID_MESSAGE:7,PEER_MESSAGE_ERR_INCOMPATIBLE_MESSAGE:8,PEER_MESSAGE_ERR_USER_NOT_LOGGED_IN:102},RenewTokenError={RENEW_TOKEN_ERR_FAILURE:1,RENEW_TOKEN_ERR_INVALID_ARGUMENT:2,RENEW_TOKEN_ERR_REJECTED:3,RENEW_TOKEN_ERR_TOO_OFTEN:4,RENEW_TOKEN_ERR_TOKEN_EXPIRED:5,RENEW_TOKEN_ERR_INVALID_TOKEN:6,RENEW_TOKEN_ERR_USER_NOT_LOGGED_IN:102,RENEW_TOKEN_ERR_ABORTED_BY_LOGOUT:201},InvitationApiCallError={INVITATION_API_CALL_ERR_INVALID_ARGUMENT:1,INVITATION_API_CALL_ERR_NOT_STARTED:2,INVITATION_API_CALL_ERR_ALREADY_END:3,INVITATION_API_CALL_ERR_ALREADY_ACCEPT:4,INVITATION_API_CALL_ERR_ALREADY_SENT:5},ATTRIBUTE_OPERATION_ERR_FAILURE=AttributeOperationError.ATTRIBUTE_OPERATION_ERR_FAILURE,ATTRIBUTE_OPERATION_ERR_INVALID_ARGUMENT=AttributeOperationError.ATTRIBUTE_OPERATION_ERR_INVALID_ARGUMENT,ATTRIBUTE_OPERATION_ERR_SIZE_OVERFLOW=AttributeOperationError.ATTRIBUTE_OPERATION_ERR_SIZE_OVERFLOW,ATTRIBUTE_OPERATION_ERR_TIMEOUT=AttributeOperationError.ATTRIBUTE_OPERATION_ERR_TIMEOUT,ATTRIBUTE_OPERATION_ERR_USER_NOT_LOGGED_IN=AttributeOperationError.ATTRIBUTE_OPERATION_ERR_USER_NOT_LOGGED_IN,CREATE_CHANNEL_ERR_INVALID_ARGUMENT=CreateChannelError.CREATE_CHANNEL_ERR_INVALID_ARGUMENT,CREATE_INSTANCE_ERR_INVALID_ARGUMENT=CreateInstanceError.CREATE_INSTANCE_ERR_INVALID_ARGUMENT,GET_MEMBERS_ERR_FAILURE=GetMembersError.GET_MEMBERS_ERR_FAILURE,GET_MEMBERS_ERR_REJECTED=GetMembersError.GET_MEMBERS_ERR_REJECTED,GET_MEMBERS_ERR_NOT_IN_CHANNEL=GetMembersError.GET_MEMBERS_ERR_NOT_IN_CHANNEL,GET_MEMBERS_ERR_USER_NOT_LOGGED_IN=GetMembersError.GET_MEMBERS_ERR_USER_NOT_LOGGED_IN,JOIN_CHANNEL_ERR_FAILURE=JoinChannelError.JOIN_CHANNEL_ERR_FAILURE,JOIN_CHANNEL_ERR_INVALID_ARGUMENT=JoinChannelError.JOIN_CHANNEL_ERR_INVALID_ARGUMENT,JOIN_CHANNEL_TIMEOUT=JoinChannelError.JOIN_CHANNEL_TIMEOUT,JOIN_CHANNEL_ERR_EXCEED_LIMIT=JoinChannelError.JOIN_CHANNEL_ERR_EXCEED_LIMIT,JOIN_CHANNEL_ERR_ALREADY_JOINED=JoinChannelError.JOIN_CHANNEL_ERR_ALREADY_JOINED,JOIN_CHANNEL_ERR_USER_NOT_LOGGED_IN=JoinChannelError.JOIN_CHANNEL_ERR_USER_NOT_LOGGED_IN,JOIN_CHANNEL_ERR_ALREADY_JOINED_CHANNEL_OF_SAME_ID=JoinChannelError.JOIN_CHANNEL_ERR_ALREADY_JOINED_CHANNEL_OF_SAME_ID,CHANNEL_MESSAGE_ERR_FAILURE=ChannelMessageError.CHANNEL_MESSAGE_ERR_FAILURE,CHANNEL_MESSAGE_ERR_TIMEOUT=ChannelMessageError.CHANNEL_MESSAGE_ERR_TIMEOUT,CHANNEL_MESSAGE_ERR_TOO_OFTEN=ChannelMessageError.CHANNEL_MESSAGE_ERR_TOO_OFTEN,CHANNEL_MESSAGE_ERR_INVALID_MESSAGE=ChannelMessageError.CHANNEL_MESSAGE_ERR_INVALID_MESSAGE,CHANNEL_MESSAGE_ERR_USER_NOT_LOGGED_IN=ChannelMessageError.CHANNEL_MESSAGE_ERR_USER_NOT_LOGGED_IN,LEAVE_CHANNEL_ERR_FAILURE=LeaveChannelError.LEAVE_CHANNEL_ERR_FAILURE,LEAVE_CHANNEL_ERR_REJECTED=LeaveChannelError.LEAVE_CHANNEL_ERR_REJECTED,LEAVE_CHANNEL_ERR_NOT_IN_CHANNEL=LeaveChannelError.LEAVE_CHANNEL_ERR_NOT_IN_CHANNEL,LEAVE_CHANNEL_ERR_USER_NOT_LOGGED_IN=LeaveChannelError.LEAVE_CHANNEL_ERR_USER_NOT_LOGGED_IN,LOGIN_ERR_UNKNOWN=LoginError.LOGIN_ERR_UNKNOWN,LOGIN_ERR_REJECTED=LoginError.LOGIN_ERR_REJECTED,LOGIN_ERR_INVALID_ARGUMENT=LoginError.LOGIN_ERR_INVALID_ARGUMENT,LOGIN_ERR_INVALID_APP_ID=LoginError.LOGIN_ERR_INVALID_APP_ID,LOGIN_ERR_INVALID_TOKEN=LoginError.LOGIN_ERR_INVALID_TOKEN,LOGIN_ERR_TOKEN_EXPIRED=LoginError.LOGIN_ERR_TOKEN_EXPIRED,LOGIN_ERR_ALREADY_LOGIN=LoginError.LOGIN_ERR_ALREADY_LOGIN,LOGIN_ERR_TIMEOUT=LoginError.LOGIN_ERR_TIMEOUT,LOGIN_ERR_TOO_OFTEN=LoginError.LOGIN_ERR_TOO_OFTEN,LOGOUT_ERR_USER_NOT_LOGGED_IN=LogoutError.LOGOUT_ERR_USER_NOT_LOGGED_IN,PEER_MESSAGE_ERR_FAILURE=PeerMessageError.PEER_MESSAGE_ERR_FAILURE,PEER_MESSAGE_ERR_TIMEOUT=PeerMessageError.PEER_MESSAGE_ERR_TIMEOUT,PEER_MESSAGE_ERR_TOO_OFTEN=PeerMessageError.PEER_MESSAGE_ERR_TOO_OFTEN,PEER_MESSAGE_ERR_INVALID_USERID=PeerMessageError.PEER_MESSAGE_ERR_INVALID_USERID,PEER_MESSAGE_ERR_INVALID_MESSAGE=PeerMessageError.PEER_MESSAGE_ERR_INVALID_MESSAGE,PEER_MESSAGE_ERR_USER_NOT_LOGGED_IN=PeerMessageError.PEER_MESSAGE_ERR_USER_NOT_LOGGED_IN,RENEW_TOKEN_ERR_FAILURE=RenewTokenError.RENEW_TOKEN_ERR_FAILURE,RENEW_TOKEN_ERR_INVALID_ARGUMENT=RenewTokenError.RENEW_TOKEN_ERR_INVALID_ARGUMENT,RENEW_TOKEN_ERR_TOKEN_EXPIRED=RenewTokenError.RENEW_TOKEN_ERR_TOKEN_EXPIRED,RENEW_TOKEN_ERR_INVALID_TOKEN=RenewTokenError.RENEW_TOKEN_ERR_INVALID_TOKEN,RENEW_TOKEN_ERR_USER_NOT_LOGGED_IN=RenewTokenError.RENEW_TOKEN_ERR_USER_NOT_LOGGED_IN,INVITATION_API_CALL_ERR_INVALID_ARGUMENT=InvitationApiCallError.INVITATION_API_CALL_ERR_INVALID_ARGUMENT,INVITATION_API_CALL_ERR_NOT_STARTED=InvitationApiCallError.INVITATION_API_CALL_ERR_NOT_STARTED,INVITATION_API_CALL_ERR_ALREADY_END=InvitationApiCallError.INVITATION_API_CALL_ERR_ALREADY_END,INVITATION_API_CALL_ERR_ALREADY_ACCEPT=InvitationApiCallError.INVITATION_API_CALL_ERR_ALREADY_ACCEPT,INVITATION_API_CALL_ERR_ALREADY_SENT=InvitationApiCallError.INVITATION_API_CALL_ERR_ALREADY_SENT;function createBaseEach(e,t){return function(n,r){if(null==n)return n;if(!isArrayLike_1(n))return e(n,r);for(var i=n.length,o=t?i:-1,a=Object(n);(t?o--:++o<i)&&!1!==r(a[o],o,a););return n}}var _createBaseEach=createBaseEach,baseEach=_createBaseEach(_baseForOwn),_baseEach=baseEach;function baseSome(e,t){var n;return _baseEach(e,(function(e,r,i){return!(n=t(e,r,i))})),!!n}var _baseSome=baseSome;function isIterateeCall(e,t,n){if(!isObject_1(n))return!1;var r=typeof t;return!!("number"==r?isArrayLike_1(n)&&_isIndex(t,n.length):"string"==r&&t in n)&&eq_1(n[t],e)}var _isIterateeCall=isIterateeCall;function some(e,t,n){var r=isArray_1(e)?_arraySome:_baseSome;return n&&_isIterateeCall(e,t,n)&&(t=void 0),r(e,_baseIteratee(t))}var some_1=some,spreadableSymbol=_Symbol?_Symbol.isConcatSpreadable:void 0;function isFlattenable(e){return isArray_1(e)||isArguments_1(e)||!!(spreadableSymbol&&e&&e[spreadableSymbol])}var _isFlattenable=isFlattenable;function baseFlatten(e,t,n,r,i){var o=-1,a=e.length;for(n||(n=_isFlattenable),i||(i=[]);++o<a;){var s=e[o];t>0&&n(s)?t>1?baseFlatten(s,t-1,n,r,i):_arrayPush(i,s):r||(i[i.length]=s)}return i}var _baseFlatten=baseFlatten;function baseMap(e,t){var n=-1,r=isArrayLike_1(e)?Array(e.length):[];return _baseEach(e,(function(e,i,o){r[++n]=t(e,i,o)})),r}var _baseMap=baseMap;function baseSortBy(e,t){var n=e.length;for(e.sort(t);n--;)e[n]=e[n].value;return e}var _baseSortBy=baseSortBy;function compareAscending(e,t){if(e!==t){var n=void 0!==e,r=null===e,i=e==e,o=isSymbol_1(e),a=void 0!==t,s=null===t,c=t==t,u=isSymbol_1(t);if(!s&&!u&&!o&&e>t||o&&a&&c&&!s&&!u||r&&a&&c||!n&&c||!i)return 1;if(!r&&!o&&!u&&e<t||u&&n&&i&&!r&&!o||s&&n&&i||!a&&i||!c)return-1}return 0}var _compareAscending=compareAscending;function compareMultiple(e,t,n){for(var r=-1,i=e.criteria,o=t.criteria,a=i.length,s=n.length;++r<a;){var c=_compareAscending(i[r],o[r]);if(c)return r>=s?c:c*("desc"==n[r]?-1:1)}return e.index-t.index}var _compareMultiple=compareMultiple;function baseOrderBy(e,t,n){t=t.length?_arrayMap(t,(function(e){return isArray_1(e)?function(t){return _baseGet(t,1===e.length?e[0]:e)}:e})):[identity_1];var r=-1;t=_arrayMap(t,_baseUnary(_baseIteratee));var i=_baseMap(e,(function(e,n,i){return{criteria:_arrayMap(t,(function(t){return t(e)})),index:++r,value:e}}));return _baseSortBy(i,(function(e,t){return _compareMultiple(e,t,n)}))}var _baseOrderBy=baseOrderBy;function apply(e,t,n){switch(n.length){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2])}return e.apply(t,n)}var _apply=apply,nativeMax=Math.max;function overRest(e,t,n){return t=nativeMax(void 0===t?e.length-1:t,0),function(){for(var r=arguments,i=-1,o=nativeMax(r.length-t,0),a=Array(o);++i<o;)a[i]=r[t+i];i=-1;for(var s=Array(t+1);++i<t;)s[i]=r[i];return s[t]=n(a),_apply(e,this,s)}}var _overRest=overRest;function constant(e){return function(){return e}}var constant_1=constant,baseSetToString=_defineProperty?function(e,t){return _defineProperty(e,"toString",{configurable:!0,enumerable:!1,value:constant_1(t),writable:!0})}:identity_1,_baseSetToString=baseSetToString,HOT_COUNT=800,HOT_SPAN=16,nativeNow=Date.now;function shortOut(e){var t=0,n=0;return function(){var r=nativeNow(),i=HOT_SPAN-(r-n);if(n=r,i>0){if(++t>=HOT_COUNT)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}var _shortOut=shortOut,setToString=_shortOut(_baseSetToString),_setToString=setToString;function baseRest(e,t){return _setToString(_overRest(e,t,identity_1),e+"")}var _baseRest=baseRest,sortBy=_baseRest((function(e,t){if(null==e)return[];var n=t.length;return n>1&&_isIterateeCall(e,t[0],t[1])?t=[]:n>2&&_isIterateeCall(t[0],t[1],t[2])&&(t=[t[0]]),_baseOrderBy(e,_baseFlatten(t,1),[])})),sortBy_1=sortBy;function assignMergeValue(e,t,n){(void 0!==n&&!eq_1(e[t],n)||void 0===n&&!(t in e))&&_baseAssignValue(e,t,n)}var _assignMergeValue=assignMergeValue,_cloneBuffer=createCommonjsModule((function(e,t){var n=t&&!t.nodeType&&t,r=n&&e&&!e.nodeType&&e,i=r&&r.exports===n?_root.Buffer:void 0,o=i?i.allocUnsafe:void 0;e.exports=function(e,t){if(t)return e.slice();var n=e.length,r=o?o(n):new e.constructor(n);return e.copy(r),r}}));function cloneArrayBuffer(e){var t=new e.constructor(e.byteLength);return new _Uint8Array(t).set(new _Uint8Array(e)),t}var _cloneArrayBuffer=cloneArrayBuffer;function cloneTypedArray(e,t){var n=t?_cloneArrayBuffer(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.length)}var _cloneTypedArray=cloneTypedArray;function copyArray(e,t){var n=-1,r=e.length;for(t||(t=Array(r));++n<r;)t[n]=e[n];return t}var _copyArray=copyArray,objectCreate=Object.create,baseCreate=function(){function e(){}return function(t){if(!isObject_1(t))return{};if(objectCreate)return objectCreate(t);e.prototype=t;var n=new e;return e.prototype=void 0,n}}(),_baseCreate=baseCreate,getPrototype=_overArg(Object.getPrototypeOf,Object),_getPrototype=getPrototype;function initCloneObject(e){return"function"!=typeof e.constructor||_isPrototype(e)?{}:_baseCreate(_getPrototype(e))}var _initCloneObject=initCloneObject;function isArrayLikeObject(e){return isObjectLike_1(e)&&isArrayLike_1(e)}var isArrayLikeObject_1=isArrayLikeObject,objectTag$3="[object Object]",funcProto$2=Function.prototype,objectProto$c=Object.prototype,funcToString$2=funcProto$2.toString,hasOwnProperty$9=objectProto$c.hasOwnProperty,objectCtorString=funcToString$2.call(Object);function isPlainObject$1(e){if(!isObjectLike_1(e)||_baseGetTag(e)!=objectTag$3)return!1;var t=_getPrototype(e);if(null===t)return!0;var n=hasOwnProperty$9.call(t,"constructor")&&t.constructor;return"function"==typeof n&&n instanceof n&&funcToString$2.call(n)==objectCtorString}var isPlainObject_1=isPlainObject$1;function safeGet(e,t){if(("constructor"!==t||"function"!=typeof e[t])&&"__proto__"!=t)return e[t]}var _safeGet=safeGet,objectProto$d=Object.prototype,hasOwnProperty$a=objectProto$d.hasOwnProperty;function assignValue(e,t,n){var r=e[t];hasOwnProperty$a.call(e,t)&&eq_1(r,n)&&(void 0!==n||t in e)||_baseAssignValue(e,t,n)}var _assignValue=assignValue;function copyObject(e,t,n,r){var i=!n;n||(n={});for(var o=-1,a=t.length;++o<a;){var s=t[o],c=r?r(n[s],e[s],s,n,e):void 0;void 0===c&&(c=e[s]),i?_baseAssignValue(n,s,c):_assignValue(n,s,c)}return n}var _copyObject=copyObject;function nativeKeysIn(e){var t=[];if(null!=e)for(var n in Object(e))t.push(n);return t}var _nativeKeysIn=nativeKeysIn,objectProto$e=Object.prototype,hasOwnProperty$b=objectProto$e.hasOwnProperty;function baseKeysIn(e){if(!isObject_1(e))return _nativeKeysIn(e);var t=_isPrototype(e),n=[];for(var r in e)("constructor"!=r||!t&&hasOwnProperty$b.call(e,r))&&n.push(r);return n}var _baseKeysIn=baseKeysIn;function keysIn(e){return isArrayLike_1(e)?_arrayLikeKeys(e,!0):_baseKeysIn(e)}var keysIn_1=keysIn;function toPlainObject(e){return _copyObject(e,keysIn_1(e))}var toPlainObject_1=toPlainObject;function baseMergeDeep(e,t,n,r,i,o,a){var s=_safeGet(e,n),c=_safeGet(t,n),u=a.get(c);if(u)_assignMergeValue(e,n,u);else{var l=o?o(s,c,n+"",e,t,a):void 0,d=void 0===l;if(d){var f=isArray_1(c),h=!f&&isBuffer_1(c),p=!f&&!h&&isTypedArray_1(c);l=c,f||h||p?isArray_1(s)?l=s:isArrayLikeObject_1(s)?l=_copyArray(s):h?(d=!1,l=_cloneBuffer(c,!0)):p?(d=!1,l=_cloneTypedArray(c,!0)):l=[]:isPlainObject_1(c)||isArguments_1(c)?(l=s,isArguments_1(s)?l=toPlainObject_1(s):isObject_1(s)&&!isFunction_1(s)||(l=_initCloneObject(c))):d=!1}d&&(a.set(c,l),i(l,c,r,o,a),a.delete(c)),_assignMergeValue(e,n,l)}}var _baseMergeDeep=baseMergeDeep;function baseMerge(e,t,n,r,i){e!==t&&_baseFor(t,(function(o,a){if(i||(i=new _Stack),isObject_1(o))_baseMergeDeep(e,t,a,n,baseMerge,r,i);else{var s=r?r(_safeGet(e,a),o,a+"",e,t,i):void 0;void 0===s&&(s=o),_assignMergeValue(e,a,s)}}),keysIn_1)}var _baseMerge=baseMerge;function createAssigner(e){return _baseRest((function(t,n){var r=-1,i=n.length,o=i>1?n[i-1]:void 0,a=i>2?n[2]:void 0;for(o=e.length>3&&"function"==typeof o?(i--,o):void 0,a&&_isIterateeCall(n[0],n[1],a)&&(o=i<3?void 0:o,i=1),t=Object(t);++r<i;){var s=n[r];s&&e(t,s,r,o)}return t}))}var _createAssigner=createAssigner,mergeWith=_createAssigner((function(e,t,n,r){_baseMerge(e,t,n,r)})),mergeWith_1=mergeWith;function rateLimit(e){var t=1,n=asapScheduler;1===(arguments.length<=1?0:arguments.length-1)?"number"==typeof(arguments.length<=1?void 0:arguments[1])?t=arguments.length<=1?void 0:arguments[1]:n=arguments.length<=1?void 0:arguments[1]:2===(arguments.length<=1?0:arguments.length-1)&&(t=arguments.length<=1?void 0:arguments[1],n=arguments.length<=2?void 0:arguments[2]);var r=t||1;return function(t){return t.pipe(scan((function(t,i){var o=n.now(),a=o-e;if((t=t.filter((function(e){return e.until>a}))).length>=r){var s=t[0],c=t[t.length-1],u=s.until+e*Math.floor(t.length/r);t.push({delay:c.until<o?u-o:u-c.until,until:u,value:i})}else t.push({delay:0,until:o,value:i});return t}),[]),map$1((function(e){return e[e.length-1]})),concatMap((function(e){var t=of(e.value);return e.delay?t.pipe(delay(e.delay,n)):t})))}}var aspromise=asPromise;function asPromise(e,t){for(var n=new Array(arguments.length-1),r=0,i=2,o=!0;i<arguments.length;)n[r++]=arguments[i++];return new Promise((function(i,a){n[r]=function(e){if(o)if(o=!1,e)a(e);else{for(var t=new Array(arguments.length-1),n=0;n<t.length;)t[n++]=arguments[n];i.apply(null,t)}};try{e.apply(t||null,n)}catch(e){o&&(o=!1,a(e))}}))}var base64_1=createCommonjsModule((function(e,t){var n=t;n.length=function(e){var t=e.length;if(!t)return 0;for(var n=0;--t%4>1&&"="===e.charAt(t);)++n;return Math.ceil(3*e.length)/4-n};for(var r=new Array(64),i=new Array(123),o=0;o<64;)i[r[o]=o<26?o+65:o<52?o+71:o<62?o-4:o-59|43]=o++;n.encode=function(e,t,n){for(var i,o=null,a=[],s=0,c=0;t<n;){var u=e[t++];switch(c){case 0:a[s++]=r[u>>2],i=(3&u)<<4,c=1;break;case 1:a[s++]=r[i|u>>4],i=(15&u)<<2,c=2;break;case 2:a[s++]=r[i|u>>6],a[s++]=r[63&u],c=0}s>8191&&((o||(o=[])).push(String.fromCharCode.apply(String,a)),s=0)}return c&&(a[s++]=r[i],a[s++]=61,1===c&&(a[s++]=61)),o?(s&&o.push(String.fromCharCode.apply(String,a.slice(0,s))),o.join("")):String.fromCharCode.apply(String,a.slice(0,s))};var a="invalid encoding";n.decode=function(e,t,n){for(var r,o=n,s=0,c=0;c<e.length;){var u=e.charCodeAt(c++);if(61===u&&s>1)break;if(void 0===(u=i[u]))throw Error(a);switch(s){case 0:r=u,s=1;break;case 1:t[n++]=r<<2|(48&u)>>4,r=u,s=2;break;case 2:t[n++]=(15&r)<<4|(60&u)>>2,r=u,s=3;break;case 3:t[n++]=(3&r)<<6|u,s=0}}if(1===s)throw Error(a);return n-o},n.test=function(e){return/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(e)}})),eventemitter=EventEmitter$1;function EventEmitter$1(){this._listeners={}}EventEmitter$1.prototype.on=function(e,t,n){return(this._listeners[e]||(this._listeners[e]=[])).push({fn:t,ctx:n||this}),this},EventEmitter$1.prototype.off=function(e,t){if(void 0===e)this._listeners={};else if(void 0===t)this._listeners[e]=[];else for(var n=this._listeners[e],r=0;r<n.length;)n[r].fn===t?n.splice(r,1):++r;return this},EventEmitter$1.prototype.emit=function(e){var t=this._listeners[e];if(t){for(var n=[],r=1;r<arguments.length;)n.push(arguments[r++]);for(r=0;r<t.length;)t[r].fn.apply(t[r++].ctx,n)}return this};var float_1=factory(factory);function factory(e){return"undefined"!=typeof Float32Array?function(){var t=new Float32Array([-0]),n=new Uint8Array(t.buffer),r=128===n[3];function i(e,r,i){t[0]=e,r[i]=n[0],r[i+1]=n[1],r[i+2]=n[2],r[i+3]=n[3]}function o(e,r,i){t[0]=e,r[i]=n[3],r[i+1]=n[2],r[i+2]=n[1],r[i+3]=n[0]}function a(e,r){return n[0]=e[r],n[1]=e[r+1],n[2]=e[r+2],n[3]=e[r+3],t[0]}function s(e,r){return n[3]=e[r],n[2]=e[r+1],n[1]=e[r+2],n[0]=e[r+3],t[0]}e.writeFloatLE=r?i:o,e.writeFloatBE=r?o:i,e.readFloatLE=r?a:s,e.readFloatBE=r?s:a}():function(){function t(e,t,n,r){var i=t<0?1:0;if(i&&(t=-t),0===t)e(1/t>0?0:2147483648,n,r);else if(isNaN(t))e(2143289344,n,r);else if(t>34028234663852886e22)e((i<<31|2139095040)>>>0,n,r);else if(t<11754943508222875e-54)e((i<<31|Math.round(t/1401298464324817e-60))>>>0,n,r);else{var o=Math.floor(Math.log(t)/Math.LN2);e((i<<31|o+127<<23|8388607&Math.round(t*Math.pow(2,-o)*8388608))>>>0,n,r)}}function n(e,t,n){var r=e(t,n),i=2*(r>>31)+1,o=r>>>23&255,a=8388607&r;return 255===o?a?NaN:i*(1/0):0===o?1401298464324817e-60*i*a:i*Math.pow(2,o-150)*(a+8388608)}e.writeFloatLE=t.bind(null,writeUintLE),e.writeFloatBE=t.bind(null,writeUintBE),e.readFloatLE=n.bind(null,readUintLE),e.readFloatBE=n.bind(null,readUintBE)}(),"undefined"!=typeof Float64Array?function(){var t=new Float64Array([-0]),n=new Uint8Array(t.buffer),r=128===n[7];function i(e,r,i){t[0]=e,r[i]=n[0],r[i+1]=n[1],r[i+2]=n[2],r[i+3]=n[3],r[i+4]=n[4],r[i+5]=n[5],r[i+6]=n[6],r[i+7]=n[7]}function o(e,r,i){t[0]=e,r[i]=n[7],r[i+1]=n[6],r[i+2]=n[5],r[i+3]=n[4],r[i+4]=n[3],r[i+5]=n[2],r[i+6]=n[1],r[i+7]=n[0]}function a(e,r){return n[0]=e[r],n[1]=e[r+1],n[2]=e[r+2],n[3]=e[r+3],n[4]=e[r+4],n[5]=e[r+5],n[6]=e[r+6],n[7]=e[r+7],t[0]}function s(e,r){return n[7]=e[r],n[6]=e[r+1],n[5]=e[r+2],n[4]=e[r+3],n[3]=e[r+4],n[2]=e[r+5],n[1]=e[r+6],n[0]=e[r+7],t[0]}e.writeDoubleLE=r?i:o,e.writeDoubleBE=r?o:i,e.readDoubleLE=r?a:s,e.readDoubleBE=r?s:a}():function(){function t(e,t,n,r,i,o){var a=r<0?1:0;if(a&&(r=-r),0===r)e(0,i,o+t),e(1/r>0?0:2147483648,i,o+n);else if(isNaN(r))e(0,i,o+t),e(2146959360,i,o+n);else if(r>17976931348623157e292)e(0,i,o+t),e((a<<31|2146435072)>>>0,i,o+n);else{var s;if(r<22250738585072014e-324)e((s=r/5e-324)>>>0,i,o+t),e((a<<31|s/4294967296)>>>0,i,o+n);else{var c=Math.floor(Math.log(r)/Math.LN2);1024===c&&(c=1023),e(4503599627370496*(s=r*Math.pow(2,-c))>>>0,i,o+t),e((a<<31|c+1023<<20|1048576*s&1048575)>>>0,i,o+n)}}}function n(e,t,n,r,i){var o=e(r,i+t),a=e(r,i+n),s=2*(a>>31)+1,c=a>>>20&2047,u=4294967296*(1048575&a)+o;return 2047===c?u?NaN:s*(1/0):0===c?5e-324*s*u:s*Math.pow(2,c-1075)*(u+4503599627370496)}e.writeDoubleLE=t.bind(null,writeUintLE,0,4),e.writeDoubleBE=t.bind(null,writeUintBE,4,0),e.readDoubleLE=n.bind(null,readUintLE,0,4),e.readDoubleBE=n.bind(null,readUintBE,4,0)}(),e}function writeUintLE(e,t,n){t[n]=255&e,t[n+1]=e>>>8&255,t[n+2]=e>>>16&255,t[n+3]=e>>>24}function writeUintBE(e,t,n){t[n]=e>>>24,t[n+1]=e>>>16&255,t[n+2]=e>>>8&255,t[n+3]=255&e}function readUintLE(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16|e[t+3]<<24)>>>0}function readUintBE(e,t){return(e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3])>>>0}var inquire_1=inquire;function inquire(moduleName){try{var mod=eval("quire".replace(/^/,"re"))(moduleName);if(mod&&(mod.length||Object.keys(mod).length))return mod}catch(e){}return null}var utf8_1=createCommonjsModule((function(e,t){var n=t;n.length=function(e){for(var t=0,n=0,r=0;r<e.length;++r)(n=e.charCodeAt(r))<128?t+=1:n<2048?t+=2:55296==(64512&n)&&56320==(64512&e.charCodeAt(r+1))?(++r,t+=4):t+=3;return t},n.read=function(e,t,n){if(n-t<1)return"";for(var r,i=null,o=[],a=0;t<n;)(r=e[t++])<128?o[a++]=r:r>191&&r<224?o[a++]=(31&r)<<6|63&e[t++]:r>239&&r<365?(r=((7&r)<<18|(63&e[t++])<<12|(63&e[t++])<<6|63&e[t++])-65536,o[a++]=55296+(r>>10),o[a++]=56320+(1023&r)):o[a++]=(15&r)<<12|(63&e[t++])<<6|63&e[t++],a>8191&&((i||(i=[])).push(String.fromCharCode.apply(String,o)),a=0);return i?(a&&i.push(String.fromCharCode.apply(String,o.slice(0,a))),i.join("")):String.fromCharCode.apply(String,o.slice(0,a))},n.write=function(e,t,n){for(var r,i,o=n,a=0;a<e.length;++a)(r=e.charCodeAt(a))<128?t[n++]=r:r<2048?(t[n++]=r>>6|192,t[n++]=63&r|128):55296==(64512&r)&&56320==(64512&(i=e.charCodeAt(a+1)))?(r=65536+((1023&r)<<10)+(1023&i),++a,t[n++]=r>>18|240,t[n++]=r>>12&63|128,t[n++]=r>>6&63|128,t[n++]=63&r|128):(t[n++]=r>>12|224,t[n++]=r>>6&63|128,t[n++]=63&r|128);return n-o}})),pool_1=pool;function pool(e,t,n){var r=n||8192,i=r>>>1,o=null,a=r;return function(n){if(n<1||n>i)return e(n);a+n>r&&(o=e(r),a=0);var s=t.call(o,a,a+=n);return 7&a&&(a=1+(7|a)),s}}var longbits=LongBits;function LongBits(e,t){this.lo=e>>>0,this.hi=t>>>0}var zero=LongBits.zero=new LongBits(0,0);zero.toNumber=function(){return 0},zero.zzEncode=zero.zzDecode=function(){return this},zero.length=function(){return 1};var zeroHash=LongBits.zeroHash="\0\0\0\0\0\0\0\0";LongBits.fromNumber=function(e){if(0===e)return zero;var t=e<0;t&&(e=-e);var n=e>>>0,r=(e-n)/4294967296>>>0;return t&&(r=~r>>>0,n=~n>>>0,++n>4294967295&&(n=0,++r>4294967295&&(r=0))),new LongBits(n,r)},LongBits.from=function(e){if("number"==typeof e)return LongBits.fromNumber(e);if(minimal.isString(e)){if(!minimal.Long)return LongBits.fromNumber(parseInt(e,10));e=minimal.Long.fromString(e)}return e.low||e.high?new LongBits(e.low>>>0,e.high>>>0):zero},LongBits.prototype.toNumber=function(e){if(!e&&this.hi>>>31){var t=1+~this.lo>>>0,n=~this.hi>>>0;return t||(n=n+1>>>0),-(t+4294967296*n)}return this.lo+4294967296*this.hi},LongBits.prototype.toLong=function(e){return minimal.Long?new minimal.Long(0|this.lo,0|this.hi,Boolean(e)):{low:0|this.lo,high:0|this.hi,unsigned:Boolean(e)}};var charCodeAt=String.prototype.charCodeAt;LongBits.fromHash=function(e){return e===zeroHash?zero:new LongBits((charCodeAt.call(e,0)|charCodeAt.call(e,1)<<8|charCodeAt.call(e,2)<<16|charCodeAt.call(e,3)<<24)>>>0,(charCodeAt.call(e,4)|charCodeAt.call(e,5)<<8|charCodeAt.call(e,6)<<16|charCodeAt.call(e,7)<<24)>>>0)},LongBits.prototype.toHash=function(){return String.fromCharCode(255&this.lo,this.lo>>>8&255,this.lo>>>16&255,this.lo>>>24,255&this.hi,this.hi>>>8&255,this.hi>>>16&255,this.hi>>>24)},LongBits.prototype.zzEncode=function(){var e=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^e)>>>0,this.lo=(this.lo<<1^e)>>>0,this},LongBits.prototype.zzDecode=function(){var e=-(1&this.lo);return this.lo=((this.lo>>>1|this.hi<<31)^e)>>>0,this.hi=(this.hi>>>1^e)>>>0,this},LongBits.prototype.length=function(){var e=this.lo,t=(this.lo>>>28|this.hi<<4)>>>0,n=this.hi>>>24;return 0===n?0===t?e<16384?e<128?1:2:e<2097152?3:4:t<16384?t<128?5:6:t<2097152?7:8:n<128?9:10};var minimal=createCommonjsModule((function(e,t){var n=t;function r(e,t,n){for(var r=Object.keys(t),i=0;i<r.length;++i)void 0!==e[r[i]]&&n||(e[r[i]]=t[r[i]]);return e}function i(e){function t(e,n){if(!(this instanceof t))return new t(e,n);Object.defineProperty(this,"message",{get:function(){return e}}),Error.captureStackTrace?Error.captureStackTrace(this,t):Object.defineProperty(this,"stack",{value:(new Error).stack||""}),n&&r(this,n)}return(t.prototype=Object.create(Error.prototype)).constructor=t,Object.defineProperty(t.prototype,"name",{get:function(){return e}}),t.prototype.toString=function(){return this.name+": "+this.message},t}n.asPromise=aspromise,n.base64=base64_1,n.EventEmitter=eventemitter,n.float=float_1,n.inquire=inquire_1,n.utf8=utf8_1,n.pool=pool_1,n.LongBits=longbits,n.isNode=Boolean(void 0!==commonjsGlobal&&commonjsGlobal&&commonjsGlobal.process&&commonjsGlobal.process.versions&&commonjsGlobal.process.versions.node),n.global=n.isNode&&commonjsGlobal||"undefined"!=typeof window&&window||"undefined"!=typeof self&&self||commonjsGlobal,n.emptyArray=Object.freeze?Object.freeze([]):[],n.emptyObject=Object.freeze?Object.freeze({}):{},n.isInteger=Number.isInteger||function(e){return"number"==typeof e&&isFinite(e)&&Math.floor(e)===e},n.isString=function(e){return"string"==typeof e||e instanceof String},n.isObject=function(e){return e&&"object"==typeof e},n.isset=n.isSet=function(e,t){var n=e[t];return!(null==n||!e.hasOwnProperty(t))&&("object"!=typeof n||(Array.isArray(n)?n.length:Object.keys(n).length)>0)},n.Buffer=function(){try{var e=n.inquire("buffer").Buffer;return e.prototype.utf8Write?e:null}catch(e){return null}}(),n._Buffer_from=null,n._Buffer_allocUnsafe=null,n.newBuffer=function(e){return"number"==typeof e?n.Buffer?n._Buffer_allocUnsafe(e):new n.Array(e):n.Buffer?n._Buffer_from(e):"undefined"==typeof Uint8Array?e:new Uint8Array(e)},n.Array="undefined"!=typeof Uint8Array?Uint8Array:Array,n.Long=n.global.dcodeIO&&n.global.dcodeIO.Long||n.global.Long||n.inquire("long"),n.key2Re=/^true|false|0|1$/,n.key32Re=/^-?(?:0|[1-9][0-9]*)$/,n.key64Re=/^(?:[\\x00-\\xff]{8}|-?(?:0|[1-9][0-9]*))$/,n.longToHash=function(e){return e?n.LongBits.from(e).toHash():n.LongBits.zeroHash},n.longFromHash=function(e,t){var r=n.LongBits.fromHash(e);return n.Long?n.Long.fromBits(r.lo,r.hi,t):r.toNumber(Boolean(t))},n.merge=r,n.lcFirst=function(e){return e.charAt(0).toLowerCase()+e.substring(1)},n.newError=i,n.ProtocolError=i("ProtocolError"),n.oneOfGetter=function(e){for(var t={},n=0;n<e.length;++n)t[e[n]]=1;return function(){for(var e=Object.keys(this),n=e.length-1;n>-1;--n)if(1===t[e[n]]&&void 0!==this[e[n]]&&null!==this[e[n]])return e[n]}},n.oneOfSetter=function(e){return function(t){for(var n=0;n<e.length;++n)e[n]!==t&&delete this[e[n]]}},n.toJSONOptions={longs:String,enums:String,bytes:String,json:!0},n._configure=function(){var e=n.Buffer;e?(n._Buffer_from=e.from!==Uint8Array.from&&e.from||function(t,n){return new e(t,n)},n._Buffer_allocUnsafe=e.allocUnsafe||function(t){return new e(t)}):n._Buffer_from=n._Buffer_allocUnsafe=null}})),writer=Writer,BufferWriter,LongBits$1=minimal.LongBits,base64=minimal.base64,utf8=minimal.utf8;function Op(e,t,n){this.fn=e,this.len=t,this.next=void 0,this.val=n}function noop$1(){}function State(e){this.head=e.head,this.tail=e.tail,this.len=e.len,this.next=e.states}function Writer(){this.len=0,this.head=new Op(noop$1,0,0),this.tail=this.head,this.states=null}var create=function(){return minimal.Buffer?function(){return(Writer.create=function(){return new BufferWriter})()}:function(){return new Writer}};function writeByte(e,t,n){t[n]=255&e}function writeVarint32(e,t,n){for(;e>127;)t[n++]=127&e|128,e>>>=7;t[n]=e}function VarintOp(e,t){this.len=e,this.next=void 0,this.val=t}function writeVarint64(e,t,n){for(;e.hi;)t[n++]=127&e.lo|128,e.lo=(e.lo>>>7|e.hi<<25)>>>0,e.hi>>>=7;for(;e.lo>127;)t[n++]=127&e.lo|128,e.lo=e.lo>>>7;t[n++]=e.lo}function writeFixed32(e,t,n){t[n]=255&e,t[n+1]=e>>>8&255,t[n+2]=e>>>16&255,t[n+3]=e>>>24}Writer.create=create(),Writer.alloc=function(e){return new minimal.Array(e)},minimal.Array!==Array&&(Writer.alloc=minimal.pool(Writer.alloc,minimal.Array.prototype.subarray)),Writer.prototype._push=function(e,t,n){return this.tail=this.tail.next=new Op(e,t,n),this.len+=t,this},VarintOp.prototype=Object.create(Op.prototype),VarintOp.prototype.fn=writeVarint32,Writer.prototype.uint32=function(e){return this.len+=(this.tail=this.tail.next=new VarintOp((e>>>=0)<128?1:e<16384?2:e<2097152?3:e<268435456?4:5,e)).len,this},Writer.prototype.int32=function(e){return e<0?this._push(writeVarint64,10,LongBits$1.fromNumber(e)):this.uint32(e)},Writer.prototype.sint32=function(e){return this.uint32((e<<1^e>>31)>>>0)},Writer.prototype.uint64=function(e){var t=LongBits$1.from(e);return this._push(writeVarint64,t.length(),t)},Writer.prototype.int64=Writer.prototype.uint64,Writer.prototype.sint64=function(e){var t=LongBits$1.from(e).zzEncode();return this._push(writeVarint64,t.length(),t)},Writer.prototype.bool=function(e){return this._push(writeByte,1,e?1:0)},Writer.prototype.fixed32=function(e){return this._push(writeFixed32,4,e>>>0)},Writer.prototype.sfixed32=Writer.prototype.fixed32,Writer.prototype.fixed64=function(e){var t=LongBits$1.from(e);return this._push(writeFixed32,4,t.lo)._push(writeFixed32,4,t.hi)},Writer.prototype.sfixed64=Writer.prototype.fixed64,Writer.prototype.float=function(e){return this._push(minimal.float.writeFloatLE,4,e)},Writer.prototype.double=function(e){return this._push(minimal.float.writeDoubleLE,8,e)};var writeBytes=minimal.Array.prototype.set?function(e,t,n){t.set(e,n)}:function(e,t,n){for(var r=0;r<e.length;++r)t[n+r]=e[r]};Writer.prototype.bytes=function(e){var t=e.length>>>0;if(!t)return this._push(writeByte,1,0);if(minimal.isString(e)){var n=Writer.alloc(t=base64.length(e));base64.decode(e,n,0),e=n}return this.uint32(t)._push(writeBytes,t,e)},Writer.prototype.string=function(e){var t=utf8.length(e);return t?this.uint32(t)._push(utf8.write,t,e):this._push(writeByte,1,0)},Writer.prototype.fork=function(){return this.states=new State(this),this.head=this.tail=new Op(noop$1,0,0),this.len=0,this},Writer.prototype.reset=function(){return this.states?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new Op(noop$1,0,0),this.len=0),this},Writer.prototype.ldelim=function(){var e=this.head,t=this.tail,n=this.len;return this.reset().uint32(n),n&&(this.tail.next=e.next,this.tail=t,this.len+=n),this},Writer.prototype.finish=function(){for(var e=this.head.next,t=this.constructor.alloc(this.len),n=0;e;)e.fn(e.val,t,n),n+=e.len,e=e.next;return t},Writer._configure=function(e){BufferWriter=e,Writer.create=create(),BufferWriter._configure()};var writer_buffer=BufferWriter$1;function BufferWriter$1(){writer.call(this)}function writeStringBuffer(e,t,n){e.length<40?minimal.utf8.write(e,t,n):t.utf8Write?t.utf8Write(e,n):t.write(e,n)}(BufferWriter$1.prototype=Object.create(writer.prototype)).constructor=BufferWriter$1,BufferWriter$1._configure=function(){BufferWriter$1.alloc=minimal._Buffer_allocUnsafe,BufferWriter$1.writeBytesBuffer=minimal.Buffer&&minimal.Buffer.prototype instanceof Uint8Array&&"set"===minimal.Buffer.prototype.set.name?function(e,t,n){t.set(e,n)}:function(e,t,n){if(e.copy)e.copy(t,n,0,e.length);else for(var r=0;r<e.length;)t[n++]=e[r++]}},BufferWriter$1.prototype.bytes=function(e){minimal.isString(e)&&(e=minimal._Buffer_from(e,"base64"));var t=e.length>>>0;return this.uint32(t),t&&this._push(BufferWriter$1.writeBytesBuffer,t,e),this},BufferWriter$1.prototype.string=function(e){var t=minimal.Buffer.byteLength(e);return this.uint32(t),t&&this._push(writeStringBuffer,t,e),this},BufferWriter$1._configure();var reader=Reader,BufferReader,LongBits$2=minimal.LongBits,utf8$1=minimal.utf8;function indexOutOfRange(e,t){return RangeError("index out of range: "+e.pos+" + "+(t||1)+" > "+e.len)}function Reader(e){this.buf=e,this.pos=0,this.len=e.length}var create_array="undefined"!=typeof Uint8Array?function(e){if(e instanceof Uint8Array||Array.isArray(e))return new Reader(e);throw Error("illegal buffer")}:function(e){if(Array.isArray(e))return new Reader(e);throw Error("illegal buffer")},create$1=function(){return minimal.Buffer?function(e){return(Reader.create=function(e){return minimal.Buffer.isBuffer(e)?new BufferReader(e):create_array(e)})(e)}:create_array},value;function readLongVarint(){var e=new LongBits$2(0,0),t=0;if(!(this.len-this.pos>4)){for(;t<3;++t){if(this.pos>=this.len)throw indexOutOfRange(this);if(e.lo=(e.lo|(127&this.buf[this.pos])<<7*t)>>>0,this.buf[this.pos++]<128)return e}return e.lo=(e.lo|(127&this.buf[this.pos++])<<7*t)>>>0,e}for(;t<4;++t)if(e.lo=(e.lo|(127&this.buf[this.pos])<<7*t)>>>0,this.buf[this.pos++]<128)return e;if(e.lo=(e.lo|(127&this.buf[this.pos])<<28)>>>0,e.hi=(e.hi|(127&this.buf[this.pos])>>4)>>>0,this.buf[this.pos++]<128)return e;if(t=0,this.len-this.pos>4){for(;t<5;++t)if(e.hi=(e.hi|(127&this.buf[this.pos])<<7*t+3)>>>0,this.buf[this.pos++]<128)return e}else for(;t<5;++t){if(this.pos>=this.len)throw indexOutOfRange(this);if(e.hi=(e.hi|(127&this.buf[this.pos])<<7*t+3)>>>0,this.buf[this.pos++]<128)return e}throw Error("invalid varint encoding")}function readFixed32_end(e,t){return(e[t-4]|e[t-3]<<8|e[t-2]<<16|e[t-1]<<24)>>>0}function readFixed64(){if(this.pos+8>this.len)throw indexOutOfRange(this,8);return new LongBits$2(readFixed32_end(this.buf,this.pos+=4),readFixed32_end(this.buf,this.pos+=4))}Reader.create=create$1(),Reader.prototype._slice=minimal.Array.prototype.subarray||minimal.Array.prototype.slice,Reader.prototype.uint32=(value=4294967295,function(){if(value=(127&this.buf[this.pos])>>>0,this.buf[this.pos++]<128)return value;if(value=(value|(127&this.buf[this.pos])<<7)>>>0,this.buf[this.pos++]<128)return value;if(value=(value|(127&this.buf[this.pos])<<14)>>>0,this.buf[this.pos++]<128)return value;if(value=(value|(127&this.buf[this.pos])<<21)>>>0,this.buf[this.pos++]<128)return value;if(value=(value|(15&this.buf[this.pos])<<28)>>>0,this.buf[this.pos++]<128)return value;if((this.pos+=5)>this.len)throw this.pos=this.len,indexOutOfRange(this,10);return value}),Reader.prototype.int32=function(){return 0|this.uint32()},Reader.prototype.sint32=function(){var e=this.uint32();return e>>>1^-(1&e)|0},Reader.prototype.bool=function(){return 0!==this.uint32()},Reader.prototype.fixed32=function(){if(this.pos+4>this.len)throw indexOutOfRange(this,4);return readFixed32_end(this.buf,this.pos+=4)},Reader.prototype.sfixed32=function(){if(this.pos+4>this.len)throw indexOutOfRange(this,4);return 0|readFixed32_end(this.buf,this.pos+=4)},Reader.prototype.float=function(){if(this.pos+4>this.len)throw indexOutOfRange(this,4);var e=minimal.float.readFloatLE(this.buf,this.pos);return this.pos+=4,e},Reader.prototype.double=function(){if(this.pos+8>this.len)throw indexOutOfRange(this,4);var e=minimal.float.readDoubleLE(this.buf,this.pos);return this.pos+=8,e},Reader.prototype.bytes=function(){var e=this.uint32(),t=this.pos,n=this.pos+e;if(n>this.len)throw indexOutOfRange(this,e);return this.pos+=e,Array.isArray(this.buf)?this.buf.slice(t,n):t===n?new this.buf.constructor(0):this._slice.call(this.buf,t,n)},Reader.prototype.string=function(){var e=this.bytes();return utf8$1.read(e,0,e.length)},Reader.prototype.skip=function(e){if("number"==typeof e){if(this.pos+e>this.len)throw indexOutOfRange(this,e);this.pos+=e}else do{if(this.pos>=this.len)throw indexOutOfRange(this)}while(128&this.buf[this.pos++]);return this},Reader.prototype.skipType=function(e){switch(e){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;4!=(e=7&this.uint32());)this.skipType(e);break;case 5:this.skip(4);break;default:throw Error("invalid wire type "+e+" at offset "+this.pos)}return this},Reader._configure=function(e){BufferReader=e,Reader.create=create$1(),BufferReader._configure();var t=minimal.Long?"toLong":"toNumber";minimal.merge(Reader.prototype,{int64:function(){return readLongVarint.call(this)[t](!1)},uint64:function(){return readLongVarint.call(this)[t](!0)},sint64:function(){return readLongVarint.call(this).zzDecode()[t](!1)},fixed64:function(){return readFixed64.call(this)[t](!0)},sfixed64:function(){return readFixed64.call(this)[t](!1)}})};var reader_buffer=BufferReader$1;function BufferReader$1(e){reader.call(this,e)}(BufferReader$1.prototype=Object.create(reader.prototype)).constructor=BufferReader$1,BufferReader$1._configure=function(){minimal.Buffer&&(BufferReader$1.prototype._slice=minimal.Buffer.prototype.slice)},BufferReader$1.prototype.string=function(){var e=this.uint32();return this.buf.utf8Slice?this.buf.utf8Slice(this.pos,this.pos=Math.min(this.pos+e,this.len)):this.buf.toString("utf-8",this.pos,this.pos=Math.min(this.pos+e,this.len))},BufferReader$1._configure();var service=Service;function Service(e,t,n){if("function"!=typeof e)throw TypeError("rpcImpl must be a function");minimal.EventEmitter.call(this),this.rpcImpl=e,this.requestDelimited=Boolean(t),this.responseDelimited=Boolean(n)}(Service.prototype=Object.create(minimal.EventEmitter.prototype)).constructor=Service,Service.prototype.rpcCall=function e(t,n,r,i,o){if(!i)throw TypeError("request must be specified");var a=this;if(!o)return minimal.asPromise(e,a,t,n,r,i);if(a.rpcImpl)try{return a.rpcImpl(t,n[a.requestDelimited?"encodeDelimited":"encode"](i).finish(),(function(e,n){if(e)return a.emit("error",e,t),o(e);if(null!==n){if(!(n instanceof r))try{n=r[a.responseDelimited?"decodeDelimited":"decode"](n)}catch(e){return a.emit("error",e,t),o(e)}return a.emit("data",n,t),o(null,n)}a.end(!0)}))}catch(e){return a.emit("error",e,t),void setTimeout((function(){o(e)}),0)}else setTimeout((function(){o(Error("already ended"))}),0)},Service.prototype.end=function(e){return this.rpcImpl&&(e||this.rpcImpl(null,null,null),this.rpcImpl=null,this.emit("end").off()),this};var rpc_1=createCommonjsModule((function(e,t){t.Service=service})),roots={},indexMinimal=createCommonjsModule((function(e,t){var n=t;function r(){n.util._configure(),n.Writer._configure(n.BufferWriter),n.Reader._configure(n.BufferReader)}n.build="minimal",n.Writer=writer,n.BufferWriter=writer_buffer,n.Reader=reader,n.BufferReader=reader_buffer,n.util=minimal,n.rpc=rpc_1,n.roots=roots,n.configure=r,r()}));indexMinimal.util.Long=long_1,indexMinimal.configure();var minimal_1=indexMinimal,$Reader=minimal_1.Reader,$Writer=minimal_1.Writer,$util=minimal_1.util,$root=minimal_1.roots.default||(minimal_1.roots.default={}),URI=$root.URI=function(){var e={},t=Object.create(e);return t[e[0]="Unknown"]=0,t[e[1]="PingUri"]=1,t[e[2]="PongUri"]=2,t[e[11]="UserJoinUri"]=11,t[e[12]="UserRespUri"]=12,t[e[21]="UserQuitUri"]=21,t[e[22]="UserDropUri"]=22,t[e[31]="GroupEnterUri"]=31,t[e[32]="GroupLeaveUri"]=32,t[e[33]="GroupReplyUri"]=33,t[e[36]="GroupEnterNoticeUri"]=36,t[e[37]="GroupLeaveNoticeUri"]=37,t[e[38]="GroupEventNoticeUri"]=38,t[e[351]="GroupAttributeGetUri"]=351,t[e[352]="GroupAttributeRetUri"]=352,t[e[353]="GroupAttributeSetUri"]=353,t[e[354]="GroupAttributeModUri"]=354,t[e[355]="GroupAttributeDelUri"]=355,t[e[356]="GroupAttributeAltUri"]=356,t[e[357]="GroupAttributeRspUri"]=357,t[e[358]="GroupAttributeErrUri"]=358,t[e[361]="GroupAttributeKeysGetUri"]=361,t[e[362]="GroupAttributeKeysRetUri"]=362,t[e[55]="GroupAllUsersListUri"]=55,t[e[56]="GroupAllUsersResultUri"]=56,t[e[100]="MessageUri"]=100,t[e[101]="AckUri"]=101,t}(),Wrapper=$root.Wrapper=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.uri=0,e.prototype.data=$util.newBuffer([]),e.encode=function(e,t){return t||(t=$Writer.create()),null!=e.uri&&Object.hasOwnProperty.call(e,"uri")&&t.uint32(8).int32(e.uri),null!=e.data&&Object.hasOwnProperty.call(e,"data")&&t.uint32(18).bytes(e.data),t},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new $root.Wrapper;e.pos<n;){var i=e.uint32();switch(i>>>3){case 1:r.uri=e.int32();break;case 2:r.data=e.bytes();break;default:e.skipType(7&i)}}return r},e}(),Ping=$root.Ping=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.seq=$util.Long?$util.Long.fromBits(0,0,!0):0,e.prototype.ms=$util.Long?$util.Long.fromBits(0,0,!0):0,e.encode=function(e,t){return t||(t=$Writer.create()),null!=e.seq&&Object.hasOwnProperty.call(e,"seq")&&t.uint32(8).uint64(e.seq),null!=e.ms&&Object.hasOwnProperty.call(e,"ms")&&t.uint32(16).uint64(e.ms),t},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new $root.Ping;e.pos<n;){var i=e.uint32();switch(i>>>3){case 1:r.seq=e.uint64();break;case 2:r.ms=e.uint64();break;default:e.skipType(7&i)}}return r},e}(),Pong=$root.Pong=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.seq=$util.Long?$util.Long.fromBits(0,0,!0):0,e.prototype.ms=$util.Long?$util.Long.fromBits(0,0,!0):0,e.encode=function(e,t){return t||(t=$Writer.create()),null!=e.seq&&Object.hasOwnProperty.call(e,"seq")&&t.uint32(8).uint64(e.seq),null!=e.ms&&Object.hasOwnProperty.call(e,"ms")&&t.uint32(16).uint64(e.ms),t},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new $root.Pong;e.pos<n;){var i=e.uint32();switch(i>>>3){case 1:r.seq=e.uint64();break;case 2:r.ms=e.uint64();break;default:e.skipType(7&i)}}return r},e}(),UserJoin=$root.UserJoin=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.seq=$util.Long?$util.Long.fromBits(0,0,!0):0,e.prototype.opt=$util.Long?$util.Long.fromBits(0,0,!0):0,e.prototype.instance=$util.Long?$util.Long.fromBits(0,0,!0):0,e.prototype.account="",e.prototype.ticket="",e.encode=function(e,t){return t||(t=$Writer.create()),null!=e.seq&&Object.hasOwnProperty.call(e,"seq")&&t.uint32(8).uint64(e.seq),null!=e.opt&&Object.hasOwnProperty.call(e,"opt")&&t.uint32(16).uint64(e.opt),null!=e.instance&&Object.hasOwnProperty.call(e,"instance")&&t.uint32(24).uint64(e.instance),null!=e.account&&Object.hasOwnProperty.call(e,"account")&&t.uint32(34).string(e.account),null!=e.ticket&&Object.hasOwnProperty.call(e,"ticket")&&t.uint32(42).string(e.ticket),t},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new $root.UserJoin;e.pos<n;){var i=e.uint32();switch(i>>>3){case 1:r.seq=e.uint64();break;case 2:r.opt=e.uint64();break;case 3:r.instance=e.uint64();break;case 4:r.account=e.string();break;case 5:r.ticket=e.string();break;default:e.skipType(7&i)}}return r},e}(),UserResp=$root.UserResp=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.seq=$util.Long?$util.Long.fromBits(0,0,!0):0,e.prototype.account="",e.prototype.code=0,e.encode=function(e,t){return t||(t=$Writer.create()),null!=e.seq&&Object.hasOwnProperty.call(e,"seq")&&t.uint32(8).uint64(e.seq),null!=e.account&&Object.hasOwnProperty.call(e,"account")&&t.uint32(18).string(e.account),null!=e.code&&Object.hasOwnProperty.call(e,"code")&&t.uint32(24).uint32(e.code),t},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new $root.UserResp;e.pos<n;){var i=e.uint32();switch(i>>>3){case 1:r.seq=e.uint64();break;case 2:r.account=e.string();break;case 3:r.code=e.uint32();break;default:e.skipType(7&i)}}return r},e}(),UserQuit=$root.UserQuit=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.encode=function(e,t){return t||(t=$Writer.create()),t},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new $root.UserQuit;e.pos<n;){var i=e.uint32();e.skipType(7&i)}return r},e}(),UserDrop=$root.UserDrop=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.code=0,e.encode=function(e,t){return t||(t=$Writer.create()),null!=e.code&&Object.hasOwnProperty.call(e,"code")&&t.uint32(8).uint32(e.code),t},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new $root.UserDrop;e.pos<n;){var i=e.uint32();switch(i>>>3){case 1:r.code=e.uint32();break;default:e.skipType(7&i)}}return r},e}(),GroupEnter=$root.GroupEnter=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.seq=$util.Long?$util.Long.fromBits(0,0,!0):0,e.prototype.account="",e.encode=function(e,t){return t||(t=$Writer.create()),null!=e.seq&&Object.hasOwnProperty.call(e,"seq")&&t.uint32(8).uint64(e.seq),null!=e.account&&Object.hasOwnProperty.call(e,"account")&&t.uint32(18).string(e.account),t},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new $root.GroupEnter;e.pos<n;){var i=e.uint32();switch(i>>>3){case 1:r.seq=e.uint64();break;case 2:r.account=e.string();break;default:e.skipType(7&i)}}return r},e}(),GroupLeave=$root.GroupLeave=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.account="",e.encode=function(e,t){return t||(t=$Writer.create()),null!=e.account&&Object.hasOwnProperty.call(e,"account")&&t.uint32(10).string(e.account),t},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new $root.GroupLeave;e.pos<n;){var i=e.uint32();switch(i>>>3){case 1:r.account=e.string();break;default:e.skipType(7&i)}}return r},e}(),GroupReply=$root.GroupReply=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.seq=$util.Long?$util.Long.fromBits(0,0,!0):0,e.prototype.account="",e.prototype.code=0,e.encode=function(e,t){return t||(t=$Writer.create()),null!=e.seq&&Object.hasOwnProperty.call(e,"seq")&&t.uint32(8).uint64(e.seq),null!=e.account&&Object.hasOwnProperty.call(e,"account")&&t.uint32(18).string(e.account),null!=e.code&&Object.hasOwnProperty.call(e,"code")&&t.uint32(24).uint32(e.code),t},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new $root.GroupReply;e.pos<n;){var i=e.uint32();switch(i>>>3){case 1:r.seq=e.uint64();break;case 2:r.account=e.string();break;case 3:r.code=e.uint32();break;default:e.skipType(7&i)}}return r},e}(),GroupLeaveNotice=$root.GroupLeaveNotice=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.seq=$util.Long?$util.Long.fromBits(0,0,!0):0,e.prototype.user="",e.prototype.group="",e.prototype.instance=$util.Long?$util.Long.fromBits(0,0,!0):0,e.prototype.size=0,e.encode=function(e,t){return t||(t=$Writer.create()),null!=e.seq&&Object.hasOwnProperty.call(e,"seq")&&t.uint32(8).uint64(e.seq),null!=e.user&&Object.hasOwnProperty.call(e,"user")&&t.uint32(18).string(e.user),null!=e.group&&Object.hasOwnProperty.call(e,"group")&&t.uint32(26).string(e.group),null!=e.instance&&Object.hasOwnProperty.call(e,"instance")&&t.uint32(32).uint64(e.instance),null!=e.size&&Object.hasOwnProperty.call(e,"size")&&t.uint32(40).uint32(e.size),t},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new $root.GroupLeaveNotice;e.pos<n;){var i=e.uint32();switch(i>>>3){case 1:r.seq=e.uint64();break;case 2:r.user=e.string();break;case 3:r.group=e.string();break;case 4:r.instance=e.uint64();break;case 5:r.size=e.uint32();break;default:e.skipType(7&i)}}return r},e}(),GroupEnterNotice=$root.GroupEnterNotice=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.seq=$util.Long?$util.Long.fromBits(0,0,!0):0,e.prototype.user="",e.prototype.group="",e.prototype.instance=$util.Long?$util.Long.fromBits(0,0,!0):0,e.prototype.size=0,e.encode=function(e,t){return t||(t=$Writer.create()),null!=e.seq&&Object.hasOwnProperty.call(e,"seq")&&t.uint32(8).uint64(e.seq),null!=e.user&&Object.hasOwnProperty.call(e,"user")&&t.uint32(18).string(e.user),null!=e.group&&Object.hasOwnProperty.call(e,"group")&&t.uint32(26).string(e.group),null!=e.instance&&Object.hasOwnProperty.call(e,"instance")&&t.uint32(32).uint64(e.instance),null!=e.size&&Object.hasOwnProperty.call(e,"size")&&t.uint32(40).uint32(e.size),t},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new $root.GroupEnterNotice;e.pos<n;){var i=e.uint32();switch(i>>>3){case 1:r.seq=e.uint64();break;case 2:r.user=e.string();break;case 3:r.group=e.string();break;case 4:r.instance=e.uint64();break;case 5:r.size=e.uint32();break;default:e.skipType(7&i)}}return r},e}(),Message=$root.Message=function(){function e(e){if(this.MiscMap={},e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.instance=$util.Long?$util.Long.fromBits(0,0,!0):0,e.prototype.dialogue=$util.Long?$util.Long.fromBits(0,0,!0):0,e.prototype.sequence=$util.Long?$util.Long.fromBits(0,0,!0):0,e.prototype.options=$util.Long?$util.Long.fromBits(0,0,!0):0,e.prototype.src="",e.prototype.dst="",e.prototype.payload=$util.newBuffer([]),e.prototype.MiscMap=$util.emptyObject,e.prototype.ms=$util.Long?$util.Long.fromBits(0,0,!0):0,e.encode=function(e,t){if(t||(t=$Writer.create()),null!=e.instance&&Object.hasOwnProperty.call(e,"instance")&&t.uint32(8).uint64(e.instance),null!=e.dialogue&&Object.hasOwnProperty.call(e,"dialogue")&&t.uint32(16).uint64(e.dialogue),null!=e.sequence&&Object.hasOwnProperty.call(e,"sequence")&&t.uint32(24).uint64(e.sequence),null!=e.options&&Object.hasOwnProperty.call(e,"options")&&t.uint32(32).uint64(e.options),null!=e.src&&Object.hasOwnProperty.call(e,"src")&&t.uint32(42).string(e.src),null!=e.dst&&Object.hasOwnProperty.call(e,"dst")&&t.uint32(50).string(e.dst),null!=e.payload&&Object.hasOwnProperty.call(e,"payload")&&t.uint32(58).bytes(e.payload),null!=e.MiscMap&&Object.hasOwnProperty.call(e,"MiscMap"))for(var n=Object.keys(e.MiscMap),r=0;r<n.length;++r)t.uint32(66).fork().uint32(10).string(n[r]).uint32(18).bytes(e.MiscMap[n[r]]).ldelim();return null!=e.ms&&Object.hasOwnProperty.call(e,"ms")&&t.uint32(72).uint64(e.ms),t},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var n,r,i=void 0===t?e.len:e.pos+t,o=new $root.Message;e.pos<i;){var a=e.uint32();switch(a>>>3){case 1:o.instance=e.uint64();break;case 2:o.dialogue=e.uint64();break;case 3:o.sequence=e.uint64();break;case 4:o.options=e.uint64();break;case 5:o.src=e.string();break;case 6:o.dst=e.string();break;case 7:o.payload=e.bytes();break;case 8:o.MiscMap===$util.emptyObject&&(o.MiscMap={});var s=e.uint32()+e.pos;for(n="",r=[];e.pos<s;){var c=e.uint32();switch(c>>>3){case 1:n=e.string();break;case 2:r=e.bytes();break;default:e.skipType(7&c)}}o.MiscMap[n]=r;break;case 9:o.ms=e.uint64();break;default:e.skipType(7&a)}}return o},e}(),Ack=$root.Ack=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.instance=$util.Long?$util.Long.fromBits(0,0,!0):0,e.prototype.dialogue=$util.Long?$util.Long.fromBits(0,0,!0):0,e.prototype.sequence=$util.Long?$util.Long.fromBits(0,0,!0):0,e.prototype.code=0,e.encode=function(e,t){return t||(t=$Writer.create()),null!=e.instance&&Object.hasOwnProperty.call(e,"instance")&&t.uint32(8).uint64(e.instance),null!=e.dialogue&&Object.hasOwnProperty.call(e,"dialogue")&&t.uint32(16).uint64(e.dialogue),null!=e.sequence&&Object.hasOwnProperty.call(e,"sequence")&&t.uint32(24).uint64(e.sequence),null!=e.code&&Object.hasOwnProperty.call(e,"code")&&t.uint32(32).uint32(e.code),t},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new $root.Ack;e.pos<n;){var i=e.uint32();switch(i>>>3){case 1:r.instance=e.uint64();break;case 2:r.dialogue=e.uint64();break;case 3:r.sequence=e.uint64();break;case 4:r.code=e.uint32();break;default:e.skipType(7&i)}}return r},e}(),GroupAllUsersList=$root.GroupAllUsersList=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.seq=$util.Long?$util.Long.fromBits(0,0,!0):0,e.prototype.group="",e.prototype.pageSize=0,e.prototype.pageNumber=0,e.encode=function(e,t){return t||(t=$Writer.create()),null!=e.seq&&Object.hasOwnProperty.call(e,"seq")&&t.uint32(8).uint64(e.seq),null!=e.group&&Object.hasOwnProperty.call(e,"group")&&t.uint32(18).string(e.group),null!=e.pageSize&&Object.hasOwnProperty.call(e,"pageSize")&&t.uint32(24).uint32(e.pageSize),null!=e.pageNumber&&Object.hasOwnProperty.call(e,"pageNumber")&&t.uint32(32).uint32(e.pageNumber),t},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new $root.GroupAllUsersList;e.pos<n;){var i=e.uint32();switch(i>>>3){case 1:r.seq=e.uint64();break;case 2:r.group=e.string();break;case 3:r.pageSize=e.uint32();break;case 4:r.pageNumber=e.uint32();break;default:e.skipType(7&i)}}return r},e}(),GroupAllUsersResult=$root.GroupAllUsersResult=function(){function e(e){if(this.memberInfos=[],e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.seq=$util.Long?$util.Long.fromBits(0,0,!0):0,e.prototype.group="",e.prototype.totalSize=0,e.prototype.pageSize=0,e.prototype.pageNumber=0,e.prototype.memberInfos=$util.emptyArray,e.encode=function(e,t){if(t||(t=$Writer.create()),null!=e.seq&&Object.hasOwnProperty.call(e,"seq")&&t.uint32(8).uint64(e.seq),null!=e.group&&Object.hasOwnProperty.call(e,"group")&&t.uint32(18).string(e.group),null!=e.totalSize&&Object.hasOwnProperty.call(e,"totalSize")&&t.uint32(24).uint32(e.totalSize),null!=e.pageSize&&Object.hasOwnProperty.call(e,"pageSize")&&t.uint32(32).uint32(e.pageSize),null!=e.pageNumber&&Object.hasOwnProperty.call(e,"pageNumber")&&t.uint32(40).uint32(e.pageNumber),null!=e.memberInfos&&e.memberInfos.length)for(var n=0;n<e.memberInfos.length;++n)$root.GroupAllUsersResult.MemberInfo.encode(e.memberInfos[n],t.uint32(50).fork()).ldelim();return t},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new $root.GroupAllUsersResult;e.pos<n;){var i=e.uint32();switch(i>>>3){case 1:r.seq=e.uint64();break;case 2:r.group=e.string();break;case 3:r.totalSize=e.uint32();break;case 4:r.pageSize=e.uint32();break;case 5:r.pageNumber=e.uint32();break;case 6:r.memberInfos&&r.memberInfos.length||(r.memberInfos=[]),r.memberInfos.push($root.GroupAllUsersResult.MemberInfo.decode(e,e.uint32()));break;default:e.skipType(7&i)}}return r},e.MemberInfo=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.account="",e.prototype.ts=0,e.encode=function(e,t){return t||(t=$Writer.create()),null!=e.account&&Object.hasOwnProperty.call(e,"account")&&t.uint32(10).string(e.account),null!=e.ts&&Object.hasOwnProperty.call(e,"ts")&&t.uint32(16).uint32(e.ts),t},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new $root.GroupAllUsersResult.MemberInfo;e.pos<n;){var i=e.uint32();switch(i>>>3){case 1:r.account=e.string();break;case 2:r.ts=e.uint32();break;default:e.skipType(7&i)}}return r},e}(),e}(),GroupAttributeGet=$root.GroupAttributeGet=function(){function e(e){if(this.attributes=[],e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.seq=$util.Long?$util.Long.fromBits(0,0,!0):0,e.prototype.group="",e.prototype.attributes=$util.emptyArray,e.encode=function(e,t){if(t||(t=$Writer.create()),null!=e.seq&&Object.hasOwnProperty.call(e,"seq")&&t.uint32(8).uint64(e.seq),null!=e.group&&Object.hasOwnProperty.call(e,"group")&&t.uint32(18).string(e.group),null!=e.attributes&&e.attributes.length)for(var n=0;n<e.attributes.length;++n)t.uint32(26).string(e.attributes[n]);return t},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new $root.GroupAttributeGet;e.pos<n;){var i=e.uint32();switch(i>>>3){case 1:r.seq=e.uint64();break;case 2:r.group=e.string();break;case 3:r.attributes&&r.attributes.length||(r.attributes=[]),r.attributes.push(e.string());break;default:e.skipType(7&i)}}return r},e}(),GroupAttributeRet=$root.GroupAttributeRet=function(){function e(e){if(this.attributeMaps=[],e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.seq=$util.Long?$util.Long.fromBits(0,0,!0):0,e.prototype.attributeMaps=$util.emptyArray,e.encode=function(e,t){if(t||(t=$Writer.create()),null!=e.seq&&Object.hasOwnProperty.call(e,"seq")&&t.uint32(8).uint64(e.seq),null!=e.attributeMaps&&e.attributeMaps.length)for(var n=0;n<e.attributeMaps.length;++n)$root.GroupAttributeRet.AttributeMap.encode(e.attributeMaps[n],t.uint32(18).fork()).ldelim();return t},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new $root.GroupAttributeRet;e.pos<n;){var i=e.uint32();switch(i>>>3){case 1:r.seq=e.uint64();break;case 2:r.attributeMaps&&r.attributeMaps.length||(r.attributeMaps=[]),r.attributeMaps.push($root.GroupAttributeRet.AttributeMap.decode(e,e.uint32()));break;default:e.skipType(7&i)}}return r},e.AttributeMap=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.key="",e.prototype.value="",e.prototype.origin="",e.prototype.ms=$util.Long?$util.Long.fromBits(0,0,!0):0,e.encode=function(e,t){return t||(t=$Writer.create()),null!=e.key&&Object.hasOwnProperty.call(e,"key")&&t.uint32(10).string(e.key),null!=e.value&&Object.hasOwnProperty.call(e,"value")&&t.uint32(18).string(e.value),null!=e.origin&&Object.hasOwnProperty.call(e,"origin")&&t.uint32(26).string(e.origin),null!=e.ms&&Object.hasOwnProperty.call(e,"ms")&&t.uint32(32).uint64(e.ms),t},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new $root.GroupAttributeRet.AttributeMap;e.pos<n;){var i=e.uint32();switch(i>>>3){case 1:r.key=e.string();break;case 2:r.value=e.string();break;case 3:r.origin=e.string();break;case 4:r.ms=e.uint64();break;default:e.skipType(7&i)}}return r},e}(),e}(),GroupAttributeSet=$root.GroupAttributeSet=function(){function e(e){if(this.attributeInfos=[],e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.seq=$util.Long?$util.Long.fromBits(0,0,!0):0,e.prototype.group="",e.prototype.broadcast=!1,e.prototype.attributeInfos=$util.emptyArray,e.encode=function(e,t){if(t||(t=$Writer.create()),null!=e.seq&&Object.hasOwnProperty.call(e,"seq")&&t.uint32(8).uint64(e.seq),null!=e.group&&Object.hasOwnProperty.call(e,"group")&&t.uint32(18).string(e.group),null!=e.broadcast&&Object.hasOwnProperty.call(e,"broadcast")&&t.uint32(24).bool(e.broadcast),null!=e.attributeInfos&&e.attributeInfos.length)for(var n=0;n<e.attributeInfos.length;++n)$root.GroupAttributeSet.AttributeInfo.encode(e.attributeInfos[n],t.uint32(34).fork()).ldelim();return t},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new $root.GroupAttributeSet;e.pos<n;){var i=e.uint32();switch(i>>>3){case 1:r.seq=e.uint64();break;case 2:r.group=e.string();break;case 3:r.broadcast=e.bool();break;case 4:r.attributeInfos&&r.attributeInfos.length||(r.attributeInfos=[]),r.attributeInfos.push($root.GroupAttributeSet.AttributeInfo.decode(e,e.uint32()));break;default:e.skipType(7&i)}}return r},e.AttributeInfo=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.key="",e.prototype.value="",e.encode=function(e,t){return t||(t=$Writer.create()),null!=e.key&&Object.hasOwnProperty.call(e,"key")&&t.uint32(10).string(e.key),null!=e.value&&Object.hasOwnProperty.call(e,"value")&&t.uint32(18).string(e.value),t},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new $root.GroupAttributeSet.AttributeInfo;e.pos<n;){var i=e.uint32();switch(i>>>3){case 1:r.key=e.string();break;case 2:r.value=e.string();break;default:e.skipType(7&i)}}return r},e}(),e}(),GroupAttributeMod=$root.GroupAttributeMod=function(){function e(e){if(this.attributeInfos=[],e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.seq=$util.Long?$util.Long.fromBits(0,0,!0):0,e.prototype.group="",e.prototype.broadcast=!1,e.prototype.attributeInfos=$util.emptyArray,e.encode=function(e,t){if(t||(t=$Writer.create()),null!=e.seq&&Object.hasOwnProperty.call(e,"seq")&&t.uint32(8).uint64(e.seq),null!=e.group&&Object.hasOwnProperty.call(e,"group")&&t.uint32(18).string(e.group),null!=e.broadcast&&Object.hasOwnProperty.call(e,"broadcast")&&t.uint32(24).bool(e.broadcast),null!=e.attributeInfos&&e.attributeInfos.length)for(var n=0;n<e.attributeInfos.length;++n)$root.GroupAttributeMod.AttributeInfo.encode(e.attributeInfos[n],t.uint32(34).fork()).ldelim();return t},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new $root.GroupAttributeMod;e.pos<n;){var i=e.uint32();switch(i>>>3){case 1:r.seq=e.uint64();break;case 2:r.group=e.string();break;case 3:r.broadcast=e.bool();break;case 4:r.attributeInfos&&r.attributeInfos.length||(r.attributeInfos=[]),r.attributeInfos.push($root.GroupAttributeMod.AttributeInfo.decode(e,e.uint32()));break;default:e.skipType(7&i)}}return r},e.AttributeInfo=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.key="",e.prototype.value="",e.encode=function(e,t){return t||(t=$Writer.create()),null!=e.key&&Object.hasOwnProperty.call(e,"key")&&t.uint32(10).string(e.key),null!=e.value&&Object.hasOwnProperty.call(e,"value")&&t.uint32(18).string(e.value),t},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new $root.GroupAttributeMod.AttributeInfo;e.pos<n;){var i=e.uint32();switch(i>>>3){case 1:r.key=e.string();break;case 2:r.value=e.string();break;default:e.skipType(7&i)}}return r},e}(),e}(),GroupAttributeDel=$root.GroupAttributeDel=function(){function e(e){if(this.attributes=[],e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.seq=$util.Long?$util.Long.fromBits(0,0,!0):0,e.prototype.group="",e.prototype.broadcast=!1,e.prototype.attributes=$util.emptyArray,e.encode=function(e,t){if(t||(t=$Writer.create()),null!=e.seq&&Object.hasOwnProperty.call(e,"seq")&&t.uint32(8).uint64(e.seq),null!=e.group&&Object.hasOwnProperty.call(e,"group")&&t.uint32(18).string(e.group),null!=e.broadcast&&Object.hasOwnProperty.call(e,"broadcast")&&t.uint32(24).bool(e.broadcast),null!=e.attributes&&e.attributes.length)for(var n=0;n<e.attributes.length;++n)t.uint32(34).string(e.attributes[n]);return t},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new $root.GroupAttributeDel;e.pos<n;){var i=e.uint32();switch(i>>>3){case 1:r.seq=e.uint64();break;case 2:r.group=e.string();break;case 3:r.broadcast=e.bool();break;case 4:r.attributes&&r.attributes.length||(r.attributes=[]),r.attributes.push(e.string());break;default:e.skipType(7&i)}}return r},e}(),GroupAttributeAlt=$root.GroupAttributeAlt=function(){function e(e){if(this.attributeMaps=[],e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.seq=$util.Long?$util.Long.fromBits(0,0,!0):0,e.prototype.group="",e.prototype.instance=$util.Long?$util.Long.fromBits(0,0,!0):0,e.prototype.attributeMaps=$util.emptyArray,e.encode=function(e,t){if(t||(t=$Writer.create()),null!=e.seq&&Object.hasOwnProperty.call(e,"seq")&&t.uint32(8).uint64(e.seq),null!=e.group&&Object.hasOwnProperty.call(e,"group")&&t.uint32(18).string(e.group),null!=e.instance&&Object.hasOwnProperty.call(e,"instance")&&t.uint32(24).uint64(e.instance),null!=e.attributeMaps&&e.attributeMaps.length)for(var n=0;n<e.attributeMaps.length;++n)$root.GroupAttributeAlt.AttributeMap.encode(e.attributeMaps[n],t.uint32(34).fork()).ldelim();return t},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new $root.GroupAttributeAlt;e.pos<n;){var i=e.uint32();switch(i>>>3){case 1:r.seq=e.uint64();break;case 2:r.group=e.string();break;case 3:r.instance=e.uint64();break;case 4:r.attributeMaps&&r.attributeMaps.length||(r.attributeMaps=[]),r.attributeMaps.push($root.GroupAttributeAlt.AttributeMap.decode(e,e.uint32()));break;default:e.skipType(7&i)}}return r},e.AttributeMap=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.key="",e.prototype.value="",e.prototype.origin="",e.prototype.ms=$util.Long?$util.Long.fromBits(0,0,!0):0,e.encode=function(e,t){return t||(t=$Writer.create()),null!=e.key&&Object.hasOwnProperty.call(e,"key")&&t.uint32(10).string(e.key),null!=e.value&&Object.hasOwnProperty.call(e,"value")&&t.uint32(18).string(e.value),null!=e.origin&&Object.hasOwnProperty.call(e,"origin")&&t.uint32(26).string(e.origin),null!=e.ms&&Object.hasOwnProperty.call(e,"ms")&&t.uint32(32).uint64(e.ms),t},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new $root.GroupAttributeAlt.AttributeMap;e.pos<n;){var i=e.uint32();switch(i>>>3){case 1:r.key=e.string();break;case 2:r.value=e.string();break;case 3:r.origin=e.string();break;case 4:r.ms=e.uint64();break;default:e.skipType(7&i)}}return r},e}(),e}(),GroupAttributeRsp=$root.GroupAttributeRsp=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.seq=$util.Long?$util.Long.fromBits(0,0,!0):0,e.encode=function(e,t){return t||(t=$Writer.create()),null!=e.seq&&Object.hasOwnProperty.call(e,"seq")&&t.uint32(8).uint64(e.seq),t},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new $root.GroupAttributeRsp;e.pos<n;){var i=e.uint32();switch(i>>>3){case 1:r.seq=e.uint64();break;default:e.skipType(7&i)}}return r},e}(),GroupAttributeErr=$root.GroupAttributeErr=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.seq=$util.Long?$util.Long.fromBits(0,0,!0):0,e.prototype.code=0,e.encode=function(e,t){return t||(t=$Writer.create()),null!=e.seq&&Object.hasOwnProperty.call(e,"seq")&&t.uint32(8).uint64(e.seq),null!=e.code&&Object.hasOwnProperty.call(e,"code")&&t.uint32(16).uint32(e.code),t},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new $root.GroupAttributeErr;e.pos<n;){var i=e.uint32();switch(i>>>3){case 1:r.seq=e.uint64();break;case 2:r.code=e.uint32();break;default:e.skipType(7&i)}}return r},e}(),GroupAttributeKeysGet=$root.GroupAttributeKeysGet=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.seq=$util.Long?$util.Long.fromBits(0,0,!0):0,e.prototype.group="",e.encode=function(e,t){return t||(t=$Writer.create()),null!=e.seq&&Object.hasOwnProperty.call(e,"seq")&&t.uint32(8).uint64(e.seq),null!=e.group&&Object.hasOwnProperty.call(e,"group")&&t.uint32(18).string(e.group),t},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new $root.GroupAttributeKeysGet;e.pos<n;){var i=e.uint32();switch(i>>>3){case 1:r.seq=e.uint64();break;case 2:r.group=e.string();break;default:e.skipType(7&i)}}return r},e}(),GroupAttributeKeysRet=$root.GroupAttributeKeysRet=function(){function e(e){if(this.keys=[],e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.seq=$util.Long?$util.Long.fromBits(0,0,!0):0,e.prototype.keys=$util.emptyArray,e.encode=function(e,t){if(t||(t=$Writer.create()),null!=e.seq&&Object.hasOwnProperty.call(e,"seq")&&t.uint32(8).uint64(e.seq),null!=e.keys&&e.keys.length)for(var n=0;n<e.keys.length;++n)t.uint32(18).string(e.keys[n]);return t},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new $root.GroupAttributeKeysRet;e.pos<n;){var i=e.uint32();switch(i>>>3){case 1:r.seq=e.uint64();break;case 2:r.keys&&r.keys.length||(r.keys=[]),r.keys.push(e.string());break;default:e.skipType(7&i)}}return r},e}(),ProtoPackets=Object.freeze({__proto__:null,URI:URI,Wrapper:Wrapper,Ping:Ping,Pong:Pong,UserJoin:UserJoin,UserResp:UserResp,UserQuit:UserQuit,UserDrop:UserDrop,GroupEnter:GroupEnter,GroupLeave:GroupLeave,GroupReply:GroupReply,GroupLeaveNotice:GroupLeaveNotice,GroupEnterNotice:GroupEnterNotice,Message:Message,Ack:Ack,GroupAllUsersList:GroupAllUsersList,GroupAllUsersResult:GroupAllUsersResult,GroupAttributeGet:GroupAttributeGet,GroupAttributeRet:GroupAttributeRet,GroupAttributeSet:GroupAttributeSet,GroupAttributeMod:GroupAttributeMod,GroupAttributeDel:GroupAttributeDel,GroupAttributeAlt:GroupAttributeAlt,GroupAttributeRsp:GroupAttributeRsp,GroupAttributeErr:GroupAttributeErr,GroupAttributeKeysGet:GroupAttributeKeysGet,GroupAttributeKeysRet:GroupAttributeKeysRet,default:$root}),defaultProtocols=[],defaultWebsocketFactory=function(e,t){return wx.connectSocket({url:e,protocols:t})},normalClosureMessage="Normal closure";function makeWebSocketObservable(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{protocols:defaultProtocols,makeWebSocket:defaultWebsocketFactory},n=t.protocols,r=void 0===n?defaultProtocols:n,i=t.makeWebSocket,o=void 0===i?defaultWebsocketFactory:i;return new Observable((function(t){var n,i=new Subject,a=o(e,r),s=!1,c=!1,u=function(){s=!0},l=function(e){if(n){u();var r=new Error("Web socket message factory function called more than once");throw t.error(r),r}return n=e.subscribe((function(e){try{a.send({data:e,fail:function(){}})}catch(e){}})),i};return a.onOpen((function(){c?(s=!0,a.close({})):t.next(l)})),a.onMessage((function(e){var t=e.data;i.next(t)})),a.onError((function(e){u(),t.error(new Error(e.errMsg))})),a.onClose((function(e){s||(u(),c?(t.complete(),i.complete()):t.error(new Error(1e3===e.code?normalClosureMessage:e.reason)))})),function(){c=!0,n&&n.unsubscribe(),s||(u(),a.close({}))}}))}var log=Math.log,LN2=Math.LN2,clz32=Math.clz32||function(e){return 31-log(e>>>0)/LN2|0},fromCharCode=String.fromCharCode,Object_prototype_toString={}.toString,NativeUint8Array=Uint8Array,patchedU8Array=NativeUint8Array||Array,ArrayBufferString=Object_prototype_toString.call((ArrayBuffer||patchedU8Array).prototype);function decoderReplacer(e){var t=e.charCodeAt(0)<<24,n=0|clz32(~t),r=0,i=0|e.length,o="";if(n<5&&i>=n){for(t=t<<n>>>24+n,r=1;r<n;r=r+1|0)t=t<<6|63&e.charCodeAt(r);t<=65535?o+=fromCharCode(t):t<=1114111?o+=fromCharCode(55296+((t=t-65536|0)>>10)|0,56320+(1023&t)|0):r=0}for(;r<i;r=r+1|0)o+="�";return o}function TextDecoder(){}function encoderReplacer(e){var t=0|e.charCodeAt(0);if(t>=55296&&t<=56319){var n=0|e.charCodeAt(1);if(n!=n)return fromCharCode(239,191,189);if(!(n>=56320&&n<=57343))return fromCharCode(239,191,189);if((t=(t-55296<<10)+n-56320+65536|0)>65535)return fromCharCode(240|t>>>18,128|t>>>12&63,128|t>>>6&63,128|63&t)}return t<=127?e:t<=2047?fromCharCode(192|t>>>6,128|63&t):fromCharCode(224|t>>>12,128|t>>>6&63,128|63&t)}function TextEncoder(){}TextDecoder.prototype.decode=function(e){var t=e&&e.buffer||e;if(Object_prototype_toString.call(t)!==ArrayBufferString)throw Error("Failed to execute 'decode' on 'TextDecoder': The provided value is not of type '(ArrayBuffer or ArrayBufferView)'");for(var n=NativeUint8Array?new patchedU8Array(t):t,r="",i=0,o=0|n.length;i<o;i=i+32768|0)r+=fromCharCode.apply(0,n[NativeUint8Array?"slice":"subarray"](i,i+32768|0));return r.replace(/[\xc0-\xff][\x80-\xbf]*/g,decoderReplacer)},TextEncoder.prototype.encode=function(e){for(var t=void 0===e?"":(""+e).replace(/[\x80-\uD7ff\uDC00-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]?/g,encoderReplacer),n=0|t.length,r=new patchedU8Array(n),i=0;i<n;i=i+1|0)r[i]=t.charCodeAt(i);return r};var util=createCommonjsModule((function(e,t){function n(e,t){var n=v.styles[t];return n?"["+v.colors[n][0]+"m"+e+"["+v.colors[n][1]+"m":e}function r(e){return void 0===e}function i(e){return"string"==typeof e}function o(e){return"boolean"==typeof e}function a(e){return b(e)&&("[object Error]"===c(e)||e instanceof Error)}function s(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function c(e){return Object.prototype.toString.call(e)}function u(e,t,n,i,o,a){var c,u,l;if((l=Object.getOwnPropertyDescriptor(t,o)||{value:t[o]}).get?u=l.set?e.stylize("[Getter/Setter]","special"):e.stylize("[Getter]","special"):l.set&&(u=e.stylize("[Setter]","special")),s(i,o)||(c="["+o+"]"),u||(e.seen.indexOf(l.value)<0?(u=g(n)?p(e,l.value,null):p(e,l.value,n-1)).indexOf("\n")>-1&&(u=a?u.split("\n").map((function(e){return"  "+e})).join("\n").substr(2):"\n"+u.split("\n").map((function(e){return"   "+e})).join("\n")):u=e.stylize("[Circular]","special")),r(c)){if(a&&o.match(/^\d+$/))return u;(c=JSON.stringify(""+o)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(c=c.substr(1,c.length-2),c=e.stylize(c,"name")):(c=c.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),c=e.stylize(c,"string"))}return c+": "+u}function l(e){return"function"==typeof e}function d(e){return"["+Error.prototype.toString.call(e)+"]"}function f(e){return b(e)&&"[object RegExp]"===c(e)}function h(e){return b(e)&&"[object Date]"===c(e)}function p(e,n,c){if(e.customInspect&&n&&l(n.inspect)&&n.inspect!==t.inspect&&(!n.constructor||n.constructor.prototype!==n)){var _=n.inspect(c,e);return i(_)||(_=p(e,_,c)),_}var v=function(e,t){if(r(t))return e.stylize("undefined","undefined");if(i(t)){var n="'"+JSON.stringify(t).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return e.stylize(n,"string")}return"number"==typeof t?e.stylize(""+t,"number"):o(t)?e.stylize(""+t,"boolean"):g(t)?e.stylize("null","null"):void 0}(e,n);if(v)return v;var b=Object.keys(n),m=function(e){var t={};return e.forEach((function(e,n){t[e]=!0})),t}(b);if(e.showHidden&&(b=Object.getOwnPropertyNames(n)),a(n)&&(b.indexOf("message")>=0||b.indexOf("description")>=0))return d(n);if(0===b.length){if(l(n)){var y=n.name?": "+n.name:"";return e.stylize("[Function"+y+"]","special")}if(f(n))return e.stylize(RegExp.prototype.toString.call(n),"regexp");if(h(n))return e.stylize(Date.prototype.toString.call(n),"date");if(a(n))return d(n)}var E,w,T="",R=!1,S=["{","}"];return E=n,Array.isArray(E)&&(R=!0,S=["[","]"]),l(n)&&(T=" [Function"+(n.name?": "+n.name:"")+"]"),f(n)&&(T=" "+RegExp.prototype.toString.call(n)),h(n)&&(T=" "+Date.prototype.toUTCString.call(n)),a(n)&&(T=" "+d(n)),0!==b.length||R&&0!=n.length?c<0?f(n)?e.stylize(RegExp.prototype.toString.call(n),"regexp"):e.stylize("[Object]","special"):(e.seen.push(n),w=R?function(e,t,n,r,i){for(var o=[],a=0,c=t.length;a<c;++a)s(t,String(a))?o.push(u(e,t,n,r,String(a),!0)):o.push("");return i.forEach((function(i){i.match(/^\d+$/)||o.push(u(e,t,n,r,i,!0))})),o}(e,n,c,m,b):b.map((function(t){return u(e,n,c,m,t,R)})),e.seen.pop(),function(e,t,n){return e.reduce((function(e,t){return t.indexOf("\n"),e+t.replace(/\u001b\[\d\d?m/g,"").length+1}),0)>60?n[0]+(""===t?"":t+"\n ")+" "+e.join(",\n  ")+" "+n[1]:n[0]+t+" "+e.join(", ")+" "+n[1]}(w,T,S)):S[0]+T+S[1]}function _(e,t){return e}function v(e,i){var a={seen:[],stylize:_};return arguments.length>=3&&(a.depth=arguments[2]),arguments.length>=4&&(a.colors=arguments[3]),o(i)?a.showHidden=i:i&&t._extend(a,i),r(a.showHidden)&&(a.showHidden=!1),r(a.depth)&&(a.depth=2),r(a.colors)&&(a.colors=!1),r(a.customInspect)&&(a.customInspect=!0),a.colors&&(a.stylize=n),p(a,e,a.depth)}function g(e){return null===e}function b(e){return"object"==typeof e&&null!==e}t._extend=function(e,t){if(!t||!b(t))return e;for(var n=Object.keys(t),r=n.length;r--;)e[n[r]]=t[n[r]];return e},v.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},v.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"};var m=/%[sdj%]/g;t.format=function(e){if(!i(e)){for(var t=[],n=0;n<arguments.length;n++)t.push(v(arguments[n]));return t.join(" ")}n=1;for(var r=arguments,o=r.length,a=String(e).replace(m,(function(e){if("%%"===e)return"%";if(n>=o)return e;switch(e){case"%s":return String(r[n++]);case"%d":return Number(r[n++]);case"%j":try{return JSON.stringify(r[n++])}catch(e){return"[Circular]"}default:return e}})),s=r[n];n<o;s=r[++n])g(s)||!b(s)?a+=" "+s:a+=" "+v(s);return a},t.inspect=v}));function genErrorMessage(e,t){var n,r="number"==typeof t?t:void 0!==t&&"string"!=typeof t?t.code:void 0,i="number"!=typeof t&&"string"!=typeof t&&void 0!==t&&void 0!==t.serverCode?t.serverCode:void 0,o="".concat(void 0!==r?" Error Code ".concat(r):"").concat(void 0!==i?", server Code ".concat(i):"");return n="string"==typeof e&&e?addPeriodIfNeeded(e):Array.isArray(e)&&"string"==typeof e[0]&&e[0]?addPeriodIfNeeded(util.format.apply(util,[e[0]].concat(_toConsumableArray(e.slice(1))))):"","".concat(""===o?"":"".concat(o," - ")).concat(n)}var RtmBaseError=function(e){"use strict";_inherits(n,e);var t=_createSuper(n);function n(e,r){var i;return _classCallCheck(this,n),i=t.call(this,genErrorMessage(e,r)),i.originalError=void 0,i.code=void 0,i.serverCode=void 0,"number"==typeof r?i.code=r:"string"==typeof r?i.name=r:void 0!==r&&(r.originalError&&(i.originalError=r.originalError),void 0!==r.code&&(i.code=r.code),void 0!==r.serverCode&&(i.serverCode=r.serverCode)),i}return n}(_wrapNativeSuper(Error)),RtmInternalError=function(e){"use strict";_inherits(n,e);var t=_createSuper(n);function n(e,r){var i;return _classCallCheck(this,n),i=t.call(this,genErrorMessage(e,r)),i.code=r,i.name="RtmInternalError",i}return n}(_wrapNativeSuper(Error)),genError=function(){return function(e){"use strict";_inherits(n,e);var t=_createSuper(n);function n(e){_classCallCheck(this,n);var r=Object.keys(e);return t.call(this,e[r[0]],r[0])}return n}(RtmInternalError)},CommonError=genError(),RtmTimeoutError=function(e){"use strict";_inherits(n,e);var t=_createSuper(n);function n(){var e;_classCallCheck(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return e=t.call.apply(t,[this].concat(i)),e.name="RtmTimeoutError",e}return n}(RtmBaseError),RtmInvalidArgumentError=function(e){"use strict";_inherits(n,e);var t=_createSuper(n);function n(){var e;_classCallCheck(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return e=t.call.apply(t,[this].concat(i)),e.name="RtmInvalidArgumentError",e}return n}(RtmBaseError),RtmInvalidStatusError=function(e){"use strict";_inherits(n,e);var t=_createSuper(n);function n(){var e;_classCallCheck(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return e=t.call.apply(t,[this].concat(i)),e.name="RtmInvalidStatusError",e}return n}(RtmBaseError),RtmLimitExceededError=function(e){"use strict";_inherits(n,e);var t=_createSuper(n);function n(){var e;_classCallCheck(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return e=t.call.apply(t,[this].concat(i)),e.name="RtmLimitExceededError",e}return n}(RtmBaseError),RtmInvokeTooOftenError=function(e){"use strict";_inherits(n,e);var t=_createSuper(n);function n(){var e;_classCallCheck(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return e=t.call.apply(t,[this].concat(i)),e.name="RtmInvokeTooOftenError",e}return n}(RtmBaseError),RtmUnavailableError=function(e){"use strict";_inherits(n,e);var t=_createSuper(n);function n(){var e;_classCallCheck(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return e=t.call.apply(t,[this].concat(i)),e.name="RtmUnavailableError",e.serverCode=void 0,e.statusCode=void 0,e}return n}(RtmBaseError),RtmUnauthenticatedError=function(e){"use strict";_inherits(n,e);var t=_createSuper(n);function n(){var e;_classCallCheck(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return e=t.call.apply(t,[this].concat(i)),e.name="RtmUnauthenticatedError",e.serverCode=void 0,e}return n}(RtmBaseError),RtmUnknownError=function(e){"use strict";_inherits(n,e);var t=_createSuper(n);function n(){var e;_classCallCheck(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return e=t.call.apply(t,[this].concat(i)),e.name="RtmUnknownError",e}return n}(RtmBaseError),isTimeout=function(e){return e instanceof RtmTimeoutError||e instanceof TimeoutError},isRtmError=function(e){return e instanceof RtmBaseError},invalidArgumentMessage="The %s in the arguments is invalid",genTimeoutMessage=function(e,t,n){return['Executing "%s.%s" timed out after %ds',e,t,n/1e3]},APP_ID_LENGTH=32,AP_REQUEST_TIMEOUT=1e4,SOCKET_KEEPALIVE_TIMEOUT=6e3,KEEPALIVE_INTERVAL=2e3,SOCKET_RETRY_INTERVAL=2e3,CLIENT_LOGIN_TIMEOUT=12e3,LOGIN_RESP_TIMEOUT=6e3,MESSAGE_MIN_COMPRESSION_LEN=128,MESSAGE_SEND_TIMEOUT=1e4,COMMON_REQUEST_TIMEOUT=1e4,DIALOGUE_EXPIRE_TIMEOUT=1e4,LRU_MAX_ITEMS=1e4,MESSAGE_RETRY_TIMEOUT=6e3,LOGOUT_SOCKET_CLOSE_TIMEOUT=5e3,LOGIN_QPS_LIMIT=2,TEXT_MESSAGE_MAX_TEXT_BYTES=32768,ONLINE_MESSAGE_DEDUP_DELAY=750,OFFLINE_MESSAGE_DEDUP_DELAY=1500,MSG_DEDUP_MAX_LEN=200,LOG_UPLOAD_MAX_ITEMS=40,MAX_JOINED_CHANNELS=20,INVITATION_EXPIRE_TIMEOUT=6e4,INVITATION_EXTRA_MAX_BYTES=8192,REMOTE_INVITATION_WAIT_ACCEPT_ACK_TIMEOUT=5e3,REMOTE_INVITATION_ACCEPT_RESEND_INTERVAL=1e3,LOCAL_INVITATION_ACK_TIMEOUT=3e4,LOCAL_INVITATION_RESEND_INTERVAL=2e3,CHANNEL_ATTRIBUTES_MAX_KEY_COUNT=512,CHANNEL_ATTRIBUTES_CACHE_MAX_LENGTH=1e4;function isValidAppId(e){return/^[\dA-Za-z]{32}$/.test(e)}function isValidId(e){return"string"==typeof e&&/^[\s\w!#$%&()+,.:;<=>?@[\]^{|}~-]{1,64}$/.test(e)&&"null"!==e}function isValidIp(e){var t;try{t=e.split(".").map((function(e){return Number(e)}))}catch(o){return!1}if(4!==t.length)return!1;if(0===t[0])return!1;var n,r=_createForOfIteratorHelper(t);try{for(r.s();!(n=r.n()).done;){var i=n.value;if(!Number.isInteger(i))return!1;if(i<0||i>255)return!1}}catch(err){r.e(err)}finally{r.f()}return!0}function validAttributes(e){var t=e.attributes,n=e.attrSizeMap,r=e.maxAttrsCount,i=e.maxAttrValueSize,o=e.maxTotalSize;if(!isPlainObject(t))throw new RtmInvalidArgumentError("attributes must be an object",ATTRIBUTE_OPERATION_ERR_INVALID_ARGUMENT);if(Object.keys(t).length>r)throw new RtmLimitExceededError("Exceed the limit of ".concat(r," attributes"),ATTRIBUTE_OPERATION_ERR_SIZE_OVERFLOW);if(0===Object.keys(t).length)throw new RtmInvalidArgumentError("The attributes is an empty object",ATTRIBUTE_OPERATION_ERR_INVALID_ARGUMENT);for(var a=0,s=0,c=Object.entries(t);s<c.length;s++){var u=_slicedToArray(c[s],2),l=u[0],d=u[1],f=getUtf8StringSize(l),h=getUtf8StringSize(d);if(0===f||f>32)throw new RtmInvalidArgumentError("Invalid attribute key",ATTRIBUTE_OPERATION_ERR_INVALID_ARGUMENT);if(h>i)throw new RtmLimitExceededError("Invalid attribute value, over the limit of ".concat(i," bytes"),ATTRIBUTE_OPERATION_ERR_SIZE_OVERFLOW);if("string"!=typeof d||0===d.length)throw new RtmInvalidArgumentError("Invalid attribute value",ATTRIBUTE_OPERATION_ERR_INVALID_ARGUMENT);a+=f,a+=h}if(a>o)throw new RtmLimitExceededError("The attributes size overflow",ATTRIBUTE_OPERATION_ERR_SIZE_OVERFLOW);if(void 0!==n){if(Object.keys(n).length>r)throw new RtmLimitExceededError("Exceed the limit of ".concat(r," attributes"),ATTRIBUTE_OPERATION_ERR_SIZE_OVERFLOW);for(var p=0,_=0,v=Object.entries(n);_<v.length;_++){var g=_slicedToArray(v[_],2),b=g[0],m=g[1],y=getUtf8StringSize(b);if(0===y)throw new RtmInvalidArgumentError("Invalid attribute key",ATTRIBUTE_OPERATION_ERR_INVALID_ARGUMENT);if(m>i)throw new RtmLimitExceededError("Invalid attribute value, over the limit of ".concat(i," bytes"),ATTRIBUTE_OPERATION_ERR_SIZE_OVERFLOW);p+=y,p+=m}if(p>o)throw new RtmLimitExceededError("The attributes size overflow",ATTRIBUTE_OPERATION_ERR_SIZE_OVERFLOW)}}function checkValidAttrGetByKeysArgs(e,t){if(!Array.isArray(t)||0===t.length||t.length>32||t.some((function(e){return 0===e.length||e.length>32})))throw new RtmInvalidArgumentError("arguments is not valid",ATTRIBUTE_OPERATION_ERR_INVALID_ARGUMENT);if(!isValidId(e))throw new RtmInvalidArgumentError("ID is invalid",ATTRIBUTE_OPERATION_ERR_INVALID_ARGUMENT)}var UINT32_MAX=4294967295;function getRandomInt(e,t){var n=Math.ceil(e),r=Math.floor(t);return Math.floor(Math.random()*(r-n+1))+e}function getRandomUInt64(){var e=getRandomInt(0,UINT32_MAX),t=getRandomInt(1,UINT32_MAX);return new long_1(e,t,!0)}function getSid(e){return e.toString().padEnd(32,"0")}function assertNever(e,t){return new TypeError("Unexpected ".concat(e,": ").concat(t))}function calIpDistance(e,t){var n=e.split(".").map((function(e){return Number(e)})),r=t.split(".").map((function(e){return Number(e)}));return Math.sqrt(1e3*Math.pow(n[0]-r[0],2)+100*Math.pow(n[1]-r[1],2)+10*Math.pow(n[2]-r[2],2)+1*Math.pow(n[3]-r[3],2))}function longToStringIfNeeded(e){return e.lessThanOrEqual(Number.MAX_SAFE_INTEGER)?e.toNumber():e.toString()}var prefixSeqMap=new Map;function uniquePrefixedId(e,t){var n="".concat(e).concat(t||""),r=prefixSeqMap.get(n)||1;return prefixSeqMap.set(n,r+1),"".concat(e).concat(r)}var getUTCTimestamp=function(){var e=new Date;return"".concat(e.toISOString().split("T")[1].replace(/\..+/,""),".").concat(e.getMilliseconds())},getKeys=Object.keys,getEntries=Object.entries.bind(Object);function isLongNum(e){return"number"==typeof e||long_1.isLong(e)}var getName=function(e){return Object.keys(e)[0]},addPeriodIfNeeded=function(e){return"string"==typeof e?e.endsWith(".")?e:"".concat(e,"."):e};function postWithAbortSignal(e,t){var n=t.body,r=t.headers,i=void 0===r?{}:r,o=t.timeout,a=void 0===o?1e4:o,s=t.signal;return new Promise((function(t,r){var o=wx.request({url:e,header:i,data:n,timeout:a,method:"POST",success:function(e){var n=e.data,i=e.statusCode;if(i>=200&&i<300||304===i){if(n instanceof ArrayBuffer)return void r(new TypeError("Invalid response type ArrayBuffer"));if("string"==typeof n)return void r(new TypeError("Invalid response type string"));t({response:n})}else{var o=new RtmUnavailableError(["Post XHR failure, status %d",i]);o.statusCode=i,o.message=n.toString()||"Request failed, status ".concat(i),r(o)}},fail:function(e){var t=new RtmUnavailableError(["Post failure"]);t.message=e.errMsg,r(t)}});if(void 0!==s){var c=function e(){o.abort();var t=new Error("The request aborted.");t.name="AbortError",r(t),s.removeEventListener("abort",e)};s.addEventListener("abort",c)}}))}function validMessage(e,t){if(!isPlainObject(e))throw new RtmInvalidArgumentError("message object is not a plain object",t);if("string"!=typeof e.text)throw new RtmInvalidArgumentError("Unsupported message type",t)}function commonSendMessage(e){return _commonSendMessage.apply(this,arguments)}function _commonSendMessage(){return _commonSendMessage=_asyncToGenerator(regeneratorRuntime.mark((function e(t){var n,r,i,o,a,s,c,u,l,d,f,h,p,_,v,g,b,m,y,E,w;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(n=t.message,r=t.peerId,i=t.toPeer,o=t.session,a=t.errorCodes,s=t.diff,c=t.options,void 0!==o){e.next=3;break}throw new RtmInvalidStatusError("The client is not logged in. Cannot do the operation",a.NOT_LOGGED_IN);case 3:if(u=!1,"TEXT"!==n.messageType||!n.text.startsWith(END_CALL_PREFIX)||!i){e.next=9;break}if(l=n.text.split("_"),d=_slicedToArray(l,3),f=d[0],h=d[1],p=d[2],void 0!==p&&isValidId(h)&&f===END_CALL_PREFIX){e.next=8;break}throw new RtmInvalidArgumentError("Message is not valid",PEER_MESSAGE_ERR_INVALID_MESSAGE);case 8:u=!0;case 9:if("string"==typeof n.text){e.next=11;break}throw new RtmInvalidArgumentError("Invalid message type",PEER_MESSAGE_ERR_INVALID_MESSAGE);case 11:if(_=Date.now(),v=o.messageSentTimes.length-1,g=o.messageSentTimes[v],!(g&&g+3e3<_)){e.next=16;break}o.messageSentTimes=[_],e.next=27;break;case 16:b=v;case 17:if(!(b>=0)){e.next=26;break}if(!(o.messageSentTimes[b]+3e3<_)){e.next=21;break}return o.messageSentTimes=o.messageSentTimes.slice(b+1,v+1),e.abrupt("break",26);case 21:if(!(v-b+1>=180)){e.next=23;break}throw new RtmLimitExceededError("Message sent failed, exceeded the 180 message in 3 seconds",a.TOO_OFTEN);case 23:b--,e.next=17;break;case 26:o.messageSentTimes.push(_);case 27:if(!u){e.next=30;break}return m=n.text.split("_"),y=_slicedToArray(m,3),E=y[1],w=y[2],e.abrupt("return",o.sendInvitationMessage({peerId:r,type:"CallCancel",extra:w,channelId:E,callId:"0"}));case 30:return e.abrupt("return",o.sendTextMessage(n.text,r,i,c,MESSAGE_SEND_TIMEOUT-s));case 31:case"end":return e.stop()}}),e)}))),_commonSendMessage.apply(this,arguments)}function uint8ArrayToArrayBuffer(e){return e.buffer.slice(e.byteOffset,e.byteOffset+e.byteLength)}function decodeUint8ArrayToString(e){return(new TextDecoder).decode(e.buffer.slice(e.byteOffset,e.byteOffset+e.byteLength))}function encodeStringToUint8Array(e){return(new TextEncoder).encode(e)}function getUtf8StringSize(e){return(new TextEncoder).encode(e).length}var isProd=!0,s=1e3,m=60*s,h=60*m,d=24*h,w=7*d,y=365.25*d,ms=function(e,t){t=t||{};var n=typeof e;if("string"===n&&e.length>0)return parse(e);if("number"===n&&isFinite(e))return t.long?fmtLong(e):fmtShort(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))};function parse(e){if(!((e=String(e)).length>100)){var t=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(e);if(t){var n=parseFloat(t[1]);switch((t[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return n*y;case"weeks":case"week":case"w":return n*w;case"days":case"day":case"d":return n*d;case"hours":case"hour":case"hrs":case"hr":case"h":return n*h;case"minutes":case"minute":case"mins":case"min":case"m":return n*m;case"seconds":case"second":case"secs":case"sec":case"s":return n*s;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return n;default:return}}}}function fmtShort(e){var t=Math.abs(e);return t>=d?Math.round(e/d)+"d":t>=h?Math.round(e/h)+"h":t>=m?Math.round(e/m)+"m":t>=s?Math.round(e/s)+"s":e+"ms"}function fmtLong(e){var t=Math.abs(e);return t>=d?plural(e,t,d,"day"):t>=h?plural(e,t,h,"hour"):t>=m?plural(e,t,m,"minute"):t>=s?plural(e,t,s,"second"):e+" ms"}function plural(e,t,n,r){var i=t>=1.5*n;return Math.round(e/n)+" "+r+(i?"s":"")}function setup(e){function t(e){var r,i=null;function o(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];if(o.enabled){var a=o,s=Number(new Date),c=s-(r||s);a.diff=c,a.prev=r,a.curr=s,r=s,n[0]=t.coerce(n[0]),"string"!=typeof n[0]&&n.unshift("%O");var u=0;n[0]=n[0].replace(/%([a-zA-Z%])/g,(function(e,r){if("%%"===e)return"%";u++;var i=t.formatters[r];if("function"==typeof i){var o=n[u];e=i.call(a,o),n.splice(u,1),u--}return e})),t.formatArgs.call(a,n),(a.log||t.log).apply(a,n)}}return o.namespace=e,o.useColors=t.useColors(),o.color=t.selectColor(e),o.extend=n,o.destroy=t.destroy,Object.defineProperty(o,"enabled",{enumerable:!0,configurable:!1,get:function(){return null===i?t.enabled(e):i},set:function(e){i=e}}),"function"==typeof t.init&&t.init(o),o}function n(e,n){var r=t(this.namespace+(void 0===n?":":n)+e);return r.log=this.log,r}function r(e){return e.toString().substring(2,e.toString().length-2).replace(/\.\*\?$/,"*")}return t.debug=t,t.default=t,t.coerce=function(e){return e instanceof Error?e.stack||e.message:e},t.disable=function(){var e=[].concat(_toConsumableArray(t.names.map(r)),_toConsumableArray(t.skips.map(r).map((function(e){return"-"+e})))).join(",");return t.enable(""),e},t.enable=function(e){var n;t.save(e),t.names=[],t.skips=[];var r=("string"==typeof e?e:"").split(/[\s,]+/),i=r.length;for(n=0;n<i;n++)r[n]&&("-"===(e=r[n].replace(/\*/g,".*?"))[0]?t.skips.push(new RegExp("^"+e.substr(1)+"$")):t.names.push(new RegExp("^"+e+"$")))},t.enabled=function(e){if("*"===e[e.length-1])return!0;var n,r;for(n=0,r=t.skips.length;n<r;n++)if(t.skips[n].test(e))return!1;for(n=0,r=t.names.length;n<r;n++)if(t.names[n].test(e))return!0;return!1},t.humanize=ms,t.destroy=function(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")},Object.keys(e).forEach((function(n){t[n]=e[n]})),t.names=[],t.skips=[],t.formatters={},t.selectColor=function(e){for(var n=0,r=0;r<e.length;r++)n=(n<<5)-n+e.charCodeAt(r),n|=0;return t.colors[Math.abs(n)%t.colors.length]},t.enable(t.load()),t}var common=setup,browser=createCommonjsModule((function(e,t){t.formatArgs=function(t){if(t[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+t[0]+(this.useColors?"%c ":" ")+"+"+e.exports.humanize(this.diff),this.useColors){var n="color: "+this.color;t.splice(1,0,n,"color: inherit");var r=0,i=0;t[0].replace(/%[a-zA-Z%]/g,(function(e){"%%"!==e&&(r++,"%c"===e&&(i=r))})),t.splice(i,0,n)}},t.save=function(e){try{e?t.storage.setItem("debug",e):t.storage.removeItem("debug")}catch(e){}},t.load=function(){var e;try{e=t.storage.getItem("debug")}catch(e){}return!e&&"undefined"!=typeof process&&"env"in process&&(e=Object({VUE_APP_INDEX_CSS_HASH:"a5c69d49",VUE_APP_NAME:"三勾门店",VUE_APP_PLATFORM:"h5",NODE_ENV:"production",BASE_URL:"/h5/"}).DEBUG),e},t.useColors=function(){return!("undefined"==typeof window||!window.process||"renderer"!==window.process.type&&!window.process.__nwjs)||("undefined"==typeof navigator||!navigator.userAgent||!navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))&&("undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/))},t.storage=function(){try{return localStorage}catch(e){}}(),t.destroy=function(){var e=!1;return function(){e||(e=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}}(),t.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],t.log=console.debug||console.log||function(){},e.exports=common(t);var n=e.exports.formatters;n.j=function(e){try{return JSON.stringify(e)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}}})),key="__global_unique_id__",gud=function(){return commonjsGlobal[key]=(commonjsGlobal[key]||0)+1};function arrayEach(e,t){for(var n=-1,r=null==e?0:e.length;++n<r&&!1!==t(e[n],n,e););return e}var _arrayEach=arrayEach;function baseAssign(e,t){return e&&_copyObject(t,keys_1(t),e)}var _baseAssign=baseAssign;function baseAssignIn(e,t){return e&&_copyObject(t,keysIn_1(t),e)}var _baseAssignIn=baseAssignIn;function copySymbols(e,t){return _copyObject(e,_getSymbols(e),t)}var _copySymbols=copySymbols,nativeGetSymbols$1=Object.getOwnPropertySymbols,getSymbolsIn=nativeGetSymbols$1?function(e){for(var t=[];e;)_arrayPush(t,_getSymbols(e)),e=_getPrototype(e);return t}:stubArray_1,_getSymbolsIn=getSymbolsIn;function copySymbolsIn(e,t){return _copyObject(e,_getSymbolsIn(e),t)}var _copySymbolsIn=copySymbolsIn;function getAllKeysIn(e){return _baseGetAllKeys(e,keysIn_1,_getSymbolsIn)}var _getAllKeysIn=getAllKeysIn,objectProto$f=Object.prototype,hasOwnProperty$c=objectProto$f.hasOwnProperty;function initCloneArray(e){var t=e.length,n=new e.constructor(t);return t&&"string"==typeof e[0]&&hasOwnProperty$c.call(e,"index")&&(n.index=e.index,n.input=e.input),n}var _initCloneArray=initCloneArray;function cloneDataView(e,t){var n=t?_cloneArrayBuffer(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.byteLength)}var _cloneDataView=cloneDataView,reFlags=/\w*$/;function cloneRegExp(e){var t=new e.constructor(e.source,reFlags.exec(e));return t.lastIndex=e.lastIndex,t}var _cloneRegExp=cloneRegExp,symbolProto$2=_Symbol?_Symbol.prototype:void 0,symbolValueOf$1=symbolProto$2?symbolProto$2.valueOf:void 0;function cloneSymbol(e){return symbolValueOf$1?Object(symbolValueOf$1.call(e)):{}}var _cloneSymbol=cloneSymbol,boolTag$2="[object Boolean]",dateTag$2="[object Date]",mapTag$3="[object Map]",numberTag$2="[object Number]",regexpTag$2="[object RegExp]",setTag$3="[object Set]",stringTag$2="[object String]",symbolTag$2="[object Symbol]",arrayBufferTag$2="[object ArrayBuffer]",dataViewTag$3="[object DataView]",float32Tag$1="[object Float32Array]",float64Tag$1="[object Float64Array]",int8Tag$1="[object Int8Array]",int16Tag$1="[object Int16Array]",int32Tag$1="[object Int32Array]",uint8Tag$1="[object Uint8Array]",uint8ClampedTag$1="[object Uint8ClampedArray]",uint16Tag$1="[object Uint16Array]",uint32Tag$1="[object Uint32Array]";function initCloneByTag(e,t,n){var r=e.constructor;switch(t){case arrayBufferTag$2:return _cloneArrayBuffer(e);case boolTag$2:case dateTag$2:return new r(+e);case dataViewTag$3:return _cloneDataView(e,n);case float32Tag$1:case float64Tag$1:case int8Tag$1:case int16Tag$1:case int32Tag$1:case uint8Tag$1:case uint8ClampedTag$1:case uint16Tag$1:case uint32Tag$1:return _cloneTypedArray(e,n);case mapTag$3:return new r;case numberTag$2:case stringTag$2:return new r(e);case regexpTag$2:return _cloneRegExp(e);case setTag$3:return new r;case symbolTag$2:return _cloneSymbol(e)}}var _initCloneByTag=initCloneByTag,mapTag$4="[object Map]";function baseIsMap(e){return isObjectLike_1(e)&&_getTag(e)==mapTag$4}var _baseIsMap=baseIsMap,isMap=_baseIsMap,isMap_1=isMap,setTag$4="[object Set]";function baseIsSet(e){return isObjectLike_1(e)&&_getTag(e)==setTag$4}var _baseIsSet=baseIsSet,isSet=_baseIsSet,isSet_1=isSet,CLONE_DEEP_FLAG=1,CLONE_FLAT_FLAG=2,CLONE_SYMBOLS_FLAG=4,argsTag$3="[object Arguments]",arrayTag$2="[object Array]",boolTag$3="[object Boolean]",dateTag$3="[object Date]",errorTag$2="[object Error]",funcTag$2="[object Function]",genTag$1="[object GeneratorFunction]",mapTag$5="[object Map]",numberTag$3="[object Number]",objectTag$4="[object Object]",regexpTag$3="[object RegExp]",setTag$5="[object Set]",stringTag$3="[object String]",symbolTag$3="[object Symbol]",weakMapTag$2="[object WeakMap]",arrayBufferTag$3="[object ArrayBuffer]",dataViewTag$4="[object DataView]",float32Tag$2="[object Float32Array]",float64Tag$2="[object Float64Array]",int8Tag$2="[object Int8Array]",int16Tag$2="[object Int16Array]",int32Tag$2="[object Int32Array]",uint8Tag$2="[object Uint8Array]",uint8ClampedTag$2="[object Uint8ClampedArray]",uint16Tag$2="[object Uint16Array]",uint32Tag$2="[object Uint32Array]",cloneableTags={};function baseClone(e,t,n,r,i,o){var a,s=t&CLONE_DEEP_FLAG,c=t&CLONE_FLAT_FLAG,u=t&CLONE_SYMBOLS_FLAG;if(n&&(a=i?n(e,r,i,o):n(e)),void 0!==a)return a;if(!isObject_1(e))return e;var l=isArray_1(e);if(l){if(a=_initCloneArray(e),!s)return _copyArray(e,a)}else{var d=_getTag(e),f=d==funcTag$2||d==genTag$1;if(isBuffer_1(e))return _cloneBuffer(e,s);if(d==objectTag$4||d==argsTag$3||f&&!i){if(a=c||f?{}:_initCloneObject(e),!s)return c?_copySymbolsIn(e,_baseAssignIn(a,e)):_copySymbols(e,_baseAssign(a,e))}else{if(!cloneableTags[d])return i?e:{};a=_initCloneByTag(e,d,s)}}o||(o=new _Stack);var h=o.get(e);if(h)return h;o.set(e,a),isSet_1(e)?e.forEach((function(r){a.add(baseClone(r,t,n,r,e,o))})):isMap_1(e)&&e.forEach((function(r,i){a.set(i,baseClone(r,t,n,i,e,o))}));var p=l?void 0:(u?c?_getAllKeysIn:_getAllKeys:c?keysIn_1:keys_1)(e);return _arrayEach(p||e,(function(r,i){p&&(r=e[i=r]),_assignValue(a,i,baseClone(r,t,n,i,e,o))})),a}cloneableTags[argsTag$3]=cloneableTags[arrayTag$2]=cloneableTags[arrayBufferTag$3]=cloneableTags[dataViewTag$4]=cloneableTags[boolTag$3]=cloneableTags[dateTag$3]=cloneableTags[float32Tag$2]=cloneableTags[float64Tag$2]=cloneableTags[int8Tag$2]=cloneableTags[int16Tag$2]=cloneableTags[int32Tag$2]=cloneableTags[mapTag$5]=cloneableTags[numberTag$3]=cloneableTags[objectTag$4]=cloneableTags[regexpTag$3]=cloneableTags[setTag$5]=cloneableTags[stringTag$3]=cloneableTags[symbolTag$3]=cloneableTags[uint8Tag$2]=cloneableTags[uint8ClampedTag$2]=cloneableTags[uint16Tag$2]=cloneableTags[uint32Tag$2]=!0,cloneableTags[errorTag$2]=cloneableTags[funcTag$2]=cloneableTags[weakMapTag$2]=!1;var _baseClone=baseClone;function last(e){var t=null==e?0:e.length;return t?e[t-1]:void 0}var last_1=last;function baseSlice(e,t,n){var r=-1,i=e.length;t<0&&(t=-t>i?0:i+t),(n=n>i?i:n)<0&&(n+=i),i=t>n?0:n-t>>>0,t>>>=0;for(var o=Array(i);++r<i;)o[r]=e[r+t];return o}var _baseSlice=baseSlice;function parent(e,t){return t.length<2?e:_baseGet(e,_baseSlice(t,0,-1))}var _parent=parent;function baseUnset(e,t){return t=_castPath(t,e),null==(e=_parent(e,t))||delete e[_toKey(last_1(t))]}var _baseUnset=baseUnset;function customOmitClone(e){return isPlainObject_1(e)?void 0:e}var _customOmitClone=customOmitClone;function flatten(e){return null!=e&&e.length?_baseFlatten(e,1):[]}var flatten_1=flatten;function flatRest(e){return _setToString(_overRest(e,void 0,flatten_1),e+"")}var _flatRest=flatRest,CLONE_DEEP_FLAG$1=1,CLONE_FLAT_FLAG$1=2,CLONE_SYMBOLS_FLAG$1=4,omit=_flatRest((function(e,t){var n={};if(null==e)return n;var r=!1;t=_arrayMap(t,(function(t){return t=_castPath(t,e),r||(r=t.length>1),t})),_copyObject(e,_getAllKeysIn(e),n),r&&(n=_baseClone(n,CLONE_DEEP_FLAG$1|CLONE_FLAT_FLAG$1|CLONE_SYMBOLS_FLAG$1,_customOmitClone));for(var i=t.length;i--;)_baseUnset(n,t[i]);return n})),omit_1=omit,hasProp=Object.prototype.hasOwnProperty;function throwsMessage(e){return"[Throws: "+(e?e.message:"?")+"]"}function safeGetValueFromPropertyOnObject(e,t){if(hasProp.call(e,t))try{return e[t]}catch(e){return throwsMessage(e)}return e[t]}function ensureProperties(e){var t=[];return function e(n){if(null===n||"object"!=typeof n)return n;if(-1!==t.indexOf(n))return"[Circular]";if(t.push(n),"function"==typeof n.toJSON)try{var r=e(n.toJSON());return t.pop(),r}catch(e){return throwsMessage(e)}if(Array.isArray(n)){var i=n.map(e);return t.pop(),i}var o=Object.keys(n).reduce((function(t,r){return t[r]=e(safeGetValueFromPropertyOnObject(n,r)),t}),{});return t.pop(),o}(e)}var safeJsonStringify=function(e,t,n){return JSON.stringify(ensureProperties(e),t,n)},ensureProperties_1=ensureProperties;safeJsonStringify.ensureProperties=ensureProperties_1;var uploadLog=browser("RTM:DEBUG"),UploadState;uploadLog.enabled=!isProd,function(e){e[e.Uploading=0]="Uploading",e[e.Free=1]="Free"}(UploadState||(UploadState={}));var LogUploader=function(){"use strict";function e(t){_classCallCheck(this,e),this.uploadRequest=void 0,this.uploadState=void 0,this.uploadResendCount=void 0,this.LogCache=void 0,this.LogsToPost=void 0,this.processId=void 0,this.sdkVersion=void 0,this.logId=void 0,this.processId=t.processId,this.sdkVersion=t.sdkVersion,this.uploadRequest=t.uploadRequest,this.uploadState=UploadState.Free,this.uploadResendCount=0,this.LogCache=[],this.LogsToPost=[],this.logId=0}return _createClass(e,[{key:"upload",value:function(e){this.LogCache.push(e),this.uploadState===UploadState.Free&&(this.LogsToPost=this.LogCache.length<LOG_UPLOAD_MAX_ITEMS?this.LogCache.splice(0,this.LogCache.length):this.LogCache.splice(0,LOG_UPLOAD_MAX_ITEMS),this.postLog(this.LogsToPost))}},{key:"postLog",value:function(e){var t=this;this.uploadState=UploadState.Uploading,setTimeout(_asyncToGenerator(regeneratorRuntime.mark((function n(){var r,i;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return r={sdk_version:t.sdkVersion,process_id:t.processId,payload:JSON.stringify(e)},n.prev=1,n.next=4,t.uploadRequest(r);case 4:n.next=10;break;case 6:return n.prev=6,n.t0=n["catch"](1),i=t.uploadResendCount++<2?200:1e4,n.abrupt("return",void setTimeout((function(){return t.postLog(t.LogsToPost)}),i));case 10:uploadLog('The logs uploaded for "process-'.concat(processId,'"')),0!==t.LogCache.length?(t.uploadResendCount=0,t.LogsToPost=t.LogCache.length<LOG_UPLOAD_MAX_ITEMS?t.LogCache.splice(0,t.LogCache.length):t.LogCache.splice(0,LOG_UPLOAD_MAX_ITEMS),t.postLog(t.LogsToPost)):t.uploadState=UploadState.Free;case 11:case"end":return n.stop()}}),n,null,[[1,6]])}))),3e3)}}]),e}(),uploadRequest=function(e){var t=0,n=function(){var r=_asyncToGenerator(regeneratorRuntime.mark((function r(){return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,postWithAbortSignal("https://logservice-rtm.agora.io/upload/v1",{body:e,timeout:1e4,headers:{"Content-Type":"application/json"}});case 3:r.next=12;break;case 5:if(r.prev=5,r.t0=r["catch"](0),t+=1,r.t1=t<=2,!r.t1){r.next=12;break}return r.next=12,n();case 12:case"end":return r.stop()}}),r,null,[[0,5]])})));return function(){return r.apply(this,arguments)}}();n()},logUploader=new LogUploader({processId:"process-".concat(processId),sdkVersion:"Agora_RTM_SDK_for_MINIAPP_".concat(BUILD),uploadRequest:uploadRequest}),blacklistedKeywords=["text","payload","rawMessage","thumbnail","token","detail","ticket","attributeInfos","attributeMaps","key","value"],filterLogObject=function(e){return omit_1(e,blacklistedKeywords)},getPlain=function(e){return"object"==typeof e?isPlainObject(e)?filterLogObject(e):e.constructor&&e.constructor.name:e},formatLogTextAndParameters=function(e,t){if(e instanceof Error)return e.message;if("string"!=typeof e)return JSON.stringify(filterLogObject(e));var n=t.map((function(e){return e instanceof Error?e.message:"object"==typeof e?safeJsonStringify(Array.isArray(e)?e.map(getPlain):getPlain(e)):e}));return util.format.apply(util,[e.replace(/%[%Oo]/g,(function(e){return"%%"===e?"%":"%o"===e||"%O"===e?"%s":e}))].concat(_toConsumableArray(n)))},logItemId=1,logAndUploadGenerator=function(e,t,n){var r=browser(e);return r.enabled=!0,r.log=n,r.useColors=!1,function(n){for(var i=arguments.length,o=new Array(i>1?i-1:0),a=1;a<i;a++)o[a-1]=arguments[a];if(t.enableLogUpload){var s=addPeriodIfNeeded(n),c=formatLogTextAndParameters(s,o);logUploader.upload({log_item_id:""+logItemId++,log_level:e,payload_str:"[".concat(getUTCTimestamp(),"] ").concat(e," - ").concat(c.length>256?c.slice(0,256):c)})}var u=function(){var e=c||formatLogTextAndParameters(addPeriodIfNeeded(n),o);r(e)};switch(e){case"RTM:INFO":t.logFilter.info&&u();break;case"RTM:WARN":t.logFilter.warn&&u();break;case"RTM:ERROR":t.logFilter.error&&u();break;case"RTM:TRACK":t.logFilter.track&&u();break;case"RTM:MSG:RECV":case"RTM:MSG:SEND":case"RTM:DEBUG":t.logFilter.debug&&u()}}},loggerId,prefixer=function(e){return function(t){return"".concat(1===loggerId||void 0===e?"":"Ins#".concat(e," ")).concat(t)}},loggerGenerator=function(e,t,n){var r=prefixer(loggerId);return logAndUploadGenerator("RTM:".concat(t),n,(function(t){return e(r(t))}))},createEventBase=function(){return function(e){"use strict";_inherits(n,e);var t=_createSuper(n);function n(e,r){var i,o=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(_classCallCheck(this,n),i=t.call(this),i.logger=e,i.name=r,i.logError=void 0,i.invokeTracker=void 0,i.resultTracker=void 0,i.errorTracker=void 0,i.eventTracker=void 0,i.info=void 0,i.warn=void 0,i.log=void 0,i.genLogger=void 0,i.loggerId=void 0,i.loggerId=e.loggerId,i.info=e.info,i.warn=e.warn,i.logError=e.logError,i.genLogger=e.genLogger,i.log=e.genLogger("RTM:DEBUG","<".concat(r,"> ")),i.invokeTracker=e.genTracker("Invoke"),i.eventTracker=e.genTracker("Event"),i.resultTracker=e.genTracker("Result"),i.errorTracker=e.genTracker("Error"),o){var a=i.emit.bind(_assertThisInitialized(i)),s=function(){for(var t,n=arguments.length,o=new Array(n),s=0;s<n;s++)o[s]=arguments[s];var c=o[0],u=o.slice(1);(t=i).eventTracker.apply(t,["%s: "+(u.length>0?"%s emitted with args: ".concat(u.map((function(){return"%o"}))):"%s emitted"),r,c].concat(_toConsumableArray(u)));try{a.apply(void 0,o)}catch(e){i.logError("Caught in the callback function of the event %s, original error %o",c,e)}};i.emit=s}return _possibleConstructorReturn(i)}return n}(events.EventEmitter)};function initLoggerId(){return loggerId=gud(),loggerId}var genInfoLogger=function(e){return loggerGenerator(console.log,"INFO",e)},genWarnLogger=function(e){return loggerGenerator(console.warn,"WARN",e)},genErrorLogger=function(e){return loggerGenerator(console.error,"ERROR",e)},debugLoggerGenerator=function(e,t){return function(n){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",i=prefixer(e),o=console.debug,a=logAndUploadGenerator(n,t,(function(e){return o(i(e))}));return function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];return a.apply(void 0,[r+e].concat(n))}}},trackLoggerGenerator=function(e,t){return function(n){return debugLoggerGenerator(e,t)("RTM:TRACK","[".concat(n,"] "))}};function logged(e,t,n){var r=n;void 0===r&&(r=Object.getOwnPropertyDescriptor(e,t));var i=r.value;return r.value=function(){for(var e=this,n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];this.invokeTracker.apply(this,["%s: "+(r.length>0?"%s with args: ".concat(r.map((function(){return"%o"}))):"%s"),this.name,t].concat(r));try{var a=i.apply(this,r)}catch(a){throw this.logError.apply(this,["".concat(void 0!==a.code?"Error Code ".concat(a.code,": "):"","%s failed").concat(r.length>0?" with args: ".concat(r.map((function(){return"%o"}))):""),t].concat(r)),a.originalError&&this.logError(a.originalError),this.errorTracker(a),a}var s=Date.now();return _asyncToGenerator(regeneratorRuntime.mark((function n(){var i;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,a;case 3:i=n.sent,n.next=9;break;case 6:return n.prev=6,n.t0=n["catch"](0),n.abrupt("return",(e.logError.apply(e,["".concat(void 0!==n.t0.code?"Error Code ".concat(n.t0.code,": "):"","%s failed").concat(r.length>0?" with args: ".concat(r.map((function(){return"%o"}))):""),t].concat(r)),n.t0.originalError&&e.logError(n.t0.originalError),void e.errorTracker(n.t0)));case 9:i!==a?void 0===i?e.resultTracker("%s promise resolves after %dms",t,Date.now()-s):e.resultTracker("%s promise resolves after %dms, result is %o",t,Date.now()-s,i):e.resultTracker("%s result is %o",t,i);case 10:case"end":return n.stop()}}),n,null,[[0,6]])})))(),a},r}var URI$1=$root.URI,Wrapper$1=ProtoPackets.Wrapper,PacketsAndURI=_objectWithoutProperties(ProtoPackets,["Wrapper"]),Packets=omit_1(PacketsAndURI,"URI"),nameToUri=function(e){var t=URI$1["".concat(e,"Uri")];if("number"!=typeof t||0===t)throw new TypeError("Got Unknown URI Name");return t};function uriToPacketName(e){return URI$1[e].slice(0,-3)}function getWrappedByName(e,t){var n=nameToUri(e),r=Packets[e],i=new r(t),o=r.encode(i).finish();return new Wrapper$1({uri:n,data:o})}var nativeFloor=Math.floor,nativeRandom=Math.random;function baseRandom(e,t){return e+nativeFloor(nativeRandom()*(t-e+1))}var _baseRandom=baseRandom;function shuffleSelf(e,t){var n=-1,r=e.length,i=r-1;for(t=void 0===t?r:t;++n<t;){var o=_baseRandom(n,i),a=e[o];e[o]=e[n],e[n]=a}return e.length=t,e}var _shuffleSelf=shuffleSelf;function arrayShuffle(e){return _shuffleSelf(_copyArray(e))}var _arrayShuffle=arrayShuffle;function baseValues(e,t){return _arrayMap(t,(function(t){return e[t]}))}var _baseValues=baseValues;function values(e){return null==e?[]:_baseValues(e,keys_1(e))}var values_1=values;function baseShuffle(e){return _shuffleSelf(values_1(e))}var _baseShuffle=baseShuffle;function shuffle(e){return(isArray_1(e)?_arrayShuffle:_baseShuffle)(e)}var shuffle_1=shuffle,EDGE_ENV_PORT={0:9590,1:9592},getApUrl=function(e){return"https://".concat(e,"/api/v1")},AP_DOMAINS_CN=["ap-web-1.agoraio.cn","ap-web-2.agoraio.cn"],AP_BACKUP_DOMAINS_CN=["ap-web-3.agoraio.cn","ap-web-4.agoraio.cn"],cnUrl$=of.apply(void 0,_toConsumableArray(shuffle_1(AP_DOMAINS_CN.map(getApUrl)))),cnBackupUrl$=of.apply(void 0,_toConsumableArray(shuffle_1(AP_BACKUP_DOMAINS_CN.map(getApUrl)))),SocketError=genError(),Socket=function(e){"use strict";_inherits(n,e);var t=_createSuper(n);function n(e,r,i,o,a){var s;if(_classCallCheck(this,n),s=t.call(this,a,uniquePrefixedId("Socket-",a.loggerId)),s.ip=e,s.env=r,s.ticket=i,s.context=o,s.isActiveClose=!1,s.loggedIn=!1,s.receivedPacket=new Subject,s.open$=void 0,s.input$=new Subject,s.userJoin$=new Subject,s.attemptsSinceLastError=0,s.message$=new Subject,s.socket$=void 0,s.toClose=new Subject,s.toReconnect=new Subject,s.sendLogger=s.genLogger("RTM:MSG:SEND"),s.receiveLogger=s.genLogger("RTM:MSG:RECV"),s.socketReconnector=function(e){var t=function(e){return s.attemptsSinceLastError+=1,s.warn("The %s of Env %d reconnecting %s",s.name,s.env,e.message),timer(SOCKET_RETRY_INTERVAL)};return e.pipe(catchError((function(e){return s.log("socket connection closed"),s.loggedIn=!1,s.attemptsSinceLastError>=2?(s.warn("socket connection failure"),s.emit("connectionFailure"),s.close(),throwError(e)):s.isActiveClose?EMPTY:(s.emit("reconnect"),throwError(e))})),retryWhen((function(e){return e.pipe(switchMap(t))})))},0!==r&&1!==r)throw new SocketError({ILLEGAL_RTM_ENV:"The env number is out of rtm env count"});if(!isValidIp(e))throw new SocketError({IP_NOT_VALID:"The ip from ap is not valid"});var c=EDGE_ENV_PORT[r];s.log("Opening websocket address %s for the Env %d",s.ip,s.env);var u=merge(s.input$,s.userJoin$.pipe(rateLimit(LOGIN_QPS_LIMIT)),s.message$).pipe(map$1((function(e){return uint8ArrayToArrayBuffer(Wrapper.encode(e).finish())})));return s.socket$=merge(makeWebSocketObservable("wss://miniapp.agoraio.cn/rtm/".concat(e.split(".").join("-"),"-").concat(c,"/"),{timeout:4e3}),s.toReconnect).pipe(map$1((function(e){if(e instanceof Error)throw s.warn("Env_%d: Force reconnect the socket",s.env),e;return e(u).pipe(map$1((function(e){return Wrapper.decode(new Uint8Array(e))})))})),s.socketReconnector),s.open$=s.socket$.pipe(tap((function(e){s.log("Websocket opened",s.name),e.subscribe((function(e){var t=e.data,n=e.uri,r=uriToPacketName(n),i=Packets[r].decode(t),o=mergeWith_1({},i,(function(e,t){return t instanceof long_1?longToStringIfNeeded(t):t})),a=!1;if(i instanceof GroupEnterNotice||i instanceof GroupLeaveNotice){var c=i.instance;c.lessThanOrEqual(UINT32_MAX)&&(a=!0)}if(i instanceof Message||i instanceof Ack){var u=i.instance,l=i.dialogue,d=i.sequence;(l.lessThanOrEqual(UINT32_MAX)||u.lessThanOrEqual(UINT32_MAX)||d.lessThan(1))&&(a=!0)}a?s.warn("Env_%d: Illegal %s, abandoned %o",s.env,r,o):("Pong"!==r&&s.receiveLogger("Env_%d: %s %o",s.env,r,o),s.receivedPacket.next([r,i]))}),(function(){}))})),mapTo(void 0),takeUntil(s.toClose),share()),_possibleConstructorReturn(s)}return _createClass(n,[{key:"address",get:function(){return"".concat(this.ip,":").concat(EDGE_ENV_PORT[this.env])}}]),_createClass(n,[{key:"sendPacket",value:function(e,t){if("Ping"!==e){var n=mapValues_1(t,(function(e){return e instanceof long_1?longToStringIfNeeded(e):e}));this.sendLogger("Env_%d: %s %o",this.env,e,n)}var r=getWrappedByName(e,t);"UserJoin"===e?this.userJoin$.next(r):"Message"===e?this.message$.next(r):this.input$.next(r)}},{key:"close",value:function(){this.isActiveClose=!0,this.loggedIn=!1,this.toClose.next()}},{key:"fromReceived",value:function(e){var t=this;return this.receivedPacket.pipe(tap((function(e){var n=_slicedToArray(e,2),r=n[0],i=n[1];"UserResp"===r&&(t.attemptsSinceLastError=0,t.loggedIn=!0),"UserDrop"===r&&t.emit("socketUserDrop",i)})),filter((function(t){var n=_slicedToArray(t,1),r=n[0];return r===e})),map$1((function(e){var t=_slicedToArray(e,2),n=t[1];return n})))}},{key:"forceReconnect",value:function(){this.toReconnect.next(new SocketError({FORCE_RECONNECTING:"Connection seems broken, try force reconnecting"}))}}]),n}(createEventBase()),cjsPonyfill=createCommonjsModule((function(e,t){function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function i(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}function o(e){return(o=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function a(e,t){return(a=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function s(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function c(e,t){return!t||"object"!=typeof t&&"function"!=typeof t?s(e):t}function u(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=o(e);if(t){var i=o(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return c(this,n)}}function l(e,t,n){return(l="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=o(e)););return e}(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(n):i.value}})(e,t,n||e)}Object.defineProperty(t,"__esModule",{value:!0});var d=function(){function e(){n(this,e),Object.defineProperty(this,"listeners",{value:{},writable:!0,configurable:!0})}return i(e,[{key:"addEventListener",value:function(e,t){e in this.listeners||(this.listeners[e]=[]),this.listeners[e].push(t)}},{key:"removeEventListener",value:function(e,t){if(e in this.listeners)for(var n=this.listeners[e],r=0,i=n.length;r<i;r++)if(n[r]===t)return void n.splice(r,1)}},{key:"dispatchEvent",value:function(e){var t=this;if(e.type in this.listeners){for(var n=function(n){setTimeout((function(){return n.call(t,e)}))},r=this.listeners[e.type],i=0,o=r.length;i<o;i++)n(r[i]);return!e.defaultPrevented}}}]),e}(),f=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&a(e,t)}(r,e);var t=u(r);function r(){var e;return n(this,r),(e=t.call(this)).listeners||d.call(s(e)),Object.defineProperty(s(e),"aborted",{value:!1,writable:!0,configurable:!0}),Object.defineProperty(s(e),"onabort",{value:null,writable:!0,configurable:!0}),e}return i(r,[{key:"toString",value:function(){return"[object AbortSignal]"}},{key:"dispatchEvent",value:function(e){"abort"===e.type&&(this.aborted=!0,"function"==typeof this.onabort&&this.onabort.call(this,e)),l(o(r.prototype),"dispatchEvent",this).call(this,e)}}]),r}(d),h=function(){function e(){n(this,e),Object.defineProperty(this,"signal",{value:new f,writable:!0,configurable:!0})}return i(e,[{key:"abort",value:function(){var e;try{e=new Event("abort")}catch(t){"undefined"!=typeof document?document.createEvent?(e=document.createEvent("Event")).initEvent("abort",!1,!1):(e=document.createEventObject()).type="abort":e={type:"abort",bubbles:!1,cancelable:!1}}this.signal.dispatchEvent(e)}},{key:"toString",value:function(){return"[object AbortController]"}}]),e}();"undefined"!=typeof Symbol&&Symbol.toStringTag&&(h.prototype[Symbol.toStringTag]="AbortController",f.prototype[Symbol.toStringTag]="AbortSignal"),t.AbortController=h,t.AbortSignal=f,t.abortableFetch=function(e){"function"==typeof e&&(e={fetch:e});var t=e,n=t.fetch,r=t.Request,i=void 0===r?n.Request:r,o=t.AbortController,a=t.__FORCE_INSTALL_ABORTCONTROLLER_POLYFILL,s=void 0!==a&&a;if(!function(e){return e.__FORCE_INSTALL_ABORTCONTROLLER_POLYFILL?(console.log("__FORCE_INSTALL_ABORTCONTROLLER_POLYFILL=true is set, will force install polyfill"),!0):"function"==typeof e.Request&&!e.Request.prototype.hasOwnProperty("signal")||!e.AbortController}({fetch:n,Request:i,AbortController:o,__FORCE_INSTALL_ABORTCONTROLLER_POLYFILL:s}))return{fetch:n,Request:c};var c=i;(c&&!c.prototype.hasOwnProperty("signal")||s)&&((c=function(e,t){var n;t&&t.signal&&(n=t.signal,delete t.signal);var r=new i(e,t);return n&&Object.defineProperty(r,"signal",{writable:!1,enumerable:!1,configurable:!0,value:n}),r}).prototype=i.prototype);var u=n;return{fetch:function(e,t){var n=c&&c.prototype.isPrototypeOf(e)?e.signal:t?t.signal:void 0;if(n){var r;try{r=new DOMException("Aborted","AbortError")}catch(e){(r=new Error("Aborted")).name="AbortError"}if(n.aborted)return Promise.reject(r);var i=new Promise((function(e,t){n.addEventListener("abort",(function(){return t(r)}),{once:!0})}));return t&&t.signal&&delete t.signal,Promise.race([i,u(e,t)])}return u(e,t)},Request:c}}})),ApResErrorMessage={INVALID_APP_ID:"Illegal App ID",NO_AUTHORIZED:"Signature verification failed",TOKEN_TIMEOUT:"Dynamic key expired",INVALID_TOKEN_UID:"UID in the security key(token) is not valid",APP_ID_NO_ACTIVATED:"The vendor is not activated",DYNAMIC_KEY_NOT_ENABLED:"The vendor did not enable the dynamic key, but uses the dynamic key",DYNAMIC_ENABLED_BUT_STATIC_KEY:"The vendor enabled the dynamic key, but uses the static key",TOKEN_EXPIRED:"The token has expired",INVALID_USER_ID:"The user ID to login does not match the token"},ApResErrorCode={5:"INVALID_APP_ID",7:"INVALID_USER_ID",9:"NO_AUTHORIZED",10:"TOKEN_TIMEOUT",11:"APP_ID_NO_ACTIVATED",12:"INVALID_TOKEN_UID",13:"TOKEN_EXPIRED",14:"DYNAMIC_KEY_NOT_ENABLED",15:"DYNAMIC_ENABLED_BUT_STATIC_KEY"},AccessPoint=function(e){"use strict";_inherits(n,e);var t=_createSuper(n);function n(e,r){var i;_classCallCheck(this,n),i=t.call(this,r,"AccessPoint"),i.context=e,i.apEdgeInfo$=void 0,i.apEdgeInfoEndFirst$=void 0,i.apFinish$=new Subject,i.fetchAp=function(e,t){var n=uniquePrefixedId("AP-",i.loggerId);i.log("The AccessPoint requests %s(%s)",e,n);var r=new cjsPonyfill.AbortController;return i.apFinish$.pipe(first()).subscribe((function(){return r.abort()})),defer((function(){var o=getRandomInt(0,Number.MAX_SAFE_INTEGER);return i.log("The %s request uid param is %d",n,o),postWithAbortSignal(e,{headers:{"X-Packet-Service-Type":"0","X-Packet-URI":"69","Content-Type":"application/json"},body:{flag:128,opid:1,key:t||i.context.key,cname:i.context.uid,detail:{},uid:o,sid:i.context.sid},signal:r.signal})})).pipe(catchError((function(t){return"AbortError"!==t.name&&(i.logError(t),i.warn("The AP server %s request failure",e)),EMPTY})),mergeMap(function(){var e=_asyncToGenerator(regeneratorRuntime.mark((function e(t){var r,o,a,s,c,u,l,d,f,h,p,_,v,g,b,m,y;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(r=t.response,o=r,i.log("The %s response is %o",n,o),a=o.code,s=o.addresses,c=o.detail[9],0===a){e.next=24;break}if(u=a,a.toString().length>4&&(l=a.toString().padStart(8,"0"),d=l.slice(0,4),201===parseInt(d,10)&&(u=parseInt(l.slice(4,8),10))),f=u.toString(),Object.keys(ApResErrorCode).includes(f)){e.next=11;break}return h=new RtmUnavailableError(["Login is rejected by the server. The response code is %d",a],LOGIN_ERR_REJECTED),e.abrupt("return",(h.serverCode=u,throwError(h)));case 11:p=ApResErrorCode[f],_=ApResErrorMessage[p],e.t0=p,e.next="INVALID_APP_ID"===e.t0||"APP_ID_NO_ACTIVATED"===e.t0?15:"INVALID_USER_ID"===e.t0?17:"TOKEN_EXPIRED"===e.t0||"TOKEN_TIMEOUT"===e.t0?19:"NO_AUTHORIZED"===e.t0||"INVALID_TOKEN_UID"===e.t0||"DYNAMIC_KEY_NOT_ENABLED"===e.t0||"DYNAMIC_ENABLED_BUT_STATIC_KEY"===e.t0?21:23;break;case 15:return v=new RtmUnauthenticatedError(_,LOGIN_ERR_INVALID_APP_ID),e.abrupt("return",(v.serverCode=a,throwError(v)));case 17:return g=new RtmUnauthenticatedError(_,LOGIN_ERR_INVALID_ARGUMENT),e.abrupt("return",(g.serverCode=a,throwError(g)));case 19:return b=new RtmUnauthenticatedError(_,LOGIN_ERR_TOKEN_EXPIRED),e.abrupt("return",(b.serverCode=a,throwError(b)));case 21:return m=new RtmUnauthenticatedError(_,LOGIN_ERR_INVALID_TOKEN),e.abrupt("return",(m.serverCode=a,throwError(m)));case 23:return e.abrupt("return",throwError(assertNever("ApResErrType",p)));case 24:return y=s,e.abrupt("return",(i.context.area=c,of.apply(void 0,_toConsumableArray(y).concat([queueScheduler]))));case 26:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),mergeAll())};var o=1;return i.apEdgeInfoEndFirst$=timer(0,2e3).pipe(take(1),takeUntil(i.apFinish$),map$1((function(){5===o&&(o=1);var e="https://ap-web-".concat(o,".agoraio.cn/api/v1");return o+=1,e})),mergeMap((function(e){return i.fetchAp(e)})),timeout(AP_REQUEST_TIMEOUT),catchError((function(e){return e instanceof TimeoutError&&i.warn("AP request timeout"),throwError(e)})),distinct((function(e){var t=e.ip;return t}))),i.apEdgeInfo$=timer(0,2e3).pipe(take(4),takeUntil(i.apFinish$),map$1((function(){5===o&&(o=1);var e="https://ap-web-".concat(o,".agoraio.cn/api/v1");return o+=1,e})),mergeMap((function(e){return i.fetchAp(e)})),timeout(AP_REQUEST_TIMEOUT),catchError((function(e){return e instanceof TimeoutError&&i.warn("AP request timeout"),throwError(e)})),distinct((function(e){var t=e.ip;return t}))),i}return n}(createEventBase()),ConnectionError=genError(),Connection=function(e){"use strict";_inherits(n,e);var t=_createSuper(n);function n(e,r){var i;_classCallCheck(this,n),i=t.call(this,r,"Connection"),i.context=e,i.logger=r,i.apClient=new AccessPoint(i.context,i.logger),i.lastOpenSockets=[new ReplaySubject(1),new ReplaySubject(1)],i.curOpenSockets=[void 0,void 0],i.ipIterator=0,i.firstEnv=Math.random()>=.5?1:0,i.firstSocketOpener=void 0,i.secondSocketOpener=void 0,i.firstOpenKeeperSubject=new Subject,i.secondOpenKeeperSubject=new Subject,i.edgeInfoReplayed=void 0,i.firstEnvOpenSocket=void 0,i.firstOpenKeeperSub=void 0,i.secondOpenKeeperSub=void 0,i.apClient.apFinish$.subscribe((function(){i.log("Ap client fetch finished")}));var o=[];i.edgeInfoReplayed=i.apClient.apEdgeInfo$.pipe(filter((function(e){return void 0!==e&&"string"==typeof e.ip&&"string"==typeof e.ticket})),throwIfEmpty((function(){return new ConnectionError({AP_NO_AVAILABLE_EDGE:"No available edge address to connect"})})),retryWhen((function(e){return e.pipe(tap((function(e){if(isRtmError(e))throw e})),delay(2e3),takeUntil(timer(7e3)))})),filter((function(e){return!some_1(o,e)})),tap((function(e){o.push(e),i.log("An edge info got %o",e)})),tap({error:function(e){i.emit("connectionInitFailure",e)}}),shareReplay()),i.firstEnvOpenSocket=i.edgeInfoReplayed.pipe(mergeMap((function(e){if(void 0===e)return throwError(new Error("Invalid edge info"));var t=e.ip,n=e.ticket,o=new Socket(t,i.firstEnv,n,i.context,r);return i.firstEnv=1===i.firstEnv?0:1,o.once("connectionFailure",(function(){return i.onSocketConnectionFailure(o)})),o.open$.pipe(mapTo(o))})),tap((function(e){i.log("The websocket of ENV_%d opened to %s:%d",e.env,e.ip,EDGE_ENV_PORT[e.env]),i.curOpenSockets[e.env]=e,i.lastOpenSockets[e.env].next(e),i.firstEnv=e.env,i.openSecondSocket(e.env,e.ip)})),take(1),share()),i.firstSocketOpener=i.firstEnvOpenSocket.pipe(mergeMap((function(e){return e.open$.pipe(tap((function(){i.log("The websocket of first ENV_%d re-opened to %s:%d",e.env,e.ip,EDGE_ENV_PORT[e.env]),i.curOpenSockets[e.env]=e,i.lastOpenSockets[e.env].next(e)})))})));var a=i.firstOpenKeeperSubject.pipe(switchAll());return i.firstOpenKeeperSub=a.subscribe({error:i.logError}),i}return _createClass(n,[{key:"initConnection",value:function(){this.firstOpenKeeperSubject.next(this.firstSocketOpener)}},{key:"closeSocket",value:function(e,t){if(![0,1].includes(e))throw new CommonError({INVALID_ENV:"The env argument is not 0 or 1"});var n;e===this.firstEnv?(n=this.firstOpenKeeperSub,this.firstOpenKeeperSub=void 0):(n=this.secondOpenKeeperSub,this.firstOpenKeeperSub=void 0);var r=this.curOpenSockets[e];this.curOpenSockets[e]=void 0,r&&(r.isActiveClose=!0,setTimeout((function(){r.close()}),t)),void 0!==n&&setTimeout((function(){var e;null===(e=n)||void 0===e||e.unsubscribe()}),t)}},{key:"waitClosing",value:function(e){var t=this;return e.isActiveClose=!0,e.open$.pipe(ignoreElements(),catchError((function(e){return"Normal closure"===e.message?EMPTY:throwError(e)})),timeout(LOGOUT_SOCKET_CLOSE_TIMEOUT),catchError((function(n){return n instanceof TimeoutError?(t.warn("Force closing the ENV_%d connection",e.env),EMPTY):throwError(n)})))}},{key:"onSocketConnectionFailure",value:function(e){var t=[0,1].filter((function(t){return t!==e.env}))[0],n=this.curOpenSockets[t];n&&n.loggedIn?this.reopenSocketWithApRequest(e.env):this.emit("socketsFailure")}},{key:"openSecondSocket",value:function(e,t){var n=this,r=1===e?0:1;this.secondSocketOpener=this.edgeInfoReplayed.pipe(reduce((function(e,t){return[].concat(_toConsumableArray(e),[t])}),[]),map$1((function(e){return sortBy_1(e,(function(e){var n=e.ip;return calIpDistance(t,n)})).slice(-1)[0]})),take(1),mergeMap((function(e){if(void 0===e)return throwError(new Error("Invalid edge info"));var t=e.ip,i=e.ticket,o=new Socket(t,r,i,n.context,n.logger);return o.once("connectionFailure",(function(){return n.onSocketConnectionFailure(o)})),o.open$.pipe(tap((function(){n.closeAfterComplete(o)||(n.lastOpenSockets[r].next(o),n.curOpenSockets[r]=o)})))})),share());var i=this.secondOpenKeeperSubject.pipe(switchAll());this.secondOpenKeeperSub=i.subscribe({error:this.logError}),this.secondOpenKeeperSubject.next(this.secondSocketOpener)}},{key:"reopenSocketWithApRequest",value:function(e){var t=this,n=[0,1].filter((function(t){return t!==e}))[0],r=this.curOpenSockets[n];if(void 0!==r){var i=r.ip,o=this.apClient.apEdgeInfoEndFirst$.pipe(filter((function(e){return void 0!==e&&"string"==typeof e.ip&&"string"==typeof e.ticket})),throwIfEmpty((function(){return new ConnectionError({AP_NO_AVAILABLE_EDGE:"No available edge address to connect"})})),retryWhen((function(e){return e.pipe(tap((function(e){if(e.code===LOGIN_ERR_TOKEN_EXPIRED)return t.emit("tokenExpired"),void t.apClient.apFinish$.next(void 0);if(isRtmError(e))throw e})),delay(1500),takeUntil(timer(7e3)))})),tap((function(e){t.log("An edge info got %o",e)}))).pipe(reduce((function(e,t){return[].concat(_toConsumableArray(e),[t])}),[]),map$1((function(e){var n=sortBy_1(e,(function(e){var t=e.ip;return calIpDistance(i,t)}));return n.length-1>=t.ipIterator?n.slice(-t.ipIterator++-1)[0]:(t.ipIterator=0,n.slice(-1)[0])})),throwIfEmpty(),mergeMap((function(n){if(void 0===n)return throwError(new Error("Invalid edge info"));var r=n.ip,i=n.ticket,o=new Socket(r,e,i,t.context,t.logger);return o.once("connectionFailure",(function(){return t.onSocketConnectionFailure(o)})),o.open$.pipe(mapTo(o))})),tap((function(n){t.log("The websocket of ENV_%d re-opened to %s:%d using ap",n.env,n.ip,EDGE_ENV_PORT[n.env]),t.curOpenSockets[e]=n,t.lastOpenSockets[e].next(n)})),mergeMap((function(n){return n.open$.pipe(tap((function(){t.log("The websocket of ENV_%d re-opened to %s:%d",n.env,n.ip,EDGE_ENV_PORT[n.env]),t.curOpenSockets[e]=n,t.lastOpenSockets[e].next(n)})))})),share());e===this.firstEnv?this.firstOpenKeeperSubject.next(o):this.secondOpenKeeperSubject.next(o)}}},{key:"closeAfterComplete",value:function(e){return!!this.lastOpenSockets[e.env].isStopped&&(e.close(),!0)}}]),n}(createEventBase()),$Writer$1=minimal_1.Writer,$util$1=minimal_1.util,$root$1=minimal_1.roots.default||(minimal_1.roots.default={}),Session=$root$1.Session=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.sid="",e.prototype.userId="",e.prototype.lts=$util$1.Long?$util$1.Long.fromBits(0,0,!1):0,e.prototype.elapse=$util$1.Long?$util$1.Long.fromBits(0,0,!1):0,e.prototype.appId="",e.prototype.ver="",e.prototype.buildno=0,e.prototype.installId="",e.prototype.os=0,e.prototype.did="",e.prototype.index=null,e.prototype.token="",e.prototype.version=0,e.prototype.subVersion=0,e.encode=function(e,t){return t||(t=$Writer$1.create()),null!=e.sid&&Object.hasOwnProperty.call(e,"sid")&&t.uint32(10).string(e.sid),null!=e.userId&&Object.hasOwnProperty.call(e,"userId")&&t.uint32(18).string(e.userId),null!=e.lts&&Object.hasOwnProperty.call(e,"lts")&&t.uint32(24).int64(e.lts),null!=e.elapse&&Object.hasOwnProperty.call(e,"elapse")&&t.uint32(32).int64(e.elapse),null!=e.appId&&Object.hasOwnProperty.call(e,"appId")&&t.uint32(42).string(e.appId),null!=e.ver&&Object.hasOwnProperty.call(e,"ver")&&t.uint32(50).string(e.ver),null!=e.buildno&&Object.hasOwnProperty.call(e,"buildno")&&t.uint32(56).int32(e.buildno),null!=e.installId&&Object.hasOwnProperty.call(e,"installId")&&t.uint32(66).string(e.installId),null!=e.os&&Object.hasOwnProperty.call(e,"os")&&t.uint32(128).int32(e.os),null!=e.did&&Object.hasOwnProperty.call(e,"did")&&t.uint32(138).string(e.did),null!=e.index&&Object.hasOwnProperty.call(e,"index")&&$root$1.Session.CommonIndex.encode(e.index,t.uint32(162).fork()).ldelim(),null!=e.token&&Object.hasOwnProperty.call(e,"token")&&t.uint32(170).string(e.token),null!=e.version&&Object.hasOwnProperty.call(e,"version")&&t.uint32(176).int32(e.version),null!=e.subVersion&&Object.hasOwnProperty.call(e,"subVersion")&&t.uint32(184).int32(e.subVersion),t},e.CommonIndex=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.index1="",e.prototype.index2="",e.prototype.index3="",e.encode=function(e,t){return t||(t=$Writer$1.create()),null!=e.index1&&Object.hasOwnProperty.call(e,"index1")&&t.uint32(10).string(e.index1),null!=e.index2&&Object.hasOwnProperty.call(e,"index2")&&t.uint32(18).string(e.index2),null!=e.index3&&Object.hasOwnProperty.call(e,"index3")&&t.uint32(26).string(e.index3),t},e}(),e}(),Link=$root$1.Link=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.sid="",e.prototype.userId="",e.prototype.lts=$util$1.Long?$util$1.Long.fromBits(0,0,!1):0,e.prototype.elapse=$util$1.Long?$util$1.Long.fromBits(0,0,!1):0,e.prototype.ec=0,e.prototype.sc=0,e.prototype.destServerIp="",e.prototype.ackedServerIp="",e.prototype.responseTime=0,e.encode=function(e,t){return t||(t=$Writer$1.create()),null!=e.sid&&Object.hasOwnProperty.call(e,"sid")&&t.uint32(10).string(e.sid),null!=e.userId&&Object.hasOwnProperty.call(e,"userId")&&t.uint32(18).string(e.userId),null!=e.lts&&Object.hasOwnProperty.call(e,"lts")&&t.uint32(24).int64(e.lts),null!=e.elapse&&Object.hasOwnProperty.call(e,"elapse")&&t.uint32(32).int64(e.elapse),null!=e.ec&&Object.hasOwnProperty.call(e,"ec")&&t.uint32(40).int32(e.ec),null!=e.sc&&Object.hasOwnProperty.call(e,"sc")&&t.uint32(48).int32(e.sc),null!=e.destServerIp&&Object.hasOwnProperty.call(e,"destServerIp")&&t.uint32(58).string(e.destServerIp),null!=e.ackedServerIp&&Object.hasOwnProperty.call(e,"ackedServerIp")&&t.uint32(66).string(e.ackedServerIp),null!=e.responseTime&&Object.hasOwnProperty.call(e,"responseTime")&&t.uint32(72).int32(e.responseTime),t},e}(),Logout=$root$1.Logout=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.sid="",e.prototype.userId="",e.prototype.lts=$util$1.Long?$util$1.Long.fromBits(0,0,!1):0,e.prototype.elapse=$util$1.Long?$util$1.Long.fromBits(0,0,!1):0,e.encode=function(e,t){return t||(t=$Writer$1.create()),null!=e.sid&&Object.hasOwnProperty.call(e,"sid")&&t.uint32(10).string(e.sid),null!=e.userId&&Object.hasOwnProperty.call(e,"userId")&&t.uint32(18).string(e.userId),null!=e.lts&&Object.hasOwnProperty.call(e,"lts")&&t.uint32(24).int64(e.lts),null!=e.elapse&&Object.hasOwnProperty.call(e,"elapse")&&t.uint32(32).int64(e.elapse),t},e}(),KickedOff=$root$1.KickedOff=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.sid="",e.prototype.userId="",e.prototype.lts=$util$1.Long?$util$1.Long.fromBits(0,0,!1):0,e.prototype.elapse=$util$1.Long?$util$1.Long.fromBits(0,0,!1):0,e.prototype.linkId=0,e.prototype.code=0,e.prototype.server="",e.prototype.serverCode=0,e.encode=function(e,t){return t||(t=$Writer$1.create()),null!=e.sid&&Object.hasOwnProperty.call(e,"sid")&&t.uint32(10).string(e.sid),null!=e.userId&&Object.hasOwnProperty.call(e,"userId")&&t.uint32(18).string(e.userId),null!=e.lts&&Object.hasOwnProperty.call(e,"lts")&&t.uint32(24).int64(e.lts),null!=e.elapse&&Object.hasOwnProperty.call(e,"elapse")&&t.uint32(32).int64(e.elapse),null!=e.linkId&&Object.hasOwnProperty.call(e,"linkId")&&t.uint32(48).int32(e.linkId),null!=e.code&&Object.hasOwnProperty.call(e,"code")&&t.uint32(56).int32(e.code),null!=e.server&&Object.hasOwnProperty.call(e,"server")&&t.uint32(66).string(e.server),null!=e.serverCode&&Object.hasOwnProperty.call(e,"serverCode")&&t.uint32(72).int32(e.serverCode),t},e}(),ChnJoin=$root$1.ChnJoin=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.sid="",e.prototype.userId="",e.prototype.lts=$util$1.Long?$util$1.Long.fromBits(0,0,!1):0,e.prototype.elapse=$util$1.Long?$util$1.Long.fromBits(0,0,!1):0,e.prototype.cname="",e.prototype.errCode=0,e.encode=function(e,t){return t||(t=$Writer$1.create()),null!=e.sid&&Object.hasOwnProperty.call(e,"sid")&&t.uint32(10).string(e.sid),null!=e.userId&&Object.hasOwnProperty.call(e,"userId")&&t.uint32(18).string(e.userId),null!=e.lts&&Object.hasOwnProperty.call(e,"lts")&&t.uint32(24).int64(e.lts),null!=e.elapse&&Object.hasOwnProperty.call(e,"elapse")&&t.uint32(32).int64(e.elapse),null!=e.cname&&Object.hasOwnProperty.call(e,"cname")&&t.uint32(50).string(e.cname),null!=e.errCode&&Object.hasOwnProperty.call(e,"errCode")&&t.uint32(56).int32(e.errCode),t},e}(),ChnJoinRes=$root$1.ChnJoinRes=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.sid="",e.prototype.userId="",e.prototype.lts=$util$1.Long?$util$1.Long.fromBits(0,0,!1):0,e.prototype.elapse=$util$1.Long?$util$1.Long.fromBits(0,0,!1):0,e.prototype.cname="",e.prototype.errCode=0,e.prototype.serverErrCode=0,e.encode=function(e,t){return t||(t=$Writer$1.create()),null!=e.sid&&Object.hasOwnProperty.call(e,"sid")&&t.uint32(10).string(e.sid),null!=e.userId&&Object.hasOwnProperty.call(e,"userId")&&t.uint32(18).string(e.userId),null!=e.lts&&Object.hasOwnProperty.call(e,"lts")&&t.uint32(24).int64(e.lts),null!=e.elapse&&Object.hasOwnProperty.call(e,"elapse")&&t.uint32(32).int64(e.elapse),null!=e.cname&&Object.hasOwnProperty.call(e,"cname")&&t.uint32(50).string(e.cname),null!=e.errCode&&Object.hasOwnProperty.call(e,"errCode")&&t.uint32(56).int32(e.errCode),null!=e.serverErrCode&&Object.hasOwnProperty.call(e,"serverErrCode")&&t.uint32(64).int32(e.serverErrCode),t},e}(),ChnLeave=$root$1.ChnLeave=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.sid="",e.prototype.userId="",e.prototype.lts=$util$1.Long?$util$1.Long.fromBits(0,0,!1):0,e.prototype.elapse=$util$1.Long?$util$1.Long.fromBits(0,0,!1):0,e.prototype.cname="",e.prototype.errCode=0,e.encode=function(e,t){return t||(t=$Writer$1.create()),null!=e.sid&&Object.hasOwnProperty.call(e,"sid")&&t.uint32(10).string(e.sid),null!=e.userId&&Object.hasOwnProperty.call(e,"userId")&&t.uint32(18).string(e.userId),null!=e.lts&&Object.hasOwnProperty.call(e,"lts")&&t.uint32(24).int64(e.lts),null!=e.elapse&&Object.hasOwnProperty.call(e,"elapse")&&t.uint32(32).int64(e.elapse),null!=e.cname&&Object.hasOwnProperty.call(e,"cname")&&t.uint32(50).string(e.cname),null!=e.errCode&&Object.hasOwnProperty.call(e,"errCode")&&t.uint32(56).int32(e.errCode),t},e}(),ConnectionStateChange=$root$1.ConnectionStateChange=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.sid="",e.prototype.userId="",e.prototype.lts=$util$1.Long?$util$1.Long.fromBits(0,0,!1):0,e.prototype.elapse=$util$1.Long?$util$1.Long.fromBits(0,0,!1):0,e.prototype.oldState=0,e.prototype.newState=0,e.prototype.reason=0,e.prototype.reconnId=0,e.encode=function(e,t){return t||(t=$Writer$1.create()),null!=e.sid&&Object.hasOwnProperty.call(e,"sid")&&t.uint32(10).string(e.sid),null!=e.userId&&Object.hasOwnProperty.call(e,"userId")&&t.uint32(18).string(e.userId),null!=e.lts&&Object.hasOwnProperty.call(e,"lts")&&t.uint32(24).int64(e.lts),null!=e.elapse&&Object.hasOwnProperty.call(e,"elapse")&&t.uint32(32).int64(e.elapse),null!=e.oldState&&Object.hasOwnProperty.call(e,"oldState")&&t.uint32(40).int32(e.oldState),null!=e.newState&&Object.hasOwnProperty.call(e,"newState")&&t.uint32(48).int32(e.newState),null!=e.reason&&Object.hasOwnProperty.call(e,"reason")&&t.uint32(56).int32(e.reason),null!=e.reconnId&&Object.hasOwnProperty.call(e,"reconnId")&&t.uint32(64).int32(e.reconnId),t},e}(),ProtoPackets$1=Object.freeze({__proto__:null,Session:Session,Link:Link,Logout:Logout,KickedOff:KickedOff,ChnJoin:ChnJoin,ChnJoinRes:ChnJoinRes,ChnLeave:ChnLeave,ConnectionStateChange:ConnectionStateChange,default:$root$1}),Counter=1,ApiExec=154,Session$1=164,ApEvent=165,Link$1=166,Logout$1=167,TxMessage=168,RxMessage=169,KickedOff$1=170,TxMessageRes=171,ChnJoin$1=172,ChnJoinRes$1=173,ChnLeave$1=174,ChnGetMembers=175,ChnGetMembersRes=176,ChnMemberJoined=177,ChnMemberLeft=178,RenewToken=181,OperateAttribute=186,OperateAttributeRes=187,ApRequest=188,LinkTcpEvent=189,LinkLoginRequest=190,ConnectionStateChange$1=191,reportId={Counter:Counter,ApiExec:ApiExec,Session:Session$1,ApEvent:ApEvent,Link:Link$1,Logout:Logout$1,TxMessage:TxMessage,RxMessage:RxMessage,KickedOff:KickedOff$1,TxMessageRes:TxMessageRes,ChnJoin:ChnJoin$1,ChnJoinRes:ChnJoinRes$1,ChnLeave:ChnLeave$1,ChnGetMembers:ChnGetMembers,ChnGetMembersRes:ChnGetMembersRes,ChnMemberJoined:ChnMemberJoined,ChnMemberLeft:ChnMemberLeft,RenewToken:RenewToken,OperateAttribute:OperateAttribute,OperateAttributeRes:OperateAttributeRes,ApRequest:ApRequest,LinkTcpEvent:LinkTcpEvent,LinkLoginRequest:LinkLoginRequest,ConnectionStateChange:ConnectionStateChange$1},ReportId=Object.freeze({__proto__:null,Counter:Counter,ApiExec:ApiExec,Session:Session$1,ApEvent:ApEvent,Link:Link$1,Logout:Logout$1,TxMessage:TxMessage,RxMessage:RxMessage,KickedOff:KickedOff$1,TxMessageRes:TxMessageRes,ChnJoin:ChnJoin$1,ChnJoinRes:ChnJoinRes$1,ChnLeave:ChnLeave$1,ChnGetMembers:ChnGetMembers,ChnGetMembersRes:ChnGetMembersRes,ChnMemberJoined:ChnMemberJoined,ChnMemberLeft:ChnMemberLeft,RenewToken:RenewToken,OperateAttribute:OperateAttribute,OperateAttributeRes:OperateAttributeRes,ApRequest:ApRequest,LinkTcpEvent:LinkTcpEvent,LinkLoginRequest:LinkLoginRequest,ConnectionStateChange:ConnectionStateChange$1,default:reportId});function sendReport(e,t){return _sendReport.apply(this,arguments)}function _sendReport(){return _sendReport=_asyncToGenerator(regeneratorRuntime.mark((function e(t,n){var r,i,o,a,s;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return r=ProtoPackets$1[t].encode(n).finish(),i=Math.ceil(Date.now()/1e3).toString(),o=ReportId[t],a=0,s=function(){var e=_asyncToGenerator(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,postWithAbortSignal("https://webcollector-rtm.agora.io:6443/events/proto-raw?sentTs=".concat(i,"&id=").concat(o),{body:uint8ArrayToArrayBuffer(r),timeout:1e4,headers:{"Content-Type":"application/octet-stream"}});case 3:e.next=11;break;case 5:if(e.prev=5,e.t0=e["catch"](0),a+=1,a<=2){e.next=9;break}return e.abrupt("return");case 9:return e.next=11,s();case 11:case"end":return e.stop()}}),e,null,[[0,5]])})));return function(){return e.apply(this,arguments)}}(),e.prev=3,e.next=6,s();case 6:e.next=10;break;case 8:e.prev=8,e.t0=e["catch"](3);case 10:case"end":return e.stop()}}),e,null,[[3,8]])}))),_sendReport.apply(this,arguments)}function getElapse(e){return void 0===e?long_1.fromNumber(0):long_1.fromNumber(Date.now()-e)}var Context=function(e){"use strict";_inherits(n,e);var t=_createSuper(n);function n(e,r){var i;return _classCallCheck(this,n),i=t.call(this,r,"Context"),i.appId=e,i._token=void 0,i._uid=void 0,i._sid=void 0,i._area=void 0,i}return _createClass(n,[{key:"token",set:function(e){this.log("The token is set to %s",e),this._token="string"==typeof e&&e?e:void 0}},{key:"uid",set:function(e){if(this.log("The user ID is set to %s",e),!isValidId(e))throw new RtmInternalError;this._uid=e},get:function(){if("string"==typeof this._uid&&this._uid)return this._uid;throw new RtmInternalError("Cannot get illegal uid")}},{key:"key",get:function(){if("string"==typeof this._token&&this._token)return this._token;if("string"==typeof this.appId&&this.appId)return this.appId;throw new RtmInternalError("Cannot get illegal key")}},{key:"sid",get:function(){if("string"==typeof this._sid&&this._sid)return this._sid;throw new RtmInternalError("Cannot get illegal sid")},set:function(e){if(this.log("sid is set to %s",e),"string"!=typeof e||!e)throw new RtmInternalError;this._sid=e}},{key:"area",get:function(){if("string"==typeof this._area&&this._area)return this._area;throw new RtmInternalError("Cannot get illegal area")},set:function(e){this.log("area is set to %s",e),this._area="string"==typeof e&&e?e:"CN"}}]),n}(createEventBase()),EndedInvitationLogMessage="The invitation has ended, skipped emitting the %s event",InvitationError=genError(),_class,_temp,failureReason=RtmStatusCode$1.LocalInvitationFailureReason,state=RtmStatusCode$1.LocalInvitationState,RtmLocalInvitation=(_temp=function(e){"use strict";_inherits(n,e);var t=_createSuper(n);function n(e,r,i){var o;return _classCallCheck(this,n),o=t.call(this,i,"RtmLocalInvitation",!0),o.calleeId=e,o.getSession=r,o.logger=i,o.state=state.IDLE,o.localInvitationEnd$=race(fromEvent(_assertThisInitialized(o),"LocalInvitationAccepted"),fromEvent(_assertThisInitialized(o),"LocalInvitationRefused"),fromEvent(_assertThisInitialized(o),"LocalInvitationFailure"),fromEvent(_assertThisInitialized(o),"LocalInvitationCanceled")).pipe(take(1)),o.callId=uuid_1.v4(),o._content="",o._channelId="",o._response="",o}return _createClass(n,[{key:"channelId",get:function(){return this._channelId},set:function(e){this.state===state.IDLE?(this.log("set channelId for %s",this.callId),this._channelId=e):this.info("set channelId only allow before invitation sent to remote")}},{key:"content",get:function(){return this._content},set:function(e){this.log("set content for %s",this.callId),this._content=e}},{key:"response",get:function(){return this._response},set:function(e){throw new RtmInvalidArgumentError('Cannot set the "response" of the LocalInvitation instance.',INVITATION_API_CALL_ERR_INVALID_ARGUMENT)}}]),_createClass(n,[{key:"send",value:function(){var e,t=this;if(this.state===state.SENT_TO_REMOTE||this.state===state.RECEIVED_BY_REMOTE)throw new RtmInvalidStatusError("The local invitation send failure. The call invitation has already been sent.",INVITATION_API_CALL_ERR_ALREADY_SENT);if(this.isLocalInvitationEnd())throw new RtmInvalidStatusError("The local invitation send failure. The call invitation has ended.",INVITATION_API_CALL_ERR_ALREADY_END);if(this._channelId.length>0&&!isValidId(this._channelId))throw new RtmInvalidArgumentError("Illegal invitation channel ID",INVITATION_API_CALL_ERR_INVALID_ARGUMENT);if(!isValidId(this.calleeId))throw new RtmInvalidArgumentError("Illegal invitation callee user ID",INVITATION_API_CALL_ERR_INVALID_ARGUMENT);if(getUtf8StringSize(this._content)>INVITATION_EXTRA_MAX_BYTES)throw new RtmInvalidArgumentError('The length of the "content" overflows. The number of bytes representing content must not exceed 8 × 1024 if encoded in UTF-8.',INVITATION_API_CALL_ERR_INVALID_ARGUMENT);this.state=state.SENT_TO_REMOTE,defer(_asyncToGenerator(regeneratorRuntime.mark((function n(){var r,i,o;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,t.getSession().sendInvitationMessage({peerId:t.calleeId,callId:t.callId,extra:t._content,type:"CallInvite",channelId:t._channelId});case 2:if(r=n.sent,i=r.hasPeerReceived,o=r.hasReSent,!t.isLocalInvitationEnd()){n.next=7;break}throw new RtmTimeoutError("send invitation timeout");case 7:if(t.log("The local invitation has sent to the callee"),i||o){n.next=9;break}throw e=new InvitationError({PEER_NOT_ONLINE:"The peer of the invitation is not online"}),e;case 9:if(i){n.next=11;break}throw e=new InvitationError({RESENT_AND_OFFLINE:"Resent and the peer of the invitation is not online"}),e;case 11:case"end":return n.stop()}}),n)})))).pipe(retryWhen((function(e){return e.pipe(tap((function(e){if(!(e instanceof InvitationError))throw e})),delay(LOCAL_INVITATION_RESEND_INTERVAL))})),timeout(LOCAL_INVITATION_ACK_TIMEOUT),catchError((function(e){return isTimeout(e)&&t.warn("local invitation ack timed out"),throwError(e)})),takeUntil(this.localInvitationEnd$)).subscribe({next:function(){t.state!==state.RECEIVED_BY_REMOTE?t.state===state.SENT_TO_REMOTE?(t.info("The peer received the local invitation %s.",t.callId),t.state=state.RECEIVED_BY_REMOTE,t.emit("LocalInvitationReceivedByPeer"),t.localInvitationEnd$.pipe(timeout(INVITATION_EXPIRE_TIMEOUT),catchError((function(e){return isTimeout(e)&&t.warn("local invitation expired"),throwError(e)}))).subscribe({error:function(){t.state=state.FAILURE,t.emit("LocalInvitationFailure",failureReason.INVITATION_EXPIRE)}})):t.log(EndedInvitationLogMessage,"LocalInvitationReceivedByPeer"):t.log('The local invitation state is already "RECEIVED_BY_REMOTE", skipped emitting "LocalInvitationReceivedByPeer"')},error:function(n){t.isLocalInvitationEnd()?t.log(EndedInvitationLogMessage,"LocalInvitationFailure"):(t.state=state.FAILURE,isTimeout(n)&&e?"PEER_NOT_ONLINE"===e.code?t.emit("LocalInvitationFailure",failureReason.PEER_OFFLINE):"RESENT_AND_OFFLINE"===e.code&&t.emit("LocalInvitationFailure",failureReason.PEER_NO_RESPONSE):isTimeout(n)?t.emit("LocalInvitationFailure",failureReason.PEER_NO_RESPONSE):"RtmInvalidStatusError"===n.name?t.emit("LocalInvitationFailure",failureReason.NOT_LOGGEDIN):t.emit("LocalInvitationFailure",failureReason.UNKNOWN))}})}},{key:"cancel",value:function(){if(this.isLocalInvitationEnd())throw new RtmInvalidStatusError("The local invitation cancel failure",INVITATION_API_CALL_ERR_ALREADY_END);if(this.state===state.IDLE)throw new RtmInvalidStatusError("The local invitation has not been sent",INVITATION_API_CALL_ERR_NOT_STARTED);if(getUtf8StringSize(this._content)>INVITATION_EXTRA_MAX_BYTES)throw new RtmInvalidArgumentError('The length of the "content" overflows. The number of bytes representing content must not exceed 8 × 1024 if encoded in UTF-8.',INVITATION_API_CALL_ERR_INVALID_ARGUMENT);this.getSession().sendInvitationMessage({callId:this.callId,peerId:this.calleeId,type:"CallCancel",channelId:this._channelId,extra:this._content}),this.state=state.CANCELED,this.emit("LocalInvitationCanceled")}},{key:"onAcceptReceived",value:function(e){if(this.isLocalInvitationEnd()&&this.state!==state.ACCEPTED_BY_REMOTE)this.log(EndedInvitationLogMessage,"LocalInvitationAccepted");else{if(this.state===state.IDLE)throw new RtmInvalidStatusError("the local have not sent the invitation, how can remote accept it?");this.getSession().sendInvitationMessage({callId:this.callId,isAcceptAck:!0,type:"CallAccept",peerId:this.calleeId,channelId:this.channelId}),this.state!==state.ACCEPTED_BY_REMOTE?(this.state===state.SENT_TO_REMOTE&&(this.log("receive LocalInvitationAccepted before remote response to the invitation"),this.state=state.RECEIVED_BY_REMOTE,this.emit("LocalInvitationReceivedByPeer")),this.state=state.ACCEPTED_BY_REMOTE,this._response=e,this.emit("LocalInvitationAccepted",e)):this.log("already in ACCEPTED_BY_REMOTE state, ignore emit ACCEPTED_BY_REMOTE")}}},{key:"onRefuseReceived",value:function(e){if(this.isLocalInvitationEnd())this.log(EndedInvitationLogMessage,"LocalInvitationRefused");else{if(this.state===state.IDLE)throw new RtmInvalidStatusError("the local have not sent the invitation, how can remote refuse it?");this.state===state.SENT_TO_REMOTE&&(this.log("receive LocalInvitationRefused before remote response to the invitation"),this.state=state.RECEIVED_BY_REMOTE,this.emit("LocalInvitationReceivedByPeer")),this._response=e,this.state=state.REFUSED_BY_REMOTE,this.emit("LocalInvitationRefused",e)}}},{key:"isLocalInvitationEnd",value:function(){return[state.CANCELED,state.FAILURE,state.ACCEPTED_BY_REMOTE,state.REFUSED_BY_REMOTE].includes(this.state)}}]),n}(createEventBase()),_class=_temp,_applyDecoratedDescriptor(_class.prototype,"send",[logged],Object.getOwnPropertyDescriptor(_class.prototype,"send"),_class.prototype),_applyDecoratedDescriptor(_class.prototype,"cancel",[logged],Object.getOwnPropertyDescriptor(_class.prototype,"cancel"),_class.prototype),_class),RemoteInvitationFailureReason=RtmStatusCode$1.RemoteInvitationFailureReason,RemoteInvitationState=RtmStatusCode$1.RemoteInvitationState,RtmRemoteInvitation=function(e){"use strict";_inherits(n,e);var t=_createSuper(n);function n(e){var r,i=e.invitationChannel,o=e.extraContent,a=e.callId,s=e.callerId,c=e.logger,u=e.getSession;return _classCallCheck(this,n),r=t.call(this,c,"RtmRemoteInvitation",!0),r.state=RemoteInvitationState.INVITATION_RECEIVED,r.remoteInvitationEnd$=race(fromEvent(_assertThisInitialized(r),"RemoteInvitationCanceled"),fromEvent(_assertThisInitialized(r),"RemoteInvitationRefused"),fromEvent(_assertThisInitialized(r),"RemoteInvitationAccepted"),fromEvent(_assertThisInitialized(r),"RemoteInvitationFailure")).pipe(take(1)),r.callerId=void 0,r.callId=void 0,r._getSession=void 0,r.logger=void 0,r._content=void 0,r._channelId=void 0,r._response="",r._channelId=i,r._content=o,r.callId=a,r.callerId=s,r._getSession=u,r.logger=c,r.remoteInvitationEnd$.pipe(timeout(INVITATION_EXPIRE_TIMEOUT),catchError((function(e){return isTimeout(e)&&r.warn("Remote invitation expired"),throwError(e)}))).subscribe({error:function(){r.state=RemoteInvitationState.FAILURE,r.emit("RemoteInvitationFailure",RemoteInvitationFailureReason.INVITATION_EXPIRE)}}),r}return _createClass(n,[{key:"channelId",get:function(){return this._channelId},set:function(e){throw new RtmInvalidArgumentError('Cannot set the "response" of the RemoteInvitation instance.',INVITATION_API_CALL_ERR_INVALID_ARGUMENT)}},{key:"content",get:function(){return this._content},set:function(e){throw new RtmInvalidArgumentError('Cannot set the "content" of the RemoteInvitation instance.',INVITATION_API_CALL_ERR_INVALID_ARGUMENT)}},{key:"response",get:function(){return this._response},set:function(e){this._response=e}}]),_createClass(n,[{key:"accept",value:function(){var e,t=this;if(this.isRemoteInvitationEnd())throw new RtmInvalidStatusError("The local invitation has ended. Cannot accept.",INVITATION_API_CALL_ERR_ALREADY_END);if(this.state===RemoteInvitationState.ACCEPT_SENT_TO_LOCAL)throw new RtmInvalidStatusError("The remote invitation is accepting. Cannot do the operation.",INVITATION_API_CALL_ERR_ALREADY_ACCEPT);if(getUtf8StringSize(this._response)>INVITATION_EXTRA_MAX_BYTES)throw new RtmInvalidArgumentError('The length of the "response" overflows. The number of bytes representing content must not exceed 8 × 1024 if encoded in UTF-8.',INVITATION_API_CALL_ERR_INVALID_ARGUMENT);this.state=RemoteInvitationState.ACCEPT_SENT_TO_LOCAL,merge(interval(REMOTE_INVITATION_ACCEPT_RESEND_INTERVAL).pipe(mergeMap((function(){return defer(_asyncToGenerator(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",t._getSession().sendInvitationMessage({peerId:t.callerId,callId:t.callId,extra:t.response,type:"CallAccept",isAcceptAck:!1,channelId:t.channelId}));case 1:case"end":return e.stop()}}),e)}))))})),filter((function(t){var n;return n=t,e=n.hasPeerReceived,e})),take(1)),fromEvent(this,"RemoteInvitationAccepted")).pipe(timeout(REMOTE_INVITATION_WAIT_ACCEPT_ACK_TIMEOUT),takeUntil(this.remoteInvitationEnd$)).subscribe({error:function(n){if(t.logError(n),t.state=RemoteInvitationState.FAILURE,isTimeout(n))switch(e){case void 0:case!0:return void t.emit("RemoteInvitationFailure",RemoteInvitationFailureReason.ACCEPT_FAILURE);case!1:return void t.emit("RemoteInvitationFailure",RemoteInvitationFailureReason.PEER_OFFLINE)}t.emit("RemoteInvitationFailure",RemoteInvitationFailureReason.UNKNOWN)}})}},{key:"refuse",value:function(){if(this.state===RemoteInvitationState.ACCEPT_SENT_TO_LOCAL)throw new RtmInvalidStatusError("The remote invitation is accepting. Cannot do the operation.",INVITATION_API_CALL_ERR_ALREADY_ACCEPT);if(this.isRemoteInvitationEnd())throw new RtmInvalidStatusError("The invitation is end. Cannot refuse",INVITATION_API_CALL_ERR_ALREADY_END);if(getUtf8StringSize(this._response)>INVITATION_EXTRA_MAX_BYTES)throw new RtmInvalidArgumentError('The length of the "response" overflows. The number of bytes representing content must not exceed 8 × 1024 if encoded in UTF-8.',INVITATION_API_CALL_ERR_INVALID_ARGUMENT);this._getSession().sendInvitationMessage({peerId:this.callerId,callId:this.callId,extra:this.response,type:"CallReject",channelId:this.channelId}),this.state=RemoteInvitationState.REFUSED,this.emit("RemoteInvitationRefused")}},{key:"onCancelReceived",value:function(e){this.isRemoteInvitationEnd()?this.log(EndedInvitationLogMessage,"RemoteInvitationCanceled"):(this.state===RemoteInvitationState.ACCEPT_SENT_TO_LOCAL&&this.log("caller canceled before receive accept"),this._content=e,this.state=RemoteInvitationState.CANCELED,this.emit("RemoteInvitationCanceled",e))}},{key:"onAcceptAckReceived",value:function(){this.state===RemoteInvitationState.ACCEPT_SENT_TO_LOCAL?(this.state=RemoteInvitationState.ACCEPTED,this.emit("RemoteInvitationAccepted")):this.log(EndedInvitationLogMessage,"ori:".concat(this.state,", to: RemoteInvitationAccepted"))}},{key:"isRemoteInvitationEnd",value:function(){return[RemoteInvitationState.ACCEPTED,RemoteInvitationState.REFUSED,RemoteInvitationState.CANCELED,RemoteInvitationState.FAILURE].includes(this.state)}}]),n}(createEventBase());function compact(e){for(var t=-1,n=null==e?0:e.length,r=0,i=[];++t<n;){var o=e[t];o&&(i[r++]=o)}return i}var compact_1=compact,Z_FIXED=4,Z_BINARY=0,Z_TEXT=1,Z_UNKNOWN=2;
/*! pako 2.0.1 https://github.com/nodeca/pako @license (MIT AND Zlib) */function zero$1(e){for(var t=e.length;--t>=0;)e[t]=0}var STORED_BLOCK=0,STATIC_TREES=1,DYN_TREES=2,MIN_MATCH=3,MAX_MATCH=258,LENGTH_CODES=29,LITERALS=256,L_CODES=LITERALS+1+LENGTH_CODES,D_CODES=30,BL_CODES=19,HEAP_SIZE=2*L_CODES+1,MAX_BITS=15,Buf_size=16,MAX_BL_BITS=7,END_BLOCK=256,REP_3_6=16,REPZ_3_10=17,REPZ_11_138=18,extra_lbits=new Uint8Array([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0]),extra_dbits=new Uint8Array([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]),extra_blbits=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7]),bl_order=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),DIST_CODE_LEN=512,static_ltree=new Array(2*(L_CODES+2));zero$1(static_ltree);var static_dtree=new Array(2*D_CODES);zero$1(static_dtree);var _dist_code=new Array(DIST_CODE_LEN);zero$1(_dist_code);var _length_code=new Array(MAX_MATCH-MIN_MATCH+1);zero$1(_length_code);var base_length=new Array(LENGTH_CODES);zero$1(base_length);var base_dist=new Array(D_CODES),static_l_desc,static_d_desc,static_bl_desc;function StaticTreeDesc(e,t,n,r,i){this.static_tree=e,this.extra_bits=t,this.extra_base=n,this.elems=r,this.max_length=i,this.has_stree=e&&e.length}function TreeDesc(e,t){this.dyn_tree=e,this.max_code=0,this.stat_desc=t}zero$1(base_dist);var d_code=function(e){return e<256?_dist_code[e]:_dist_code[256+(e>>>7)]},put_short=function(e,t){e.pending_buf[e.pending++]=255&t,e.pending_buf[e.pending++]=t>>>8&255},send_bits=function(e,t,n){e.bi_valid>Buf_size-n?(e.bi_buf|=t<<e.bi_valid&65535,put_short(e,e.bi_buf),e.bi_buf=t>>Buf_size-e.bi_valid,e.bi_valid+=n-Buf_size):(e.bi_buf|=t<<e.bi_valid&65535,e.bi_valid+=n)},send_code=function(e,t,n){send_bits(e,n[2*t],n[2*t+1])},bi_reverse=function(e,t){var n=0;do{n|=1&e,e>>>=1,n<<=1}while(--t>0);return n>>>1},bi_flush=function(e){16===e.bi_valid?(put_short(e,e.bi_buf),e.bi_buf=0,e.bi_valid=0):e.bi_valid>=8&&(e.pending_buf[e.pending++]=255&e.bi_buf,e.bi_buf>>=8,e.bi_valid-=8)},gen_bitlen=function(e,t){var n,r,i,o,a,s,c=t.dyn_tree,u=t.max_code,l=t.stat_desc.static_tree,d=t.stat_desc.has_stree,f=t.stat_desc.extra_bits,h=t.stat_desc.extra_base,p=t.stat_desc.max_length,_=0;for(o=0;o<=MAX_BITS;o++)e.bl_count[o]=0;for(c[2*e.heap[e.heap_max]+1]=0,n=e.heap_max+1;n<HEAP_SIZE;n++)r=e.heap[n],o=c[2*c[2*r+1]+1]+1,o>p&&(o=p,_++),c[2*r+1]=o,r>u||(e.bl_count[o]++,a=0,r>=h&&(a=f[r-h]),s=c[2*r],e.opt_len+=s*(o+a),d&&(e.static_len+=s*(l[2*r+1]+a)));if(0!==_){do{for(o=p-1;0===e.bl_count[o];)o--;e.bl_count[o]--,e.bl_count[o+1]+=2,e.bl_count[p]--,_-=2}while(_>0);for(o=p;0!==o;o--)for(r=e.bl_count[o];0!==r;)i=e.heap[--n],i>u||(c[2*i+1]!==o&&(e.opt_len+=(o-c[2*i+1])*c[2*i],c[2*i+1]=o),r--)}},gen_codes=function(e,t,n){var r,i,o=new Array(MAX_BITS+1),a=0;for(r=1;r<=MAX_BITS;r++)o[r]=a=a+n[r-1]<<1;for(i=0;i<=t;i++){var s=e[2*i+1];0!==s&&(e[2*i]=bi_reverse(o[s]++,s))}},tr_static_init=function(){var e,t,n,r,i,o=new Array(MAX_BITS+1);for(n=0,r=0;r<LENGTH_CODES-1;r++)for(base_length[r]=n,e=0;e<1<<extra_lbits[r];e++)_length_code[n++]=r;for(_length_code[n-1]=r,i=0,r=0;r<16;r++)for(base_dist[r]=i,e=0;e<1<<extra_dbits[r];e++)_dist_code[i++]=r;for(i>>=7;r<D_CODES;r++)for(base_dist[r]=i<<7,e=0;e<1<<extra_dbits[r]-7;e++)_dist_code[256+i++]=r;for(t=0;t<=MAX_BITS;t++)o[t]=0;for(e=0;e<=143;)static_ltree[2*e+1]=8,e++,o[8]++;for(;e<=255;)static_ltree[2*e+1]=9,e++,o[9]++;for(;e<=279;)static_ltree[2*e+1]=7,e++,o[7]++;for(;e<=287;)static_ltree[2*e+1]=8,e++,o[8]++;for(gen_codes(static_ltree,L_CODES+1,o),e=0;e<D_CODES;e++)static_dtree[2*e+1]=5,static_dtree[2*e]=bi_reverse(e,5);static_l_desc=new StaticTreeDesc(static_ltree,extra_lbits,LITERALS+1,L_CODES,MAX_BITS),static_d_desc=new StaticTreeDesc(static_dtree,extra_dbits,0,D_CODES,MAX_BITS),static_bl_desc=new StaticTreeDesc(new Array(0),extra_blbits,0,BL_CODES,MAX_BL_BITS)},init_block=function(e){var t;for(t=0;t<L_CODES;t++)e.dyn_ltree[2*t]=0;for(t=0;t<D_CODES;t++)e.dyn_dtree[2*t]=0;for(t=0;t<BL_CODES;t++)e.bl_tree[2*t]=0;e.dyn_ltree[2*END_BLOCK]=1,e.opt_len=e.static_len=0,e.last_lit=e.matches=0},bi_windup=function(e){e.bi_valid>8?put_short(e,e.bi_buf):e.bi_valid>0&&(e.pending_buf[e.pending++]=e.bi_buf),e.bi_buf=0,e.bi_valid=0},copy_block=function(e,t,n,r){bi_windup(e),r&&(put_short(e,n),put_short(e,~n)),e.pending_buf.set(e.window.subarray(t,t+n),e.pending),e.pending+=n},smaller=function(e,t,n,r){var i=2*t,o=2*n;return e[i]<e[o]||e[i]===e[o]&&r[t]<=r[n]},pqdownheap=function(e,t,n){for(var r=e.heap[n],i=n<<1;i<=e.heap_len&&(i<e.heap_len&&smaller(t,e.heap[i+1],e.heap[i],e.depth)&&i++,!smaller(t,r,e.heap[i],e.depth));)e.heap[n]=e.heap[i],n=i,i<<=1;e.heap[n]=r},compress_block=function(e,t,n){var r,i,o,a,s=0;if(0!==e.last_lit)do{r=e.pending_buf[e.d_buf+2*s]<<8|e.pending_buf[e.d_buf+2*s+1],i=e.pending_buf[e.l_buf+s],s++,0===r?send_code(e,i,t):(o=_length_code[i],send_code(e,o+LITERALS+1,t),a=extra_lbits[o],0!==a&&(i-=base_length[o],send_bits(e,i,a)),r--,o=d_code(r),send_code(e,o,n),a=extra_dbits[o],0!==a&&(r-=base_dist[o],send_bits(e,r,a)))}while(s<e.last_lit);send_code(e,END_BLOCK,t)},build_tree=function(e,t){var n,r,i,o=t.dyn_tree,a=t.stat_desc.static_tree,s=t.stat_desc.has_stree,c=t.stat_desc.elems,u=-1;for(e.heap_len=0,e.heap_max=HEAP_SIZE,n=0;n<c;n++)0!==o[2*n]?(e.heap[++e.heap_len]=u=n,e.depth[n]=0):o[2*n+1]=0;for(;e.heap_len<2;)i=e.heap[++e.heap_len]=u<2?++u:0,o[2*i]=1,e.depth[i]=0,e.opt_len--,s&&(e.static_len-=a[2*i+1]);for(t.max_code=u,n=e.heap_len>>1;n>=1;n--)pqdownheap(e,o,n);i=c;do{n=e.heap[1],e.heap[1]=e.heap[e.heap_len--],pqdownheap(e,o,1),r=e.heap[1],e.heap[--e.heap_max]=n,e.heap[--e.heap_max]=r,o[2*i]=o[2*n]+o[2*r],e.depth[i]=(e.depth[n]>=e.depth[r]?e.depth[n]:e.depth[r])+1,o[2*n+1]=o[2*r+1]=i,e.heap[1]=i++,pqdownheap(e,o,1)}while(e.heap_len>=2);e.heap[--e.heap_max]=e.heap[1],gen_bitlen(e,t),gen_codes(o,u,e.bl_count)},scan_tree=function(e,t,n){var r,i,o=-1,a=t[1],s=0,c=7,u=4;for(0===a&&(c=138,u=3),t[2*(n+1)+1]=65535,r=0;r<=n;r++)i=a,a=t[2*(r+1)+1],++s<c&&i===a||(s<u?e.bl_tree[2*i]+=s:0!==i?(i!==o&&e.bl_tree[2*i]++,e.bl_tree[2*REP_3_6]++):s<=10?e.bl_tree[2*REPZ_3_10]++:e.bl_tree[2*REPZ_11_138]++,s=0,o=i,0===a?(c=138,u=3):i===a?(c=6,u=3):(c=7,u=4))},send_tree=function(e,t,n){var r,i,o=-1,a=t[1],s=0,c=7,u=4;for(0===a&&(c=138,u=3),r=0;r<=n;r++)if(i=a,a=t[2*(r+1)+1],!(++s<c&&i===a)){if(s<u)do{send_code(e,i,e.bl_tree)}while(0!=--s);else 0!==i?(i!==o&&(send_code(e,i,e.bl_tree),s--),send_code(e,REP_3_6,e.bl_tree),send_bits(e,s-3,2)):s<=10?(send_code(e,REPZ_3_10,e.bl_tree),send_bits(e,s-3,3)):(send_code(e,REPZ_11_138,e.bl_tree),send_bits(e,s-11,7));s=0,o=i,0===a?(c=138,u=3):i===a?(c=6,u=3):(c=7,u=4)}},build_bl_tree=function(e){var t;for(scan_tree(e,e.dyn_ltree,e.l_desc.max_code),scan_tree(e,e.dyn_dtree,e.d_desc.max_code),build_tree(e,e.bl_desc),t=BL_CODES-1;t>=3&&0===e.bl_tree[2*bl_order[t]+1];t--);return e.opt_len+=3*(t+1)+5+5+4,t},send_all_trees=function(e,t,n,r){var i;for(send_bits(e,t-257,5),send_bits(e,n-1,5),send_bits(e,r-4,4),i=0;i<r;i++)send_bits(e,e.bl_tree[2*bl_order[i]+1],3);send_tree(e,e.dyn_ltree,t-1),send_tree(e,e.dyn_dtree,n-1)},detect_data_type=function(e){var t,n=4093624447;for(t=0;t<=31;t++,n>>>=1)if(1&n&&0!==e.dyn_ltree[2*t])return Z_BINARY;if(0!==e.dyn_ltree[18]||0!==e.dyn_ltree[20]||0!==e.dyn_ltree[26])return Z_TEXT;for(t=32;t<LITERALS;t++)if(0!==e.dyn_ltree[2*t])return Z_TEXT;return Z_BINARY},static_init_done=!1,_tr_init=function(e){static_init_done||(tr_static_init(),static_init_done=!0),e.l_desc=new TreeDesc(e.dyn_ltree,static_l_desc),e.d_desc=new TreeDesc(e.dyn_dtree,static_d_desc),e.bl_desc=new TreeDesc(e.bl_tree,static_bl_desc),e.bi_buf=0,e.bi_valid=0,init_block(e)},_tr_stored_block=function(e,t,n,r){send_bits(e,(STORED_BLOCK<<1)+(r?1:0),3),copy_block(e,t,n,!0)},_tr_align=function(e){send_bits(e,STATIC_TREES<<1,3),send_code(e,END_BLOCK,static_ltree),bi_flush(e)},_tr_flush_block=function(e,t,n,r){var i,o,a=0;e.level>0?(e.strm.data_type===Z_UNKNOWN&&(e.strm.data_type=detect_data_type(e)),build_tree(e,e.l_desc),build_tree(e,e.d_desc),a=build_bl_tree(e),i=e.opt_len+3+7>>>3,o=e.static_len+3+7>>>3,o<=i&&(i=o)):i=o=n+5,n+4<=i&&-1!==t?_tr_stored_block(e,t,n,r):e.strategy===Z_FIXED||o===i?(send_bits(e,(STATIC_TREES<<1)+(r?1:0),3),compress_block(e,static_ltree,static_dtree)):(send_bits(e,(DYN_TREES<<1)+(r?1:0),3),send_all_trees(e,e.l_desc.max_code+1,e.d_desc.max_code+1,a+1),compress_block(e,e.dyn_ltree,e.dyn_dtree)),init_block(e),r&&bi_windup(e)},_tr_tally=function(e,t,n){return e.pending_buf[e.d_buf+2*e.last_lit]=t>>>8&255,e.pending_buf[e.d_buf+2*e.last_lit+1]=255&t,e.pending_buf[e.l_buf+e.last_lit]=255&n,e.last_lit++,0===t?e.dyn_ltree[2*n]++:(e.matches++,t--,e.dyn_ltree[2*(_length_code[n]+LITERALS+1)]++,e.dyn_dtree[2*d_code(t)]++),e.last_lit===e.lit_bufsize-1},_tr_init_1=_tr_init,_tr_stored_block_1=_tr_stored_block,_tr_flush_block_1=_tr_flush_block,_tr_tally_1=_tr_tally,_tr_align_1=_tr_align,trees={_tr_init:_tr_init_1,_tr_stored_block:_tr_stored_block_1,_tr_flush_block:_tr_flush_block_1,_tr_tally:_tr_tally_1,_tr_align:_tr_align_1},adler32=function(e,t,n,r){for(var i=65535&e|0,o=e>>>16&65535|0,a=0;0!==n;){a=n>2e3?2e3:n,n-=a;do{i=i+t[r++]|0,o=o+i|0}while(--a);i%=65521,o%=65521}return i|o<<16|0},adler32_1=adler32,makeTable=function(){for(var e,t=[],n=0;n<256;n++){e=n;for(var r=0;r<8;r++)e=1&e?3988292384^e>>>1:e>>>1;t[n]=e}return t},crcTable=new Uint32Array(makeTable()),crc32=function(e,t,n,r){var i=crcTable,o=r+n;e^=-1;for(var a=r;a<o;a++)e=e>>>8^i[255&(e^t[a])];return-1^e},crc32_1=crc32,messages={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},constants={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8},_tr_init$1=trees._tr_init,_tr_stored_block$1=trees._tr_stored_block,_tr_flush_block$1=trees._tr_flush_block,_tr_tally$1=trees._tr_tally,_tr_align$1=trees._tr_align,Z_NO_FLUSH=constants.Z_NO_FLUSH,Z_PARTIAL_FLUSH=constants.Z_PARTIAL_FLUSH,Z_FULL_FLUSH=constants.Z_FULL_FLUSH,Z_FINISH=constants.Z_FINISH,Z_BLOCK=constants.Z_BLOCK,Z_OK=constants.Z_OK,Z_STREAM_END=constants.Z_STREAM_END,Z_STREAM_ERROR=constants.Z_STREAM_ERROR,Z_DATA_ERROR=constants.Z_DATA_ERROR,Z_BUF_ERROR=constants.Z_BUF_ERROR,Z_DEFAULT_COMPRESSION=constants.Z_DEFAULT_COMPRESSION,Z_FILTERED=constants.Z_FILTERED,Z_HUFFMAN_ONLY=constants.Z_HUFFMAN_ONLY,Z_RLE=constants.Z_RLE,Z_FIXED$1=constants.Z_FIXED,Z_DEFAULT_STRATEGY=constants.Z_DEFAULT_STRATEGY,Z_UNKNOWN$1=constants.Z_UNKNOWN,Z_DEFLATED=constants.Z_DEFLATED,MAX_MEM_LEVEL=9,MAX_WBITS=15,DEF_MEM_LEVEL=8,LENGTH_CODES$1=29,LITERALS$1=256,L_CODES$1=LITERALS$1+1+LENGTH_CODES$1,D_CODES$1=30,BL_CODES$1=19,HEAP_SIZE$1=2*L_CODES$1+1,MAX_BITS$1=15,MIN_MATCH$1=3,MAX_MATCH$1=258,MIN_LOOKAHEAD=MAX_MATCH$1+MIN_MATCH$1+1,PRESET_DICT=32,INIT_STATE=42,EXTRA_STATE=69,NAME_STATE=73,COMMENT_STATE=91,HCRC_STATE=103,BUSY_STATE=113,FINISH_STATE=666,BS_NEED_MORE=1,BS_BLOCK_DONE=2,BS_FINISH_STARTED=3,BS_FINISH_DONE=4,OS_CODE=3,err=function(e,t){return e.msg=messages[t],t},rank=function(e){return(e<<1)-(e>4?9:0)},zero$1$1=function(e){for(var t=e.length;--t>=0;)e[t]=0},HASH_ZLIB=function(e,t,n){return(t<<e.hash_shift^n)&e.hash_mask},HASH=HASH_ZLIB,flush_pending=function(e){var t=e.state,n=t.pending;n>e.avail_out&&(n=e.avail_out),0!==n&&(e.output.set(t.pending_buf.subarray(t.pending_out,t.pending_out+n),e.next_out),e.next_out+=n,t.pending_out+=n,e.total_out+=n,e.avail_out-=n,t.pending-=n,0===t.pending&&(t.pending_out=0))},flush_block_only=function(e,t){_tr_flush_block$1(e,e.block_start>=0?e.block_start:-1,e.strstart-e.block_start,t),e.block_start=e.strstart,flush_pending(e.strm)},put_byte=function(e,t){e.pending_buf[e.pending++]=t},putShortMSB=function(e,t){e.pending_buf[e.pending++]=t>>>8&255,e.pending_buf[e.pending++]=255&t},read_buf=function(e,t,n,r){var i=e.avail_in;return i>r&&(i=r),0===i?0:(e.avail_in-=i,t.set(e.input.subarray(e.next_in,e.next_in+i),n),1===e.state.wrap?e.adler=adler32_1(e.adler,t,i,n):2===e.state.wrap&&(e.adler=crc32_1(e.adler,t,i,n)),e.next_in+=i,e.total_in+=i,i)},longest_match=function(e,t){var n,r,i=e.max_chain_length,o=e.strstart,a=e.prev_length,s=e.nice_match,c=e.strstart>e.w_size-MIN_LOOKAHEAD?e.strstart-(e.w_size-MIN_LOOKAHEAD):0,u=e.window,l=e.w_mask,d=e.prev,f=e.strstart+MAX_MATCH$1,h=u[o+a-1],p=u[o+a];e.prev_length>=e.good_match&&(i>>=2),s>e.lookahead&&(s=e.lookahead);do{if(n=t,u[n+a]===p&&u[n+a-1]===h&&u[n]===u[o]&&u[++n]===u[o+1]){o+=2,n++;do{}while(u[++o]===u[++n]&&u[++o]===u[++n]&&u[++o]===u[++n]&&u[++o]===u[++n]&&u[++o]===u[++n]&&u[++o]===u[++n]&&u[++o]===u[++n]&&u[++o]===u[++n]&&o<f);if(r=MAX_MATCH$1-(f-o),o=f-MAX_MATCH$1,r>a){if(e.match_start=t,a=r,r>=s)break;h=u[o+a-1],p=u[o+a]}}}while((t=d[t&l])>c&&0!=--i);return a<=e.lookahead?a:e.lookahead},fill_window=function(e){var t,n,r,i,o,a=e.w_size;do{if(i=e.window_size-e.lookahead-e.strstart,e.strstart>=a+(a-MIN_LOOKAHEAD)){e.window.set(e.window.subarray(a,a+a),0),e.match_start-=a,e.strstart-=a,e.block_start-=a,n=e.hash_size,t=n;do{r=e.head[--t],e.head[t]=r>=a?r-a:0}while(--n);n=a,t=n;do{r=e.prev[--t],e.prev[t]=r>=a?r-a:0}while(--n);i+=a}if(0===e.strm.avail_in)break;if(n=read_buf(e.strm,e.window,e.strstart+e.lookahead,i),e.lookahead+=n,e.lookahead+e.insert>=MIN_MATCH$1)for(o=e.strstart-e.insert,e.ins_h=e.window[o],e.ins_h=HASH(e,e.ins_h,e.window[o+1]);e.insert&&(e.ins_h=HASH(e,e.ins_h,e.window[o+MIN_MATCH$1-1]),e.prev[o&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=o,o++,e.insert--,!(e.lookahead+e.insert<MIN_MATCH$1)););}while(e.lookahead<MIN_LOOKAHEAD&&0!==e.strm.avail_in)},deflate_stored=function(e,t){var n=65535;for(n>e.pending_buf_size-5&&(n=e.pending_buf_size-5);;){if(e.lookahead<=1){if(fill_window(e),0===e.lookahead&&t===Z_NO_FLUSH)return BS_NEED_MORE;if(0===e.lookahead)break}e.strstart+=e.lookahead,e.lookahead=0;var r=e.block_start+n;if((0===e.strstart||e.strstart>=r)&&(e.lookahead=e.strstart-r,e.strstart=r,flush_block_only(e,!1),0===e.strm.avail_out))return BS_NEED_MORE;if(e.strstart-e.block_start>=e.w_size-MIN_LOOKAHEAD&&(flush_block_only(e,!1),0===e.strm.avail_out))return BS_NEED_MORE}return e.insert=0,t===Z_FINISH?(flush_block_only(e,!0),0===e.strm.avail_out?BS_FINISH_STARTED:BS_FINISH_DONE):(e.strstart>e.block_start&&(flush_block_only(e,!1),e.strm.avail_out),BS_NEED_MORE)},deflate_fast=function(e,t){for(var n,r;;){if(e.lookahead<MIN_LOOKAHEAD){if(fill_window(e),e.lookahead<MIN_LOOKAHEAD&&t===Z_NO_FLUSH)return BS_NEED_MORE;if(0===e.lookahead)break}if(n=0,e.lookahead>=MIN_MATCH$1&&(e.ins_h=HASH(e,e.ins_h,e.window[e.strstart+MIN_MATCH$1-1]),n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),0!==n&&e.strstart-n<=e.w_size-MIN_LOOKAHEAD&&(e.match_length=longest_match(e,n)),e.match_length>=MIN_MATCH$1)if(r=_tr_tally$1(e,e.strstart-e.match_start,e.match_length-MIN_MATCH$1),e.lookahead-=e.match_length,e.match_length<=e.max_lazy_match&&e.lookahead>=MIN_MATCH$1){e.match_length--;do{e.strstart++,e.ins_h=HASH(e,e.ins_h,e.window[e.strstart+MIN_MATCH$1-1]),n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart}while(0!=--e.match_length);e.strstart++}else e.strstart+=e.match_length,e.match_length=0,e.ins_h=e.window[e.strstart],e.ins_h=HASH(e,e.ins_h,e.window[e.strstart+1]);else r=_tr_tally$1(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++;if(r&&(flush_block_only(e,!1),0===e.strm.avail_out))return BS_NEED_MORE}return e.insert=e.strstart<MIN_MATCH$1-1?e.strstart:MIN_MATCH$1-1,t===Z_FINISH?(flush_block_only(e,!0),0===e.strm.avail_out?BS_FINISH_STARTED:BS_FINISH_DONE):e.last_lit&&(flush_block_only(e,!1),0===e.strm.avail_out)?BS_NEED_MORE:BS_BLOCK_DONE},deflate_slow=function(e,t){for(var n,r,i;;){if(e.lookahead<MIN_LOOKAHEAD){if(fill_window(e),e.lookahead<MIN_LOOKAHEAD&&t===Z_NO_FLUSH)return BS_NEED_MORE;if(0===e.lookahead)break}if(n=0,e.lookahead>=MIN_MATCH$1&&(e.ins_h=HASH(e,e.ins_h,e.window[e.strstart+MIN_MATCH$1-1]),n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),e.prev_length=e.match_length,e.prev_match=e.match_start,e.match_length=MIN_MATCH$1-1,0!==n&&e.prev_length<e.max_lazy_match&&e.strstart-n<=e.w_size-MIN_LOOKAHEAD&&(e.match_length=longest_match(e,n),e.match_length<=5&&(e.strategy===Z_FILTERED||e.match_length===MIN_MATCH$1&&e.strstart-e.match_start>4096)&&(e.match_length=MIN_MATCH$1-1)),e.prev_length>=MIN_MATCH$1&&e.match_length<=e.prev_length){i=e.strstart+e.lookahead-MIN_MATCH$1,r=_tr_tally$1(e,e.strstart-1-e.prev_match,e.prev_length-MIN_MATCH$1),e.lookahead-=e.prev_length-1,e.prev_length-=2;do{++e.strstart<=i&&(e.ins_h=HASH(e,e.ins_h,e.window[e.strstart+MIN_MATCH$1-1]),n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart)}while(0!=--e.prev_length);if(e.match_available=0,e.match_length=MIN_MATCH$1-1,e.strstart++,r&&(flush_block_only(e,!1),0===e.strm.avail_out))return BS_NEED_MORE}else if(e.match_available){if(r=_tr_tally$1(e,0,e.window[e.strstart-1]),r&&flush_block_only(e,!1),e.strstart++,e.lookahead--,0===e.strm.avail_out)return BS_NEED_MORE}else e.match_available=1,e.strstart++,e.lookahead--}return e.match_available&&(r=_tr_tally$1(e,0,e.window[e.strstart-1]),e.match_available=0),e.insert=e.strstart<MIN_MATCH$1-1?e.strstart:MIN_MATCH$1-1,t===Z_FINISH?(flush_block_only(e,!0),0===e.strm.avail_out?BS_FINISH_STARTED:BS_FINISH_DONE):e.last_lit&&(flush_block_only(e,!1),0===e.strm.avail_out)?BS_NEED_MORE:BS_BLOCK_DONE},deflate_rle=function(e,t){for(var n,r,i,o,a=e.window;;){if(e.lookahead<=MAX_MATCH$1){if(fill_window(e),e.lookahead<=MAX_MATCH$1&&t===Z_NO_FLUSH)return BS_NEED_MORE;if(0===e.lookahead)break}if(e.match_length=0,e.lookahead>=MIN_MATCH$1&&e.strstart>0&&(i=e.strstart-1,r=a[i],r===a[++i]&&r===a[++i]&&r===a[++i])){o=e.strstart+MAX_MATCH$1;do{}while(r===a[++i]&&r===a[++i]&&r===a[++i]&&r===a[++i]&&r===a[++i]&&r===a[++i]&&r===a[++i]&&r===a[++i]&&i<o);e.match_length=MAX_MATCH$1-(o-i),e.match_length>e.lookahead&&(e.match_length=e.lookahead)}if(e.match_length>=MIN_MATCH$1?(n=_tr_tally$1(e,1,e.match_length-MIN_MATCH$1),e.lookahead-=e.match_length,e.strstart+=e.match_length,e.match_length=0):(n=_tr_tally$1(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++),n&&(flush_block_only(e,!1),0===e.strm.avail_out))return BS_NEED_MORE}return e.insert=0,t===Z_FINISH?(flush_block_only(e,!0),0===e.strm.avail_out?BS_FINISH_STARTED:BS_FINISH_DONE):e.last_lit&&(flush_block_only(e,!1),0===e.strm.avail_out)?BS_NEED_MORE:BS_BLOCK_DONE},deflate_huff=function(e,t){for(var n;;){if(0===e.lookahead&&(fill_window(e),0===e.lookahead)){if(t===Z_NO_FLUSH)return BS_NEED_MORE;break}if(e.match_length=0,n=_tr_tally$1(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++,n&&(flush_block_only(e,!1),0===e.strm.avail_out))return BS_NEED_MORE}return e.insert=0,t===Z_FINISH?(flush_block_only(e,!0),0===e.strm.avail_out?BS_FINISH_STARTED:BS_FINISH_DONE):e.last_lit&&(flush_block_only(e,!1),0===e.strm.avail_out)?BS_NEED_MORE:BS_BLOCK_DONE};function Config(e,t,n,r,i){this.good_length=e,this.max_lazy=t,this.nice_length=n,this.max_chain=r,this.func=i}var configuration_table=[new Config(0,0,0,0,deflate_stored),new Config(4,4,8,4,deflate_fast),new Config(4,5,16,8,deflate_fast),new Config(4,6,32,32,deflate_fast),new Config(4,4,16,16,deflate_slow),new Config(8,16,32,32,deflate_slow),new Config(8,16,128,128,deflate_slow),new Config(8,32,128,256,deflate_slow),new Config(32,128,258,1024,deflate_slow),new Config(32,258,258,4096,deflate_slow)],lm_init=function(e){e.window_size=2*e.w_size,zero$1$1(e.head),e.max_lazy_match=configuration_table[e.level].max_lazy,e.good_match=configuration_table[e.level].good_length,e.nice_match=configuration_table[e.level].nice_length,e.max_chain_length=configuration_table[e.level].max_chain,e.strstart=0,e.block_start=0,e.lookahead=0,e.insert=0,e.match_length=e.prev_length=MIN_MATCH$1-1,e.match_available=0,e.ins_h=0};function DeflateState(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=Z_DEFLATED,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new Uint16Array(2*HEAP_SIZE$1),this.dyn_dtree=new Uint16Array(2*(2*D_CODES$1+1)),this.bl_tree=new Uint16Array(2*(2*BL_CODES$1+1)),zero$1$1(this.dyn_ltree),zero$1$1(this.dyn_dtree),zero$1$1(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new Uint16Array(MAX_BITS$1+1),this.heap=new Uint16Array(2*L_CODES$1+1),zero$1$1(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new Uint16Array(2*L_CODES$1+1),zero$1$1(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}var deflateResetKeep=function(e){if(!e||!e.state)return err(e,Z_STREAM_ERROR);e.total_in=e.total_out=0,e.data_type=Z_UNKNOWN$1;var t=e.state;return t.pending=0,t.pending_out=0,t.wrap<0&&(t.wrap=-t.wrap),t.status=t.wrap?INIT_STATE:BUSY_STATE,e.adler=2===t.wrap?0:1,t.last_flush=Z_NO_FLUSH,_tr_init$1(t),Z_OK},deflateReset=function(e){var t=deflateResetKeep(e);return t===Z_OK&&lm_init(e.state),t},deflateSetHeader=function(e,t){return e&&e.state?2!==e.state.wrap?Z_STREAM_ERROR:(e.state.gzhead=t,Z_OK):Z_STREAM_ERROR},deflateInit2=function(e,t,n,r,i,o){if(!e)return Z_STREAM_ERROR;var a=1;if(t===Z_DEFAULT_COMPRESSION&&(t=6),r<0?(a=0,r=-r):r>15&&(a=2,r-=16),i<1||i>MAX_MEM_LEVEL||n!==Z_DEFLATED||r<8||r>15||t<0||t>9||o<0||o>Z_FIXED$1)return err(e,Z_STREAM_ERROR);8===r&&(r=9);var s=new DeflateState;return e.state=s,s.strm=e,s.wrap=a,s.gzhead=null,s.w_bits=r,s.w_size=1<<s.w_bits,s.w_mask=s.w_size-1,s.hash_bits=i+7,s.hash_size=1<<s.hash_bits,s.hash_mask=s.hash_size-1,s.hash_shift=~~((s.hash_bits+MIN_MATCH$1-1)/MIN_MATCH$1),s.window=new Uint8Array(2*s.w_size),s.head=new Uint16Array(s.hash_size),s.prev=new Uint16Array(s.w_size),s.lit_bufsize=1<<i+6,s.pending_buf_size=4*s.lit_bufsize,s.pending_buf=new Uint8Array(s.pending_buf_size),s.d_buf=1*s.lit_bufsize,s.l_buf=3*s.lit_bufsize,s.level=t,s.strategy=o,s.method=n,deflateReset(e)},deflateInit=function(e,t){return deflateInit2(e,t,Z_DEFLATED,MAX_WBITS,DEF_MEM_LEVEL,Z_DEFAULT_STRATEGY)},deflate=function(e,t){var n,r;if(!e||!e.state||t>Z_BLOCK||t<0)return e?err(e,Z_STREAM_ERROR):Z_STREAM_ERROR;var i=e.state;if(!e.output||!e.input&&0!==e.avail_in||i.status===FINISH_STATE&&t!==Z_FINISH)return err(e,0===e.avail_out?Z_BUF_ERROR:Z_STREAM_ERROR);i.strm=e;var o=i.last_flush;if(i.last_flush=t,i.status===INIT_STATE)if(2===i.wrap)e.adler=0,put_byte(i,31),put_byte(i,139),put_byte(i,8),i.gzhead?(put_byte(i,(i.gzhead.text?1:0)+(i.gzhead.hcrc?2:0)+(i.gzhead.extra?4:0)+(i.gzhead.name?8:0)+(i.gzhead.comment?16:0)),put_byte(i,255&i.gzhead.time),put_byte(i,i.gzhead.time>>8&255),put_byte(i,i.gzhead.time>>16&255),put_byte(i,i.gzhead.time>>24&255),put_byte(i,9===i.level?2:i.strategy>=Z_HUFFMAN_ONLY||i.level<2?4:0),put_byte(i,255&i.gzhead.os),i.gzhead.extra&&i.gzhead.extra.length&&(put_byte(i,255&i.gzhead.extra.length),put_byte(i,i.gzhead.extra.length>>8&255)),i.gzhead.hcrc&&(e.adler=crc32_1(e.adler,i.pending_buf,i.pending,0)),i.gzindex=0,i.status=EXTRA_STATE):(put_byte(i,0),put_byte(i,0),put_byte(i,0),put_byte(i,0),put_byte(i,0),put_byte(i,9===i.level?2:i.strategy>=Z_HUFFMAN_ONLY||i.level<2?4:0),put_byte(i,OS_CODE),i.status=BUSY_STATE);else{var a=Z_DEFLATED+(i.w_bits-8<<4)<<8,s=-1;s=i.strategy>=Z_HUFFMAN_ONLY||i.level<2?0:i.level<6?1:6===i.level?2:3,a|=s<<6,0!==i.strstart&&(a|=PRESET_DICT),a+=31-a%31,i.status=BUSY_STATE,putShortMSB(i,a),0!==i.strstart&&(putShortMSB(i,e.adler>>>16),putShortMSB(i,65535&e.adler)),e.adler=1}if(i.status===EXTRA_STATE)if(i.gzhead.extra){for(n=i.pending;i.gzindex<(65535&i.gzhead.extra.length)&&(i.pending!==i.pending_buf_size||(i.gzhead.hcrc&&i.pending>n&&(e.adler=crc32_1(e.adler,i.pending_buf,i.pending-n,n)),flush_pending(e),n=i.pending,i.pending!==i.pending_buf_size));)put_byte(i,255&i.gzhead.extra[i.gzindex]),i.gzindex++;i.gzhead.hcrc&&i.pending>n&&(e.adler=crc32_1(e.adler,i.pending_buf,i.pending-n,n)),i.gzindex===i.gzhead.extra.length&&(i.gzindex=0,i.status=NAME_STATE)}else i.status=NAME_STATE;if(i.status===NAME_STATE)if(i.gzhead.name){n=i.pending;do{if(i.pending===i.pending_buf_size&&(i.gzhead.hcrc&&i.pending>n&&(e.adler=crc32_1(e.adler,i.pending_buf,i.pending-n,n)),flush_pending(e),n=i.pending,i.pending===i.pending_buf_size)){r=1;break}r=i.gzindex<i.gzhead.name.length?255&i.gzhead.name.charCodeAt(i.gzindex++):0,put_byte(i,r)}while(0!==r);i.gzhead.hcrc&&i.pending>n&&(e.adler=crc32_1(e.adler,i.pending_buf,i.pending-n,n)),0===r&&(i.gzindex=0,i.status=COMMENT_STATE)}else i.status=COMMENT_STATE;if(i.status===COMMENT_STATE)if(i.gzhead.comment){n=i.pending;do{if(i.pending===i.pending_buf_size&&(i.gzhead.hcrc&&i.pending>n&&(e.adler=crc32_1(e.adler,i.pending_buf,i.pending-n,n)),flush_pending(e),n=i.pending,i.pending===i.pending_buf_size)){r=1;break}r=i.gzindex<i.gzhead.comment.length?255&i.gzhead.comment.charCodeAt(i.gzindex++):0,put_byte(i,r)}while(0!==r);i.gzhead.hcrc&&i.pending>n&&(e.adler=crc32_1(e.adler,i.pending_buf,i.pending-n,n)),0===r&&(i.status=HCRC_STATE)}else i.status=HCRC_STATE;if(i.status===HCRC_STATE&&(i.gzhead.hcrc?(i.pending+2>i.pending_buf_size&&flush_pending(e),i.pending+2<=i.pending_buf_size&&(put_byte(i,255&e.adler),put_byte(i,e.adler>>8&255),e.adler=0,i.status=BUSY_STATE)):i.status=BUSY_STATE),0!==i.pending){if(flush_pending(e),0===e.avail_out)return i.last_flush=-1,Z_OK}else if(0===e.avail_in&&rank(t)<=rank(o)&&t!==Z_FINISH)return err(e,Z_BUF_ERROR);if(i.status===FINISH_STATE&&0!==e.avail_in)return err(e,Z_BUF_ERROR);if(0!==e.avail_in||0!==i.lookahead||t!==Z_NO_FLUSH&&i.status!==FINISH_STATE){var c=i.strategy===Z_HUFFMAN_ONLY?deflate_huff(i,t):i.strategy===Z_RLE?deflate_rle(i,t):configuration_table[i.level].func(i,t);if(c!==BS_FINISH_STARTED&&c!==BS_FINISH_DONE||(i.status=FINISH_STATE),c===BS_NEED_MORE||c===BS_FINISH_STARTED)return 0===e.avail_out&&(i.last_flush=-1),Z_OK;if(c===BS_BLOCK_DONE&&(t===Z_PARTIAL_FLUSH?_tr_align$1(i):t!==Z_BLOCK&&(_tr_stored_block$1(i,0,0,!1),t===Z_FULL_FLUSH&&(zero$1$1(i.head),0===i.lookahead&&(i.strstart=0,i.block_start=0,i.insert=0))),flush_pending(e),0===e.avail_out))return i.last_flush=-1,Z_OK}return t!==Z_FINISH?Z_OK:i.wrap<=0?Z_STREAM_END:(2===i.wrap?(put_byte(i,255&e.adler),put_byte(i,e.adler>>8&255),put_byte(i,e.adler>>16&255),put_byte(i,e.adler>>24&255),put_byte(i,255&e.total_in),put_byte(i,e.total_in>>8&255),put_byte(i,e.total_in>>16&255),put_byte(i,e.total_in>>24&255)):(putShortMSB(i,e.adler>>>16),putShortMSB(i,65535&e.adler)),flush_pending(e),i.wrap>0&&(i.wrap=-i.wrap),0!==i.pending?Z_OK:Z_STREAM_END)},deflateEnd=function(e){if(!e||!e.state)return Z_STREAM_ERROR;var t=e.state.status;return t!==INIT_STATE&&t!==EXTRA_STATE&&t!==NAME_STATE&&t!==COMMENT_STATE&&t!==HCRC_STATE&&t!==BUSY_STATE&&t!==FINISH_STATE?err(e,Z_STREAM_ERROR):(e.state=null,t===BUSY_STATE?err(e,Z_DATA_ERROR):Z_OK)},deflateSetDictionary=function(e,t){var n=t.length;if(!e||!e.state)return Z_STREAM_ERROR;var r=e.state,i=r.wrap;if(2===i||1===i&&r.status!==INIT_STATE||r.lookahead)return Z_STREAM_ERROR;if(1===i&&(e.adler=adler32_1(e.adler,t,n,0)),r.wrap=0,n>=r.w_size){0===i&&(zero$1$1(r.head),r.strstart=0,r.block_start=0,r.insert=0);var o=new Uint8Array(r.w_size);o.set(t.subarray(n-r.w_size,n),0),t=o,n=r.w_size}var a=e.avail_in,s=e.next_in,c=e.input;for(e.avail_in=n,e.next_in=0,e.input=t,fill_window(r);r.lookahead>=MIN_MATCH$1;){var u=r.strstart,l=r.lookahead-(MIN_MATCH$1-1);do{r.ins_h=HASH(r,r.ins_h,r.window[u+MIN_MATCH$1-1]),r.prev[u&r.w_mask]=r.head[r.ins_h],r.head[r.ins_h]=u,u++}while(--l);r.strstart=u,r.lookahead=MIN_MATCH$1-1,fill_window(r)}return r.strstart+=r.lookahead,r.block_start=r.strstart,r.insert=r.lookahead,r.lookahead=0,r.match_length=r.prev_length=MIN_MATCH$1-1,r.match_available=0,e.next_in=s,e.input=c,e.avail_in=a,r.wrap=i,Z_OK},deflateInit_1=deflateInit,deflateInit2_1=deflateInit2,deflateReset_1=deflateReset,deflateResetKeep_1=deflateResetKeep,deflateSetHeader_1=deflateSetHeader,deflate_2=deflate,deflateEnd_1=deflateEnd,deflateSetDictionary_1=deflateSetDictionary,deflateInfo="pako deflate (from Nodeca project)",deflate_1={deflateInit:deflateInit_1,deflateInit2:deflateInit2_1,deflateReset:deflateReset_1,deflateResetKeep:deflateResetKeep_1,deflateSetHeader:deflateSetHeader_1,deflate:deflate_2,deflateEnd:deflateEnd_1,deflateSetDictionary:deflateSetDictionary_1,deflateInfo:deflateInfo},_has=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},assign=function(e){for(var t=Array.prototype.slice.call(arguments,1);t.length;){var n=t.shift();if(n){if("object"!=typeof n)throw new TypeError(n+"must be non-object");for(var r in n)_has(n,r)&&(e[r]=n[r])}}return e},flattenChunks=function(e){for(var t=0,n=0,r=e.length;n<r;n++)t+=e[n].length;for(var i=new Uint8Array(t),o=0,a=0,s=e.length;o<s;o++){var c=e[o];i.set(c,a),a+=c.length}return i},common$1={assign:assign,flattenChunks:flattenChunks},STR_APPLY_UIA_OK=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(e){STR_APPLY_UIA_OK=!1}for(var _utf8len=new Uint8Array(256),e=0;e<256;e++)_utf8len[e]=e>=252?6:e>=248?5:e>=240?4:e>=224?3:e>=192?2:1;_utf8len[254]=_utf8len[254]=1;var string2buf=function(e){var t,n,r,i,o,a=e.length,s=0;for(i=0;i<a;i++)n=e.charCodeAt(i),55296==(64512&n)&&i+1<a&&(r=e.charCodeAt(i+1),56320==(64512&r)&&(n=65536+(n-55296<<10)+(r-56320),i++)),s+=n<128?1:n<2048?2:n<65536?3:4;for(t=new Uint8Array(s),o=0,i=0;o<s;i++)n=e.charCodeAt(i),55296==(64512&n)&&i+1<a&&(r=e.charCodeAt(i+1),56320==(64512&r)&&(n=65536+(n-55296<<10)+(r-56320),i++)),n<128?t[o++]=n:n<2048?(t[o++]=192|n>>>6,t[o++]=128|63&n):n<65536?(t[o++]=224|n>>>12,t[o++]=128|n>>>6&63,t[o++]=128|63&n):(t[o++]=240|n>>>18,t[o++]=128|n>>>12&63,t[o++]=128|n>>>6&63,t[o++]=128|63&n);return t},buf2binstring=function(e,t){if(t<65534&&e.subarray&&STR_APPLY_UIA_OK)return String.fromCharCode.apply(null,e.length===t?e:e.subarray(0,t));for(var n="",r=0;r<t;r++)n+=String.fromCharCode(e[r]);return n},buf2string=function(e,t){var n,r,i=t||e.length,o=new Array(2*i);for(r=0,n=0;n<i;){var a=e[n++];if(a<128)o[r++]=a;else{var s=_utf8len[a];if(s>4)o[r++]=65533,n+=s-1;else{for(a&=2===s?31:3===s?15:7;s>1&&n<i;)a=a<<6|63&e[n++],s--;s>1?o[r++]=65533:a<65536?o[r++]=a:(a-=65536,o[r++]=55296|a>>10&1023,o[r++]=56320|1023&a)}}}return buf2binstring(o,r)},utf8border=function(e,t){(t=t||e.length)>e.length&&(t=e.length);for(var n=t-1;n>=0&&128==(192&e[n]);)n--;return n<0||0===n?t:n+_utf8len[e[n]]>t?n:t},strings={string2buf:string2buf,buf2string:buf2string,utf8border:utf8border};function ZStream(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}var zstream=ZStream,toString$1=Object.prototype.toString,Z_NO_FLUSH$1=constants.Z_NO_FLUSH,Z_SYNC_FLUSH=constants.Z_SYNC_FLUSH,Z_FULL_FLUSH$1=constants.Z_FULL_FLUSH,Z_FINISH$1=constants.Z_FINISH,Z_OK$1=constants.Z_OK,Z_STREAM_END$1=constants.Z_STREAM_END,Z_DEFAULT_COMPRESSION$1=constants.Z_DEFAULT_COMPRESSION,Z_DEFAULT_STRATEGY$1=constants.Z_DEFAULT_STRATEGY,Z_DEFLATED$1=constants.Z_DEFLATED;function Deflate(e){this.options=common$1.assign({level:Z_DEFAULT_COMPRESSION$1,method:Z_DEFLATED$1,chunkSize:16384,windowBits:15,memLevel:8,strategy:Z_DEFAULT_STRATEGY$1},e||{});var t=this.options;t.raw&&t.windowBits>0?t.windowBits=-t.windowBits:t.gzip&&t.windowBits>0&&t.windowBits<16&&(t.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new zstream,this.strm.avail_out=0;var n=deflate_1.deflateInit2(this.strm,t.level,t.method,t.windowBits,t.memLevel,t.strategy);if(n!==Z_OK$1)throw new Error(messages[n]);if(t.header&&deflate_1.deflateSetHeader(this.strm,t.header),t.dictionary){var r;if(r="string"==typeof t.dictionary?strings.string2buf(t.dictionary):"[object ArrayBuffer]"===toString$1.call(t.dictionary)?new Uint8Array(t.dictionary):t.dictionary,n=deflate_1.deflateSetDictionary(this.strm,r),n!==Z_OK$1)throw new Error(messages[n]);this._dict_set=!0}}function deflate$1(e,t){var n=new Deflate(t);if(n.push(e,!0),n.err)throw n.msg||messages[n.err];return n.result}function deflateRaw(e,t){return(t=t||{}).raw=!0,deflate$1(e,t)}function gzip(e,t){return(t=t||{}).gzip=!0,deflate$1(e,t)}Deflate.prototype.push=function(e,t){var n,r,i=this.strm,o=this.options.chunkSize;if(this.ended)return!1;for(r=t===~~t?t:!0===t?Z_FINISH$1:Z_NO_FLUSH$1,"string"==typeof e?i.input=strings.string2buf(e):"[object ArrayBuffer]"===toString$1.call(e)?i.input=new Uint8Array(e):i.input=e,i.next_in=0,i.avail_in=i.input.length;;)if(0===i.avail_out&&(i.output=new Uint8Array(o),i.next_out=0,i.avail_out=o),(r===Z_SYNC_FLUSH||r===Z_FULL_FLUSH$1)&&i.avail_out<=6)this.onData(i.output.subarray(0,i.next_out)),i.avail_out=0;else{if(n=deflate_1.deflate(i,r),n===Z_STREAM_END$1)return i.next_out>0&&this.onData(i.output.subarray(0,i.next_out)),n=deflate_1.deflateEnd(this.strm),this.onEnd(n),this.ended=!0,n===Z_OK$1;if(0!==i.avail_out){if(r>0&&i.next_out>0)this.onData(i.output.subarray(0,i.next_out)),i.avail_out=0;else if(0===i.avail_in)break}else this.onData(i.output)}return!0},Deflate.prototype.onData=function(e){this.chunks.push(e)},Deflate.prototype.onEnd=function(e){e===Z_OK$1&&(this.result=common$1.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};var deflate_1$1={Deflate:Deflate,deflate:deflate$1,deflateRaw:deflateRaw,gzip:gzip,constants:constants},BAD=30,TYPE=12,inffast=function(e,t){var n,r,i,o,a,s,c,u,l,d,f,h,p,_,v,g,b,m,y,E,w,T,R,S,I=e.state;n=e.next_in,R=e.input,r=n+(e.avail_in-5),i=e.next_out,S=e.output,o=i-(t-e.avail_out),a=i+(e.avail_out-257),s=I.dmax,c=I.wsize,u=I.whave,l=I.wnext,d=I.window,f=I.hold,h=I.bits,p=I.lencode,_=I.distcode,v=(1<<I.lenbits)-1,g=(1<<I.distbits)-1;e:do{h<15&&(f+=R[n++]<<h,h+=8,f+=R[n++]<<h,h+=8),b=p[f&v];t:for(;;){if(m=b>>>24,f>>>=m,h-=m,m=b>>>16&255,0===m)S[i++]=65535&b;else{if(!(16&m)){if(0==(64&m)){b=p[(65535&b)+(f&(1<<m)-1)];continue t}if(32&m){I.mode=TYPE;break e}e.msg="invalid literal/length code",I.mode=BAD;break e}y=65535&b,m&=15,m&&(h<m&&(f+=R[n++]<<h,h+=8),y+=f&(1<<m)-1,f>>>=m,h-=m),h<15&&(f+=R[n++]<<h,h+=8,f+=R[n++]<<h,h+=8),b=_[f&g];n:for(;;){if(m=b>>>24,f>>>=m,h-=m,m=b>>>16&255,!(16&m)){if(0==(64&m)){b=_[(65535&b)+(f&(1<<m)-1)];continue n}e.msg="invalid distance code",I.mode=BAD;break e}if(E=65535&b,m&=15,h<m&&(f+=R[n++]<<h,h+=8,h<m&&(f+=R[n++]<<h,h+=8)),E+=f&(1<<m)-1,E>s){e.msg="invalid distance too far back",I.mode=BAD;break e}if(f>>>=m,h-=m,m=i-o,E>m){if(m=E-m,m>u&&I.sane){e.msg="invalid distance too far back",I.mode=BAD;break e}if(w=0,T=d,0===l){if(w+=c-m,m<y){y-=m;do{S[i++]=d[w++]}while(--m);w=i-E,T=S}}else if(l<m){if(w+=c+l-m,m-=l,m<y){y-=m;do{S[i++]=d[w++]}while(--m);if(w=0,l<y){m=l,y-=m;do{S[i++]=d[w++]}while(--m);w=i-E,T=S}}}else if(w+=l-m,m<y){y-=m;do{S[i++]=d[w++]}while(--m);w=i-E,T=S}for(;y>2;)S[i++]=T[w++],S[i++]=T[w++],S[i++]=T[w++],y-=3;y&&(S[i++]=T[w++],y>1&&(S[i++]=T[w++]))}else{w=i-E;do{S[i++]=S[w++],S[i++]=S[w++],S[i++]=S[w++],y-=3}while(y>2);y&&(S[i++]=S[w++],y>1&&(S[i++]=S[w++]))}break}}break}}while(n<r&&i<a);y=h>>3,n-=y,h-=y<<3,f&=(1<<h)-1,e.next_in=n,e.next_out=i,e.avail_in=n<r?r-n+5:5-(n-r),e.avail_out=i<a?a-i+257:257-(i-a),I.hold=f,I.bits=h},MAXBITS=15,ENOUGH_LENS=852,ENOUGH_DISTS=592,CODES=0,LENS=1,DISTS=2,lbase=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),lext=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),dbase=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),dext=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]),inflate_table=function(e,t,n,r,i,o,a,s){var c,u,l,d,f,h,p,_,v,g=s.bits,b=0,m=0,y=0,E=0,w=0,T=0,R=0,S=0,I=0,O=0,A=null,C=0,k=new Uint16Array(MAXBITS+1),N=new Uint16Array(MAXBITS+1),L=null,M=0;for(b=0;b<=MAXBITS;b++)k[b]=0;for(m=0;m<r;m++)k[t[n+m]]++;for(w=g,E=MAXBITS;E>=1&&0===k[E];E--);if(w>E&&(w=E),0===E)return i[o++]=20971520,i[o++]=20971520,s.bits=1,0;for(y=1;y<E&&0===k[y];y++);for(w<y&&(w=y),S=1,b=1;b<=MAXBITS;b++)if(S<<=1,S-=k[b],S<0)return-1;if(S>0&&(e===CODES||1!==E))return-1;for(N[1]=0,b=1;b<MAXBITS;b++)N[b+1]=N[b]+k[b];for(m=0;m<r;m++)0!==t[n+m]&&(a[N[t[n+m]]++]=m);if(e===CODES?(A=L=a,h=19):e===LENS?(A=lbase,C-=257,L=lext,M-=257,h=256):(A=dbase,L=dext,h=-1),O=0,m=0,b=y,f=o,T=w,R=0,l=-1,I=1<<w,d=I-1,e===LENS&&I>ENOUGH_LENS||e===DISTS&&I>ENOUGH_DISTS)return 1;for(;;){p=b-R,a[m]<h?(_=0,v=a[m]):a[m]>h?(_=L[M+a[m]],v=A[C+a[m]]):(_=96,v=0),c=1<<b-R,u=1<<T,y=u;do{u-=c,i[f+(O>>R)+u]=p<<24|_<<16|v|0}while(0!==u);for(c=1<<b-1;O&c;)c>>=1;if(0!==c?(O&=c-1,O+=c):O=0,m++,0==--k[b]){if(b===E)break;b=t[n+a[m]]}if(b>w&&(O&d)!==l){for(0===R&&(R=w),f+=y,T=b-R,S=1<<T;T+R<E&&(S-=k[T+R],!(S<=0));)T++,S<<=1;if(I+=1<<T,e===LENS&&I>ENOUGH_LENS||e===DISTS&&I>ENOUGH_DISTS)return 1;l=O&d,i[l]=w<<24|T<<16|f-o|0}}return 0!==O&&(i[f+O]=b-R<<24|64<<16|0),s.bits=w,0},inftrees=inflate_table,CODES$1=0,LENS$1=1,DISTS$1=2,Z_FINISH$2=constants.Z_FINISH,Z_BLOCK$1=constants.Z_BLOCK,Z_TREES=constants.Z_TREES,Z_OK$2=constants.Z_OK,Z_STREAM_END$2=constants.Z_STREAM_END,Z_NEED_DICT=constants.Z_NEED_DICT,Z_STREAM_ERROR$1=constants.Z_STREAM_ERROR,Z_DATA_ERROR$1=constants.Z_DATA_ERROR,Z_MEM_ERROR=constants.Z_MEM_ERROR,Z_BUF_ERROR$1=constants.Z_BUF_ERROR,Z_DEFLATED$2=constants.Z_DEFLATED,HEAD=1,FLAGS=2,TIME=3,OS=4,EXLEN=5,EXTRA=6,NAME=7,COMMENT=8,HCRC=9,DICTID=10,DICT=11,TYPE$1=12,TYPEDO=13,STORED=14,COPY_=15,COPY=16,TABLE=17,LENLENS=18,CODELENS=19,LEN_=20,LEN=21,LENEXT=22,DIST=23,DISTEXT=24,MATCH=25,LIT=26,CHECK=27,LENGTH=28,DONE=29,BAD$1=30,MEM=31,SYNC=32,ENOUGH_LENS$1=852,ENOUGH_DISTS$1=592,MAX_WBITS$1=15,DEF_WBITS=MAX_WBITS$1,zswap32=function(e){return(e>>>24&255)+(e>>>8&65280)+((65280&e)<<8)+((255&e)<<24)};function InflateState(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}var inflateResetKeep=function(e){if(!e||!e.state)return Z_STREAM_ERROR$1;var t=e.state;return e.total_in=e.total_out=t.total=0,e.msg="",t.wrap&&(e.adler=1&t.wrap),t.mode=HEAD,t.last=0,t.havedict=0,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new Int32Array(ENOUGH_LENS$1),t.distcode=t.distdyn=new Int32Array(ENOUGH_DISTS$1),t.sane=1,t.back=-1,Z_OK$2},inflateReset=function(e){if(!e||!e.state)return Z_STREAM_ERROR$1;var t=e.state;return t.wsize=0,t.whave=0,t.wnext=0,inflateResetKeep(e)},inflateReset2=function(e,t){var n;if(!e||!e.state)return Z_STREAM_ERROR$1;var r=e.state;return t<0?(n=0,t=-t):(n=1+(t>>4),t<48&&(t&=15)),t&&(t<8||t>15)?Z_STREAM_ERROR$1:(null!==r.window&&r.wbits!==t&&(r.window=null),r.wrap=n,r.wbits=t,inflateReset(e))},inflateInit2=function(e,t){if(!e)return Z_STREAM_ERROR$1;var n=new InflateState;e.state=n,n.window=null;var r=inflateReset2(e,t);return r!==Z_OK$2&&(e.state=null),r},inflateInit=function(e){return inflateInit2(e,DEF_WBITS)},virgin=!0,lenfix,distfix,fixedtables=function(e){if(virgin){lenfix=new Int32Array(512),distfix=new Int32Array(32);for(var t=0;t<144;)e.lens[t++]=8;for(;t<256;)e.lens[t++]=9;for(;t<280;)e.lens[t++]=7;for(;t<288;)e.lens[t++]=8;for(inftrees(LENS$1,e.lens,0,288,lenfix,0,e.work,{bits:9}),t=0;t<32;)e.lens[t++]=5;inftrees(DISTS$1,e.lens,0,32,distfix,0,e.work,{bits:5}),virgin=!1}e.lencode=lenfix,e.lenbits=9,e.distcode=distfix,e.distbits=5},updatewindow=function(e,t,n,r){var i,o=e.state;return null===o.window&&(o.wsize=1<<o.wbits,o.wnext=0,o.whave=0,o.window=new Uint8Array(o.wsize)),r>=o.wsize?(o.window.set(t.subarray(n-o.wsize,n),0),o.wnext=0,o.whave=o.wsize):(i=o.wsize-o.wnext,i>r&&(i=r),o.window.set(t.subarray(n-r,n-r+i),o.wnext),(r-=i)?(o.window.set(t.subarray(n-r,n),0),o.wnext=r,o.whave=o.wsize):(o.wnext+=i,o.wnext===o.wsize&&(o.wnext=0),o.whave<o.wsize&&(o.whave+=i))),0},inflate=function(e,t){var n,r,i,o,a,s,c,u,l,d,f,h,p,_,v,g,b,m,y,E,w,T,R,S,I=0,O=new Uint8Array(4),A=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(!e||!e.state||!e.output||!e.input&&0!==e.avail_in)return Z_STREAM_ERROR$1;n=e.state,n.mode===TYPE$1&&(n.mode=TYPEDO),a=e.next_out,i=e.output,c=e.avail_out,o=e.next_in,r=e.input,s=e.avail_in,u=n.hold,l=n.bits,d=s,f=c,T=Z_OK$2;e:for(;;)switch(n.mode){case HEAD:if(0===n.wrap){n.mode=TYPEDO;break}for(;l<16;){if(0===s)break e;s--,u+=r[o++]<<l,l+=8}if(2&n.wrap&&35615===u){n.check=0,O[0]=255&u,O[1]=u>>>8&255,n.check=crc32_1(n.check,O,2,0),u=0,l=0,n.mode=FLAGS;break}if(n.flags=0,n.head&&(n.head.done=!1),!(1&n.wrap)||(((255&u)<<8)+(u>>8))%31){e.msg="incorrect header check",n.mode=BAD$1;break}if((15&u)!==Z_DEFLATED$2){e.msg="unknown compression method",n.mode=BAD$1;break}if(u>>>=4,l-=4,w=8+(15&u),0===n.wbits)n.wbits=w;else if(w>n.wbits){e.msg="invalid window size",n.mode=BAD$1;break}n.dmax=1<<n.wbits,e.adler=n.check=1,n.mode=512&u?DICTID:TYPE$1,u=0,l=0;break;case FLAGS:for(;l<16;){if(0===s)break e;s--,u+=r[o++]<<l,l+=8}if(n.flags=u,(255&n.flags)!==Z_DEFLATED$2){e.msg="unknown compression method",n.mode=BAD$1;break}if(57344&n.flags){e.msg="unknown header flags set",n.mode=BAD$1;break}n.head&&(n.head.text=u>>8&1),512&n.flags&&(O[0]=255&u,O[1]=u>>>8&255,n.check=crc32_1(n.check,O,2,0)),u=0,l=0,n.mode=TIME;case TIME:for(;l<32;){if(0===s)break e;s--,u+=r[o++]<<l,l+=8}n.head&&(n.head.time=u),512&n.flags&&(O[0]=255&u,O[1]=u>>>8&255,O[2]=u>>>16&255,O[3]=u>>>24&255,n.check=crc32_1(n.check,O,4,0)),u=0,l=0,n.mode=OS;case OS:for(;l<16;){if(0===s)break e;s--,u+=r[o++]<<l,l+=8}n.head&&(n.head.xflags=255&u,n.head.os=u>>8),512&n.flags&&(O[0]=255&u,O[1]=u>>>8&255,n.check=crc32_1(n.check,O,2,0)),u=0,l=0,n.mode=EXLEN;case EXLEN:if(1024&n.flags){for(;l<16;){if(0===s)break e;s--,u+=r[o++]<<l,l+=8}n.length=u,n.head&&(n.head.extra_len=u),512&n.flags&&(O[0]=255&u,O[1]=u>>>8&255,n.check=crc32_1(n.check,O,2,0)),u=0,l=0}else n.head&&(n.head.extra=null);n.mode=EXTRA;case EXTRA:if(1024&n.flags&&(h=n.length,h>s&&(h=s),h&&(n.head&&(w=n.head.extra_len-n.length,n.head.extra||(n.head.extra=new Uint8Array(n.head.extra_len)),n.head.extra.set(r.subarray(o,o+h),w)),512&n.flags&&(n.check=crc32_1(n.check,r,h,o)),s-=h,o+=h,n.length-=h),n.length))break e;n.length=0,n.mode=NAME;case NAME:if(2048&n.flags){if(0===s)break e;h=0;do{w=r[o+h++],n.head&&w&&n.length<65536&&(n.head.name+=String.fromCharCode(w))}while(w&&h<s);if(512&n.flags&&(n.check=crc32_1(n.check,r,h,o)),s-=h,o+=h,w)break e}else n.head&&(n.head.name=null);n.length=0,n.mode=COMMENT;case COMMENT:if(4096&n.flags){if(0===s)break e;h=0;do{w=r[o+h++],n.head&&w&&n.length<65536&&(n.head.comment+=String.fromCharCode(w))}while(w&&h<s);if(512&n.flags&&(n.check=crc32_1(n.check,r,h,o)),s-=h,o+=h,w)break e}else n.head&&(n.head.comment=null);n.mode=HCRC;case HCRC:if(512&n.flags){for(;l<16;){if(0===s)break e;s--,u+=r[o++]<<l,l+=8}if(u!==(65535&n.check)){e.msg="header crc mismatch",n.mode=BAD$1;break}u=0,l=0}n.head&&(n.head.hcrc=n.flags>>9&1,n.head.done=!0),e.adler=n.check=0,n.mode=TYPE$1;break;case DICTID:for(;l<32;){if(0===s)break e;s--,u+=r[o++]<<l,l+=8}e.adler=n.check=zswap32(u),u=0,l=0,n.mode=DICT;case DICT:if(0===n.havedict)return e.next_out=a,e.avail_out=c,e.next_in=o,e.avail_in=s,n.hold=u,n.bits=l,Z_NEED_DICT;e.adler=n.check=1,n.mode=TYPE$1;case TYPE$1:if(t===Z_BLOCK$1||t===Z_TREES)break e;case TYPEDO:if(n.last){u>>>=7&l,l-=7&l,n.mode=CHECK;break}for(;l<3;){if(0===s)break e;s--,u+=r[o++]<<l,l+=8}switch(n.last=1&u,u>>>=1,l-=1,3&u){case 0:n.mode=STORED;break;case 1:if(fixedtables(n),n.mode=LEN_,t===Z_TREES){u>>>=2,l-=2;break e}break;case 2:n.mode=TABLE;break;case 3:e.msg="invalid block type",n.mode=BAD$1}u>>>=2,l-=2;break;case STORED:for(u>>>=7&l,l-=7&l;l<32;){if(0===s)break e;s--,u+=r[o++]<<l,l+=8}if((65535&u)!=(u>>>16^65535)){e.msg="invalid stored block lengths",n.mode=BAD$1;break}if(n.length=65535&u,u=0,l=0,n.mode=COPY_,t===Z_TREES)break e;case COPY_:n.mode=COPY;case COPY:if(h=n.length,h){if(h>s&&(h=s),h>c&&(h=c),0===h)break e;i.set(r.subarray(o,o+h),a),s-=h,o+=h,c-=h,a+=h,n.length-=h;break}n.mode=TYPE$1;break;case TABLE:for(;l<14;){if(0===s)break e;s--,u+=r[o++]<<l,l+=8}if(n.nlen=257+(31&u),u>>>=5,l-=5,n.ndist=1+(31&u),u>>>=5,l-=5,n.ncode=4+(15&u),u>>>=4,l-=4,n.nlen>286||n.ndist>30){e.msg="too many length or distance symbols",n.mode=BAD$1;break}n.have=0,n.mode=LENLENS;case LENLENS:for(;n.have<n.ncode;){for(;l<3;){if(0===s)break e;s--,u+=r[o++]<<l,l+=8}n.lens[A[n.have++]]=7&u,u>>>=3,l-=3}for(;n.have<19;)n.lens[A[n.have++]]=0;if(n.lencode=n.lendyn,n.lenbits=7,R={bits:n.lenbits},T=inftrees(CODES$1,n.lens,0,19,n.lencode,0,n.work,R),n.lenbits=R.bits,T){e.msg="invalid code lengths set",n.mode=BAD$1;break}n.have=0,n.mode=CODELENS;case CODELENS:for(;n.have<n.nlen+n.ndist;){for(;I=n.lencode[u&(1<<n.lenbits)-1],v=I>>>24,g=I>>>16&255,b=65535&I,!(v<=l);){if(0===s)break e;s--,u+=r[o++]<<l,l+=8}if(b<16)u>>>=v,l-=v,n.lens[n.have++]=b;else{if(16===b){for(S=v+2;l<S;){if(0===s)break e;s--,u+=r[o++]<<l,l+=8}if(u>>>=v,l-=v,0===n.have){e.msg="invalid bit length repeat",n.mode=BAD$1;break}w=n.lens[n.have-1],h=3+(3&u),u>>>=2,l-=2}else if(17===b){for(S=v+3;l<S;){if(0===s)break e;s--,u+=r[o++]<<l,l+=8}u>>>=v,l-=v,w=0,h=3+(7&u),u>>>=3,l-=3}else{for(S=v+7;l<S;){if(0===s)break e;s--,u+=r[o++]<<l,l+=8}u>>>=v,l-=v,w=0,h=11+(127&u),u>>>=7,l-=7}if(n.have+h>n.nlen+n.ndist){e.msg="invalid bit length repeat",n.mode=BAD$1;break}for(;h--;)n.lens[n.have++]=w}}if(n.mode===BAD$1)break;if(0===n.lens[256]){e.msg="invalid code -- missing end-of-block",n.mode=BAD$1;break}if(n.lenbits=9,R={bits:n.lenbits},T=inftrees(LENS$1,n.lens,0,n.nlen,n.lencode,0,n.work,R),n.lenbits=R.bits,T){e.msg="invalid literal/lengths set",n.mode=BAD$1;break}if(n.distbits=6,n.distcode=n.distdyn,R={bits:n.distbits},T=inftrees(DISTS$1,n.lens,n.nlen,n.ndist,n.distcode,0,n.work,R),n.distbits=R.bits,T){e.msg="invalid distances set",n.mode=BAD$1;break}if(n.mode=LEN_,t===Z_TREES)break e;case LEN_:n.mode=LEN;case LEN:if(s>=6&&c>=258){e.next_out=a,e.avail_out=c,e.next_in=o,e.avail_in=s,n.hold=u,n.bits=l,inffast(e,f),a=e.next_out,i=e.output,c=e.avail_out,o=e.next_in,r=e.input,s=e.avail_in,u=n.hold,l=n.bits,n.mode===TYPE$1&&(n.back=-1);break}for(n.back=0;I=n.lencode[u&(1<<n.lenbits)-1],v=I>>>24,g=I>>>16&255,b=65535&I,!(v<=l);){if(0===s)break e;s--,u+=r[o++]<<l,l+=8}if(g&&0==(240&g)){for(m=v,y=g,E=b;I=n.lencode[E+((u&(1<<m+y)-1)>>m)],v=I>>>24,g=I>>>16&255,b=65535&I,!(m+v<=l);){if(0===s)break e;s--,u+=r[o++]<<l,l+=8}u>>>=m,l-=m,n.back+=m}if(u>>>=v,l-=v,n.back+=v,n.length=b,0===g){n.mode=LIT;break}if(32&g){n.back=-1,n.mode=TYPE$1;break}if(64&g){e.msg="invalid literal/length code",n.mode=BAD$1;break}n.extra=15&g,n.mode=LENEXT;case LENEXT:if(n.extra){for(S=n.extra;l<S;){if(0===s)break e;s--,u+=r[o++]<<l,l+=8}n.length+=u&(1<<n.extra)-1,u>>>=n.extra,l-=n.extra,n.back+=n.extra}n.was=n.length,n.mode=DIST;case DIST:for(;I=n.distcode[u&(1<<n.distbits)-1],v=I>>>24,g=I>>>16&255,b=65535&I,!(v<=l);){if(0===s)break e;s--,u+=r[o++]<<l,l+=8}if(0==(240&g)){for(m=v,y=g,E=b;I=n.distcode[E+((u&(1<<m+y)-1)>>m)],v=I>>>24,g=I>>>16&255,b=65535&I,!(m+v<=l);){if(0===s)break e;s--,u+=r[o++]<<l,l+=8}u>>>=m,l-=m,n.back+=m}if(u>>>=v,l-=v,n.back+=v,64&g){e.msg="invalid distance code",n.mode=BAD$1;break}n.offset=b,n.extra=15&g,n.mode=DISTEXT;case DISTEXT:if(n.extra){for(S=n.extra;l<S;){if(0===s)break e;s--,u+=r[o++]<<l,l+=8}n.offset+=u&(1<<n.extra)-1,u>>>=n.extra,l-=n.extra,n.back+=n.extra}if(n.offset>n.dmax){e.msg="invalid distance too far back",n.mode=BAD$1;break}n.mode=MATCH;case MATCH:if(0===c)break e;if(h=f-c,n.offset>h){if(h=n.offset-h,h>n.whave&&n.sane){e.msg="invalid distance too far back",n.mode=BAD$1;break}h>n.wnext?(h-=n.wnext,p=n.wsize-h):p=n.wnext-h,h>n.length&&(h=n.length),_=n.window}else _=i,p=a-n.offset,h=n.length;h>c&&(h=c),c-=h,n.length-=h;do{i[a++]=_[p++]}while(--h);0===n.length&&(n.mode=LEN);break;case LIT:if(0===c)break e;i[a++]=n.length,c--,n.mode=LEN;break;case CHECK:if(n.wrap){for(;l<32;){if(0===s)break e;s--,u|=r[o++]<<l,l+=8}if(f-=c,e.total_out+=f,n.total+=f,f&&(e.adler=n.check=n.flags?crc32_1(n.check,i,f,a-f):adler32_1(n.check,i,f,a-f)),f=c,(n.flags?u:zswap32(u))!==n.check){e.msg="incorrect data check",n.mode=BAD$1;break}u=0,l=0}n.mode=LENGTH;case LENGTH:if(n.wrap&&n.flags){for(;l<32;){if(0===s)break e;s--,u+=r[o++]<<l,l+=8}if(u!==(4294967295&n.total)){e.msg="incorrect length check",n.mode=BAD$1;break}u=0,l=0}n.mode=DONE;case DONE:T=Z_STREAM_END$2;break e;case BAD$1:T=Z_DATA_ERROR$1;break e;case MEM:return Z_MEM_ERROR;case SYNC:default:return Z_STREAM_ERROR$1}return e.next_out=a,e.avail_out=c,e.next_in=o,e.avail_in=s,n.hold=u,n.bits=l,(n.wsize||f!==e.avail_out&&n.mode<BAD$1&&(n.mode<CHECK||t!==Z_FINISH$2))&&updatewindow(e,e.output,e.next_out,f-e.avail_out),d-=e.avail_in,f-=e.avail_out,e.total_in+=d,e.total_out+=f,n.total+=f,n.wrap&&f&&(e.adler=n.check=n.flags?crc32_1(n.check,i,f,e.next_out-f):adler32_1(n.check,i,f,e.next_out-f)),e.data_type=n.bits+(n.last?64:0)+(n.mode===TYPE$1?128:0)+(n.mode===LEN_||n.mode===COPY_?256:0),(0===d&&0===f||t===Z_FINISH$2)&&T===Z_OK$2&&(T=Z_BUF_ERROR$1),T},inflateEnd=function(e){if(!e||!e.state)return Z_STREAM_ERROR$1;var t=e.state;return t.window&&(t.window=null),e.state=null,Z_OK$2},inflateGetHeader=function(e,t){if(!e||!e.state)return Z_STREAM_ERROR$1;var n=e.state;return 0==(2&n.wrap)?Z_STREAM_ERROR$1:(n.head=t,t.done=!1,Z_OK$2)},inflateSetDictionary=function(e,t){var n,r,i,o=t.length;return e&&e.state?(n=e.state,0!==n.wrap&&n.mode!==DICT?Z_STREAM_ERROR$1:n.mode===DICT&&(r=1,r=adler32_1(r,t,o,0),r!==n.check)?Z_DATA_ERROR$1:(i=updatewindow(e,t,o,o),i?(n.mode=MEM,Z_MEM_ERROR):(n.havedict=1,Z_OK$2))):Z_STREAM_ERROR$1},inflateReset_1=inflateReset,inflateReset2_1=inflateReset2,inflateResetKeep_1=inflateResetKeep,inflateInit_1=inflateInit,inflateInit2_1=inflateInit2,inflate_2=inflate,inflateEnd_1=inflateEnd,inflateGetHeader_1=inflateGetHeader,inflateSetDictionary_1=inflateSetDictionary,inflateInfo="pako inflate (from Nodeca project)",inflate_1={inflateReset:inflateReset_1,inflateReset2:inflateReset2_1,inflateResetKeep:inflateResetKeep_1,inflateInit:inflateInit_1,inflateInit2:inflateInit2_1,inflate:inflate_2,inflateEnd:inflateEnd_1,inflateGetHeader:inflateGetHeader_1,inflateSetDictionary:inflateSetDictionary_1,inflateInfo:inflateInfo};function GZheader(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}var gzheader=GZheader,toString$1$1=Object.prototype.toString,Z_NO_FLUSH$2=constants.Z_NO_FLUSH,Z_FINISH$3=constants.Z_FINISH,Z_OK$3=constants.Z_OK,Z_STREAM_END$3=constants.Z_STREAM_END,Z_NEED_DICT$1=constants.Z_NEED_DICT,Z_STREAM_ERROR$2=constants.Z_STREAM_ERROR,Z_DATA_ERROR$2=constants.Z_DATA_ERROR,Z_MEM_ERROR$1=constants.Z_MEM_ERROR;function Inflate(e){this.options=common$1.assign({chunkSize:65536,windowBits:15,to:""},e||{});var t=this.options;t.raw&&t.windowBits>=0&&t.windowBits<16&&(t.windowBits=-t.windowBits,0===t.windowBits&&(t.windowBits=-15)),!(t.windowBits>=0&&t.windowBits<16)||e&&e.windowBits||(t.windowBits+=32),t.windowBits>15&&t.windowBits<48&&0==(15&t.windowBits)&&(t.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new zstream,this.strm.avail_out=0;var n=inflate_1.inflateInit2(this.strm,t.windowBits);if(n!==Z_OK$3)throw new Error(messages[n]);if(this.header=new gzheader,inflate_1.inflateGetHeader(this.strm,this.header),t.dictionary&&("string"==typeof t.dictionary?t.dictionary=strings.string2buf(t.dictionary):"[object ArrayBuffer]"===toString$1$1.call(t.dictionary)&&(t.dictionary=new Uint8Array(t.dictionary)),t.raw&&(n=inflate_1.inflateSetDictionary(this.strm,t.dictionary),n!==Z_OK$3)))throw new Error(messages[n])}function inflate$1(e,t){var n=new Inflate(t);if(n.push(e),n.err)throw n.msg||messages[n.err];return n.result}function inflateRaw(e,t){return(t=t||{}).raw=!0,inflate$1(e,t)}Inflate.prototype.push=function(e,t){var n,r,i,o=this.strm,a=this.options.chunkSize,s=this.options.dictionary;if(this.ended)return!1;for(r=t===~~t?t:!0===t?Z_FINISH$3:Z_NO_FLUSH$2,"[object ArrayBuffer]"===toString$1$1.call(e)?o.input=new Uint8Array(e):o.input=e,o.next_in=0,o.avail_in=o.input.length;;){for(0===o.avail_out&&(o.output=new Uint8Array(a),o.next_out=0,o.avail_out=a),n=inflate_1.inflate(o,r),n===Z_NEED_DICT$1&&s&&(n=inflate_1.inflateSetDictionary(o,s),n===Z_OK$3?n=inflate_1.inflate(o,r):n===Z_DATA_ERROR$2&&(n=Z_NEED_DICT$1));o.avail_in>0&&n===Z_STREAM_END$3&&o.state.wrap>0&&0!==e[o.next_in];)inflate_1.inflateReset(o),n=inflate_1.inflate(o,r);switch(n){case Z_STREAM_ERROR$2:case Z_DATA_ERROR$2:case Z_NEED_DICT$1:case Z_MEM_ERROR$1:return this.onEnd(n),this.ended=!0,!1}if(i=o.avail_out,o.next_out&&(0===o.avail_out||n===Z_STREAM_END$3))if("string"===this.options.to){var c=strings.utf8border(o.output,o.next_out),u=o.next_out-c,l=strings.buf2string(o.output,c);o.next_out=u,o.avail_out=a-u,u&&o.output.set(o.output.subarray(c,c+u),0),this.onData(l)}else this.onData(o.output.length===o.next_out?o.output:o.output.subarray(0,o.next_out));if(n!==Z_OK$3||0!==i){if(n===Z_STREAM_END$3)return n=inflate_1.inflateEnd(this.strm),this.onEnd(n),this.ended=!0,!0;if(0===o.avail_in)break}}return!0},Inflate.prototype.onData=function(e){this.chunks.push(e)},Inflate.prototype.onEnd=function(e){e===Z_OK$3&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=common$1.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};var inflate_1$1={Inflate:Inflate,inflate:inflate$1,inflateRaw:inflateRaw,ungzip:inflate$1,constants:constants},Deflate$1=deflate_1$1.Deflate,deflate$2=deflate_1$1.deflate,deflateRaw$1=deflate_1$1.deflateRaw,gzip$1=deflate_1$1.gzip,Inflate$1=inflate_1$1.Inflate,inflate$2=inflate_1$1.inflate,inflateRaw$1=inflate_1$1.inflateRaw,ungzip=inflate_1$1.ungzip,pako={Deflate:Deflate$1,deflate:deflate$2,deflateRaw:deflateRaw$1,gzip:gzip$1,Inflate:Inflate$1,inflate:inflate$2,inflateRaw:inflateRaw$1,ungzip:ungzip,constants:constants};function createFind(e){return function(t,n,r){var i=Object(t);if(!isArrayLike_1(t)){var o=_baseIteratee(n);t=keys_1(t),n=function(e){return o(i[e],e,i)}}var a=e(t,n,r);return a>-1?i[o?t[a]:a]:void 0}}var _createFind=createFind;function baseFindIndex(e,t,n,r){for(var i=e.length,o=n+(r?1:-1);r?o--:++o<i;)if(t(e[o],o,e))return o;return-1}var _baseFindIndex=baseFindIndex,NAN=NaN,reTrim=/^\s+|\s+$/g,reIsBadHex=/^[-+]0x[0-9a-f]+$/i,reIsBinary=/^0b[01]+$/i,reIsOctal=/^0o[0-7]+$/i,freeParseInt=parseInt;function toNumber(e){if("number"==typeof e)return e;if(isSymbol_1(e))return NAN;if(isObject_1(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=isObject_1(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=e.replace(reTrim,"");var n=reIsBinary.test(e);return n||reIsOctal.test(e)?freeParseInt(e.slice(2),n?2:8):reIsBadHex.test(e)?NAN:+e}var toNumber_1=toNumber,INFINITY$2=1/0,MAX_INTEGER=17976931348623157e292;function toFinite(e){return e?(e=toNumber_1(e))===INFINITY$2||e===-INFINITY$2?(e<0?-1:1)*MAX_INTEGER:e==e?e:0:0===e?e:0}var toFinite_1=toFinite;function toInteger(e){var t=toFinite_1(e),n=t%1;return t==t?n?t-n:t:0}var toInteger_1=toInteger,nativeMax$1=Math.max;function findIndex(e,t,n){var r=null==e?0:e.length;if(!r)return-1;var i=null==n?0:toInteger_1(n);return i<0&&(i=nativeMax$1(r+i,0)),_baseFindIndex(e,_baseIteratee(t),i)}var findIndex_1=findIndex,find=_createFind(findIndex_1),find_1=find;function baseIsNaN(e){return e!=e}var _baseIsNaN=baseIsNaN;function strictIndexOf(e,t,n){for(var r=n-1,i=e.length;++r<i;)if(e[r]===t)return r;return-1}var _strictIndexOf=strictIndexOf;function baseIndexOf(e,t,n){return t==t?_strictIndexOf(e,t,n):_baseFindIndex(e,_baseIsNaN,n)}var _baseIndexOf=baseIndexOf;function arrayIncludes(e,t){return!(null==e||!e.length)&&_baseIndexOf(e,t,0)>-1}var _arrayIncludes=arrayIncludes;function arrayIncludesWith(e,t,n){for(var r=-1,i=null==e?0:e.length;++r<i;)if(n(t,e[r]))return!0;return!1}var _arrayIncludesWith=arrayIncludesWith;function noop$2(){}var noop_1=noop$2,INFINITY$3=1/0,createSet=_Set&&1/_setToArray(new _Set([,-0]))[1]==INFINITY$3?function(e){return new _Set(e)}:noop_1,_createSet=createSet,LARGE_ARRAY_SIZE$1=200;function baseUniq(e,t,n){var r=-1,i=_arrayIncludes,o=e.length,a=!0,s=[],c=s;if(n)a=!1,i=_arrayIncludesWith;else if(o>=LARGE_ARRAY_SIZE$1){var u=t?null:_createSet(e);if(u)return _setToArray(u);a=!1,i=_cacheHas,c=new _SetCache}else c=t?[]:s;e:for(;++r<o;){var l=e[r],d=t?t(l):l;if(l=n||0!==l?l:0,a&&d==d){for(var f=c.length;f--;)if(c[f]===d)continue e;t&&c.push(d),s.push(l)}else i(c,d,n)||(c!==s&&c.push(d),s.push(l))}return s}var _baseUniq=baseUniq;function uniqWith(e,t){return t="function"==typeof t?t:void 0,e&&e.length?_baseUniq(e,void 0,t):[]}var uniqWith_1=uniqWith;function comparator(e,t){return long_1.fromValue(e).eq(t)}function validateField(e,t){var n=void 0===t?e.val:t,r=e.isBoolean,i=e.isNumber,o=e.oneof,a=e.len;if(2!==[r,i,o].filter((function(e){return!e})).length)throw new TypeError("invalid field type");if(void 0!==n){var s=!1;if(void 0!==o){var c=values_1(o);uniqWith_1(c,comparator).length===c.length&&void 0!==find_1(c,(function(e){return comparator(n,e)}))&&(s=!0)}var u=void 0!==r&&(0===n||1===n)&&1===a,l=void 0!==i&&n.toString(2).length<=a;if(!(s||u||l))throw new Error("invalid field value")}}var Struct=function(){"use strict";function e(){_classCallCheck(this,e),this.size=0,this.fields=new Map}return _createClass(e,[{key:"define",value:function(e,t,n){if(this.size+=n,this.size>64)throw new RangeError("the struct over 64 bits is not supported");var r={val:0,isNumber:"number"===t,isBoolean:"boolean"===t,oneof:"number"===t||"boolean"===t?void 0:t,len:n};validateField(r),this.fields.set(e,r)}},{key:"set",value:function(e,t){var n=this.fields.get(e);if(!n)throw new Error("field not found");var r,i=n.oneof;if(long_1.isLong(t)||"number"==typeof t)r=t;else if("boolean"==typeof t)r=t?1:0;else{if(void 0===i)throw new Error("invalid field type");var o=i[t];if(void 0===o)throw new Error("field type not found");r=o}validateField(n,r),n.val=r}},{key:"toNumber",value:function(){var e,t=0,n=0,r=_createForOfIteratorHelper(this.fields);try{for(r.s();!(e=r.n()).done;){var i=_slicedToArray(e.value,2),o=i[1],a=o.len,s=o.val;void 0!==s&&(t+=long_1.fromValue(s).shiftLeft(n).toNumber(),n+=a)}}catch(err){r.e(err)}finally{r.f()}return t}},{key:"toLong",value:function(){var e,t=long_1.fromNumber(0,!0),n=0,r=_createForOfIteratorHelper(this.fields);try{for(r.s();!(e=r.n()).done;){var i=_slicedToArray(e.value,2),o=i[1],a=o.len,s=o.val;void 0!==s&&(t=long_1.fromValue(s).shiftLeft(n).add(t),n+=a)}}catch(err){r.e(err)}finally{r.f()}return t}},{key:"assert",value:function(e,t){var n=this.fields.get(e);if(!n)throw new Error("field not found");var r=n.oneof;function i(e){var t;if(long_1.isLong(e)||"number"==typeof e)t=e;else if("boolean"==typeof e)t=e?1:0;else{if(void 0===r)throw new Error("invalid field type");var i=r[e];if(void 0===i)throw new Error("field type not found");t=i}return validateField(n,t),comparator(t,n.val)}if(!Array.isArray(t))return i(t);if(1===t.length)return i(t[0]);if(t.every((function(e){return"string"==typeof e}))&&void 0!==r)return t.some((function(e){return i(e)}));throw new Error("invalid valueTypes")}},{key:"from",value:function(e){var t,n=long_1.fromValue(e),r=0,i=_createForOfIteratorHelper(this.fields);try{for(i.s();!(t=i.n()).done;){var o=_slicedToArray(t.value,2),a=o[1],s=a.len,c=long_1.fromNumber(Math.pow(2,s)-1,!0).shiftLeft(r),u=n.and(c).shiftRightUnsigned(r);validateField(a,u),a.val=u,r+=s}}catch(err){i.e(err)}finally{i.f()}}},{key:"typeOf",value:function(e){var t=this.fields.get(e);if(void 0!==t){var n=t.oneof,r=t.val;if(void 0!==n)for(var i=0,o=Object.entries(n);i<o.length;i++){var a=_slicedToArray(o[i],2),s=a[0],c=a[1];if(comparator(r,c))return s}}throw new TypeError("can only get type of oneof type")}}]),e}(),UserJoinOptions=function(e){"use strict";_inherits(n,e);var t=_createSuper(n);function n(e){var r;return _classCallCheck(this,n),r=t.call(this),r.define("Rejoin","boolean",1),r.define("Unused","number",31),r.define("Platform","number",8),r.define("Version","number",12),r.define("Subversion","number",12),r.set("Platform",PLATFORM_TYPE),r.set("Version",VERSION_NO),r.set("Subversion",SUBVERSION),r.set("Rejoin",e),r}return n}(Struct),InvitationType={CallInvite:101,CallAccept:102,CallReject:103,CallCancel:104},TextMessageDstType={PeerTextMessage:0,ChannelTextMessage:1,VendorTextMessage:2},MessageDstType=_objectSpread({},TextMessageDstType),MessageType=_objectSpread(_objectSpread({},MessageDstType),InvitationType),CompressionMethod={Uncompressed:0,Zlib:1},MessageOption=function(e){"use strict";_inherits(n,e);var t=_createSuper(n);function n(e){var r;if(_classCallCheck(this,n),r=t.call(this),r.define("MessageType",MessageType,8),r.define("BroadcastJumps","number",2),r.define("ToCache","boolean",1),r.define("FromCache","boolean",1),r.define("CompressionMethod",CompressionMethod,2),r.define("IterationNumber","number",4),r.define("BufferedMessage","boolean",1),r.define("ToArchive","boolean",1),r.define("FromArchive","boolean",1),isLongNum(e))r.from(e);else if(void 0!==e){var i,o=_createForOfIteratorHelper(getEntries(e));try{for(o.s();!(i=o.n()).done;){var a=_slicedToArray(i.value,2),s=a[0],c=a[1];r.set(s,c)}}catch(err){o.e(err)}finally{o.f()}}return _possibleConstructorReturn(r)}return _createClass(n,[{key:"isTextMessage",value:function(){return this.assert("MessageType",["PeerTextMessage","ChannelTextMessage","VendorTextMessage"])}},{key:"isPeerTextMessage",value:function(){return this.assert("MessageType","PeerTextMessage")}},{key:"isChannelTextMessage",value:function(){return this.assert("MessageType","ChannelTextMessage")}},{key:"isPeerMessage",value:function(){return this.assert("MessageType",["PeerTextMessage"])}},{key:"isZlibCompressed",value:function(){return this.assert("CompressionMethod","Zlib")}},{key:"isFromCache",value:function(){return this.assert("FromCache",!0)}},{key:"isBufferedMessage",value:function(){return this.assert("BufferedMessage",!0)}},{key:"isFromArchive",value:function(){return this.assert("FromArchive",!0)}},{key:"isInvitation",value:function(e){var t=this;return void 0!==e?this.assert("MessageType",e):getKeys(InvitationType).some((function(e){return t.assert("MessageType",e)}))}},{key:"getInvitationType",value:function(){if(!this.isInvitation())throw new TypeError("cannot get InvitationType of a normal message type");return this.typeOf("MessageType")}}]),n}(Struct),ChatManager=function(e){"use strict";_inherits(n,e);var t=_createSuper(n);function n(e){var r;return _classCallCheck(this,n),r=t.call(this,e,"ChatManager"),r.dialogueLru=new TLRUCache(void 0,{maxlen:LRU_MAX_ITEMS,ttl:DIALOGUE_EXPIRE_TIMEOUT}),r}return _createClass(n,[{key:"getChatInfo",value:function(e){var t=this.dialogueLru.get(e);if(this.dialogueLru.prune(),t){var n=t.dialogue,r=t.sequence,i=r.add(1),o={dialogue:n,sequence:i};return this.dialogueLru.set(e,{dialogue:n,sequence:i}),o}var a={dialogue:getRandomUInt64(),sequence:long_1.fromNumber(1,!0)};return this.dialogueLru.set(e,a),a}}]),n}(createEventBase()),inflate$3=pako.inflate,deflate$3=pako.deflate,Session$2=function(e){"use strict";_inherits(n,e);var t=_createSuper(n);function n(e,r,i,o){var a;return _classCallCheck(this,n),a=t.call(this,o,"Session"),a.context=e,a.connection=r,a.instanceId=i,a.chatManager=new ChatManager(a.logger),a.joinedChannels=new Set,a.msgDedupLru=new LRUCache(void 0,{maxlen:MSG_DEDUP_MAX_LEN}),a.startTime=Date.now(),a.seq=long_1.fromNumber(1,!0),a.userJoinOptions=new UserJoinOptions(!1),a.seqSentStatuses=[!1,!1],a.dialogueSequenceLru=new LRUCache(void 0,{maxlen:LRU_MAX_ITEMS}),a.messageSentTimes=[],a.curLoginSockets=[void 0,void 0],a.loginSocketSubs=[{channels:new Map,receivers:[]},{channels:new Map,receivers:[]}],a.lastLoginSockets=[new ReplaySubject(1),new ReplaySubject(1)],a.dialPendingMsgSubjectMaps=[new Map,new Map],a.registerSocketsFailureListener=function(){a.connection.once("socketsFailure",(function(){a.log("socketsFailure, creating a new connection"),defer((function(){return a.connection.removeAllListeners(),a.connection=new Connection(a.context,a.logger),a.loginHandler(6e3,!0)})).pipe(retryWhen((function(e){return e.pipe(delay(2e3))})),takeUntil(a.connection.apClient.apFinish$)).subscribe((function(){a.log("new connection connected")}))})),0===a.connection.listenerCount("tokenExpired")&&a.connection.on("tokenExpired",(function(){a.emit("tokenExpired")}))},a.log("The instanceId is %s",a.instanceId.toString()),a}return _createClass(n,null,[{key:"sendMessageAck",value:function(e,t){var n=new MessageOption(e.options);(n.isInvitation()||n.isPeerMessage())&&t.sendPacket("Ack",{code:0,dialogue:e.dialogue,instance:e.instance,sequence:e.sequence})}}]),_createClass(n,[{key:"loginHandler",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:CLIENT_LOGIN_TIMEOUT,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];n&&this.registerSocketsFailureListener(),this.connection.initConnection();var r=this.seq,i=this.getSocketLoginObservables(this.connection.lastOpenSockets,r),o=Date.now();return i.forEach((function(t,r){var i=e.loginSocketSubs[r].login;void 0!==i&&i.unsubscribe(),e.loginSocketSubs[r].login=t.pipe(tap((function(t){e.curLoginSockets[r]=t;var i=Date.now();sendReport("Link",{ackedServerIp:t.address,destServerIp:t.ip,ec:0,sc:0,elapse:getElapse(e.startTime),lts:long_1.fromNumber(i),responseTime:o-i,sid:getSid(e.instanceId),userId:e.context.uid}),e.emit("userJoined",t.env),n&&e.connection.apClient.apFinish$.next(void 0)}))).subscribe(e.lastLoginSockets[r])})),this.initKeepAliveSender(),this.initKeepAliveReconnector(),this.initLoginReceiver(),merge.apply(void 0,_toConsumableArray(i).concat([fromEvent(this.connection,"connectionInitFailure").pipe(tap((function(e){if(isRtmError(e)||isTimeout(e))throw e;throw new RtmUnavailableError("Login failure",{code:LOGIN_ERR_UNKNOWN,originalError:e})})))])).pipe(first(),timeout(t),catchError((function(t){return t instanceof TimeoutError&&e.warn("Client login timeout"),t&&t.code===LOGIN_ERR_TOKEN_EXPIRED&&(e.connection.emit("tokenExpired"),e.connection.apClient.apFinish$.next(void 0)),e.clearSockets(0,n),throwError(t)})),tap((function(){n||e.registerSocketsFailureListener()})),finalize((function(){n||e.connection.apClient.apFinish$.next(void 0)})))}},{key:"logoutHandler",value:function(){var e=_asyncToGenerator(regeneratorRuntime.mark((function e(){var t,n,r,i=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t=this.getLoginSockets(),n=t.map((function(e){return e.sendPacket("UserQuit",{}),i.connection.waitClosing(e)})),this.clearSockets(LOGOUT_SOCKET_CLOSE_TIMEOUT),r=t.map((function(e){return e.env})),e.abrupt("return",([0,1].filter((function(e){return!r.includes(e)})).forEach((function(e){i.connection.closeSocket(e,0)})),merge.apply(void 0,_toConsumableArray(n)).toPromise()));case 4:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"requestChannelJoin",value:function(){var e=_asyncToGenerator(regeneratorRuntime.mark((function e(t,n){var r,i,o,a=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(0!==this.getLoginSockets().length){e.next=2;break}throw new RtmInvalidStatusError("Client is not logged in. Cannot join the channel",JOIN_CHANNEL_ERR_USER_NOT_LOGGED_IN);case 2:return r=fromEvent(this,"channelLeft").pipe(filter((function(e){return e===t})),take(1)),i=this.incGetSeq(),o=this.lastLoginSockets.map((function(e){return e.pipe(switchMap((function(e,t){0!==t&&a.incSeqIfNeeded(e.env);var r=0===t?i:a.seq;return e.sendPacket("GroupEnter",{account:n,seq:r}),e.fromReceived("GroupReply").pipe(first((function(e){var t=e.seq;return r.eq(t)})),tap((function(e){var t=e.code;if(0!==t)throw new RtmUnavailableError(["Channel join failure. The response code is %d",t],JOIN_CHANNEL_ERR_FAILURE)})))})),takeUntil(r),share())})),o.forEach((function(e,n){var r=function(){return a.loginSocketSubs[n].channels.delete(t.channelId)};a.loginSocketSubs[n].channels.set(t.channelId,e.subscribe({error:r,complete:r}))})),e.next=6,merge.apply(void 0,_toConsumableArray(o)).pipe(first(),timeout(COMMON_REQUEST_TIMEOUT),catchError((function(e){return e instanceof TimeoutError&&a.warn("Channel join timeout"),throwError(e)}))).toPromise();case 6:this.joinedChannels.add(t);case 7:case"end":return e.stop()}}),e,this)})));function t(t,n){return e.apply(this,arguments)}return t}()},{key:"requestSetChannelAttributes",value:function(e,t,r){var i=this.getLoginSockets();if(0===i.length)throw new RtmInvalidStatusError("Client is not logged in");var o=this.incGetSeq();return i.forEach((function(n){n.sendPacket("GroupAttributeSet",{broadcast:r,group:e,attributeInfos:Object.entries(t).map((function(e){var t=_slicedToArray(e,2),n=t[0],r=t[1];return{key:n,value:r}})),seq:o})})),race.apply(void 0,_toConsumableArray(i.map((function(e){return e.fromReceived("GroupAttributeErr").pipe(first((function(e){var t=e.seq;return o.eq(t)})),map$1((function(e){var t=e.code;throw new RtmUnavailableError(["The group attributes set failure, code %d",t],ATTRIBUTE_OPERATION_ERR_FAILURE)})))}))).concat([n.genTimeoutError(ATTRIBUTE_OPERATION_ERR_TIMEOUT)],_toConsumableArray(i.map((function(e){return e.fromReceived("GroupAttributeRsp").pipe(first((function(e){var t=e.seq;return o.eq(t)})))})))))}},{key:"requestGetChannelAttributesByKeys",value:function(e,t){var r=this.getLoginSockets();if(0===r.length)throw new RtmInvalidStatusError("Client is not logged in");var i=this.incGetSeq();return r.forEach((function(n){n.sendPacket("GroupAttributeGet",{group:e,seq:i,attributes:t})})),race.apply(void 0,[n.genTimeoutError(ATTRIBUTE_OPERATION_ERR_TIMEOUT)].concat(_toConsumableArray(r.map((function(e){return e.fromReceived("GroupAttributeErr").pipe(first((function(e){var t=e.seq;return i.eq(t)})),map$1((function(e){var t=e.code;throw new RtmUnavailableError(["The channel attributes get failure, code %d",t],ATTRIBUTE_OPERATION_ERR_FAILURE)})))}))),_toConsumableArray(r.map((function(e){return e.fromReceived("GroupAttributeRet").pipe(first((function(e){var t=e.seq;return i.eq(t)})))})))))}},{key:"requestAddOrUpdateChannelAttributes",value:function(e,t,r){var i=this.getLoginSockets();if(0===i.length)throw new RtmInvalidStatusError("Client is not logged in");var o=this.incGetSeq();return i.forEach((function(n){n.sendPacket("GroupAttributeMod",{broadcast:r,group:e,attributeInfos:Object.entries(t).map((function(e){var t=_slicedToArray(e,2),n=t[0],r=t[1];return{key:n,value:r}})),seq:o})})),race.apply(void 0,_toConsumableArray(i.map((function(e){return e.fromReceived("GroupAttributeErr").pipe(first((function(e){var t=e.seq;return o.eq(t)})),map$1((function(e){var t=e.code;throw new RtmUnavailableError(["The group attributes add or update failure, code %d",t],ATTRIBUTE_OPERATION_ERR_FAILURE)})))}))).concat([n.genTimeoutError(ATTRIBUTE_OPERATION_ERR_TIMEOUT)],_toConsumableArray(i.map((function(e){return e.fromReceived("GroupAttributeRsp").pipe(first((function(e){var t=e.seq;return o.eq(t)})))})))))}},{key:"requestGetChannelAttributesKeys",value:function(e){var t=this.getLoginSockets();if(0===t.length)throw new RtmInvalidStatusError("Client is not logged in");var r=this.incGetSeq();return t.forEach((function(t){t.sendPacket("GroupAttributeKeysGet",{group:e,seq:r})})),race.apply(void 0,[n.genTimeoutError(ATTRIBUTE_OPERATION_ERR_TIMEOUT)].concat(_toConsumableArray(t.map((function(e){return e.fromReceived("GroupAttributeErr").pipe(first((function(e){var t=e.seq;return r.eq(t)})),map$1((function(e){var t=e.code;throw new RtmUnknownError(["Channel attribute operation unknown error code: %d",t],ATTRIBUTE_OPERATION_ERR_FAILURE)})))}))),_toConsumableArray(t.map((function(e){return e.fromReceived("GroupAttributeKeysRet").pipe(first((function(e){var t=e.seq;return r.eq(t)})))})))))}},{key:"requestDeleteChannelAttributesByKeys",value:function(e,t,r){var i=this.getLoginSockets();if(0===i.length)throw new RtmInvalidStatusError("Client is not logged in");var o=this.incGetSeq();return i.forEach((function(n){n.sendPacket("GroupAttributeDel",{group:e,broadcast:r,attributes:t,seq:o})})),race.apply(void 0,_toConsumableArray(i.map((function(e){return e.fromReceived("GroupAttributeErr").pipe(first((function(e){var t=e.seq;return o.eq(t)})),map$1((function(e){var t=e.code;throw new RtmUnavailableError(["The channel attributes delete failure, code %d",t],ATTRIBUTE_OPERATION_ERR_FAILURE)})))}))).concat([n.genTimeoutError(ATTRIBUTE_OPERATION_ERR_TIMEOUT)],_toConsumableArray(i.map((function(e){return e.fromReceived("GroupAttributeRsp").pipe(first((function(e){var t=e.seq;return o.eq(t)})))})))))}},{key:"requestClearChannelAttributes",value:function(e,t){var r=this.getLoginSockets();if(0===r.length)throw new RtmInvalidStatusError("Client is not logged in");var i=this.incGetSeq();return r.forEach((function(n){n.sendPacket("GroupAttributeSet",{group:e,seq:i,attributeInfos:[],broadcast:t})})),race.apply(void 0,_toConsumableArray(r.map((function(e){return e.fromReceived("GroupAttributeErr").pipe(first((function(e){var t=e.seq;return i.eq(t)})),map$1((function(e){var t=e.code;throw new RtmUnavailableError(["The channel attributes clear failure, code %d",t],ATTRIBUTE_OPERATION_ERR_FAILURE)})))}))).concat([n.genTimeoutError(ATTRIBUTE_OPERATION_ERR_TIMEOUT)],_toConsumableArray(r.map((function(e){return e.fromReceived("GroupAttributeRsp").pipe(first((function(e){var t=e.seq;return i.eq(t)})))})))))}},{key:"requestChannelLeave",value:function(e,t){this.emit("channelLeft",e),this.joinedChannels.delete(e),this.getLoginSockets().forEach((function(e){e.sendPacket("GroupLeave",{account:t})}))}},{key:"requestChannelMemberList",value:function(e){var t=this.getLoginSockets();if(0===t.length)throw new RtmInvalidStatusError("Client is not logged in. Cannot get the channel members",GET_MEMBERS_ERR_REJECTED);var r=this.incGetSeq();return t.forEach((function(t){t.sendPacket("GroupAllUsersList",{group:e,pageNumber:0,pageSize:200,seq:r})})),race.apply(void 0,[n.genTimeoutError(COMMON_REQUEST_TIMEOUT)].concat(_toConsumableArray(t.map((function(t){return t.fromReceived("GroupAllUsersResult").pipe(first((function(t){var n=t.group,i=t.seq;return n===e&&r.eq(i)})))})))))}},{key:"sendTextMessage",value:function(){var e=_asyncToGenerator(regeneratorRuntime.mark((function e(t,n,r,i,o){var a,s,c,u,l,d,f,h,p,_,v=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(a=i.enableOfflineMessaging,s=i.enableHistoricalMessaging,isValidId(n)){e.next=3;break}throw new RtmInvalidArgumentError("The send message arguments are not valid",r?PEER_MESSAGE_ERR_INVALID_USERID:CHANNEL_MESSAGE_ERR_FAILURE);case 3:if(c=getUtf8StringSize(t),!(c>TEXT_MESSAGE_MAX_TEXT_BYTES)){e.next=6;break}throw new RtmLimitExceededError("The message size is over the 32KB limit",r?PEER_MESSAGE_ERR_INVALID_MESSAGE:CHANNEL_MESSAGE_ERR_INVALID_MESSAGE);case 6:return u=!AgoraRTM.getParameter("DISABLE_MESSAGE_COMPRESSION")&&c>=MESSAGE_MIN_COMPRESSION_LEN,l=this.chatManager.getChatInfo(n),d=l.dialogue,f=l.sequence,h=this.instanceId,this.log('A%s %s message is sending to %s: "'.concat(h,"-").concat(d,"#").concat(f,'"'),u?" compressed":"",r?"peer":"channel",n),e.next=10,from(this.sendMessageToRetry((function(e){return{MiscMap:{},sequence:f,dialogue:d,instance:h,dst:n,ms:long_1.fromNumber(Date.now(),!0),options:new MessageOption({IterationNumber:e,CompressionMethod:u?"Zlib":"Uncompressed",MessageType:r?"PeerTextMessage":"ChannelTextMessage",ToCache:a,ToArchive:s}).toLong(),payload:u?deflate$3(t):encodeStringToUint8Array(t),src:v.context.uid}}),!0)).pipe(timeout(void 0===o?COMMON_REQUEST_TIMEOUT:o),catchError((function(e){return e instanceof TimeoutError&&v.warn("Send message timeout"),throwError(e)}))).toPromise();case 10:return p=e.sent,_=p.code,e.abrupt("return",{hasPeerReceived:0===_});case 13:case"end":return e.stop()}}),e,this)})));function t(t,n,r,i,o){return e.apply(this,arguments)}return t}()},{key:"sendInvitationMessage",value:function(){var e=_asyncToGenerator(regeneratorRuntime.mark((function e(t){var n,r,i,o,a,s,c,u,l,d,f,h=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(n=t.peerId,r=t.callId,i=t.extra,o=t.isAcceptAck,a=t.channelId,s=t.type,"0"===r&&this.info("[rtm-API] EndCall message send api is called"),c={callId:r},void 0===o){e.next=7;break}if("CallAccept"===s){e.next=6;break}throw new Error("invalid invitation type");case 6:c.type=o?"ack":"request";case 7:return c.channel=a,("CallInvite"===s||"CallCancel"===s||"CallReject"===s||"CallAccept"===s&&!1===o)&&void 0!==i&&(c.extra=i),u=getRandomUInt64(),this.log("The sent invitation body is %o",c),e.next=13,from(this.sendMessageToRetry((function(e){return{MiscMap:{},sequence:long_1.fromNumber(1),dialogue:u,instance:h.instanceId,dst:n,ms:long_1.fromNumber(Date.now(),!0),options:new MessageOption({IterationNumber:e,MessageType:s}).toLong(),payload:encodeStringToUint8Array(JSON.stringify(c)),src:h.context.uid}}),!0)).pipe(timeout(MESSAGE_SEND_TIMEOUT),catchError((function(e){return e instanceof TimeoutError&&h.warn("Send invitation timeout"),throwError(e)}))).toPromise();case 13:return l=e.sent,d=l.code,f=l.retryTimes,e.abrupt("return",{hasPeerReceived:0===d,hasReSent:0!==f});case 17:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"cleanLoginSubs",value:function(e,t){Object.entries(this.loginSocketSubs[e]).forEach((function(e){var n=_slicedToArray(e,2),r=n[0],i=n[1];"channels"===r&&t||(Array.isArray(i)||i instanceof Map?i.forEach((function(e){return e.unsubscribe()})):i&&i.unsubscribe())})),this.loginSocketSubs[e]={channels:t?this.loginSocketSubs[e].channels:new Map,receivers:[]}}},{key:"sendMessageToRetry",value:function(){var e=_asyncToGenerator(regeneratorRuntime.mark((function e(t,n){var r,i,o,a,s,c,u,l,d,f=this,h=arguments;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(r=h.length>2&&void 0!==h[2]?h[2]:0,this.log("Attempt to send the message "+(n?" with retrying, %o":"without retrying"),{retryTimes:r}),i=this.getLoginSockets(),0!==i.length){e.next=5;break}throw new Error("no logged-in sockets");case 5:return o=t(r),i.forEach((function(e){e.sendPacket("Message",o)})),a=o.dialogue,s=o.sequence,c=o.instance,u=i.map((function(e){return e.fromReceived("Ack").pipe(filter((function(e){return a.eq(e.dialogue)&&s.eq(e.sequence)&&c.eq(e.instance)})))})),e.prev=8,e.next=11,merge.apply(void 0,_toConsumableArray(u)).pipe(timeout(MESSAGE_RETRY_TIMEOUT),catchError((function(e){return isTimeout(e)&&f.warn("Send message retry timeout"),throwError(e)})),first()).toPromise();case 11:return l=e.sent,d=l.code,e.abrupt("return",(this.log("The message has been acked, %o",{code:d}),{code:d,retryTimes:r}));case 16:if(e.prev=16,e.t0=e["catch"](8),!(e.t0 instanceof TimeoutError&&n)){e.next=20;break}return e.abrupt("return",this.sendMessageToRetry(t,!1,r+1));case 20:throw e.t0;case 21:case"end":return e.stop()}}),e,this,[[8,16]])})));function t(t,n){return e.apply(this,arguments)}return t}()},{key:"initKeepAliveSender",value:function(){var e=this;this.lastLoginSockets.map((function(t){return t.pipe(switchMap((function(t){return timer(0,KEEPALIVE_INTERVAL).pipe(tap((function(){e.incSeqIfNeeded(t.env),t.sendPacket("Ping",{ms:long_1.fromNumber(Date.now(),!0),seq:e.seq})})))})))})).forEach((function(t,n){var r=e.loginSocketSubs[n].keepAlive;void 0!==r&&r.unsubscribe(),e.loginSocketSubs[n].keepAlive=t.subscribe({error:function(){}})}))}},{key:"initKeepAliveReconnector",value:function(){var e=this;this.lastLoginSockets.map((function(e){return e.pipe(switchMap((function(e){var t,n=!1,r=e.userJoin$.pipe(tap((function(){n=!0}))),i=e.input$.pipe(tap((function(e){"Ping"!==uriToPacketName(e.uri)&&(n=!1)})));return merge(timer(LOGIN_RESP_TIMEOUT,SOCKET_KEEPALIVE_TIMEOUT).pipe(withLatestFrom(e.receivedPacket),tap((function(r){var i=_slicedToArray(r,2),o=_slicedToArray(i[1],2),a=o[1];t!==a||n||e.forceReconnect(),t=a}))),r,i)})))})).forEach((function(t,n){var r=e.loginSocketSubs[n].keepAliveReconnector;void 0!==r&&r.unsubscribe(),e.loginSocketSubs[n].keepAliveReconnector=t.subscribe({error:function(){}})}))}},{key:"initLoginReceiver",value:function(){var e=this;this.lastLoginSockets.map((function(t){return t.pipe(switchMap((function(t){return merge(fromEvent(t,"reconnect").pipe(tap(e.onSocketReconnect(t))),t.fromReceived("Message").pipe(tap(e.onMessage(t))),t.fromReceived("GroupEnterNotice").pipe(tap(e.onGroupEnterNotice())),t.fromReceived("GroupLeaveNotice").pipe(tap(e.onGroupLeaveNotice())),t.fromReceived("GroupAttributeAlt").pipe(tap(e.onGroupAttributeAlt()))).pipe(mapTo(void 0))})))})).forEach((function(t,n){e.loginSocketSubs[n].receivers.push(t.subscribe({error:function(){}}))}))}},{key:"requestSocketLogin",value:function(e,t,n){var r=this;return concat(defer((function(){r.userJoinOptions=new UserJoinOptions(t),e.sendPacket("UserJoin",{account:r.context.uid,instance:r.instanceId,opt:r.userJoinOptions.toLong(),seq:n,ticket:e.ticket})})),e.fromReceived("UserResp").pipe(first((function(e){return n.eq(e.seq)})),tap((function(t){var n=t.code;if(0!==n)throw r.clearSockets(),r.logError("Connected to gateway success but the Rtm server rejected login"),new RtmUnavailableError(["Login failure. The response code from the RTM service is %d",n],LOGIN_ERR_REJECTED);r.log("ENV_%d logged in",e.env)})),mapTo(e),timeout(LOGIN_RESP_TIMEOUT))).pipe(filter((function(e){return void 0!==e})),catchError((function(e){return e instanceof TimeoutError&&r.warn("Login response timeout, rejoin: %s",t),throwError(e)})))}},{key:"getSocketLoginObservables",value:function(e,t){var n=this;return e.map((function(e){return e.pipe(tap((function(e){0===e.listenerCount("socketUserDrop")&&e.on("socketUserDrop",(function(t){return n.onUserDrop(t,e)}))})),switchMap((function(e,r){return n.incSeqIfNeeded(e.env),n.requestSocketLogin(e,0!==r,0===r?t:n.seq)})),share())}))}},{key:"incSeqIfNeeded",value:function(e){if(![0,1].includes(e))throw new CommonError({INVALID_ENV:"The env argument is not 0 or 1"});this.seqSentStatuses[e]&&(this.seq=this.seq.add(1),this.seqSentStatuses=[!1,!1]),this.seqSentStatuses[e]=!0}},{key:"incGetSeq",value:function(){return this.seq=this.seq.add(1),this.seqSentStatuses=[!0,!0],this.seq}},{key:"getLoginSockets",value:function(){return compact_1(this.curLoginSockets)}},{key:"emitMessage",value:function(e,t){var r=e.options,i=e.payload,o=e.src,a=e.dst,s=e.instance,c=e.dialogue,u=e.sequence,l=e.ms;this.dialogueSequenceLru.set(c.toString(),u);var d="".concat(s,"-").concat(c,"#").concat(u);if(this.msgDedupLru.has(d))this.warn("Env_%d: Messages out-of-order or not start with 1: %s",t,d);else{this.msgDedupLru.set(d,void 0);var f=new MessageOption(r);this.getLoginSockets().forEach((function(t){n.sendMessageAck(e,t)}));var h=f.isZlibCompressed();if(f.isInvitation()){var p=h?inflate$3(i,{to:"string"}):decodeUint8ArrayToString(i),_=JSON.parse(p);this.log("The received invitation body is %o",_),this.emit("invitationMessage",{body:_,type:f.getInvitationType(),peerId:o,serverReceivedTs:l.toNumber()})}else if(f.isTextMessage()){var v=f.isPeerTextMessage(),g=h?inflate$3(i,{to:"string"}):decodeUint8ArrayToString(i);if(this.info("Received a%s %s text message from %s to %s, %s",h?" compressed":"",v?"peer":"channel",o,a,d),v){var b={text:g,peerId:o,properties:{serverReceivedTs:l.toNumber(),isOfflineMessage:f.isFromCache(),isHistoricalMessage:f.isFromArchive()}};this.emit("peerTextMessage",b)}else this.emit("channelTextMessage",{channelId:a,memberId:o,text:g,properties:{serverReceivedTs:l.toNumber(),isOfflineMessage:!1,isHistoricalMessage:f.isFromArchive()}})}}}},{key:"onSocketReconnect",value:function(e){var t=this;return function(){var n=[0,1].filter((function(t){return t!==e.env}))[0],r=t.connection.curOpenSockets[n];r&&!r.loggedIn&&t.emit("connectionLost")}}},{key:"onUserDrop",value:function(e,t){var n=e.code;if(sendReport("KickedOff",{code:0,elapse:getElapse(this.startTime),linkId:parseInt(t.name.split("-")[1],10),lts:long_1.fromNumber(Date.now()),server:t.address,serverCode:n,sid:getSid(this.instanceId),userId:this.context.uid}),10006!==n&&10001!==n)return 10009===n?(this.warn("The instance ID conflicts, reconnecting"),this.instanceId=getRandomUInt64(),this.context.sid=getSid(this.instanceId),void this.emit("instanceChanged",this.instanceId)):void([11,14,15,16].includes(n)&&(this.emit("userDrop",n),this.clearSockets()));this.warn("Login too often and kicked off, reconnect and login")}},{key:"clearSockets",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];[0,1].forEach((function(r){e.cleanLoginSubs(r,n),e.connection.lastOpenSockets[r].complete(),e.connection.closeSocket(r,t)}))}},{key:"onMessage",value:function(e){var t=this;return function(n){var r=n.dialogue,i=n.instance,o=n.sequence,a=n.options,s=n.src;if(s!==t.context.uid){var c=r.toString(),u=t.dialPendingMsgSubjectMaps[e.env].get(c),l="".concat(i,"-").concat(r,"#").concat(o);if(u)return u.next(n),void t.log("Env_%d: The dialogue has pending messages, next: %s",e.env,l);var d=t.dialogueSequenceLru.get(c),f=!d&&o.eq(1),h=void 0!==d&&o.sub(d).eq(1);if(f||h)t.emitMessage(n,e.env);else{if(d){if(o.lte(d))return;t.log("Env_%d: The message pended, the sequence is not continuous with the last: %s",e.env,l)}else t.log("Env_%d: The message pended, the first sequence is not equal to 1: %s",e.env,l);var p=new Subject;t.dialPendingMsgSubjectMaps[e.env].set(c,p);var _=p.pipe(observeOn(asyncScheduler),scan((function(e,t){return[].concat(_toConsumableArray(e),[t])}),[]),map$1((function(e){return e.sort((function(e,t){var n=e.sequence,r=t.sequence;return n.eq(r)?0:n.gt(r)?1:-1}))})),shareReplay(1)),v=new MessageOption(a),g=!v.isFromCache()&&!v.isBufferedMessage();_.pipe(takeUntil(timer(g?ONLINE_MESSAGE_DEDUP_DELAY:OFFLINE_MESSAGE_DEDUP_DELAY)),first((function(e){if(e.length<2)return!1;for(var t=void 0===d?long_1.fromNumber(1,!0):d.add(1),n=0;n<e.length;t=t.add(1),n++)if(!e[n].sequence.eq(t))return!1;return!0})),finalize((function(){t.dialPendingMsgSubjectMaps[e.env].delete(c)}))).subscribe((function(n){n.forEach((function(n){t.emitMessage(n,e.env),t.log("Env_%d: The message queue has fully ordered, emitting: %s",e.env,"".concat(n.instance,"-").concat(n.dialogue,"#").concat(n.sequence))}))}),(function(n){n instanceof EmptyError&&_.pipe(first()).subscribe((function(n){return n.forEach((function(n){t.log("Env_%d: The message pending queue expired, emitting: %s",e.env,"".concat(n.instance,"-").concat(n.dialogue,"#").concat(n.sequence)),t.emitMessage(n,e.env)}))}))})),p.next(n)}}else t.log("The message is from the local account, ignored")}}},{key:"onGroupEnterNotice",value:function(){var e=this;return function(t){var n=t.group,r=t.instance,i=t.seq,o=t.user,a=t.size;e.emit("memberNotice",{channelId:n,seq:i,instance:r,memberId:o,type:"MemberJoined",size:a})}}},{key:"onGroupLeaveNotice",value:function(){var e=this;return function(t){var n=t.group,r=t.instance,i=t.seq,o=t.user,a=t.size;e.emit("memberNotice",{channelId:n,seq:i,instance:r,memberId:o,type:"MemberLeft",size:a})}}},{key:"onGroupAttributeAlt",value:function(){var e=this;return function(t){var n=t.group,r=_objectWithoutProperties(t,["group"]);e.emit("channelAttributesUpdated",_objectSpread({channelId:n},r))}}}]),n}(createEventBase());function genGetSession(e){return function(){var t=e();if(!t)throw new RtmInvalidStatusError("Client is not logged in. Cannot do the operation");return t}}Session$2.genTimeoutError=function(e,t){return of(void 0).pipe(delay(void 0===t?COMMON_REQUEST_TIMEOUT:t),map$1((function(){throw new RtmTimeoutError(["Request timed out after %ds",void 0===t?COMMON_REQUEST_TIMEOUT:t],e)})))};var InvitationManager=function(e){"use strict";_inherits(n,e);var t=_createSuper(n);function n(e,r){var i;return _classCallCheck(this,n),i=t.call(this,r,"InvitationManager"),i.logger=r,i.getSession=void 0,i.invitationDispatcher=new events.EventEmitter,i.outgoingLocalInvitations=new Map,i.receivedRemoteInvitations=new LRUCache(void 0,{maxlen:LRU_MAX_ITEMS}),i.getSession=genGetSession(e),i.invitationDispatcher.on("remoteInvitationToManager",(function(e){var t=e.callId,n=e.extra,o=e.callerId,a=e.channelId;if(!i.receivedRemoteInvitations.has(t)){var s=new RtmRemoteInvitation({callerId:o,callId:t,getSession:i.getSession,logger:r,extraContent:n,invitationChannel:a});s.remoteInvitationEnd$.subscribe((function(){i.receivedRemoteInvitations.delete(t)})),i.receivedRemoteInvitations.set(t,s),i.emit("remoteInvitationInstance",s)}})),i.invitationDispatcher.on("acceptAckToRemoteInvitation",(function(e){var t=e.callId,n=i.receivedRemoteInvitations.get(t);n&&n.onAcceptAckReceived()})),i.invitationDispatcher.on("cancelToRemoteInvitation",(function(e){var t=e.callId,n=e.extra,r=i.receivedRemoteInvitations.get(t);r&&r.onCancelReceived(n)})),i.invitationDispatcher.on("acceptToLocalInvitation",(function(e){var t=e.callId,n=e.extra,r=i.outgoingLocalInvitations.get(t);r&&r.onAcceptReceived(n)})),i.invitationDispatcher.on("refuseToLocalInvitation",(function(e){var t=e.callId,n=e.extra,r=i.outgoingLocalInvitations.get(t);r&&r.onRefuseReceived(n)})),i}return _createClass(n,[{key:"invitationMessageHandler",value:function(e){var t=e.body,n=t.callId,r=t.extra,i=void 0===r?"":r,o=t.type,a=t.channel,s=void 0===a?"":a,c=e.type,u=e.peerId,l=e.serverReceivedTs;switch(c){case"CallAccept":return void("ack"===o?this.invitationDispatcher.emit("acceptAckToRemoteInvitation",{callId:n}):"request"===o&&this.invitationDispatcher.emit("acceptToLocalInvitation",{callId:n,extra:i}));case"CallInvite":return void this.invitationDispatcher.emit("remoteInvitationToManager",{callId:n,callerId:u,extra:i,channelId:s});case"CallCancel":if("0"===n){var d="".concat(END_CALL_PREFIX,"_").concat(s,"_").concat(i);return void this.getSession().emit("peerTextMessage",{peerId:u,properties:{serverReceivedTs:l,isOfflineMessage:!1,isHistoricalMessage:!1},text:d})}return void this.invitationDispatcher.emit("cancelToRemoteInvitation",{callId:n,extra:i});case"CallReject":return void this.invitationDispatcher.emit("refuseToLocalInvitation",{callId:n,extra:i});default:throw assertNever("invitationType",c)}}},{key:"genLocalInvitation",value:function(e){var t=this,n=new RtmLocalInvitation(e,this.getSession,this.logger);return n.localInvitationEnd$.subscribe((function(){t.outgoingLocalInvitations.delete(n.callId)})),this.outgoingLocalInvitations.set(n.callId,n),n}}]),n}(createEventBase()),_class$1,_temp$1,MemberJoinState={JOINED:0,LEFT:1},ConnectionState=RtmStatusCode$1.ConnectionState,Channel=(_temp$1=function(e){"use strict";_inherits(n,e);var t=_createSuper(n);function n(e,r,i,o){var a;return _classCallCheck(this,n),a=t.call(this,o,"RtmChannel",!0),a.channelId=e,a.client=i,a.getSession=void 0,a.memberJoinedLru=new LRUCache(void 0,{maxlen:LRU_MAX_ITEMS}),a.memberLeftLru=new LRUCache(void 0,{maxlen:LRU_MAX_ITEMS}),a.memberJoinStateLru=new LRUCache(void 0,{maxlen:LRU_MAX_ITEMS}),a.attributesSeqLru=new LRUCache(void 0,{maxlen:LRU_MAX_ITEMS}),a.onChannelTextMessage=function(e){var t=e.memberId,n=e.text,r=e.channelId,i=e.properties;r===a.channelId&&a.emit("ChannelMessage",{text:n,messageType:RtmStatusCode$1.MessageType.TEXT},t,i)},a.onAttributesUpdated=function(e){var t=e.channelId,n=e.attributeMaps,r=e.instance,i=e.seq,o=r.toString(),s=a.attributesSeqLru.get(o);if((!s||i.greaterThan(s))&&(a.attributesSeqLru.set(o,i),t===a.channelId)){var c,u={},l=_createForOfIteratorHelper(n);try{for(l.s();!(c=l.n()).done;){var d=c.value,f=d.key,h=d.ms,p=d.value,_=d.origin;if("string"!=typeof f||!long_1.isLong(h)||"string"!=typeof p||!isValidId(_))break;u[f]={value:p,lastUpdateUserId:_,lastUpdateTs:h.toNumber()}}}catch(err){l.e(err)}finally{l.f()}a.emit("AttributesUpdated",u)}},a.onMemberNotice=function(e){var t=e.channelId,n=e.instance,r=e.memberId,i=e.seq,o=e.type;if(t===a.channelId){var s=n.toString(),c=i.toString(),u={MemberLeft:a.memberLeftLru,MemberJoined:a.memberJoinedLru,MemberCountUpdated:void 0}[o];if(u){if(u.has(s+c))return void a.log("received duplicated %s notice (seq: %s), channel '%s', member '%s'",o,c,a.channelId,r);if(u.set(s+c,void 0),"string"!=typeof r)return;if(r!==a.getSession().context.uid){var l=a.memberJoinStateLru.get(r);if(l===MemberJoinState.JOINED&&"MemberJoined"===o)return void a.log("received duplicated %s state (seq: %s), channel '%s', member '%s'",o,c,a.channelId,r);if(l===MemberJoinState.LEFT&&"MemberLeft"===o)return void a.log("received duplicated %s state (seq: %s), channel '%s', member '%s'",o,c,a.channelId,r)}a.memberJoinStateLru.set(r,"MemberJoined"===o?MemberJoinState.JOINED:MemberJoinState.LEFT)}a.info("Channel %s - %s, memberId: %s",o,a.channelId,"MemberCountUpdated"===o?"[unknown]":r);var d=r===a.getSession().context.uid;("MemberLeft"===o&&isValidId(r)||"MemberJoined"===o&&isValidId(r))&&(d||a.emit(o,r))}},a.getSession=genGetSession(r),a.info("A channel created, id %s",e),a}return _createClass(n,[{key:"join",value:function(){var e=this;if(!isValidId(this.channelId))throw new RtmInvalidArgumentError([invalidArgumentMessage,"channelId"],JOIN_CHANNEL_ERR_INVALID_ARGUMENT);try{var t=this.getSession()}catch(n){throw new RtmInvalidStatusError("The client is not logged in. Cannot do the operation",JOIN_CHANNEL_ERR_USER_NOT_LOGGED_IN)}if(t.joinedChannels.has(this))throw sendReport("ChnJoin",{cname:this.channelId,lts:long_1.fromNumber(Date.now()),userId:t.context.uid,elapse:getElapse(t.startTime),errCode:JOIN_CHANNEL_ERR_ALREADY_JOINED,sid:getSid(t.instanceId)}),new RtmInvalidStatusError("The channel has joined. Cannot rejoin",JOIN_CHANNEL_ERR_ALREADY_JOINED);try{if(this.log("Joining the channel %s",this.channelId),this.hasOtherChannelJoined())throw sendReport("ChnJoin",{cname:this.channelId,lts:long_1.fromNumber(Date.now()),userId:t.context.uid,elapse:getElapse(t.startTime),errCode:JOIN_CHANNEL_ERR_ALREADY_JOINED_CHANNEL_OF_SAME_ID,sid:getSid(t.instanceId)}),new RtmInvalidStatusError("A channel of the same channel ID has already joined. Cannot rejoin",JOIN_CHANNEL_ERR_ALREADY_JOINED_CHANNEL_OF_SAME_ID);if(t.joinedChannels.size===MAX_JOINED_CHANNELS)throw sendReport("ChnJoin",{cname:this.channelId,lts:long_1.fromNumber(Date.now()),userId:t.context.uid,elapse:getElapse(t.startTime),errCode:JOIN_CHANNEL_ERR_EXCEED_LIMIT,sid:getSid(t.instanceId)}),new RtmLimitExceededError("The joined channels has exceeded the limit of 20",JOIN_CHANNEL_ERR_EXCEED_LIMIT);return sendReport("ChnJoin",{cname:this.channelId,lts:long_1.fromNumber(Date.now()),userId:t.context.uid,elapse:getElapse(t.startTime),errCode:0,sid:getSid(t.instanceId)}),t.requestChannelJoin(this,this.channelId).then((function(){e.info("The channel %s joined successfully",e.channelId),t.on("channelTextMessage",e.onChannelTextMessage),t.on("memberNotice",e.onMemberNotice),t.on("channelAttributesUpdated",e.onAttributesUpdated)}))}catch(r){if(this.logError(r),isRtmError(r))throw r;if(isTimeout(r))throw sendReport("ChnJoinRes",{cname:this.channelId,lts:long_1.fromNumber(Date.now()),elapse:getElapse(t.startTime),errCode:JOIN_CHANNEL_TIMEOUT,sid:getSid(t.instanceId),serverErrCode:0,userId:t.context.uid}),new RtmTimeoutError(["Join channel %s timed out",this.channelId],JOIN_CHANNEL_TIMEOUT);throw new RtmUnknownError(["The channel %s join failure",this.channelId],{code:JOIN_CHANNEL_ERR_FAILURE,originalError:r})}}},{key:"leave",value:function(){var e=_asyncToGenerator(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:e.prev=0,t=this.getSession(),e.next=7;break;case 4:throw e.prev=4,e.t0=e["catch"](0),new RtmInvalidStatusError("The client is not logged in. Cannot do the operation",LEAVE_CHANNEL_ERR_USER_NOT_LOGGED_IN);case 7:if(t.joinedChannels.has(this)){e.next=9;break}throw new RtmInvalidStatusError("The channel does not join. Cannot do the operation",LEAVE_CHANNEL_ERR_NOT_IN_CHANNEL);case 9:e.prev=9,t.requestChannelLeave(this,this.channelId),this.memberLeftLru.empty(),this.memberJoinedLru.empty(),this.memberJoinStateLru.empty(),t.removeListener("channelTextMessage",this.onChannelTextMessage),t.removeListener("memberNotice",this.onMemberNotice),t.removeListener("channelAttributesUpdated",this.onAttributesUpdated),e.next=18;break;case 13:if(e.prev=13,e.t1=e["catch"](9),this.logError(e.t1),!isRtmError(e.t1)){e.next=17;break}throw void 0===e.t1.code&&(e.t1.code=LEAVE_CHANNEL_ERR_REJECTED),sendReport("ChnLeave",{cname:this.channelId,lts:long_1.fromNumber(Date.now()),elapse:getElapse(t.startTime),errCode:LEAVE_CHANNEL_ERR_REJECTED,sid:getSid(t.instanceId),userId:t.context.uid}),e.t1;case 17:throw sendReport("ChnLeave",{cname:this.channelId,lts:long_1.fromNumber(Date.now()),elapse:getElapse(t.startTime),errCode:LEAVE_CHANNEL_ERR_FAILURE,sid:getSid(t.instanceId),userId:t.context.uid}),new RtmUnknownError("The channel leave failure",{code:LEAVE_CHANNEL_ERR_FAILURE,originalError:e.t1});case 18:sendReport("ChnLeave",{cname:this.channelId,lts:long_1.fromNumber(Date.now()),elapse:getElapse(t.startTime),errCode:0,sid:getSid(t.instanceId),userId:t.context.uid});case 19:case"end":return e.stop()}}),e,this,[[0,4],[9,13]])})));function t(){return e.apply(this,arguments)}return t}()},{key:"sendMessage",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=n.enableHistoricalMessaging,i=void 0!==r&&r;validMessage(e,CHANNEL_MESSAGE_ERR_INVALID_MESSAGE);try{var o=this.getSession()}catch(s){throw new RtmInvalidStatusError("The client is not logged in. Cannot do the operation",CHANNEL_MESSAGE_ERR_USER_NOT_LOGGED_IN)}if(!o.joinedChannels.has(this))throw new RtmInvalidStatusError("The channel does not join. Cannot do the operation",CHANNEL_MESSAGE_ERR_USER_NOT_LOGGED_IN);if(this.client.connectionState===ConnectionState.RECONNECTING){var a=Date.now();return new Promise((function(n,r){var o,s=function(){var s=Date.now()-a;try{n(commonSendMessage({message:e,peerId:t.channelId,toPeer:!1,session:t.getSession(),errorCodes:{NOT_LOGGED_IN:CHANNEL_MESSAGE_ERR_USER_NOT_LOGGED_IN,TOO_OFTEN:CHANNEL_MESSAGE_ERR_TOO_OFTEN},diff:s,options:{enableHistoricalMessaging:i,enableOfflineMessaging:!1}}).then((function(){})))}catch(e){isTimeout(e)&&r(new RtmTimeoutError(genTimeoutMessage(t.name,"sendMessageToPeer",MESSAGE_SEND_TIMEOUT),CHANNEL_MESSAGE_ERR_TIMEOUT)),isRtmError(e)&&r(e),r(new RtmUnavailableError("Channel message send failure",{code:CHANNEL_MESSAGE_ERR_FAILURE,originalError:e}))}finally{clearTimeout(o)}};t.client.internalEmitter.once("RECONNECTED",s),o=setTimeout((function(){t.client.internalEmitter.off("RECONNECTED",s),r(new RtmTimeoutError(genTimeoutMessage(t.name,"sendMessageToPeer",MESSAGE_SEND_TIMEOUT),CHANNEL_MESSAGE_ERR_TIMEOUT))}),9e3)}))}if(this.client.connectionState!==ConnectionState.CONNECTED)throw new RtmInvalidStatusError("The client is not logged in. Cannot do the operation",CHANNEL_MESSAGE_ERR_USER_NOT_LOGGED_IN);try{return commonSendMessage({message:e,peerId:this.channelId,toPeer:!1,session:this.getSession(),errorCodes:{NOT_LOGGED_IN:CHANNEL_MESSAGE_ERR_USER_NOT_LOGGED_IN,TOO_OFTEN:CHANNEL_MESSAGE_ERR_TOO_OFTEN},diff:0,options:{enableHistoricalMessaging:i,enableOfflineMessaging:!1}}).then((function(){}))}catch(e){if(isTimeout(e))throw new RtmTimeoutError(genTimeoutMessage(this.name,"sendMessage",MESSAGE_SEND_TIMEOUT),CHANNEL_MESSAGE_ERR_TIMEOUT);if(isRtmError(e))throw this.logError(e),e;throw new RtmUnknownError("The channel message send failure",CHANNEL_MESSAGE_ERR_FAILURE)}}},{key:"getMembers",value:function(){var e=this;try{try{var t=this.getSession()}catch(n){throw new RtmInvalidStatusError("The client is not logged in. Cannot do the operation",GET_MEMBERS_ERR_USER_NOT_LOGGED_IN)}if(!t.joinedChannels.has(this))throw new RtmInvalidStatusError("The channel does not join. Cannot do the operation",GET_MEMBERS_ERR_NOT_IN_CHANNEL);return this.getSession().requestChannelMemberList(this.channelId).pipe(map$1((function(e){var t=e.memberInfos;return t.map((function(e){var t=e.account;return t}))}))).toPromise().then((function(t){return e.info("Channel %s - get members success, %o",e.channelId,t),t}))}catch(t){if(isRtmError(t))throw this.logError(t),t;throw new RtmUnknownError("The channel members get failure",GET_MEMBERS_ERR_FAILURE)}}},{key:"hasOtherChannelJoined",value:function(){var e=this;return!this.getSession().joinedChannels.has(this)&&_toConsumableArray(this.getSession().joinedChannels).some((function(t){return t.channelId===e.channelId}))}}]),n}(createEventBase()),_class$1=_temp$1,_applyDecoratedDescriptor(_class$1.prototype,"join",[logged],Object.getOwnPropertyDescriptor(_class$1.prototype,"join"),_class$1.prototype),_applyDecoratedDescriptor(_class$1.prototype,"leave",[logged],Object.getOwnPropertyDescriptor(_class$1.prototype,"leave"),_class$1.prototype),_applyDecoratedDescriptor(_class$1.prototype,"sendMessage",[logged],Object.getOwnPropertyDescriptor(_class$1.prototype,"sendMessage"),_class$1.prototype),_applyDecoratedDescriptor(_class$1.prototype,"getMembers",[logged],Object.getOwnPropertyDescriptor(_class$1.prototype,"getMembers"),_class$1.prototype),_class$1),_class$2,_temp$2,ConnectionChangeReason=RtmStatusCode$1.ConnectionChangeReason,ConnectionState$1=RtmStatusCode$1.ConnectionState,connectionStateCodeMap={DISCONNECTED:1,CONNECTING:2,CONNECTED:3,RECONNECTING:4,ABORTED:5},connectionStateChangeReason={LOGIN:1,LOGIN_SUCCESS:2,LOGIN_FAILURE:3,LOGIN_TIMEOUT:4,INTERRUPTED:5,LOGOUT:6,BANNED_BY_SERVER:7,REMOTE_LOGIN:8},Client=(_temp$2=function(e){"use strict";_inherits(n,e);var t=_createSuper(n);function n(e,r,i,o){var a;return _classCallCheck(this,n),a=t.call(this,r,"RtmClient",!0),a.parameters=i,a.setParameters=o,a.connectionState=ConnectionState$1.DISCONNECTED,a.internalEmitter=new events.EventEmitter,a.context=void 0,a.invitationManager=new InvitationManager((function(){return a.session}),a.logger),a.reconnId=0,a.channelAttributesCacheLru=new LRUCache(void 0,{maxlen:CHANNEL_ATTRIBUTES_CACHE_MAX_LENGTH}),a.loginPromise=void 0,a.session=void 0,a.lastLoginTime=void 0,a.userDropHandler=function(e){if(a.connectionState!==ConnectionState$1.ABORTED)switch(e){case 11:return a.logError("Kicked off by remote session"),void a.onConnectionStateChanged(ConnectionState$1.ABORTED,ConnectionChangeReason.REMOTE_LOGIN);case 14:case 15:case 16:var t={14:"User ID",15:"IP",16:"Channel Name"};return a.logError("Server banned because of illegal ".concat(t[e])),void a.onConnectionStateChanged(ConnectionState$1.ABORTED,ConnectionChangeReason.BANNED_BY_SERVER);default:a.logError("User kicked off for unknown code: ".concat(e)),a.onConnectionStateChanged(ConnectionState$1.ABORTED,ConnectionChangeReason.INTERRUPTED)}},a.context=new Context(e,r),a.invitationManager.on("remoteInvitationInstance",(function(e){a.emit("RemoteInvitationReceived",e)})),a}return _createClass(n,[{key:"renewToken",value:function(){var e=_asyncToGenerator(regeneratorRuntime.mark((function e(t){var n,r,i,o=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if("string"==typeof t&&0!==t.length){e.next=2;break}throw new RtmInvalidArgumentError("Invalid argument",RENEW_TOKEN_ERR_INVALID_ARGUMENT);case 2:if("string"!=typeof t||!(t.length<APP_ID_LENGTH||t.slice(3,APP_ID_LENGTH+3)!==this.context.appId)){e.next=4;break}throw new RtmInvalidArgumentError("Invalid token",RENEW_TOKEN_ERR_INVALID_TOKEN);case 4:if(e.t0=this.connectionState===ConnectionState$1.ABORTED,!e.t0){e.next=8;break}return e.next=8,new Promise((function(){}));case 8:if(this.connectionState===ConnectionState$1.CONNECTED||this.connectionState===ConnectionState$1.RECONNECTING){e.next=10;break}throw new RtmInvalidStatusError("The client is not logged in",RENEW_TOKEN_ERR_USER_NOT_LOGGED_IN);case 10:if(void 0!==this.session){e.next=12;break}throw new CommonError({SESSION_NOT_FOUND:"Failed to get session of the client"});case 12:return e.prev=12,n=this.context.token,this.context.token=t,e.next=17,this.session.connection.apClient.apEdgeInfo$.pipe(throwIfEmpty((function(){return new Error("No available edge address to connect")})),retryWhen((function(e){return e.pipe(tap((function(e){if(isRtmError(e))throw e})),delay(2e3),take(4))})),first(),timeout(1e4),catchError((function(e){return isTimeout(e)&&o.warn("renewToken timed out"),throwError(e)}))).toPromise();case 17:r=e.sent,i=r.ticket,e.next=29;break;case 21:if(e.prev=21,e.t1=e["catch"](12),this.context.token=n,e.t1.code!==LOGIN_ERR_INVALID_APP_ID&&e.t1.code!==LOGIN_ERR_INVALID_TOKEN){e.next=25;break}throw new RtmUnauthenticatedError("Invalid token",RENEW_TOKEN_ERR_INVALID_TOKEN);case 25:if(e.t1.code!==LOGIN_ERR_TOKEN_EXPIRED){e.next=27;break}throw new RtmUnauthenticatedError("The token expired",RENEW_TOKEN_ERR_TOKEN_EXPIRED);case 27:if(!isTimeout(e.t1)){e.next=29;break}throw new RtmTimeoutError("Renew token timed out",RENEW_TOKEN_ERR_FAILURE);case 29:this.session.curLoginSockets.filter((function(e){return void 0!==e})).forEach((function(e){return e.ticket=i}));case 30:case"end":return e.stop()}}),e,this,[[12,21]])})));function t(t){return e.apply(this,arguments)}return t}()},{key:"login",value:function(){var e=_asyncToGenerator(regeneratorRuntime.mark((function e(t){var n,r,i,o=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(n=getRandomUInt64(),r=t.token,t.token===this.context.appId&&(r=void 0),wx.getSystemInfo({success:function(e){sendReport("Session",{appId:o.context.appId,did:"".concat(e.platform,"-").concat(e.model,"-").concat(e.version),elapse:getElapse(o.session&&o.session.startTime),index:{index1:t.uid,index2:o.context.appId,index3:"enableLogUpload=".concat(o.parameters.enableLogUpload)},installId:processId,lts:long_1.fromNumber(Date.now()),os:PLATFORM_TYPE,sid:getSid(n),token:r||"",userId:t.uid,ver:version,buildno:100*VERSION_NO+SUBVERSION,subVersion:SUBVERSION,version:VERSION_NO})}}),isPlainObject(t)&&isValidId(t.uid)){e.next=4;break}throw new RtmInvalidArgumentError("not a valid user id",LOGIN_ERR_INVALID_ARGUMENT);case 4:if("string"!=typeof r||!r){e.next=10;break}if(!(r.length<APP_ID_LENGTH+3||r.slice(3,APP_ID_LENGTH+3)!==this.context.appId)){e.next=7;break}throw new RtmInvalidArgumentError("Invalid token",LOGIN_ERR_INVALID_TOKEN);case 7:this.context.token=r,e.next=12;break;case 10:if("string"==typeof r||isNil_1(r)){e.next=12;break}throw new RtmInvalidArgumentError('The "token" is not a valid string.',LOGIN_ERR_INVALID_ARGUMENT);case 12:return i=Date.now(),this.context.sid=getSid(n),this.loginPromise=this.loginImpl({uid:t.uid,instanceId:n}),this.info("RTM Client logging in as ".concat(t.uid)),e.prev=14,e.next=17,this.loginPromise;case 17:e.next=22;break;case 19:throw e.prev=19,e.t0=e["catch"](14),isRtmError(e.t0)&&sendReport("Link",{ackedServerIp:"",destServerIp:"",ec:e.t0.code||1,sc:e.t0.serverCode,elapse:getElapse(this.session&&this.session.startTime),lts:long_1.fromNumber(Date.now()),responseTime:Date.now()-i,sid:getSid(n),userId:t.uid}),this.context.token=void 0,e.t0;case 22:return e.prev=22,this.loginPromise=void 0,e.finish(22);case 25:case"end":return e.stop()}}),e,this,[[14,19,22,25]])})));function t(t){return e.apply(this,arguments)}return t}()},{key:"logout",value:function(){var e=_asyncToGenerator(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(e.t0=this.loginPromise,!e.t0){e.next=4;break}return e.next=4,this.loginPromise;case 4:if(this.connectionState!==ConnectionState$1.DISCONNECTED){e.next=6;break}throw this.logError("Already in logout state"),new RtmInvalidStatusError("Logout failure. The client has already been logged out",LOGOUT_ERR_USER_NOT_LOGGED_IN);case 6:if(this.connectionState!==ConnectionState$1.ABORTED){e.next=8;break}return e.abrupt("return",(this.info('Reset connection state from "ABORTED" to "DISCONNECTED"'),void this.onConnectionStateChanged(ConnectionState$1.DISCONNECTED,ConnectionChangeReason.LOGOUT)));case 8:if(void 0===this.session){e.next=16;break}return sendReport("Logout",{elapse:getElapse(this.session.startTime),lts:long_1.fromNumber(Date.now()),sid:getSid(this.session.instanceId),userId:this.context.uid}),e.next=12,this.session.logoutHandler();case 12:this.onConnectionStateChanged(ConnectionState$1.DISCONNECTED,ConnectionChangeReason.LOGOUT),this.log("Log out success"),e.next=17;break;case 16:this.onConnectionStateChanged(ConnectionState$1.DISCONNECTED,ConnectionChangeReason.LOGOUT);case 17:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"sendMessageToPeer",value:function(){var e=_asyncToGenerator(regeneratorRuntime.mark((function e(t,n){var r,i,o,a,s,c,u=this,l=arguments;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(r=l.length>2&&void 0!==l[2]?l[2]:{},i=r.enableOfflineMessaging,o=void 0!==i&&i,a=r.enableHistoricalMessaging,s=void 0!==a&&a,validMessage(t,PEER_MESSAGE_ERR_INVALID_MESSAGE),this.connectionState!==ConnectionState$1.RECONNECTING){e.next=4;break}return c=Date.now(),e.abrupt("return",new Promise((function(e,r){var i,a=function(){var a=_asyncToGenerator(regeneratorRuntime.mark((function a(){var l;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(void 0!==u.session){a.next=2;break}throw new CommonError({SESSION_NOT_FOUND:"Failed to get session of the client"});case 2:return l=Date.now()-c,a.prev=3,a.t0=e,a.next=7,commonSendMessage({message:t,peerId:n,toPeer:!0,session:u.session,errorCodes:{NOT_LOGGED_IN:PEER_MESSAGE_ERR_USER_NOT_LOGGED_IN,TOO_OFTEN:PEER_MESSAGE_ERR_TOO_OFTEN},diff:l,options:{enableHistoricalMessaging:s,enableOfflineMessaging:o}});case 7:a.t1=a.sent,(0,a.t0)(a.t1),a.next=14;break;case 11:a.prev=11,a.t2=a["catch"](3),isTimeout(a.t2)&&r(new RtmTimeoutError(genTimeoutMessage(u.name,"sendMessageToPeer",MESSAGE_SEND_TIMEOUT),PEER_MESSAGE_ERR_TIMEOUT)),isRtmError(a.t2)&&r(a.t2),r(new RtmUnavailableError("Peer-to-peer message send failure",{code:PEER_MESSAGE_ERR_FAILURE,originalError:a.t2}));case 14:return a.prev=14,clearTimeout(i),a.finish(14);case 17:case"end":return a.stop()}}),a,null,[[3,11,14,17]])})));return function(){return a.apply(this,arguments)}}();u.internalEmitter.once("RECONNECTED",a),i=setTimeout((function(){u.internalEmitter.off("RECONNECTED",a),r(new RtmTimeoutError(genTimeoutMessage(u.name,"sendMessageToPeer",MESSAGE_SEND_TIMEOUT),PEER_MESSAGE_ERR_TIMEOUT))}),9e3)})));case 4:if(this.connectionState===ConnectionState$1.CONNECTED){e.next=6;break}throw new RtmInvalidStatusError("Failed to send the peer-to-peer message. The client is not logged in",PEER_MESSAGE_ERR_USER_NOT_LOGGED_IN);case 6:if(void 0!==this.session){e.next=8;break}throw new CommonError({SESSION_NOT_FOUND:"Failed to get session of the client"});case 8:return e.prev=8,e.next=11,commonSendMessage({message:t,peerId:n,toPeer:!0,session:this.session,errorCodes:{NOT_LOGGED_IN:PEER_MESSAGE_ERR_USER_NOT_LOGGED_IN,TOO_OFTEN:PEER_MESSAGE_ERR_TOO_OFTEN},diff:0,options:{enableHistoricalMessaging:s,enableOfflineMessaging:o}});case 11:return e.abrupt("return",e.sent);case 14:if(e.prev=14,e.t0=e["catch"](8),!isTimeout(e.t0)){e.next=18;break}throw new RtmTimeoutError(genTimeoutMessage(this.name,"sendMessageToPeer",MESSAGE_SEND_TIMEOUT),PEER_MESSAGE_ERR_TIMEOUT);case 18:if(!isRtmError(e.t0)){e.next=20;break}throw e.t0;case 20:throw new RtmUnavailableError("Peer-to-peer message send failure",{code:PEER_MESSAGE_ERR_FAILURE,originalError:e.t0});case 21:case"end":return e.stop()}}),e,this,[[8,14]])})));function t(t,n){return e.apply(this,arguments)}return t}()},{key:"createChannel",value:function(e){var t=this;if(!isValidId(e))throw new RtmInvalidArgumentError([invalidArgumentMessage,getName({channelId:e})],CREATE_CHANNEL_ERR_INVALID_ARGUMENT);return new Channel(e,(function(){return t.session}),this,this.logger)}},{key:"setChannelAttributes",value:function(){var e=_asyncToGenerator(regeneratorRuntime.mark((function e(t,n){var r,i,o,a,s,c=arguments;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(r=c.length>2&&void 0!==c[2]?c[2]:{},i=r.enableNotificationToChannelMembers,o=void 0!==i&&i,validAttributes({attributes:n,maxAttrValueSize:8192,maxAttrsCount:32,maxTotalSize:32768}),this.connectionState===ConnectionState$1.CONNECTED){e.next=3;break}throw new RtmInvalidStatusError("The client is not logged in",ATTRIBUTE_OPERATION_ERR_USER_NOT_LOGGED_IN);case 3:if(void 0!==this.session){e.next=5;break}throw new CommonError({SESSION_NOT_FOUND:"Failed to get session of the client"});case 5:return a=this.session.requestSetChannelAttributes(t,n,o).toPromise(),e.prev=6,e.next=9,a;case 9:s=mapValues_1(n,(function(e){return getUtf8StringSize(e)})),this.channelAttributesCacheLru.set(t,s),e.next=18;break;case 13:if(e.prev=13,e.t0=e["catch"](6),!isRtmError(e.t0)){e.next=17;break}throw e.t0;case 17:throw new RtmInvalidArgumentError("arguments is not valid",ATTRIBUTE_OPERATION_ERR_INVALID_ARGUMENT);case 18:case"end":return e.stop()}}),e,this,[[6,13]])})));function t(t,n){return e.apply(this,arguments)}return t}()},{key:"addOrUpdateChannelAttributes",value:function(){var e=_asyncToGenerator(regeneratorRuntime.mark((function e(t,n){var r,i,o,a,s,c=arguments;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(r=c.length>2&&void 0!==c[2]?c[2]:{},i=r.enableNotificationToChannelMembers,o=void 0!==i&&i,a=_objectSpread(_objectSpread({},this.channelAttributesCacheLru.get(t,{})),mapValues_1(n,(function(e){return getUtf8StringSize(e)}))),validAttributes({attributes:n,attrSizeMap:a,maxAttrValueSize:8192,maxAttrsCount:32,maxTotalSize:32768}),this.connectionState===ConnectionState$1.CONNECTED){e.next=4;break}throw new RtmInvalidStatusError("The client is not logged in",ATTRIBUTE_OPERATION_ERR_USER_NOT_LOGGED_IN);case 4:if(void 0!==this.session){e.next=6;break}throw new CommonError({SESSION_NOT_FOUND:"Failed to get session of the client"});case 6:return s=this.session.requestAddOrUpdateChannelAttributes(t,n,o).toPromise(),e.prev=7,e.next=10,s;case 10:this.channelAttributesCacheLru.set(t,a),e.next=18;break;case 13:if(e.prev=13,e.t0=e["catch"](7),!isRtmError(e.t0)){e.next=17;break}throw e.t0;case 17:throw new RtmInvalidArgumentError("arguments is not valid",ATTRIBUTE_OPERATION_ERR_INVALID_ARGUMENT);case 18:case"end":return e.stop()}}),e,this,[[7,13]])})));function t(t,n){return e.apply(this,arguments)}return t}()},{key:"deleteChannelAttributesByKeys",value:function(){var e=_asyncToGenerator(regeneratorRuntime.mark((function e(t,n){var r,i,o,a,s,c,u,l,d=arguments;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(r=d.length>2&&void 0!==d[2]?d[2]:{},i=r.enableNotificationToChannelMembers,o=void 0!==i&&i,Array.isArray(n)&&0!==n.length&&isValidId(t)&&!n.some((function(e){return 0===e.length||e.length>CHANNEL_ATTRIBUTES_MAX_KEY_COUNT}))){e.next=3;break}throw new RtmInvalidStatusError("arguments is not valid",ATTRIBUTE_OPERATION_ERR_INVALID_ARGUMENT);case 3:if(this.connectionState===ConnectionState$1.CONNECTED){e.next=5;break}throw new RtmInvalidStatusError("The client is not logged in",ATTRIBUTE_OPERATION_ERR_USER_NOT_LOGGED_IN);case 5:if(void 0!==this.session){e.next=7;break}throw new CommonError({SESSION_NOT_FOUND:"Failed to get session of the client"});case 7:return a=this.session.requestDeleteChannelAttributesByKeys(t,n,o).toPromise(),e.prev=8,e.next=11,a;case 11:if(s=this.channelAttributesCacheLru.get(t),s){c=_createForOfIteratorHelper(n);try{for(c.s();!(u=c.n()).done;)l=u.value,delete s[l]}catch(err){c.e(err)}finally{c.f()}}e.next=20;break;case 15:if(e.prev=15,e.t0=e["catch"](8),!isRtmError(e.t0)){e.next=19;break}throw e.t0;case 19:throw new RtmInvalidArgumentError("arguments is not valid",ATTRIBUTE_OPERATION_ERR_INVALID_ARGUMENT);case 20:case"end":return e.stop()}}),e,this,[[8,15]])})));function t(t,n){return e.apply(this,arguments)}return t}()},{key:"clearChannelAttributes",value:function(){var e=_asyncToGenerator(regeneratorRuntime.mark((function e(t){var n,r,i,o,a=arguments;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(n=a.length>1&&void 0!==a[1]?a[1]:{},r=n.enableNotificationToChannelMembers,i=void 0!==r&&r,this.connectionState===ConnectionState$1.CONNECTED){e.next=3;break}throw new RtmInvalidStatusError("The client is not logged in",ATTRIBUTE_OPERATION_ERR_USER_NOT_LOGGED_IN);case 3:if(void 0!==this.session){e.next=5;break}throw new CommonError({SESSION_NOT_FOUND:"Failed to get session of the client"});case 5:return o=this.session.requestClearChannelAttributes(t,i).toPromise(),e.prev=6,e.next=9,o;case 9:this.channelAttributesCacheLru.delete(t),e.next=17;break;case 12:if(e.prev=12,e.t0=e["catch"](6),!isRtmError(e.t0)){e.next=16;break}throw e.t0;case 16:throw new RtmInvalidArgumentError("arguments is not valid",ATTRIBUTE_OPERATION_ERR_INVALID_ARGUMENT);case 17:case"end":return e.stop()}}),e,this,[[6,12]])})));function t(t){return e.apply(this,arguments)}return t}()},{key:"getChannelAttributes",value:function(){var e=_asyncToGenerator(regeneratorRuntime.mark((function e(t){var n,r,i,o,a,s,c,u,l,d,f,h;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(isValidId(t)){e.next=2;break}throw new RtmInvalidArgumentError("Not a valid channel ID",ATTRIBUTE_OPERATION_ERR_INVALID_ARGUMENT);case 2:if(this.connectionState===ConnectionState$1.CONNECTED){e.next=4;break}throw new RtmInvalidStatusError("The client is not logged in",ATTRIBUTE_OPERATION_ERR_USER_NOT_LOGGED_IN);case 4:if(void 0!==this.session){e.next=6;break}throw new CommonError({SESSION_NOT_FOUND:"Failed to get session of the client"});case 6:return e.prev=6,e.next=9,this.session.requestGetChannelAttributesKeys(t).toPromise();case 9:return n=e.sent,r=n.keys,e.next=13,this.session.requestGetChannelAttributesByKeys(t,r).toPromise();case 13:i=e.sent,o=i.attributeMaps,e.next=22;break;case 17:if(e.prev=17,e.t0=e["catch"](6),!isRtmError(e.t0)){e.next=21;break}throw e.t0;case 21:throw new RtmInvalidArgumentError("arguments is not valid",ATTRIBUTE_OPERATION_ERR_INVALID_ARGUMENT);case 22:a={},s=_createForOfIteratorHelper(o),e.prev=24,s.s();case 26:if((c=s.n()).done){e.next=33;break}if(u=c.value,l=u.key,d=u.ms,f=u.value,h=u.origin,"string"==typeof l&&long_1.isLong(d)&&"string"==typeof f&&isValidId(h)){e.next=30;break}return e.abrupt("break",33);case 30:a[l]={value:f,lastUpdateUserId:h,lastUpdateTs:d.toNumber()};case 31:e.next=26;break;case 33:e.next=38;break;case 35:e.prev=35,e.t1=e["catch"](24),s.e(e.t1);case 38:return e.prev=38,s.f(),e.finish(38);case 41:return e.abrupt("return",(this.channelAttributesCacheLru.set(t,mapValues_1(a,(function(e){var t=e.value;return getUtf8StringSize(t)}))),a));case 42:case"end":return e.stop()}}),e,this,[[6,17],[24,35,38,41]])})));function t(t){return e.apply(this,arguments)}return t}()},{key:"getChannelAttributesByKeys",value:function(){var e=_asyncToGenerator(regeneratorRuntime.mark((function e(t,n){var r,i,o,a,s,c,u,l,d,f,h;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(this.connectionState===ConnectionState$1.CONNECTED){e.next=2;break}throw new RtmInvalidStatusError("The client is not logged in",ATTRIBUTE_OPERATION_ERR_USER_NOT_LOGGED_IN);case 2:if(void 0!==this.session){e.next=4;break}throw new CommonError({SESSION_NOT_FOUND:"Failed to get session of the client"});case 4:return checkValidAttrGetByKeysArgs(t,n),e.prev=5,e.next=8,this.session.requestGetChannelAttributesByKeys(t,n).toPromise();case 8:r=e.sent,i=r.attributeMaps,e.next=17;break;case 12:if(e.prev=12,e.t0=e["catch"](5),!isRtmError(e.t0)){e.next=16;break}throw e.t0;case 16:throw new RtmInvalidArgumentError("arguments is not valid",ATTRIBUTE_OPERATION_ERR_INVALID_ARGUMENT);case 17:o={},a=this.channelAttributesCacheLru.get(t,{}),s=_createForOfIteratorHelper(i),e.prev=19,s.s();case 21:if((c=s.n()).done){e.next=28;break}if(u=c.value,l=u.key,d=u.ms,f=u.value,h=u.origin,"string"==typeof l&&long_1.isLong(d)&&"string"==typeof f&&isValidId(h)){e.next=25;break}return e.abrupt("break",28);case 25:a[l]=getUtf8StringSize(f),o[l]={value:f,lastUpdateUserId:h,lastUpdateTs:d.toNumber()};case 26:e.next=21;break;case 28:e.next=33;break;case 30:e.prev=30,e.t1=e["catch"](19),s.e(e.t1);case 33:return e.prev=33,s.f(),e.finish(33);case 36:return e.abrupt("return",(this.channelAttributesCacheLru.set(t,a),o));case 37:case"end":return e.stop()}}),e,this,[[5,12],[19,30,33,36]])})));function t(t,n){return e.apply(this,arguments)}return t}()},{key:"createLocalInvitation",value:function(e){if(!isValidId(e))throw new RtmInvalidArgumentError([invalidArgumentMessage,getName({calleeId:e})],INVITATION_API_CALL_ERR_INVALID_ARGUMENT);return this.invitationManager.genLocalInvitation(e)}},{key:"loginImpl",value:function(){var e=_asyncToGenerator(regeneratorRuntime.mark((function e(t){var n,r,i,o,a=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(n=t.uid,r=t.instanceId,i=r,!(void 0!==this.lastLoginTime&&Date.now()-this.lastLoginTime<1e3/LOGIN_QPS_LIMIT)){e.next=4;break}throw new RtmInvokeTooOftenError(["The frequency of login exceeded the limit of %d queries per second",LOGIN_QPS_LIMIT],LOGIN_ERR_TOO_OFTEN);case 4:if(this.connectionState===ConnectionState$1.DISCONNECTED){e.next=6;break}throw new RtmInvalidStatusError("The SDK is either logging in or has logged in the Agora RTM system",LOGIN_ERR_ALREADY_LOGIN);case 6:e.prev=6,this.context.uid=n,e.next=13;break;case 10:throw e.prev=10,e.t0=e["catch"](6),new RtmInvalidArgumentError([invalidArgumentMessage,getName({uid:n})],LOGIN_ERR_INVALID_ARGUMENT);case 13:return this.onConnectionStateChanged(ConnectionState$1.CONNECTING,ConnectionChangeReason.LOGIN),o=new Session$2(this.context,new Connection(this.context,this.logger),i,this.logger),this.session=o,o.on("connectionLost",(function(){a.connectionState===ConnectionState$1.CONNECTED&&(a.onConnectionStateChanged(ConnectionState$1.RECONNECTING,ConnectionChangeReason.INTERRUPTED),a.session&&a.session.once("userJoined",(function(){a.onConnectionStateChanged(ConnectionState$1.CONNECTED,ConnectionChangeReason.LOGIN_SUCCESS)})))})),o.on("tokenExpired",(function(){a.emit("TokenExpired")})),o.once("userDrop",this.userDropHandler),this.session.on("peerTextMessage",(function(e){var t=e.peerId,n=e.text,r=e.properties,i=function(){return a.emit("MessageFromPeer",{text:n,messageType:RtmStatusCode$1.MessageType.TEXT},t,r)};a.connectionState!==ConnectionState$1.CONNECTED?Promise.resolve().then(i):i()})),o.on("channelAttributesUpdated",(function(e){var t,n=e.channelId,r=e.attributeMaps,i={},o=_createForOfIteratorHelper(r);try{for(o.s();!(t=o.n()).done;){var s=t.value,c=s.key,u=s.ms,l=s.value,d=s.origin;if("string"!=typeof c||!long_1.isLong(u)||"string"!=typeof l||!isValidId(d))break;i[c]=getUtf8StringSize(l)}}catch(err){o.e(err)}finally{o.f()}a.channelAttributesCacheLru.set(n,i)})),o.on("instanceChanged",(function(e){return i=e})),o.on("invitationMessage",this.invitationManager.invitationMessageHandler.bind(this.invitationManager)),this.lastLoginTime=Date.now(),e.prev=17,e.next=20,o.loginHandler().toPromise();case 20:e.next=29;break;case 22:if(e.prev=22,e.t1=e["catch"](17),!isTimeout(e.t1)){e.next=26;break}throw this.onConnectionStateChanged(ConnectionState$1.DISCONNECTED,ConnectionChangeReason.LOGIN_TIMEOUT),new RtmTimeoutError(genTimeoutMessage(this.name,"login",CLIENT_LOGIN_TIMEOUT),LOGIN_ERR_TIMEOUT);case 26:if(this.onConnectionStateChanged(ConnectionState$1.DISCONNECTED,ConnectionChangeReason.LOGIN_FAILURE),!isRtmError(e.t1)){e.next=28;break}throw e.t1;case 28:throw new RtmUnavailableError("Login failure",{code:LOGIN_ERR_UNKNOWN,originalError:e.t1});case 29:this.onConnectionStateChanged(ConnectionState$1.CONNECTED,ConnectionChangeReason.LOGIN_SUCCESS);case 30:case"end":return e.stop()}}),e,this,[[6,10],[17,22]])})));function t(t){return e.apply(this,arguments)}return t}()},{key:"onConnectionStateChanged",value:function(e,t){e===ConnectionState$1.RECONNECTING&&(this.reconnId+=1),sendReport("ConnectionStateChange",{elapse:getElapse(this.session&&this.session.startTime),lts:long_1.fromNumber(Date.now()),newState:connectionStateCodeMap[e],oldState:connectionStateCodeMap[this.connectionState],reason:connectionStateChangeReason[t],sid:getSid(this.session&&this.session.instanceId||long_1.fromNumber(0)),userId:this.context.uid,reconnId:this.reconnId}),this.connectionState===ConnectionState$1.RECONNECTING&&e===ConnectionState$1.CONNECTED&&this.internalEmitter.emit("RECONNECTED"),this.connectionState=e,e!==ConnectionState$1.ABORTED&&e!==ConnectionState$1.DISCONNECTED||(this.reconnId=0,this.session&&(this.session.removeAllListeners(),this.session.joinedChannels.clear(),this.session.msgDedupLru.empty(),this.session.dialogueSequenceLru.empty()),this.session=void 0,this.context.token=void 0),this.emit("ConnectionStateChanged",e,t)}}]),n}(createEventBase()),_class$2=_temp$2,_applyDecoratedDescriptor(_class$2.prototype,"renewToken",[logged],Object.getOwnPropertyDescriptor(_class$2.prototype,"renewToken"),_class$2.prototype),_applyDecoratedDescriptor(_class$2.prototype,"login",[logged],Object.getOwnPropertyDescriptor(_class$2.prototype,"login"),_class$2.prototype),_applyDecoratedDescriptor(_class$2.prototype,"logout",[logged],Object.getOwnPropertyDescriptor(_class$2.prototype,"logout"),_class$2.prototype),_applyDecoratedDescriptor(_class$2.prototype,"sendMessageToPeer",[logged],Object.getOwnPropertyDescriptor(_class$2.prototype,"sendMessageToPeer"),_class$2.prototype),_applyDecoratedDescriptor(_class$2.prototype,"createChannel",[logged],Object.getOwnPropertyDescriptor(_class$2.prototype,"createChannel"),_class$2.prototype),_applyDecoratedDescriptor(_class$2.prototype,"setChannelAttributes",[logged],Object.getOwnPropertyDescriptor(_class$2.prototype,"setChannelAttributes"),_class$2.prototype),_applyDecoratedDescriptor(_class$2.prototype,"addOrUpdateChannelAttributes",[logged],Object.getOwnPropertyDescriptor(_class$2.prototype,"addOrUpdateChannelAttributes"),_class$2.prototype),_applyDecoratedDescriptor(_class$2.prototype,"deleteChannelAttributesByKeys",[logged],Object.getOwnPropertyDescriptor(_class$2.prototype,"deleteChannelAttributesByKeys"),_class$2.prototype),_applyDecoratedDescriptor(_class$2.prototype,"clearChannelAttributes",[logged],Object.getOwnPropertyDescriptor(_class$2.prototype,"clearChannelAttributes"),_class$2.prototype),_applyDecoratedDescriptor(_class$2.prototype,"getChannelAttributes",[logged],Object.getOwnPropertyDescriptor(_class$2.prototype,"getChannelAttributes"),_class$2.prototype),_applyDecoratedDescriptor(_class$2.prototype,"getChannelAttributesByKeys",[logged],Object.getOwnPropertyDescriptor(_class$2.prototype,"getChannelAttributesByKeys"),_class$2.prototype),_applyDecoratedDescriptor(_class$2.prototype,"createLocalInvitation",[logged],Object.getOwnPropertyDescriptor(_class$2.prototype,"createLocalInvitation"),_class$2.prototype),_class$2),ConnectionChangeReason$1=RtmStatusCode$1.ConnectionChangeReason,ConnectionState$2=RtmStatusCode$1.ConnectionState,MessageType$1=RtmStatusCode$1.MessageType;void 0===Number.MAX_SAFE_INTEGER&&(Number.MAX_SAFE_INTEGER=9007199254740991);var LogFilter={LOG_FILTER_OFF:{error:!1,warn:!1,info:!1,track:!1,debug:!1},LOG_FILTER_ERROR:{error:!0,warn:!1,info:!1,track:!1,debug:!1},LOG_FILTER_WARNING:{error:!0,warn:!0,info:!1,track:!1,debug:!1},LOG_FILTER_INFO:{error:!0,warn:!0,info:!0,track:!1,debug:!1},LOG_FILTER_DEBUG:{error:!0,warn:!0,info:!0,track:!0,debug:!0}};function createInstance(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.enableLogUpload,r=void 0!==n&&n,i=t.logFilter,o=void 0===i?LogFilter.LOG_FILTER_INFO:i;if(!isValidAppId(e))throw new RtmInvalidArgumentError([invalidArgumentMessage,getName({appId:e})],CREATE_INSTANCE_ERR_INVALID_ARGUMENT);var a={enableLogUpload:r,logFilter:o},s=initLoggerId(),c=genInfoLogger(a),u=genWarnLogger(a),l=genErrorLogger(a),d=trackLoggerGenerator(s,a),f=debugLoggerGenerator(s,a),h=f("RTM:DEBUG","<Entry> ");return c("The Agora RTM Web SDK version is %s",version),h("Creating an RtmClient instance"),h('The Git commit ID is "'.concat(BUILD,'"')),h("The App ID is %s",e),c("The process ID is %s",processId),c("The build is %s",BUILD),h("process.env.NODE_ENV is %s","production"),new Client(e,{genLogger:f,genTracker:d,info:c,warn:u,logError:l,loggerId:s},a,(function(e){var t,n=_createForOfIteratorHelper(getKeys(e));try{for(n.s();!(t=n.n()).done;){var r=t.value,i=e[r];null!=i&&(a[r]=i)}}catch(err){n.e(err)}finally{n.f()}}))}var MUTABLE_PARAMS={DISABLE_MESSAGE_COMPRESSION:!1};function setParameter(e,t){Object.keys(MUTABLE_PARAMS).includes(e)&&(MUTABLE_PARAMS[e]=t)}function getParameter(e){return MUTABLE_PARAMS[e]}var AgoraRTM=_objectSpread({createInstance:createInstance,BUILD:BUILD,VERSION:version,processId:processId,ConnectionChangeReason:ConnectionChangeReason$1,ConnectionState:ConnectionState$2,MessageType:MessageType$1,setParameter:setParameter,getParameter:getParameter},LogFilter);module.exports=AgoraRTM}).call(this,__webpack_require__("c8ba"),__webpack_require__("4362"))},ff61:function(e,t,n){"use strict";var r=n("3bb0"),i=n.n(r);i.a}}]);