(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-plus-chat-chat_list"],{"0893":function(e,t,i){var s=i("7088e");"string"===typeof s&&(s=[[e.i,s,""]]),s.locals&&(e.exports=s.locals);var n=i("4f06").default;n("79b2ad79",s,!0,{sourceMap:!1,shadowMode:!1})},3198:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var s={data:function(){return{imList:[],user_id:"",official:"",logistic:"",socketTask:null,is_open_socket:!1,url:"",intervalId:null,is_live:!1,my_user_id:""}},onShow:function(){this.get_im_list()},onLoad:function(){this.my_user_id=uni.getStorageSync("user_id")},beforeDestroy:function(){console.log("beforeDestroy"),this.closeSocket(),this.is_live=!0},methods:{send:function(e){var t=this;t.is_open_socket?t.socketTask.send({data:e,success:function(){}}):(console.log("处于离线状态"),t.socketTask=null,t.is_open_socket=!1,clearInterval(t.intervalId),t.socketInit())},socketInit:function(){var e=this;e.is_open_socket||(e.socketTask=null,e.socketTask=uni.connectSocket({url:e.url+"/socket?user_id="+e.getUserId()+"&usertype=user&to=0",success:function(){console.log("Socket连接成功！")}}),e.socketTask.onOpen((function(t){console.log("WebSocket连接正常打开中...！"),e.is_open_socket=!0,e.startHeart(),e.socketTask.onMessage((function(t){console.log("收到服务器内容："),console.log(t),e.getNewcontent(t)}))})),e.socketTask.onClose((function(){console.log("已经被关闭了"),e.socketTask=null,e.is_open_socket=!1,clearInterval(e.intervalId),!e.is_live&&e.socketInit()})))},getNewcontent:function(e){var t=JSON.parse(e.data);if("init"==t.type){var i=this;i._post("plus.chat.chat/bindClient",{client_id:t.client_id,supplier_user_id:0},(function(e){}))}},get_im_list:function(){var e=this;e._post("plus.chat.chat/index",{},(function(t){console.log(t),e.imList=t.data.list,e.official=t.data.official,e.logistic=t.data.logistic,""==e.url&&(e.url=t.data.url,e.$nextTick((function(){e.socketInit()})))}))},closeSocket:function(){var e=this,t=JSON.stringify({type:"close",app_id:e.getAppId(),supplier_user_id:0,user_id:e.my_user_id,shop_supplier_id:0,msg_type:2});e.send(t),e.socketTask.close({success:function(e){console.log("关闭成功",e)},fail:function(e){console.log("关闭失败",e)}}),e.socketTask=null,e.is_open_socket=!1,clearInterval(e.intervalId)},jumpPage:function(e,t,i){if(t==uni.getStorageInfoSync("user_id"))return!1;this.gotoPage("/pages/plus/chat/chat?user_id="+e+"&shop_supplier_id="+t+"&nickName="+i)},gotoMessage:function(e){this.gotoPage("/pages/im/message?type="+e)}}};t.default=s},"40e4":function(e,t,i){"use strict";var s=i("0893"),n=i.n(s);n.a},"5a13":function(e,t,i){"use strict";i.r(t);var s=i("fb27"),n=i("cb63");for(var o in n)"default"!==o&&function(e){i.d(t,e,(function(){return n[e]}))}(o);i("40e4");var a,c=i("f0c5"),l=Object(c["a"])(n["default"],s["b"],s["c"],!1,null,"00e1dede",null,!1,s["a"],a);t["default"]=l.exports},"7088e":function(e,t,i){var s=i("24fb");t=s(!1),t.push([e.i,".im_index[data-v-00e1dede]{width:100%}.im_item[data-v-00e1dede]{width:90%;height:%?120?%;margin:0 auto;display:flex;align-items:center}.im_item_left[data-v-00e1dede]{box-sizing:border-box;display:flex;justify-content:center;align-items:center}.im_item_left uni-image[data-v-00e1dede]{width:%?80?%;height:%?80?%;margin:0 auto;margin-top:5%;border-radius:50%;background-color:rgba(0,0,0,.1)}.im_item_right[data-v-00e1dede]{width:%?555?%;padding:%?10?%;border-bottom:1px #dcdcdc solid;box-sizing:border-box;display:flex;flex-direction:column}.message[data-v-00e1dede]{width:%?30?%;height:%?30?%;border-radius:50%;color:#fff;background-color:red;display:flex;justify-content:center;align-items:center;font-size:%?15?%}.im_item_right_item[data-v-00e1dede]{display:flex;align-items:center;justify-content:space-between;margin-bottom:%?10?%}.title[data-v-00e1dede]{font-size:%?32?%}.guangfang[data-v-00e1dede]{font-size:%?16?%;color:#f36a24;border:%?1?% #f36a24 solid;border-radius:%?10?%;padding:%?5?% %?10?%;box-sizing:border-box;position:relative;left:%?-65?%}.time[data-v-00e1dede]{font-size:%?26?%;color:#999;flex-shrink:0}.content[data-v-00e1dede]{font-size:%?26?%;color:#999;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;overflow:hidden;word-break:break-all}.hint[data-v-00e1dede]{width:%?750?%;text-align:center;font-size:%?32?%;color:#585858;margin-top:%?20?%}",""]),e.exports=t},cb63:function(e,t,i){"use strict";i.r(t);var s=i("3198"),n=i.n(s);for(var o in s)"default"!==o&&function(e){i.d(t,e,(function(){return s[e]}))}(o);t["default"]=n.a},fb27:function(e,t,i){"use strict";var s;i.d(t,"b",(function(){return n})),i.d(t,"c",(function(){return o})),i.d(t,"a",(function(){return s}));var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("v-uni-view",{staticClass:"im_index"},[e._l(e.imList,(function(t,s){return i("v-uni-view",{key:s,staticClass:"im_item",on:{click:function(i){arguments[0]=i=e.$handleEvent(i),e.jumpPage(t.supplier_user_id,t.shop_supplier_id,t.supplier.name)}}},[i("v-uni-view",{staticClass:"im_item_left"},[i("v-uni-image",{attrs:{src:t.supplier.logo.file_path,mode:""}})],1),i("v-uni-view",{staticClass:"im_item_right"},[i("v-uni-view",{staticClass:"im_item_right_item"},[i("v-uni-view",{staticClass:"title text-ellipsis"},[e._v(e._s(t.supplier.name))]),i("v-uni-view",{staticClass:"time"},[e._v(e._s(t.newMessage.create_time))])],1),i("v-uni-view",{staticClass:"im_item_right_item"},[0==t.newMessage.type?i("v-uni-view",{staticClass:"content"},[e._v(e._s(t.newMessage.content))]):e._e(),1==t.newMessage.type?i("v-uni-view",{staticClass:"content"},[e._v("[图片]")]):e._e(),2==t.newMessage.type?i("v-uni-view",{staticClass:"content"},[e._v("[商品]")]):e._e(),t.num>0?i("v-uni-view",{staticClass:"message"},[e._v(e._s(t.num))]):e._e()],1)],1)],1)})),0==e.imList.length?i("v-uni-view",{staticClass:"hint"},[e._v("您当前并没有与任何人聊天哦！")]):e._e()],2)},o=[]}}]);